<div class="row">
  <div class="col-xl-4 col-lg-5 pr-0">
    <div class="card" style="height:625px">
      <div class="card-block p-0">
        <strong>
          <table class="table table-striped table-hover mb-0">
            <tbody>
              <tr (click)="currentSection = undefined">
                <td>
                  <i class="fa fa-check" aria-hidden="true"></i>
                </td>
                <td>Genel Toplam:</td>
                <td>{{detailData.total_income  | number:'1.0-2'}} TL</td>
              </tr>
              <tr class="text-muted" (click)="filterOldData('Checks','All')">
                <td>
                  <i class="fa fa-sticky-note" aria-hidden="true"></i>
                </td>
                <td>Toplam Hesap Sayısı:</td>
                <td>{{detailData.check_count}} Adet</td>
              </tr>
              <tr class="text-success" (click)="filterOldData('Checks','Nakit')">
                <td width="4%">
                  <i class="fa fa-money" aria-hidden="true"></i>
                </td>
                <td width="60%">Nakit Hesap Toplamı:</td>
                <td>{{detailData.cash_total  | number:'1.0-2'}} TL</td>
              </tr>
              <tr class="text-warning" (click)="filterOldData('Checks','Kart')">
                <td>
                  <i class="fa fa-credit-card" aria-hidden="true"></i>
                </td>
                <td>Kart Hesap Toplamı:</td>
                <td>{{detailData.card_total  | number:'1.0-2'}} TL</td>
              </tr>
              <tr class="text-info" (click)="filterOldData('Checks','Kupon')">
                <td>
                  <i class="fa fa-bookmark ml-1" aria-hidden="true"></i>
                </td>
                <td>Kupon Hesap Toplamı:</td>
                <td>{{detailData.coupon_total  | number:'1.0-2'}} TL</td>
              </tr>
              <tr class="text-danger" (click)="filterOldData('Checks','İkram')">
                <td>
                  <i class="fa fa-handshake-o" aria-hidden="true"></i>
                </td>
                <td>İkram Hesap Toplamı:</td>
                <td>{{detailData.free_total  | number:'1.0-2'}} TL</td>
              </tr>
              <tr class="text-primary" (click)="filterOldData('Checks','İptal')">
                <td>
                  <i class="fa fa-times-rectangle" aria-hidden="true"></i>
                </td>
                <td>İptal Hesap Toplamı:</td>
                <td>{{detailData.canceled_total  | number:'1.0-2'}} TL</td>
              </tr>
              <tr (click)="filterOldData('Cashbox','Gelir')">
                <td>
                  <i class="fa fa-arrow-down" aria-hidden="true"></i>
                </td>
                <td>Kasa Geliri Toplamı:</td>
                <td>{{detailData.incomes  | number:'1.0-2'}} TL</td>
              </tr>
              <tr (click)="filterOldData('Cashbox','Gider')">
                <td>
                  <i class="fa fa-arrow-up" aria-hidden="true"></i>
                </td>
                <td>Kasa Gideri Toplamı:</td>
                <td>{{detailData.outcomes  | number:'1.0-2'}} TL</td>
              </tr>
              <tr>
                <td>
                  <i class="fa fa-user" aria-hidden="true"></i>
                </td>
                <td>Kullanıcı:</td>
                <td>{{detailData.owner | general:'users' | async}}</td>
              </tr>
              <tr>
                <td>
                  <i class="fa fa-calendar" aria-hidden="true"></i>
                </td>
                <td>Tarih:</td>
                <td>{{detailData.time | date:'d/M/y'}}</td>
              </tr>
              <tr>
                <td>
                  <i class="fa fa-clock-o" aria-hidden="true"></i>
                </td>
                <td>Saat:</td>
                <td>{{detailData.time | date:'HH:mm'}}</td>
              </tr>
            </tbody>
          </table>
        </strong>
      </div>
      <div class="card-footer p-1 text-center">
        <small *ngIf="oldBackupData == undefined">
          <i class="fa fa-refresh fa-spin" aria-hidden="true"></i> Veriler Senkorinize Ediliyor
        </small>
        <small *ngIf="syncStatus && oldBackupData !== undefined" class="text-success">
          <i class="fa fa-check" aria-hidden="true"></i> Senkorinize Edildi
        </small>
        <small *ngIf="!syncStatus && oldBackupData !== undefined" class="text-danger">
          <i class="fa fa-times" aria-hidden="true"></i> Senkorinize Edilemedi
        </small>
      </div>
    </div>
  </div>
  <div class="col-xl-8 col-lg-7 pl-0">
    <div class="card" style="height:625px">
      <div class="card-header">
        Detaylar
      </div>
      <div class="card-block flow p-0">
        <div class="row">
          <div class="col-lg-12">
            <section *ngIf="currentSection == undefined" id="chart" class="p-3">
              <canvas baseChart style="height:525px; width:95%;  margin:auto;" [data]="pieData" [colors]="pieColors" [labels]="pieLabels"
                [legend]="true" chartType="pie" [options]="pieOptions"></canvas>
            </section>
            <section id="checks" *ngIf="currentSection == 'Checks'">
              <table class="table table-striped table-hover table-bordered mb-0">
                <thead class="thead-inverse">
                  <tr>
                    <th width="8%">#</th>
                    <th width="35%">Hesap</th>
                    <th width="15%">Kullanıcı</th>
                    <th width="17%">Tutar</th>
                    <th width="10%">Saat</th>
                    <th width="15%">Ödeme</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of checksTable; let i = index" (click)="showCheckDetail(item)">
                    <td>{{i+1}}</td>
                    <td>{{item.table_id | general:'tables' | async}}
                      <small *ngIf="item.note !== '' && item.note !== undefined" class="text-muted">({{item.note}})</small>
                    </td>
                    <td>{{item.owner}}</td>
                    <td>{{item.total_price  | number:'1.0-2'}} TL
                      <small *ngIf="item.discount !== 0" class="text-danger pull-right">
                        <i class="fa fa-arrow-down" aria-hidden="true"></i> {{item.discount}} TL</small>
                    </td>
                    <td>{{item.timestamp | date:'HH:MM'}}</td>
                    <td>{{item.payment_method}}</td>
                  </tr>
                </tbody>
              </table>
            </section>
            <section id="cashbox" *ngIf="currentSection == 'Cashbox'">
              <table class="table table-bordered table-hover table-striped">
                <thead class="thead-inverse">
                  <tr>
                    <th width="8%">#</th>
                    <th width="40%">Açıklama</th>
                    <th width="20%">Kullanıcı</th>
                    <th width="12%">Saat</th>
                    <th width="20%">Tutar</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let cash of cashboxTable; let i=index" (click)="showCashDetail(cash)">
                    <td>{{i+1}}</td>
                    <td>{{cash.description}}</td>
                    <td>{{cash.user}}</td>
                    <td>{{cash.time | date:'HH:mm'}}</td>
                    <td>{{cash.cash + cash.card + cash.coupon  | number:'1.0-2'}} TL</td>
                  </tr>
                </tbody>
              </table>
            </section>
            <section id="reports" *ngIf="currentSection == 'Reports'">

            </section>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="checkDetail" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-md" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Hesap Detayı
        </h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <div class="card checkDetail">
          <div class="card-header">
            <b>{{checkDetail?.table_id | general:'tables' | async}}
              <small class="text-muted"> ({{checkDetail?.timestamp | date:'dd/M/y HH:mm'}})</small>
            </b>
            <span class="pull-right text-muted"> Hesap Türü : {{checkDetail?.payment_method}}</span>
          </div>
          <div class="card-block flow p-0">
            <table *ngIf="checkDetail?.payment_method != 'Parçalı'" class="table table-striped table-sm table-bordered mb-0">
              <thead class="thead-inverse">
                <th>#</th>
                <th>Ürün</th>
                <th>Garson</th>
                <th>Saat</th>
                <th>Fiyat</th>
              </thead>
              <tbody>
                <tr *ngFor="let item of checkDetail?.products; let i = index;" [ngClass]="{'table-danger': item.status == 3}">
                  <td width="5%">{{i+1}}</td>
                  <td width="49%">{{item.name}}
                    <small *ngIf="item.note !== '' && item.note !== undefined" class="text-muted">({{item.note}})</small>
                  </td>
                  <td width="17%">{{item.owner}}</td>
                  <td width="14%">{{item.timestamp |date:'HH:mm'}}</td>
                  <td width="14%">{{item.price  | number:'1.0-2'}} TL</td>
                </tr>
              </tbody>
            </table>
            <section *ngIf="checkDetail?.payment_method == 'Parçalı'">
              <table *ngFor="let item of checkDetail?.payment_flow; let i = index;" class="table table-sm table-bordered table-striped mb-0">
                <thead class="thead-inverse">
                  <th>#</th>
                  <th>{{item.owner}}</th>
                  <th>{{item.method}}</th>
                  <th>{{item.timestamp | date:'HH:mm'}}</th>
                  <th>{{item.amount + item.discount}} TL</th>
                </thead>
                <tbody>
                  <tr *ngIf="item.discount > 0" class="table-info">
                    <td width="4%">
                      <i class="fa fa-arrow-down" aria-hidden="true"></i>
                    </td>
                    <td width="48%">İndirim Tutarı</td>
                    <td width="15%"></td>
                    <td width="15%"></td>
                    <td width="17%">{{item.discount}} TL</td>
                  </tr>
                  <tr *ngFor="let product of item.payed_products; let i = index;" [ngClass]="{'table-danger': product.status == 3}">
                    <td width="4%">{{i+1}}</td>
                    <td width="48%">{{product.name}}
                      <small *ngIf="product.note !== '' && product.note !== undefined" class="text-muted">({{product.note}})</small>
                    </td>
                    <td width="15%">{{product.owner}}</td>
                    <td width="15%">{{product.timestamp |date:'HH:mm'}}</td>
                    <td width="17%">{{product.price  | number:'1.0-2'}} TL</td>
                  </tr>
                </tbody>
              </table>
            </section>
          </div>
          <div class="card-footer">
            <b>
              <i class="fa fa-user mr-1" aria-hidden="true"></i> Kullanıcı:
              <span class="pull-right">{{checkDetail?.owner}}</span>
            </b>
          </div>
          <div *ngIf="checkDetail?.discount > 0" class="card-footer">
            <b>
              <i class="fa fa-arrow-down" aria-hidden="true"></i> Toplam İndirim Tutarı:
              <span class="pull-right">{{checkDetail?.discount}} TL</span>
            </b>
          </div>
          <div class="card-footer">
            <b>
              <i class="fa fa-check" aria-hidden="true"></i> Ödenen Miktar:
              <span class="pull-right">{{checkDetail?.total_price  | number:'1.0-2' }} TL</span>
            </b>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal" aria-label="Close">Kapat</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="cashDetail" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="modelTitleId">{{cashDetail?.type}} Hareketi</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body p-0">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">{{cashDetail?.description}}</h5>
          </div>
          <div class="card-block p-0">
            <strong>
              <table class="table table-striped mb-0">
                <tbody>
                  <tr class="table-success">
                    <td width="10%">
                      <i class="fa fa-money" aria-hidden="true"></i>
                    </td>
                    <td>Nakit:</td>
                    <td width="20%">
                      <span class="pull-right">{{cashDetail?.cash  | number:'1.0-2' }} TL</span>
                    </td>
                  </tr>
                  <tr class="table-warning">
                    <td width="10%">
                      <i class="fa fa-credit-card" aria-hidden="true"></i>
                    </td>
                    <td>Kart:</td>
                    <td width="20%">
                      <span class="pull-right">{{cashDetail?.card  | number:'1.0-2' }} TL</span>
                    </td>
                  </tr>
                  <tr class="table-info">
                    <td width="10%">
                      <i class="fa fa-bookmark ml-1" aria-hidden="true"></i>
                    </td>
                    <td>Kupon:</td>
                    <td width="20%">
                      <span class="pull-right">{{cashDetail?.coupon  | number:'1.0-2' }} TL</span>
                    </td>
                  </tr>
                  <tr>
                    <td width="10%">
                      <i class="fa fa-check" aria-hidden="true"></i>
                    </td>
                    <td>Toplam:</td>
                    <td width="20%">
                      <span class="pull-right">{{cashDetail?.coupon + cashDetail?.cash + cashDetail?.card  | number:'1.0-2' }} TL</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </strong>
          </div>
          <div class="card-footer">
            <i class="fa fa-user" aria-hidden="true"></i> {{cashDetail?.user}}
            <span class="pull-right">
              {{cashDetail?.time | date:'HH:MM'}}
            </span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal">Kapat</button>
      </div>
    </div>
  </div>
</div>