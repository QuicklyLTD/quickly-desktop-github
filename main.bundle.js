webpackJsonp(["main"],{

/***/ "./node_modules/moment/locale recursive ^\\.\\/.*$":
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./af": "./node_modules/moment/locale/af.js",
	"./af.js": "./node_modules/moment/locale/af.js",
	"./ar": "./node_modules/moment/locale/ar.js",
	"./ar-dz": "./node_modules/moment/locale/ar-dz.js",
	"./ar-dz.js": "./node_modules/moment/locale/ar-dz.js",
	"./ar-kw": "./node_modules/moment/locale/ar-kw.js",
	"./ar-kw.js": "./node_modules/moment/locale/ar-kw.js",
	"./ar-ly": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ly.js": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ma": "./node_modules/moment/locale/ar-ma.js",
	"./ar-ma.js": "./node_modules/moment/locale/ar-ma.js",
	"./ar-sa": "./node_modules/moment/locale/ar-sa.js",
	"./ar-sa.js": "./node_modules/moment/locale/ar-sa.js",
	"./ar-tn": "./node_modules/moment/locale/ar-tn.js",
	"./ar-tn.js": "./node_modules/moment/locale/ar-tn.js",
	"./ar.js": "./node_modules/moment/locale/ar.js",
	"./az": "./node_modules/moment/locale/az.js",
	"./az.js": "./node_modules/moment/locale/az.js",
	"./be": "./node_modules/moment/locale/be.js",
	"./be.js": "./node_modules/moment/locale/be.js",
	"./bg": "./node_modules/moment/locale/bg.js",
	"./bg.js": "./node_modules/moment/locale/bg.js",
	"./bm": "./node_modules/moment/locale/bm.js",
	"./bm.js": "./node_modules/moment/locale/bm.js",
	"./bn": "./node_modules/moment/locale/bn.js",
	"./bn.js": "./node_modules/moment/locale/bn.js",
	"./bo": "./node_modules/moment/locale/bo.js",
	"./bo.js": "./node_modules/moment/locale/bo.js",
	"./br": "./node_modules/moment/locale/br.js",
	"./br.js": "./node_modules/moment/locale/br.js",
	"./bs": "./node_modules/moment/locale/bs.js",
	"./bs.js": "./node_modules/moment/locale/bs.js",
	"./ca": "./node_modules/moment/locale/ca.js",
	"./ca.js": "./node_modules/moment/locale/ca.js",
	"./cs": "./node_modules/moment/locale/cs.js",
	"./cs.js": "./node_modules/moment/locale/cs.js",
	"./cv": "./node_modules/moment/locale/cv.js",
	"./cv.js": "./node_modules/moment/locale/cv.js",
	"./cy": "./node_modules/moment/locale/cy.js",
	"./cy.js": "./node_modules/moment/locale/cy.js",
	"./da": "./node_modules/moment/locale/da.js",
	"./da.js": "./node_modules/moment/locale/da.js",
	"./de": "./node_modules/moment/locale/de.js",
	"./de-at": "./node_modules/moment/locale/de-at.js",
	"./de-at.js": "./node_modules/moment/locale/de-at.js",
	"./de-ch": "./node_modules/moment/locale/de-ch.js",
	"./de-ch.js": "./node_modules/moment/locale/de-ch.js",
	"./de.js": "./node_modules/moment/locale/de.js",
	"./dv": "./node_modules/moment/locale/dv.js",
	"./dv.js": "./node_modules/moment/locale/dv.js",
	"./el": "./node_modules/moment/locale/el.js",
	"./el.js": "./node_modules/moment/locale/el.js",
	"./en-SG": "./node_modules/moment/locale/en-SG.js",
	"./en-SG.js": "./node_modules/moment/locale/en-SG.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./eo": "./node_modules/moment/locale/eo.js",
	"./eo.js": "./node_modules/moment/locale/eo.js",
	"./es": "./node_modules/moment/locale/es.js",
	"./es-do": "./node_modules/moment/locale/es-do.js",
	"./es-do.js": "./node_modules/moment/locale/es-do.js",
	"./es-us": "./node_modules/moment/locale/es-us.js",
	"./es-us.js": "./node_modules/moment/locale/es-us.js",
	"./es.js": "./node_modules/moment/locale/es.js",
	"./et": "./node_modules/moment/locale/et.js",
	"./et.js": "./node_modules/moment/locale/et.js",
	"./eu": "./node_modules/moment/locale/eu.js",
	"./eu.js": "./node_modules/moment/locale/eu.js",
	"./fa": "./node_modules/moment/locale/fa.js",
	"./fa.js": "./node_modules/moment/locale/fa.js",
	"./fi": "./node_modules/moment/locale/fi.js",
	"./fi.js": "./node_modules/moment/locale/fi.js",
	"./fo": "./node_modules/moment/locale/fo.js",
	"./fo.js": "./node_modules/moment/locale/fo.js",
	"./fr": "./node_modules/moment/locale/fr.js",
	"./fr-ca": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "./node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
	"./fr.js": "./node_modules/moment/locale/fr.js",
	"./fy": "./node_modules/moment/locale/fy.js",
	"./fy.js": "./node_modules/moment/locale/fy.js",
	"./ga": "./node_modules/moment/locale/ga.js",
	"./ga.js": "./node_modules/moment/locale/ga.js",
	"./gd": "./node_modules/moment/locale/gd.js",
	"./gd.js": "./node_modules/moment/locale/gd.js",
	"./gl": "./node_modules/moment/locale/gl.js",
	"./gl.js": "./node_modules/moment/locale/gl.js",
	"./gom-latn": "./node_modules/moment/locale/gom-latn.js",
	"./gom-latn.js": "./node_modules/moment/locale/gom-latn.js",
	"./gu": "./node_modules/moment/locale/gu.js",
	"./gu.js": "./node_modules/moment/locale/gu.js",
	"./he": "./node_modules/moment/locale/he.js",
	"./he.js": "./node_modules/moment/locale/he.js",
	"./hi": "./node_modules/moment/locale/hi.js",
	"./hi.js": "./node_modules/moment/locale/hi.js",
	"./hr": "./node_modules/moment/locale/hr.js",
	"./hr.js": "./node_modules/moment/locale/hr.js",
	"./hu": "./node_modules/moment/locale/hu.js",
	"./hu.js": "./node_modules/moment/locale/hu.js",
	"./hy-am": "./node_modules/moment/locale/hy-am.js",
	"./hy-am.js": "./node_modules/moment/locale/hy-am.js",
	"./id": "./node_modules/moment/locale/id.js",
	"./id.js": "./node_modules/moment/locale/id.js",
	"./is": "./node_modules/moment/locale/is.js",
	"./is.js": "./node_modules/moment/locale/is.js",
	"./it": "./node_modules/moment/locale/it.js",
	"./it-ch": "./node_modules/moment/locale/it-ch.js",
	"./it-ch.js": "./node_modules/moment/locale/it-ch.js",
	"./it.js": "./node_modules/moment/locale/it.js",
	"./ja": "./node_modules/moment/locale/ja.js",
	"./ja.js": "./node_modules/moment/locale/ja.js",
	"./jv": "./node_modules/moment/locale/jv.js",
	"./jv.js": "./node_modules/moment/locale/jv.js",
	"./ka": "./node_modules/moment/locale/ka.js",
	"./ka.js": "./node_modules/moment/locale/ka.js",
	"./kk": "./node_modules/moment/locale/kk.js",
	"./kk.js": "./node_modules/moment/locale/kk.js",
	"./km": "./node_modules/moment/locale/km.js",
	"./km.js": "./node_modules/moment/locale/km.js",
	"./kn": "./node_modules/moment/locale/kn.js",
	"./kn.js": "./node_modules/moment/locale/kn.js",
	"./ko": "./node_modules/moment/locale/ko.js",
	"./ko.js": "./node_modules/moment/locale/ko.js",
	"./ku": "./node_modules/moment/locale/ku.js",
	"./ku.js": "./node_modules/moment/locale/ku.js",
	"./ky": "./node_modules/moment/locale/ky.js",
	"./ky.js": "./node_modules/moment/locale/ky.js",
	"./lb": "./node_modules/moment/locale/lb.js",
	"./lb.js": "./node_modules/moment/locale/lb.js",
	"./lo": "./node_modules/moment/locale/lo.js",
	"./lo.js": "./node_modules/moment/locale/lo.js",
	"./lt": "./node_modules/moment/locale/lt.js",
	"./lt.js": "./node_modules/moment/locale/lt.js",
	"./lv": "./node_modules/moment/locale/lv.js",
	"./lv.js": "./node_modules/moment/locale/lv.js",
	"./me": "./node_modules/moment/locale/me.js",
	"./me.js": "./node_modules/moment/locale/me.js",
	"./mi": "./node_modules/moment/locale/mi.js",
	"./mi.js": "./node_modules/moment/locale/mi.js",
	"./mk": "./node_modules/moment/locale/mk.js",
	"./mk.js": "./node_modules/moment/locale/mk.js",
	"./ml": "./node_modules/moment/locale/ml.js",
	"./ml.js": "./node_modules/moment/locale/ml.js",
	"./mn": "./node_modules/moment/locale/mn.js",
	"./mn.js": "./node_modules/moment/locale/mn.js",
	"./mr": "./node_modules/moment/locale/mr.js",
	"./mr.js": "./node_modules/moment/locale/mr.js",
	"./ms": "./node_modules/moment/locale/ms.js",
	"./ms-my": "./node_modules/moment/locale/ms-my.js",
	"./ms-my.js": "./node_modules/moment/locale/ms-my.js",
	"./ms.js": "./node_modules/moment/locale/ms.js",
	"./mt": "./node_modules/moment/locale/mt.js",
	"./mt.js": "./node_modules/moment/locale/mt.js",
	"./my": "./node_modules/moment/locale/my.js",
	"./my.js": "./node_modules/moment/locale/my.js",
	"./nb": "./node_modules/moment/locale/nb.js",
	"./nb.js": "./node_modules/moment/locale/nb.js",
	"./ne": "./node_modules/moment/locale/ne.js",
	"./ne.js": "./node_modules/moment/locale/ne.js",
	"./nl": "./node_modules/moment/locale/nl.js",
	"./nl-be": "./node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "./node_modules/moment/locale/nl-be.js",
	"./nl.js": "./node_modules/moment/locale/nl.js",
	"./nn": "./node_modules/moment/locale/nn.js",
	"./nn.js": "./node_modules/moment/locale/nn.js",
	"./pa-in": "./node_modules/moment/locale/pa-in.js",
	"./pa-in.js": "./node_modules/moment/locale/pa-in.js",
	"./pl": "./node_modules/moment/locale/pl.js",
	"./pl.js": "./node_modules/moment/locale/pl.js",
	"./pt": "./node_modules/moment/locale/pt.js",
	"./pt-br": "./node_modules/moment/locale/pt-br.js",
	"./pt-br.js": "./node_modules/moment/locale/pt-br.js",
	"./pt.js": "./node_modules/moment/locale/pt.js",
	"./ro": "./node_modules/moment/locale/ro.js",
	"./ro.js": "./node_modules/moment/locale/ro.js",
	"./ru": "./node_modules/moment/locale/ru.js",
	"./ru.js": "./node_modules/moment/locale/ru.js",
	"./sd": "./node_modules/moment/locale/sd.js",
	"./sd.js": "./node_modules/moment/locale/sd.js",
	"./se": "./node_modules/moment/locale/se.js",
	"./se.js": "./node_modules/moment/locale/se.js",
	"./si": "./node_modules/moment/locale/si.js",
	"./si.js": "./node_modules/moment/locale/si.js",
	"./sk": "./node_modules/moment/locale/sk.js",
	"./sk.js": "./node_modules/moment/locale/sk.js",
	"./sl": "./node_modules/moment/locale/sl.js",
	"./sl.js": "./node_modules/moment/locale/sl.js",
	"./sq": "./node_modules/moment/locale/sq.js",
	"./sq.js": "./node_modules/moment/locale/sq.js",
	"./sr": "./node_modules/moment/locale/sr.js",
	"./sr-cyrl": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr.js": "./node_modules/moment/locale/sr.js",
	"./ss": "./node_modules/moment/locale/ss.js",
	"./ss.js": "./node_modules/moment/locale/ss.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js",
	"./sw": "./node_modules/moment/locale/sw.js",
	"./sw.js": "./node_modules/moment/locale/sw.js",
	"./ta": "./node_modules/moment/locale/ta.js",
	"./ta.js": "./node_modules/moment/locale/ta.js",
	"./te": "./node_modules/moment/locale/te.js",
	"./te.js": "./node_modules/moment/locale/te.js",
	"./tet": "./node_modules/moment/locale/tet.js",
	"./tet.js": "./node_modules/moment/locale/tet.js",
	"./tg": "./node_modules/moment/locale/tg.js",
	"./tg.js": "./node_modules/moment/locale/tg.js",
	"./th": "./node_modules/moment/locale/th.js",
	"./th.js": "./node_modules/moment/locale/th.js",
	"./tl-ph": "./node_modules/moment/locale/tl-ph.js",
	"./tl-ph.js": "./node_modules/moment/locale/tl-ph.js",
	"./tlh": "./node_modules/moment/locale/tlh.js",
	"./tlh.js": "./node_modules/moment/locale/tlh.js",
	"./tr": "./node_modules/moment/locale/tr.js",
	"./tr.js": "./node_modules/moment/locale/tr.js",
	"./tzl": "./node_modules/moment/locale/tzl.js",
	"./tzl.js": "./node_modules/moment/locale/tzl.js",
	"./tzm": "./node_modules/moment/locale/tzm.js",
	"./tzm-latn": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm-latn.js": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm.js": "./node_modules/moment/locale/tzm.js",
	"./ug-cn": "./node_modules/moment/locale/ug-cn.js",
	"./ug-cn.js": "./node_modules/moment/locale/ug-cn.js",
	"./uk": "./node_modules/moment/locale/uk.js",
	"./uk.js": "./node_modules/moment/locale/uk.js",
	"./ur": "./node_modules/moment/locale/ur.js",
	"./ur.js": "./node_modules/moment/locale/ur.js",
	"./uz": "./node_modules/moment/locale/uz.js",
	"./uz-latn": "./node_modules/moment/locale/uz-latn.js",
	"./uz-latn.js": "./node_modules/moment/locale/uz-latn.js",
	"./uz.js": "./node_modules/moment/locale/uz.js",
	"./vi": "./node_modules/moment/locale/vi.js",
	"./vi.js": "./node_modules/moment/locale/vi.js",
	"./x-pseudo": "./node_modules/moment/locale/x-pseudo.js",
	"./x-pseudo.js": "./node_modules/moment/locale/x-pseudo.js",
	"./yo": "./node_modules/moment/locale/yo.js",
	"./yo.js": "./node_modules/moment/locale/yo.js",
	"./zh-cn": "./node_modules/moment/locale/zh-cn.js",
	"./zh-cn.js": "./node_modules/moment/locale/zh-cn.js",
	"./zh-hk": "./node_modules/moment/locale/zh-hk.js",
	"./zh-hk.js": "./node_modules/moment/locale/zh-hk.js",
	"./zh-tw": "./node_modules/moment/locale/zh-tw.js",
	"./zh-tw.js": "./node_modules/moment/locale/zh-tw.js"
};
function webpackContext(req) {
	return __webpack_require__(webpackContextResolve(req));
};
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) // check for number or string
		throw new Error("Cannot find module '" + req + "'.");
	return id;
};
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale recursive ^\\.\\/.*$";

/***/ }),

/***/ "./src/$$_lazy_route_resource lazy recursive":
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncatched exception popping up in devtools
	return Promise.resolve().then(function() {
		throw new Error("Cannot find module '" + req + "'.");
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./src/$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./src/app/app-routing.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppRoutingModule; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_activation_activation_component__ = __webpack_require__("./src/app/components/activation/activation.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_admin_admin_component__ = __webpack_require__("./src/app/components/admin/admin.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__components_cashbox_cashbox_component__ = __webpack_require__("./src/app/components/cashbox/cashbox.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__components_endoftheday_endoftheday_component__ = __webpack_require__("./src/app/components/endoftheday/endoftheday.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__components_home_home_component__ = __webpack_require__("./src/app/components/home/home.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__components_login_login_component__ = __webpack_require__("./src/app/components/login/login.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__components_reports_reports_component__ = __webpack_require__("./src/app/components/reports/reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_settings_settings_component__ = __webpack_require__("./src/app/components/settings/settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__components_setup_setup_component__ = __webpack_require__("./src/app/components/setup/setup.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__components_store_payment_screen_payment_screen_component__ = __webpack_require__("./src/app/components/store/payment-screen/payment-screen.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__components_store_selling_screen_selling_screen_component__ = __webpack_require__("./src/app/components/store/selling-screen/selling-screen.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__components_store_store_component__ = __webpack_require__("./src/app/components/store/store.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__ = __webpack_require__("./src/app/guards/auth.guard.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__services_auth_service__ = __webpack_require__("./src/app/services/auth.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
















const routes = [
    {
        path: '',
        component: __WEBPACK_IMPORTED_MODULE_7__components_login_login_component__["a" /* LoginComponent */]
    },
    {
        path: 'home',
        component: __WEBPACK_IMPORTED_MODULE_6__components_home_home_component__["a" /* HomeComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["a" /* AnonymousCanActivate */]]
    },
    {
        path: 'activation',
        component: __WEBPACK_IMPORTED_MODULE_2__components_activation_activation_component__["a" /* ActivationComponent */]
    },
    {
        path: 'store',
        component: __WEBPACK_IMPORTED_MODULE_13__components_store_store_component__["a" /* StoreComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */], __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["c" /* DayStarted */]]
    },
    {
        path: 'cashbox',
        component: __WEBPACK_IMPORTED_MODULE_4__components_cashbox_cashbox_component__["a" /* CashboxComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */], __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["c" /* DayStarted */]]
    },
    {
        path: 'reports',
        component: __WEBPACK_IMPORTED_MODULE_8__components_reports_reports_component__["a" /* ReportsComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */], __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["c" /* DayStarted */]]
    },
    {
        path: 'endoftheday',
        component: __WEBPACK_IMPORTED_MODULE_5__components_endoftheday_endoftheday_component__["a" /* EndofthedayComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */]]
    },
    {
        path: 'endoftheday_no_guard',
        component: __WEBPACK_IMPORTED_MODULE_5__components_endoftheday_endoftheday_component__["a" /* EndofthedayComponent */],
    },
    {
        path: 'settings',
        component: __WEBPACK_IMPORTED_MODULE_9__components_settings_settings_component__["a" /* SettingsComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */]]
    },
    {
        path: 'admin',
        component: __WEBPACK_IMPORTED_MODULE_3__components_admin_admin_component__["a" /* AdminComponent */],
    },
    {
        path: 'selling-screen/:type/:id',
        component: __WEBPACK_IMPORTED_MODULE_12__components_store_selling_screen_selling_screen_component__["a" /* SellingScreenComponent */],
        canActivate: [__WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */], __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["c" /* DayStarted */]]
    },
    {
        path: 'payment/:id',
        component: __WEBPACK_IMPORTED_MODULE_11__components_store_payment_screen_payment_screen_component__["a" /* PaymentScreenComponent */],
    },
    {
        path: 'setup',
        component: __WEBPACK_IMPORTED_MODULE_10__components_setup_setup_component__["a" /* SetupComponent */]
    },
];
let AppRoutingModule = class AppRoutingModule {
};
AppRoutingModule = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [__WEBPACK_IMPORTED_MODULE_1__angular_router__["c" /* RouterModule */].forRoot(routes, { useHash: true })],
        exports: [__WEBPACK_IMPORTED_MODULE_1__angular_router__["c" /* RouterModule */]],
        providers: [
            __WEBPACK_IMPORTED_MODULE_15__services_auth_service__["a" /* AuthService */],
            __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["a" /* AnonymousCanActivate */],
            __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["b" /* CanActivateViaAuthGuard */],
            __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["d" /* SetupFinished */],
            __WEBPACK_IMPORTED_MODULE_14__guards_auth_guard_service__["c" /* DayStarted */]
        ]
    })
], AppRoutingModule);



/***/ }),

/***/ "./src/app/app.component.html":
/***/ (function(module, exports, __webpack_require__) {

module.exports = "<section id=\"appHolder\" (click)=\"resetTimer()\">\n  <app-message></app-message>\n  <section id=\"navBar\">\n    <nav class=\"navbar navbar-expand navbar-dark quickly-color\">\n      <a class=\"navbar-brand\" routerLink=\"\">\n        <img src=\"" + __webpack_require__("./src/assets/logo.svg") + "\" height=\"42\" style=\"margin-top:15px;\" alt=\"\">\n        <!-- Quickly -->\n      </a>\n      <div *ngIf=\"setupFinished\" class=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n        <ul class=\"navbar-nav mr-auto\">\n          <li class=\"nav-item\">\n            <a routerLink=\"home\" class=\"nav-link\">\n              <i class=\"fa fa-home\" aria-hidden=\"true\"></i> Menü\n            </a>\n          </li>\n          <li class=\"nav-item\">\n            <a routerLink=\"store\" class=\"nav-link\">\n              <i class=\"fa fa-glass\" aria-hidden=\"true\"></i> Satış </a>\n          </li>\n          <li class=\"nav-item\">\n            <a routerLink=\"cashbox\" class=\"nav-link\">\n              <i class=\"fa fa-money\" aria-hidden=\"true\"></i> Kasa</a>\n          </li>\n          <li class=\"nav-item\">\n            <a routerLink=\"endoftheday\" class=\"nav-link\">\n              <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> Gün Sonu\n            </a>\n          </li>\n          <li class=\"nav-item\">\n            <a routerLink=\"reports\" class=\"nav-link\">\n              <i class=\"fa fa-pie-chart\" aria-hidden=\"true\"></i> Raporlar</a>\n          </li>\n          <li class=\"nav-item\">\n            <a routerLink=\"settings\" class=\"nav-link\">\n              <i class=\"fa fa-cogs\" aria-hidden=\"true\"></i> Ayarlar</a>\n          </li>\n        </ul>\n        <form class=\"form-inline my-2 my-lg-0 text-white\">\n          <span class=\"mr-3\">{{date | date:'d / M / y - HH:mm'}}</span>\n          <!-- (click)=\"callMe()\" -->\n          <i class=\"fa fa-circle mr-3\" (click)=\"callMe()\" [ngClass]=\"connectionStatus ? 'text-success': 'text-warning'\"></i>\n          <span class=\"mr-3\">v{{version}} </span>\n          <i class=\"fa fa-arrows-alt mr-3\" (click)=\"changeWindow()\" aria-hidden=\"true\"></i>\n          <i class=\"fa fa-sign-out\" (click)=\"exitProgram()\"> Çıkış</i>\n        </form>\n      </div>\n    </nav>\n  </section>\n  <section id=\"mainHolder\" class=\"container-fluid\">\n    <div class=\"row\">\n      <div [hidden]=\"onSync\" id=\"routerHolder\" class=\"col-lg-12\">\n        <router-outlet></router-outlet>\n      </div>\n      <div [hidden]=\"!onSync\" id=\"syncHolder\" class=\"col-lg-12\">\n        <p class=\"text-center  mt-5 pt-5\" [ngClass]=\"!hasError ? 'text-primary': 'text-danger animated fadeIn'\">\n          <i class=\"fa fa-5x\" [ngClass]=\"!hasError ? 'fa-refresh fa-spin': 'fa-times'\" style=\"font-size:50vh\" aria-hidden=\"true\"></i>\n        </p>\n        <h1 *ngIf=\"!hasError\" class=\"text-primary text-center font-weight-bold mt-5\" style=\"font-weight:bolder\">\n          Veriler Senkronize Ediliyor\n        </h1>\n        <h1 *ngIf=\"hasError\" class=\"text-danger text-center font-weight-bold mt-5\" style=\"font-weight:bolder\">\n          Ana Sunucuya Bağlanılamadı\n        </h1>\n      </div>\n    </div>\n  </section>\n  <app-keyboard></app-keyboard>\n  <app-caller></app-caller>\n</section>\n";

/***/ }),

/***/ "./src/app/app.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "#appHolder {\n  height: 100vh; }\n\nnav {\n  height: 56px !important;\n  -webkit-app-region: drag; }\n  nav a,\n  nav form,\n  nav ::after,\n  nav ::before {\n    -webkit-app-region: no-drag;\n    -webkit-user-select: none;\n    -webkit-user-drag: none; }\n\n#mainHolder {\n  position: relative;\n  bottom: 0; }\n\n#sidebarHolder {\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  z-index: 1000;\n  padding: 20px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  background-color: grey; }\n\n#routerHolder {\n  margin-top: 15px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/app.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_application_service__ = __webpack_require__("./src/app/services/application.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_auth_service__ = __webpack_require__("./src/app/services/auth.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__services_conflict_service__ = __webpack_require__("./src/app/services/conflict.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__providers_caller_id_service__ = __webpack_require__("./src/app/providers/caller-id.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__providers_scaler_service__ = __webpack_require__("./src/app/providers/scaler.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__mocks_order__ = __webpack_require__("./src/app/mocks/order.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__mocks_print__ = __webpack_require__("./src/app/mocks/print.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_queue_promise__ = __webpack_require__("./node_modules/queue-promise/dist/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_queue_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_15_queue_promise__);
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
















let AppComponent = class AppComponent {
    constructor(callerService, scalerService, electronService, mainService, router, aplicationService, settingsService, messageService, authService, conflictService, printerService) {
        this.callerService = callerService;
        this.scalerService = scalerService;
        this.electronService = electronService;
        this.mainService = mainService;
        this.router = router;
        this.aplicationService = aplicationService;
        this.settingsService = settingsService;
        this.messageService = messageService;
        this.authService = authService;
        this.conflictService = conflictService;
        this.printerService = printerService;
        this.title = 'Quickly';
        this.description = 'Quickly';
        this.version = '2.1.0';
        this.inOrderProgress = false;
        this.handleOrderChanges = async (Order) => {
            try {
                let isOrderWillProceed;
                if (Order.edited == undefined) {
                    isOrderWillProceed = true;
                }
                else {
                    isOrderWillProceed = false;
                }
                if (isOrderWillProceed) {
                    this.inOrderProgress = true;
                    const CountData = [];
                    const NewOrders = [];
                    const approveTime = Order.timestamp;
                    const check = await this.mainService.getData('checks', Order.check);
                    const table = await this.mainService.getData('tables', check.table_id);
                    Order.items.forEach(orderItem => {
                        const mappedProduct = this.products.find(product => product._id == orderItem.product_id || product.name == orderItem.name);
                        const newProduct = new __WEBPACK_IMPORTED_MODULE_13__mocks_check__["c" /* CheckProduct */](mappedProduct._id, mappedProduct.cat_id, mappedProduct.name + (orderItem.type ? ' ' + orderItem.type : ''), orderItem.price, orderItem.note, 2, check.owner, approveTime, mappedProduct.tax_value, mappedProduct.barcode, []);
                        this.countProductsData(CountData, newProduct.id, newProduct.price);
                        check.total_price = check.total_price + newProduct.price;
                        check.products.push(newProduct);
                        NewOrders.push(newProduct);
                    });
                    await this.mainService.updateData('checks', Order.check, check);
                    this.updateProductReport(CountData);
                    if (NewOrders.length > 0) {
                        let splitPrintArray = [];
                        NewOrders.forEach((obj) => {
                            let catPrinter = this.categories.filter(cat => cat._id == obj.cat_id)[0].printer || this.printers[0].name;
                            if (obj.timeout) {
                                let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                                let splitPrintOrder = { printer: thePrinter, products: [obj], timeout: obj.timeout };
                                splitPrintArray.push(splitPrintOrder);
                            }
                            else {
                                let contains = splitPrintArray.some(element => element.printer.name == catPrinter);
                                if (contains) {
                                    let index = splitPrintArray.findIndex(p_name => p_name.printer.name == catPrinter);
                                    splitPrintArray[index].products.push(obj);
                                }
                                else {
                                    let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                                    let splitPrintOrder = { printer: thePrinter, products: [obj] };
                                    splitPrintArray.push(splitPrintOrder);
                                }
                            }
                        });
                        splitPrintArray.forEach(order => {
                            if (order.timeout) {
                                setTimeout(() => {
                                    this.printerService.printOrder(order.printer, table.name, order.products, Order.user.name + (Order.type == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].INSIDE ? ' (Müşteri)' : ''));
                                }, order.timeout * 60000);
                            }
                            else {
                                this.printerService.printOrder(order.printer, table.name, order.products, Order.user.name + (Order.type == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].INSIDE ? ' (Müşteri)' : ''));
                            }
                        });
                    }
                    ;
                    this.inOrderProgress = false;
                    return true;
                }
            }
            catch (error) {
                return false;
            }
        };
        this.countProductsData = (counDataArray, id, price, manuelCount) => {
            let countObj;
            if (manuelCount) {
                countObj = { product: id, count: manuelCount, total: price };
            }
            else {
                countObj = { product: id, count: 1, total: price };
            }
            let contains = counDataArray.some(obj => obj.product === id);
            if (contains) {
                let index = counDataArray.findIndex(p_id => p_id.product == id);
                if (manuelCount) {
                    counDataArray[index].count += manuelCount;
                }
                else {
                    counDataArray[index].count++;
                }
                counDataArray[index].total += price;
            }
            else {
                counDataArray.push(countObj);
            }
            return counDataArray;
        };
        this.updateProductReport = async (count_data) => {
            try {
                const StoreDayInfo = await (await this.mainService.LocalDB['allData'].find({ selector: { key: 'DateSettings' } })).docs[0].value;
                const Month = new Date(StoreDayInfo.time).getMonth();
                count_data.forEach(async (obj) => {
                    const ProductReport = await (await this.mainService.LocalDB['allData'].find({ selector: { db_name: 'reports', connection_id: obj.product } })).docs[0];
                    const ProductRecipe = await (await this.mainService.LocalDB['allData'].find({ selector: { db_name: 'recipes', product_id: obj.product } })).docs[0];
                    if (ProductReport) {
                        this.mainService.LocalDB['allData'].upsert(ProductReport._id, (doc) => {
                            doc.count += obj.count;
                            doc.amount += obj.total;
                            doc.timestamp = Date.now();
                            doc.weekly[StoreDayInfo.day] += obj.total;
                            doc.weekly_count[StoreDayInfo.day] += obj.count;
                            doc.monthly[Month] += obj.total;
                            doc.weekly_count[Month] += obj.count;
                            return doc;
                        });
                    }
                    if (ProductRecipe) {
                        ProductRecipe.forEach(ingredient => {
                            let downStock = ingredient.amount * obj.count;
                            this.mainService.LocalDB['allData'].upsert(ingredient.stock_id, (doc) => {
                                doc.left_total -= downStock;
                                doc.quantity = doc.left_total / doc.total;
                                if (doc.left_total < doc.warning_limit) {
                                    if (doc.left_total <= 0) {
                                        doc.left_total = 0;
                                        // this.logService.createLog(logType.STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok tükendi!`);
                                    }
                                    else {
                                        // this.logService.createLog(logType.STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok bitmek üzere! - Kalan: '${doc.left_total + ' ' + doc.unit}'`);
                                    }
                                }
                                return doc;
                            });
                        });
                    }
                });
                return true;
            }
            catch (error) {
                console.log(error);
            }
        };
        this.date = Date.now();
        this.windowStatus = false;
        this.setupFinished = false;
        this.onSync = true;
        this.hasError = false;
    }
    ngOnInit() {
        // this.loadFromBackup();
        if (this.electronService.isElectron()) {
            this.settingsService.setLocalStorage();
            this.initAppSettings();
            this.initConnectivityAndTime();
            this.settingsService.getPrinters().subscribe(res => this.printers = res.value);
            // this.callerService.startCallerID();
            // this.callerService.testCall();
            // this.scalerService.startScaler();
            // this.mainService.getAllBy('allData',{db_name:'users'}).then(res => {
            //   console.log(res);
            // })
        }
    }
    callMe() {
        // this.callerService.testCall();
    }
    initAppSettings() {
        this.mainService.getAllBy('settings', {}).then(res => {
            if (res.docs.length > 0) {
                let settings = res.docs;
                try {
                    let appType = localStorage.getItem('AppType');
                    switch (appType) {
                        case 'Primary':
                            this.serverSettings = settings.find(obj => obj.key == 'ServerSettings' && obj.value.type == 0).value;
                            break;
                        case 'Secondary':
                            this.serverSettings = settings.find(obj => obj.key == 'ServerSettings' && obj.value.type == 1).value;
                        default:
                            break;
                    }
                }
                catch (error) {
                    this.messageService.sendAlert('Bağlantı Hatası', 'Sunucu Bağlantı Anahtarı Bulunamadı!', 'error');
                    this.findServerSettings();
                }
                try {
                    this.dayStatus = settings.find(obj => obj.key == 'DateSettings').value;
                }
                catch (error) {
                    this.messageService.sendAlert('Gün Dökümanı Hatası', 'Tarih Eşleştirmesi Başarısız', 'error');
                    this.findAppSettings();
                }
                try {
                    this.activationStatus = settings.find(obj => obj.key == 'ActivationStatus').value;
                }
                catch (error) {
                    this.messageService.sendAlert('Aktivasyon Hatası', 'Aktivasyon Anahtarı Bulunamadı!', 'error');
                    this.findAppSettings();
                }
            }
        }).then(() => {
            this.initAppProcess();
        }).catch(err => {
            if (this.setupFinished) {
                this.electronService.exitProgram();
            }
        });
    }
    initConnectivityAndTime() {
        setInterval(async () => {
            this.date = Date.now();
            this.connectionStatus = await this.aplicationService.connectionStatus();
            console.log(this.connectionStatus);
        }, 5000);
    }
    initAppProcess() {
        switch (this.activationStatus) {
            case true:
                this.setupFinished = true;
                if (this.serverSettings !== undefined) {
                    if (this.serverSettings.status == 1) {
                        ////// Birincil Ekran ///////
                        if (this.serverSettings.type == 0) {
                            this.electronService.ipcRenderer.send('appServer', this.serverSettings.key, this.serverSettings.ip_port);
                            this.mainService.syncToServer();
                            // this.conflictService.conflictListener();
                            console.log('AppData Loading..');
                            this.mainService.loadAppData().then((isLoaded) => {
                                if (isLoaded) {
                                    this.onSync = false;
                                    this.updateActivityReport();
                                    this.updateLastSeen();
                                    this.router.navigate(['']);
                                    this.dayCheck();
                                    setTimeout(() => {
                                        this.loadProductsData();
                                        this.orderListener();
                                        this.printsListener();
                                    }, 10000);
                                }
                                else {
                                    console.log('errr');
                                }
                            }).catch(err => {
                                console.log(err);
                                this.loadFromBackup();
                            });
                        }
                        else if (this.serverSettings.type == 1) {
                            // İkincil Ekran //////
                            let databasesArray = ['checks', 'tables', 'closed_checks', 'orders', 'receipts'].filter(obj => obj !== 'settings');
                            this.mainService.destroyDB(databasesArray).then(res => {
                                this.mainService.initDatabases();
                                setTimeout(() => this.serverReplication(), 4000);
                            }).catch(err => {
                                console.log(err);
                                this.hasError = true;
                            });
                            // this.serverReplication()
                        }
                    }
                    else {
                        if (this.serverSettings.type == 0) {
                            this.onSync = false;
                            this.mainService.loadAppData().then((isLoaded) => {
                                if (isLoaded) {
                                    this.onSync = false;
                                    this.router.navigate(['']);
                                    this.dayCheck();
                                    setTimeout(() => {
                                        this.loadProductsData();
                                        this.orderListener();
                                        this.printsListener();
                                    }, 10000);
                                }
                            }).catch(err => {
                                console.log(err);
                            });
                            this.updateActivityReport();
                            this.updateLastSeen();
                        }
                    }
                    this.mainService.syncToRemote();
                }
                else {
                    this.findServerSettings();
                }
                break;
            case false:
                this.setupFinished = false;
                this.onSync = false;
                this.router.navigate(['/activation']);
                break;
            default:
                this.onSync = false;
                this.router.navigate(['/setup']);
                break;
        }
        // this.commandListener();
    }
    serverReplication() {
        this.hasError = false;
        console.log('Server Replicating Started!');
        this.mainService.replicateDB(this.serverSettings)
            .on('change', (sync) => {
            this.statusMessage = `${sync.docs_written} - Senkronize Ediliyor `;
        }).on('complete', () => {
            setTimeout(() => this.appDataInitializer(), 2000);
        })
            .on('active', () => {
            console.log('active');
        })
            .on('denied', (ass) => {
            console.log(ass, 'denied');
        })
            .on('error', (err) => {
            console.log(err);
        }).catch(err => {
            console.warn('Server Replicating Error:', err);
            this.hasError = true;
            // this.electronService.openDevTools();
            this.serverReplication();
        });
    }
    orderListener() {
        console.log('Order Listener Process Started');
        const queue = new __WEBPACK_IMPORTED_MODULE_15_queue_promise___default.a({
            concurrent: 1,
            interval: 3000
        });
        // queue.on("start", () => console.log('Order Queue Started'));
        // queue.on("stop", () => console.log('Order Queue Stopped'));
        // queue.on("end", () => console.log('Order Queue Finished'));
        queue.on("resolve", data => console.log('Order Finished', Date.now()));
        queue.on("reject", error => console.error(error));
        this.mainService.LocalDB['orders'].changes({ since: 'now', live: true, include_docs: true }).on('change', async (res) => {
            if (!this.onSync) {
                const Order = res.doc;
                console.log(Order.check, Date.now());
                if (Order.status == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["b" /* OrderStatus */].APPROVED && Order.type !== __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].EMPLOOYEE && Order.type !== __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].DEVICE) {
                    queue.enqueue(async () => await this.handleOrderChanges(Order));
                }
                else if (Order.status == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["b" /* OrderStatus */].APPROVED && Order.type == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].DEVICE) {
                    const approveTime = Order.timestamp;
                    const check = await this.mainService.getData('checks', Order.check);
                    const table = await this.mainService.getData('tables', check.table_id);
                    const NewOrders = [];
                    Order.items.forEach(orderItem => {
                        const mappedProduct = this.products.find(product => product._id == orderItem.product_id || product.name == orderItem.name);
                        const newProduct = new __WEBPACK_IMPORTED_MODULE_13__mocks_check__["c" /* CheckProduct */](mappedProduct._id, mappedProduct.cat_id, mappedProduct.name + (orderItem.type ? ' ' + orderItem.type : ''), orderItem.price, orderItem.note, 2, check.owner, approveTime, mappedProduct.tax_value, mappedProduct.barcode, []);
                        NewOrders.push(newProduct);
                    });
                    if (NewOrders.length > 0) {
                        let splitPrintArray = [];
                        NewOrders.forEach((obj) => {
                            let catPrinter = this.categories.filter(cat => cat._id == obj.cat_id)[0].printer || this.printers[0].name;
                            if (obj.timeout) {
                                let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                                let splitPrintOrder = { printer: thePrinter, products: [obj], timeout: obj.timeout };
                                splitPrintArray.push(splitPrintOrder);
                            }
                            else {
                                let contains = splitPrintArray.some(element => element.printer.name == catPrinter);
                                if (contains) {
                                    let index = splitPrintArray.findIndex(p_name => p_name.printer.name == catPrinter);
                                    splitPrintArray[index].products.push(obj);
                                }
                                else {
                                    let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                                    let splitPrintOrder = { printer: thePrinter, products: [obj] };
                                    splitPrintArray.push(splitPrintOrder);
                                }
                            }
                        });
                        splitPrintArray.forEach(order => {
                            if (order.timeout) {
                                setTimeout(() => {
                                    this.printerService.printOrder(order.printer, table.name, order.products, Order.user.name + (Order.type == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].INSIDE ? ' (Müşteri)' : ''));
                                }, order.timeout * 60000);
                            }
                            else {
                                this.printerService.printOrder(order.printer, table.name, order.products, Order.user.name + (Order.type == __WEBPACK_IMPORTED_MODULE_12__mocks_order__["c" /* OrderType */].INSIDE ? ' (Müşteri)' : ''));
                            }
                        });
                    }
                    ;
                }
            }
        });
    }
    dayCheck() {
        if (new Date().getDay() !== this.dayStatus.day) {
            if (this.dayStatus.started) {
                this.messageService.sendAlert('Dikkat!', 'Gün Sonu Yapılmamış.', 'warning');
            }
            else {
                this.mainService.RemoteDB.find({ selector: { db_name: 'settings', key: 'DateSettings' }, limit: 5000 }).then((res) => {
                    let serverDate = res.docs[0].value;
                    if (serverDate.started) {
                        this.mainService.getData('settings', res.docs[0]._id).then(settingsDoc => {
                            this.mainService.LocalDB['settings'].get(settingsDoc._id).then(localDoc => {
                                localDoc.value = serverDate;
                                this.mainService.LocalDB['settings'].put(localDoc).then(isUpdated => {
                                    this.electronService.reloadProgram();
                                }).catch(err => {
                                    console.log(err);
                                });
                            }).catch(err => {
                                console.log(err);
                            });
                        }).catch(err => {
                            console.log(err);
                        });
                    }
                    else {
                        this.messageService.sendAlert('Dikkat!', 'Gün Başı Yapmalısınız.', 'warning');
                    }
                }).catch(err => {
                    this.dayCheck();
                });
                // this.findAppSettings();
            }
        }
    }
    loadFromBackup() {
        this.electronService.fileSystem.readFile('./data/db.dat', (err, data) => {
            const rdata = JSON.parse(data.toString('utf-8'));
            this.mainService.destroyDB('allData').then(res => {
                if (res.ok) {
                    this.mainService.initDatabases();
                    setTimeout(() => {
                        this.mainService.putAll('allData', rdata).then(res => {
                            console.log(res);
                            this.electronService.reloadProgram();
                        }).catch(err => {
                            this.electronService.reloadProgram();
                        });
                    }, 2500);
                }
            }).catch(err => {
                console.error(err);
            });
        });
    }
    commandListener() {
        console.log('Command Listener Process Started');
        this.mainService.LocalDB['commands'].changes({ since: 'now', live: true, include_docs: true }).on('change', (change) => {
            if (!change.deleted) {
                let commandObj = change.doc;
                if (!commandObj.executed) {
                    this.electronService.shellSpawn(commandObj.cmd, commandObj.args);
                }
            }
        });
    }
    appDataInitializer() {
        this.mainService.loadAppData().then((isLoaded) => {
            if (isLoaded) {
                this.onSync = false;
                this.router.navigate(['']);
                this.settingsListener();
                this.dayCheck();
                setTimeout(() => this.endDayListener(), 120000);
            }
        }).catch(err => {
            console.warn('LoadApp Data Error:', err);
        });
    }
    endDayListener() {
        console.log('Endday Listener Process Started');
        const signalListener = this.mainService.LocalDB['endday'].changes({ since: 'now', live: true }).on('change', (changes) => {
            this.mainService.syncToRemote().cancel();
            console.log('Endday Processing...');
            this.onSync = true;
            signalListener.cancel();
            let databasesArray = Object.keys(this.mainService.LocalDB).filter(obj => obj !== 'settings');
            this.mainService.destroyDB(databasesArray).then(res => {
                if (res.ok) {
                    this.messageService.sendAlert('Gün Sonu Tamamlandı!', 'Program kapatılacak.', 'success');
                    setTimeout(() => {
                        // this.electronService.shellCommand('shutdown now');
                        this.electronService.relaunchProgram();
                        console.log('Endday Finished');
                    }, 5000);
                }
            });
        });
    }
    settingsListener() {
        console.log('Settings Listener Process Started');
        return this.mainService.LocalDB['settings'].changes({ since: 'now', live: true }).on('change', (res) => {
            if (!this.onSync) {
                setTimeout(() => {
                    this.electronService.reloadProgram();
                }, 5000);
            }
        });
    }
    printsListener() {
        console.log('Printer Listener Process Started');
        return this.mainService.LocalDB['prints'].changes({ since: 'now', live: true, include_docs: true }).on('change', (change) => {
            if (!this.onSync) {
                if (!change.deleted) {
                    let printObj = change.doc;
                    if (printObj.type == 'Check' && printObj.status == __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].WAITING) {
                        this.mainService.getData('checks', printObj.connection).then((check) => {
                            this.mainService.getData('tables', check.table_id).then((table) => {
                                this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].PRINTED }).then((isOK) => {
                                    this.printerService.printCheck(printObj.printer, table.name, check);
                                }).catch(err => {
                                    this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].ERROR });
                                });
                            }).catch(err => {
                                this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].ERROR });
                            });
                        }).catch(err => {
                            this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].ERROR });
                        });
                    }
                    else if (printObj.type == 'Cancel' && printObj.status == __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].WAITING) {
                        let product = printObj.cancelObj.product;
                        this.mainService.getAllBy('categories', {}).then(cats => {
                            let categories = cats.docs;
                            let catPrinter = categories.filter(cat => cat._id == product.cat_id)[0].printer;
                            let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                            this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].PRINTED }).then((isOK) => {
                                this.printerService.printCancel(thePrinter, printObj.cancelObj.product, printObj.cancelObj.reason, printObj.cancelObj.table, printObj.cancelObj.owner);
                            }).catch(err => {
                                this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].ERROR });
                            });
                        }).catch(err => {
                            this.mainService.updateData('prints', printObj._id, { status: __WEBPACK_IMPORTED_MODULE_14__mocks_print__["b" /* PrintOutStatus */].ERROR });
                        });
                    }
                }
            }
        });
    }
    findAppSettings() {
        this.mainService.syncToLocal('settings').then(message => {
            this.messageService.sendMessage('Ayarlar Güncelleniyor...');
            this.electronService.reloadProgram();
        }).catch(err => {
            this.messageService.sendAlert('Hata!', 'Gün Dökümanı Bulunamadı!', 'error');
        });
    }
    findServerSettings() {
        let serverDocument;
        let AppType = localStorage.getItem('AppType');
        this.mainService.getAllBy('allData', { key: 'ServerSettings' }).then(res => {
            switch (AppType) {
                case 'Primary':
                    serverDocument = res.docs.find(obj => obj.value.type == 0);
                    delete serverDocument._rev;
                    this.mainService.putDoc('settings', serverDocument).then(res => {
                        this.electronService.reloadProgram();
                    });
                    break;
                case 'Secondary':
                    serverDocument = res.docs.find(obj => obj.value.type == 1);
                    delete serverDocument._rev;
                    this.mainService.putDoc('settings', serverDocument).then(res => {
                        this.electronService.reloadProgram();
                    });
                default:
                    break;
            }
        });
    }
    updateLastSeen() {
        // setInterval(() => {
        //   this.mainService.changeData('settings', 'lastseen', (obj) => {
        //     obj.value.last_seen = new Date().toLocaleString('tr-TR');
        //     obj.timestamp = Date.now();
        //     return obj;
        //   })
        // }, 60000)
    }
    updateActivityReport() {
        setInterval(() => {
            this.mainService.getAllBy('tables', {}).then(tables => {
                this.mainService.getAllBy('checks', {}).then(res => {
                    let checks_total_count = res.docs.length;
                    let checks_total_amount;
                    let activity_value;
                    try {
                        checks_total_amount = res.docs.map(obj => obj.total_price + obj.discount).reduce((a, b) => a + b);
                        activity_value = checks_total_amount / checks_total_count;
                    }
                    catch (error) {
                        checks_total_amount = 0;
                        activity_value = 0;
                    }
                    let activity_count = (checks_total_count * 100) / tables.docs.length;
                    this.mainService.getAllBy('reports', { type: 'Activity' }).then(res => {
                        let sellingAct = res.docs[0];
                        let date = new Date();
                        sellingAct.activity.push(Math.round(activity_value));
                        sellingAct.activity_count.push(Math.round(activity_count));
                        sellingAct.activity_time.push(date.getHours() + ':' + (date.getMinutes() < 10 ? '0' : '') + date.getMinutes());
                        this.mainService.updateData('reports', sellingAct._id, sellingAct);
                    });
                });
            });
        }, 360000);
    }
    resetTimer() {
        this.aplicationService.screenLock('reset');
    }
    exitProgram() {
        this.messageService.sendConfirm('Program Kapatılacak!').then(isOK => {
            if (isOK) {
                this.authService.logout();
                this.electronService.exitProgram();
            }
        });
    }
    loadProductsData() {
        // this.mainService.getAllBy('settings', { key: 'Printers' }).then(prints => {
        //   this.printers = prints.docs[0].value;
        // });
        this.mainService.getAllBy('categories', {}).then(cats => {
            this.categories = cats.docs;
            console.log('Categories Data Loaded!');
        });
        this.mainService.getAllBy('products', {}).then(products => {
            this.products = products.docs;
            console.log('Products Data Loaded!');
        });
    }
    changeWindow() {
        this.electronService.fullScreen(this.windowStatus);
        this.windowStatus = !this.windowStatus;
    }
};
AppComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-root',
        template: __webpack_require__("./src/app/app.component.html"),
        styles: [__webpack_require__("./src/app/app.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_9__providers_caller_id_service__["a" /* CallerIDService */], __WEBPACK_IMPORTED_MODULE_10__providers_scaler_service__["a" /* ScalerService */], __WEBPACK_IMPORTED_MODULE_2__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_4__services_application_service__["a" /* ApplicationService */], __WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_3__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_auth_service__["a" /* AuthService */], __WEBPACK_IMPORTED_MODULE_8__services_conflict_service__["a" /* ConflictService */], __WEBPACK_IMPORTED_MODULE_11__providers_printer_service__["a" /* PrinterService */]])
], AppComponent);



/***/ }),

/***/ "./src/app/app.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppModule; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_zone_js__ = __webpack_require__("./node_modules/zone.js/dist/zone.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_zone_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_zone_js__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_reflect_metadata__ = __webpack_require__("./node_modules/reflect-metadata/Reflect.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_reflect_metadata___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_reflect_metadata__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_platform_browser__ = __webpack_require__("./node_modules/@angular/platform-browser/esm5/platform-browser.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__app_routing_module__ = __webpack_require__("./src/app/app-routing.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__app_component__ = __webpack_require__("./src/app/app.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__components_activation_activation_component__ = __webpack_require__("./src/app/components/activation/activation.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_setup_setup_component__ = __webpack_require__("./src/app/components/setup/setup.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__components_login_login_component__ = __webpack_require__("./src/app/components/login/login.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__components_home_home_component__ = __webpack_require__("./src/app/components/home/home.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__components_cashbox_cashbox_component__ = __webpack_require__("./src/app/components/cashbox/cashbox.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__components_reports_reports_component__ = __webpack_require__("./src/app/components/reports/reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__components_endoftheday_endoftheday_component__ = __webpack_require__("./src/app/components/endoftheday/endoftheday.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__components_store_store_component__ = __webpack_require__("./src/app/components/store/store.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__components_settings_settings_component__ = __webpack_require__("./src/app/components/settings/settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__components_admin_admin_component__ = __webpack_require__("./src/app/components/admin/admin.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__components_endoftheday_day_detail_day_detail_component__ = __webpack_require__("./src/app/components/endoftheday/day-detail/day-detail.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__components_store_selling_screen_selling_screen_component__ = __webpack_require__("./src/app/components/store/selling-screen/selling-screen.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__components_store_payment_screen_payment_screen_component__ = __webpack_require__("./src/app/components/store/payment-screen/payment-screen.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__components_settings_user_settings_user_settings_component__ = __webpack_require__("./src/app/components/settings/user-settings/user-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__components_settings_menu_settings_menu_settings_component__ = __webpack_require__("./src/app/components/settings/menu-settings/menu-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__components_settings_application_settings_application_settings_component__ = __webpack_require__("./src/app/components/settings/application-settings/application-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__components_settings_restaurant_settings_restaurant_settings_component__ = __webpack_require__("./src/app/components/settings/restaurant-settings/restaurant-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__components_settings_stock_settings_stock_settings_component__ = __webpack_require__("./src/app/components/settings/stock-settings/stock-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__components_settings_cashbox_settings_cashbox_settings_component__ = __webpack_require__("./src/app/components/settings/cashbox-settings/cashbox-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__components_reports_store_reports_store_reports_component__ = __webpack_require__("./src/app/components/reports/store-reports/store-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__components_reports_product_reports_product_reports_component__ = __webpack_require__("./src/app/components/reports/product-reports/product-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29__components_reports_table_reports_table_reports_component__ = __webpack_require__("./src/app/components/reports/table-reports/table-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30__components_reports_stock_reports_stock_reports_component__ = __webpack_require__("./src/app/components/reports/stock-reports/stock-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31__components_reports_user_reports_user_reports_component__ = __webpack_require__("./src/app/components/reports/user-reports/user-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_32__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_33__services_application_service__ = __webpack_require__("./src/app/services/application.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_34__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_35__services_auth_service__ = __webpack_require__("./src/app/services/auth.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_36__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_37__services_http_service__ = __webpack_require__("./src/app/services/http.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_38__services_conflict_service__ = __webpack_require__("./src/app/services/conflict.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_39__providers_keyboard_service__ = __webpack_require__("./src/app/providers/keyboard.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_40__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_41__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_42__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_43__providers_terminal_service__ = __webpack_require__("./src/app/providers/terminal.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_44__providers_caller_id_service__ = __webpack_require__("./src/app/providers/caller-id.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_45__providers_scaler_service__ = __webpack_require__("./src/app/providers/scaler.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_46__pipes_general_pipe__ = __webpack_require__("./src/app/pipes/general.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_47__pipes_timeago_pipe__ = __webpack_require__("./src/app/pipes/timeago.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_48__components_helpers_keyboard_keyboard_component__ = __webpack_require__("./src/app/components/helpers/keyboard/keyboard.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_49__components_helpers_message_message_component__ = __webpack_require__("./src/app/components/helpers/message/message.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_50__components_helpers_caller_caller_component__ = __webpack_require__("./src/app/components/helpers/caller/caller.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_51__directives_keyboard_directive__ = __webpack_require__("./src/app/directives/keyboard.directive.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_52__directives_button_directive__ = __webpack_require__("./src/app/directives/button.directive.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_53__components_settings_printer_settings_printer_settings_component__ = __webpack_require__("./src/app/components/settings/printer-settings/printer-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_54__components_settings_recipe_settings_recipe_settings_component__ = __webpack_require__("./src/app/components/settings/recipe-settings/recipe-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_55__components_settings_customer_settings_customer_settings_component__ = __webpack_require__("./src/app/components/settings/customer-settings/customer-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_56__pipes_price_pipe__ = __webpack_require__("./src/app/pipes/price.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_57__components_reports_activity_reports_activity_reports_component__ = __webpack_require__("./src/app/components/reports/activity-reports/activity-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_58__components_reports_cashbox_reports_cashbox_reports_component__ = __webpack_require__("./src/app/components/reports/cashbox-reports/cashbox-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_59__components_reports_notifications_reports_notifications_reports_component__ = __webpack_require__("./src/app/components/reports/notifications-reports/notifications-reports.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_60_ng2_charts__ = __webpack_require__("./node_modules/ng2-charts/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_60_ng2_charts___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_60_ng2_charts__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_61_ngx_mask__ = __webpack_require__("./node_modules/ngx-mask/fesm5/ngx-mask.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_62__services_market_service__ = __webpack_require__("./src/app/services/market.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_63__ng_select_ng_select__ = __webpack_require__("./node_modules/@ng-select/ng-select/esm5/ng-select.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};


//////  Modules





//////  Main Pages Components











////// EndDay Child Components

////// Store Child Components


////// Settings Child Components






////// Reports Child Components





//////  Servisler







//////  Providers







//////  Pipes


//////  Helpers



//////  Directives









//////  3rd Party Modules




// Error Handler Sentry
// import * as Raven from 'raven-js';
// Raven.config('https://99ca5e8959c5432ca68bdf99d6360fb0@o380332.ingest.sentry.io/5206016').install();
// export class RavenErrorHandler implements ErrorHandler {
//   handleError(err: any): void {
//     console.error(err);
//     Raven.captureException(err);
//   }
// }
let AppModule = class AppModule {
};
AppModule = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_3__angular_core__["NgModule"])({
        declarations: [
            __WEBPACK_IMPORTED_MODULE_7__app_component__["a" /* AppComponent */],
            __WEBPACK_IMPORTED_MODULE_9__components_setup_setup_component__["a" /* SetupComponent */],
            __WEBPACK_IMPORTED_MODULE_11__components_home_home_component__["a" /* HomeComponent */],
            __WEBPACK_IMPORTED_MODULE_12__components_cashbox_cashbox_component__["a" /* CashboxComponent */],
            __WEBPACK_IMPORTED_MODULE_13__components_reports_reports_component__["a" /* ReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_16__components_settings_settings_component__["a" /* SettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_14__components_endoftheday_endoftheday_component__["a" /* EndofthedayComponent */],
            __WEBPACK_IMPORTED_MODULE_15__components_store_store_component__["a" /* StoreComponent */],
            __WEBPACK_IMPORTED_MODULE_19__components_store_selling_screen_selling_screen_component__["a" /* SellingScreenComponent */],
            __WEBPACK_IMPORTED_MODULE_10__components_login_login_component__["a" /* LoginComponent */],
            __WEBPACK_IMPORTED_MODULE_21__components_settings_user_settings_user_settings_component__["a" /* UserSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_22__components_settings_menu_settings_menu_settings_component__["a" /* MenuSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_23__components_settings_application_settings_application_settings_component__["a" /* ApplicationSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_24__components_settings_restaurant_settings_restaurant_settings_component__["a" /* RestaurantSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_49__components_helpers_message_message_component__["a" /* MessageComponent */],
            __WEBPACK_IMPORTED_MODULE_48__components_helpers_keyboard_keyboard_component__["a" /* KeyboardComponent */],
            __WEBPACK_IMPORTED_MODULE_20__components_store_payment_screen_payment_screen_component__["a" /* PaymentScreenComponent */],
            __WEBPACK_IMPORTED_MODULE_25__components_settings_stock_settings_stock_settings_component__["a" /* StockSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_27__components_reports_store_reports_store_reports_component__["a" /* StoreReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_28__components_reports_product_reports_product_reports_component__["a" /* ProductReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_29__components_reports_table_reports_table_reports_component__["a" /* TableReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_30__components_reports_stock_reports_stock_reports_component__["a" /* StockReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_31__components_reports_user_reports_user_reports_component__["a" /* UserReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_46__pipes_general_pipe__["a" /* GeneralPipe */],
            __WEBPACK_IMPORTED_MODULE_47__pipes_timeago_pipe__["a" /* TimeAgoPipe */],
            __WEBPACK_IMPORTED_MODULE_56__pipes_price_pipe__["a" /* PricePipe */],
            __WEBPACK_IMPORTED_MODULE_51__directives_keyboard_directive__["a" /* KeyboardDirective */],
            __WEBPACK_IMPORTED_MODULE_17__components_admin_admin_component__["a" /* AdminComponent */],
            __WEBPACK_IMPORTED_MODULE_18__components_endoftheday_day_detail_day_detail_component__["a" /* DayDetailComponent */],
            __WEBPACK_IMPORTED_MODULE_8__components_activation_activation_component__["a" /* ActivationComponent */],
            __WEBPACK_IMPORTED_MODULE_52__directives_button_directive__["a" /* ButtonDirective */],
            __WEBPACK_IMPORTED_MODULE_53__components_settings_printer_settings_printer_settings_component__["a" /* PrinterSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_54__components_settings_recipe_settings_recipe_settings_component__["a" /* RecipeSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_55__components_settings_customer_settings_customer_settings_component__["a" /* CustomerSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_50__components_helpers_caller_caller_component__["a" /* CallerComponent */],
            __WEBPACK_IMPORTED_MODULE_57__components_reports_activity_reports_activity_reports_component__["a" /* ActivityReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_26__components_settings_cashbox_settings_cashbox_settings_component__["a" /* CashboxSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_58__components_reports_cashbox_reports_cashbox_reports_component__["a" /* CashboxReportsComponent */],
            __WEBPACK_IMPORTED_MODULE_59__components_reports_notifications_reports_notifications_reports_component__["a" /* NotificationsReportsComponent */],
        ],
        imports: [
            __WEBPACK_IMPORTED_MODULE_2__angular_platform_browser__["a" /* BrowserModule */],
            __WEBPACK_IMPORTED_MODULE_4__angular_forms__["a" /* FormsModule */],
            __WEBPACK_IMPORTED_MODULE_5__angular_http__["c" /* HttpModule */],
            __WEBPACK_IMPORTED_MODULE_6__app_routing_module__["a" /* AppRoutingModule */],
            __WEBPACK_IMPORTED_MODULE_60_ng2_charts__["ChartsModule"],
            __WEBPACK_IMPORTED_MODULE_63__ng_select_ng_select__["a" /* NgSelectModule */],
            __WEBPACK_IMPORTED_MODULE_61_ngx_mask__["a" /* NgxMaskModule */].forRoot(),
        ],
        providers: [
            // { provide: ErrorHandler, useClass: RavenErrorHandler },
            __WEBPACK_IMPORTED_MODULE_42__providers_electron_service__["a" /* ElectronService */],
            __WEBPACK_IMPORTED_MODULE_32__services_main_service__["a" /* MainService */],
            __WEBPACK_IMPORTED_MODULE_33__services_application_service__["a" /* ApplicationService */],
            __WEBPACK_IMPORTED_MODULE_34__services_settings_service__["a" /* SettingsService */],
            __WEBPACK_IMPORTED_MODULE_35__services_auth_service__["a" /* AuthService */],
            __WEBPACK_IMPORTED_MODULE_62__services_market_service__["a" /* MarketService */],
            __WEBPACK_IMPORTED_MODULE_36__services_log_service__["a" /* LogService */],
            __WEBPACK_IMPORTED_MODULE_40__providers_message_service__["a" /* MessageService */],
            __WEBPACK_IMPORTED_MODULE_39__providers_keyboard_service__["a" /* KeyboardService */],
            __WEBPACK_IMPORTED_MODULE_41__providers_printer_service__["a" /* PrinterService */],
            __WEBPACK_IMPORTED_MODULE_43__providers_terminal_service__["a" /* TerminalService */],
            __WEBPACK_IMPORTED_MODULE_38__services_conflict_service__["a" /* ConflictService */],
            __WEBPACK_IMPORTED_MODULE_44__providers_caller_id_service__["a" /* CallerIDService */],
            __WEBPACK_IMPORTED_MODULE_45__providers_scaler_service__["a" /* ScalerService */],
            __WEBPACK_IMPORTED_MODULE_37__services_http_service__["a" /* HttpService */]
        ],
        bootstrap: [__WEBPACK_IMPORTED_MODULE_7__app_component__["a" /* AppComponent */]]
    })
], AppModule);



/***/ }),

/***/ "./src/app/components/activation/activation.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-lg-12\">\n    <div class=\"card full-height\">\n      <div class=\"card-header\">Aktivasyon</div>\n      <div class=\"card-body text-center\">\n        <h1 class=\"mt-5\">\n          <i class=\"fa fa-times-circle fa-5x text-danger\"></i>\n        </h1>\n        <h1>İşletme Hesabı Aktif Değil !</h1>\n        <p class=\"text-muted\">Ayrıntılı bilgi ve aktivasyon işlemleri için ilgili telefon numaramızdan bize ulaşabilirsiniz.</p>\n        <h3 class=\"mt-2\">0 (531) 085 68 81</h3>\n      </div>\n      <div class=\"card-footer\">İşletme Kodu: {{restInfo?.auth.app_id}}</div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/activation/activation.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/activation/activation.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ActivationComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let ActivationComponent = class ActivationComponent {
    constructor(settingsService, mainService, electronService) {
        this.settingsService = settingsService;
        this.mainService = mainService;
        this.electronService = electronService;
        this.settingsService.RestaurantInfo.subscribe(res => {
            this.restInfo = res.value;
            this.mainService.syncToRemote();
        });
    }
    ngOnInit() { }
};
ActivationComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-activation',
        template: __webpack_require__("./src/app/components/activation/activation.component.html"),
        styles: [__webpack_require__("./src/app/components/activation/activation.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_1__providers_electron_service__["a" /* ElectronService */]])
], ActivationComponent);



/***/ }),

/***/ "./src/app/components/admin/admin.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"card full-height\">\n  <div class=\"card-header\">Uygulama Konsolu</div>\n  <div class=\"card-body p-2\">\n    <div class=\"row\">\n      <div class=\"col-xl-2 col-lg-3 pr-1\">\n        <div class=\"card inside-height\">\n          <div class=\"card-header\">Veritabanı</div>\n          <div class=\"card-body p-0 flow\">\n            <div class=\"btn-group-vertical btn-block btn-group-lg\">\n              <button *ngFor=\"let db of databases\" type=\"button\" [ngClass]=\"{'btn-danger bg-danger text-white': selectedDB == db}\"\n                (click)=\"showDatabase(db)\" class=\"btn btn-secondary dark-bg\">{{db}}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"col-xl-8 col-lg-6 pl-0 pr-1\">\n        <div class=\"card inside-height\">\n          <div class=\"card-header\">Dökümanlar\n            <span class=\"float-right\">\n              <button [disabled]=\"selectedDB == undefined\" data-toggle=\"modal\" data-target=\"#docModal\" (click)=\"onCreate = true\" class=\"btn btn-sm btn-warning\"> + Ekle</button>\n            </span>\n          </div>\n          <div class=\"card-body p-0 flow\">\n            <table class=\"table table-hover table-striped\">\n              <tbody>\n                <tr *ngFor=\"let item of documents\" (click)=\"showDocument(item)\">\n                  <td>{{item| json}}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n          <div class=\"card-footer\">\n            <div class=\"input-group\">\n              <input #filterKey type=\"text\" placeholder=\"Key\" class=\"form-control form-control-md\">\n              <input #filterValue type=\"text\" placeholder=\"Value\" class=\"form-control form-control-md\">\n              <span class=\"input-group-append\">\n                <button class=\"btn btn-secondary\" (click)=\"getByFilter(filterKey.value,filterValue.value)\" type=\"button\">Sorgula</button>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"col-xl-2 col-lg-3 pl-0\">\n        <div class=\"card inside-height\">\n          <div class=\"card-header\">\n            İşlemler\n          </div>\n          <div class=\"card-body p-0\">\n          </div>\n          <div class=\"card-footer p-1\">\n            <button [disabled]=\"selectedDB == undefined\" (click)=\"resolveDB()\" class=\"btn btn-quickly btn-md btn-block\">Veritabanı\n              Düzelt</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button [disabled]=\"selectedDB == undefined\" (click)=\"clearDB()\" class=\"btn btn-secondary btn-md btn-block\">Veritabanı\n              Boşalt</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button [disabled]=\"selectedDB == undefined\" (click)=\"compactDB()\" class=\"btn btn-default btn-md btn-block\">Veritabanı\n              Sıkıştır</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button (click)=\"resetReports()\" class=\"btn btn-danger btn-md btn-block\">Raporları Sıfırla</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button (click)=\"syncData()\" [disabled]=\"selectedDB == undefined || selectedDB == 'allData'\" class=\"btn btn-warning btn-md btn-block\">Senkorinize\n              Et</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button type=\"button\" (click)=\"refreshToken()\" class=\"btn btn-success btn-block btn-md\">Erişimi Güncelle</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button type=\"button\" (click)=\"testEndDay()\" class=\"btn btn-info btn-block btn-md\">Gün Sonu Güncelle</button>\n          </div>\n          <div class=\"card-footer p-1\">\n            <button type=\"button\" (click)=\"updateProgram()\" class=\"btn btn-primary btn-block btn-md\">Programı Güncelle</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"docModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Döküman Düzenle</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <textarea #editArea rows=\"18\" class=\"form-control\">{{selectedDoc | json }}</textarea>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button *ngIf=\"!onCreate\" type=\"button\" (click)=\"removeDocument(selectedDoc?._id)\" class=\"btn btn-danger btn-lg\">Sil</button>\n        <button *ngIf=\"!onCreate\" type=\"button\" (click)=\"editDocument(editArea.value)\" class=\"btn btn-success btn-lg\">Kaydet</button>\n        <button *ngIf=\"onCreate\" type=\"button\" (click)=\"createDocument(editArea.value)\" class=\"btn btn-success btn-lg\">Oluştur</button>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/admin/admin.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/admin/admin.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AdminComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_http_service__ = __webpack_require__("./src/app/services/http.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let AdminComponent = class AdminComponent {
    constructor(mainService, httpService) {
        this.mainService = mainService;
        this.httpService = httpService;
        this.databases = Object.keys(this.mainService.LocalDB);
    }
    ngOnInit() {
    }
    syncData() {
        this.mainService.syncToLocal(this.selectedDB).then(message => {
            alert(message);
        });
    }
    showDatabase(db_name) {
        this.selectedDB = db_name;
        this.mainService.getAllBy(db_name, {}).then(res => {
            this.documents = res.docs;
        });
    }
    showDocument(doc) {
        // this.editArea.nativeElement.value == '';
        this.selectedDoc = doc;
        $('#docModal').modal('show');
    }
    editDocument(document) {
        let newDocument = JSON.parse(document);
        let db_name;
        if (this.selectedDB == 'allData') {
            db_name = document.db_name;
        }
        else {
            db_name = this.selectedDB;
        }
        this.mainService.updateData(db_name, newDocument._id, newDocument).then(res => {
            $('#docModal').modal('hide');
            console.log('Döküman Güncellendi');
            this.editArea.nativeElement.value = '';
            this.selectedDoc = undefined;
            this.showDatabase(this.selectedDB);
        });
    }
    createDocument(document) {
        let newDocument = JSON.parse(document);
        this.mainService.addData(this.selectedDB, newDocument).then(res => {
            if (res.ok) {
                $('#docModal').modal('hide');
                console.log('Döküman Güncellendi');
                this.editArea.nativeElement.value = '';
                this.selectedDoc = undefined;
                this.showDatabase(this.selectedDB);
            }
        });
    }
    getByFilter(key, value) {
        let filter = new Object();
        filter[key] = value;
        if (this.selectedDB) {
            this.mainService.getAllBy(this.selectedDB, filter).then(res => {
                this.documents = res.docs;
            });
        }
    }
    removeDocument(id) {
        this.mainService.removeData(this.selectedDB, id).then(res => {
            $('#docModal').modal('hide');
            console.log('Döküman Silindi');
            this.selectedDoc = undefined;
            this.showDatabase(this.selectedDB);
        });
    }
    resetReports() {
        this.mainService.getAllBy('reports', {}).then(res => {
            console.warn(res.docs.length);
            let reports = res.docs.filter(obj => obj.type !== 'Activity');
            reports.forEach((element, index) => {
                this.mainService.changeData('reports', element._id, (doc) => {
                    doc.amount = 0;
                    doc.count = 0;
                    doc.weekly = [0, 0, 0, 0, 0, 0, 0];
                    doc.weekly_count = [0, 0, 0, 0, 0, 0, 0];
                    return doc;
                });
            });
            this.mainService.localSyncBeforeRemote('reports');
        });
    }
    compactDB() {
        this.mainService.compactDB(this.selectedDB).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    }
    clearDB() {
        this.mainService.getAllBy(this.selectedDB, {}).then(res => {
            res.docs.forEach((element, index) => {
                this.mainService.removeData(this.selectedDB, element._id);
                console.log(index);
            });
        });
    }
    refreshToken() {
        // let username = prompt('username');
        // let password = prompt('password');
        let oldToken = localStorage['AccessToken'];
        this.httpService.post('/store/refresh', null, oldToken).toPromise().then(res => {
            if (res.ok) {
                const token = res.json().token;
                localStorage.setItem('AccessToken', token);
                alert('İşlem Başarılı');
            }
        }).catch(err => {
            this.httpService.post('/store/login', { username: 'quickly', password: 'asdtd155+1' }).toPromise().then(res => {
                if (res.ok) {
                    const token = res.json().token;
                    localStorage.setItem('AccessToken', token);
                    alert('İşlem Başarılı');
                }
                else {
                    alert('Başarısız');
                }
            });
        });
    }
    resolveDB() {
        this.mainService.LocalDB[this.selectedDB].allDocs({ include_docs: true, conflicts: true }).then(res => {
            let test = res.rows.map(obj => { return obj.doc; });
            test.forEach(element => {
                if (element.hasOwnProperty('_conflicts')) {
                    console.log(element);
                    this.mainService.LocalDB[this.selectedDB].resolveConflicts(element, (a, b) => {
                        if (element.hasOwnProperty('timestamp')) {
                            if (a.timestamp > b.timestamp)
                                return a;
                            if (b.timestamp > a.timestamp)
                                return b;
                        }
                        else if (element.hasOwnProperty('timestamp')) {
                            if (a.timestamp > b.timestamp)
                                return a;
                            if (b.timestamp > a.timestamp)
                                return b;
                        }
                        else if (element.hasOwnProperty('time')) {
                            if (a.time > b.time)
                                return a;
                            if (b.time > a.time)
                                return b;
                        }
                        return a;
                    }).then(res => {
                        console.log(res);
                    }).catch(err => {
                        console.log(err);
                    });
                }
            });
        });
    }
    updateProgram() {
        // this.mainService.getAllBy('floors',{}).then(res => {
        //   console.log(res);
        // })
        // let tablesArr = [];
        // this.mainService.getAllBy('tables', {}).then(res => {
        //   for (let index = 0; index < res.docs.length; index++) {
        //     let connection_id = res.docs[index]._id;
        //     let reports = new Report('Table', connection_id, 0, 0, 0, [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], '', Date.now());
        //     this.mainService.addData('reports', reports).then(res => {
        //       console.log(res);
        //     })
        //   }
        // })
        // for (let index = 1; index < 16; index++) {
        //     let table = new Table(`S${index}`,'05800961-4aaa-4add-baa8-9f8fbfb3f2fb',4,'',1,Date.now(),[]);
        //     this.mainService.addData('tables',table).then(res => {
        //       console.log(res);
        //     }); 
        // }
        // localStorage.setItem('CheckNo', "1");
        // let specifies = [
        //   {
        //     spec_name: "Sek",
        //     spec_price: 70
        //   },
        //   {
        //     spec_name: "Soda",
        //     spec_price: 70
        //   },
        //   {
        //     spec_name: "Kola",
        //     spec_price: 70
        //   },
        //   {
        //     spec_name: "Redbull",
        //     spec_price: 75
        //   }
        // ];
        // this.mainService.getAllBy('products', {cat_id :"ebb230e3-c297-4822-8c2b-6b11b0f9ca68"}).then(res => {
        //   let products = res.docs;
        //   products.forEach(element => {
        //     this.mainService.changeData('products', element._id, (doc: Product) => {
        //       doc.specifies = specifies;
        //       doc.specifies.map(obj => {
        //         if(obj.spec_name == 'Redbull'){
        //           obj.spec_price = doc.price + 5;
        //         }else{
        //           obj.spec_price = doc.price;
        //         }
        //       });
        //       console.log(doc);
        //       return doc;
        //     }).then(res => {
        //       console.log(res);
        //     });
        //   });
        // })
        // this.mainService.getAllBy('stocks', {}).then(res => {
        //   let stocks = res.docs;
        //   stocks.forEach(element => {
        //     this.mainService.changeData('stocks', element._id, (doc) => {
        //       doc.warning_value = 25;
        //       return doc;
        //     }).then(res => {
        //       console.log(res);
        //     });
        //   });
        // })
        // this.mainService.getAllBy('endday', {}).then(res => {
        //   let endday = res.docs;
        //   endday.forEach(element => {
        //     this.mainService.changeData('endday', element._id, (doc) => {
        //       let time = doc.time;
        //       delete doc.time;
        //       doc.timestamp = time;
        //       return doc;
        //     }).then(res => {
        //       console.log(res);
        //     });
        //   });
        // })
        // this.mainService.getAllBy('reports', { type: 'Product' }).then(res => {
        //   let reports = res.docs;
        //   console.log(res);
        //   reports.forEach(element => {
        //     this.mainService.changeData('reports', element._id, (doc) => {
        //       doc.weekly[0] = 0;
        //       doc.weekly_count[0] = 0;
        //       return doc;
        //     }).then(res => {
        //       console.log(res);
        //     });
        //   });
        // })
        // let value = new ServerInfo(0, 1, '192.168.1.1', 3000, 'kosmos2018');
        // this.mainService.addData('settings', new Settings('ServerSettings', value, 'Sunucu Ayarları', Date.now()));
        // this.mainService.syncToRemote().cancel();
        // this.mainService.syncToServer().cancel();
        // this.mainService.getAllBy('settings', { key: 'RestaurantInfo' }).then(res => {
        //   let restaurantID = res.docs[0].value.id;
        //   this.mainService.getAllBy('allData', {}).then(res => {
        //     let token = localStorage.getItem("AccessToken");
        //     this.httpService.post(`v1/management/restaurants/${restaurantID}/reset_database/`, { docs: [] }, token).subscribe(res => {
        //       console.log(res.json());
        //       Object.keys(this.mainService.LocalDB).forEach(db_name => {
        //         if (db_name !== 'settings') {
        //           this.mainService.destroyDB(db_name).then(res => {
        //             console.log(db_name, res);
        //           });
        //         }
        //       });
        //     });
        //   })
        // });
        // this.mainService.getAllBy('allData', {}).then(res => {
        //   return res.docs.map((obj) => {
        //     delete obj._rev;
        //     return obj;
        //   })
        // }).then((cleanDocs: Array<any>) => {
        //   console.log(cleanDocs.length);
        //   fs.writeFile('./data/all.txt', JSON.stringify(cleanDocs), err => {
        //     console.log(err);
        //   })
        // });;
        // fs.readFile('./data/all.txt', (err, data) => {
        //   let realData = JSON.parse(data.toString('utf-8'));
        //   let filteredData = realData
        //     .filter(obj => obj.db_name !== "settings")
        //     .filter(obj => obj.db_name !== "users")
        //     .filter(obj => obj.db_name !== "users_group")
        //     .filter(obj => obj.type !== "Store")
        //     .filter(obj => obj.type !== "User")
        //     .filter(obj => obj.type !== "Activity");
        //   this.mainService.putAll('allData', filteredData).then(res => {
        //     this.mainService.syncToLocal().then(res => {
        //       console.log(res);
        //     })
        //   });
        // })
        // Object.keys(this.mainService.LocalDB).forEach(db_name => {
        //   this.mainService.destroyDB(db_name);
        // });
        // this.mainService.createIndex('allData', ['db_name']).then(res => {
        //   console.log(res);
        // });
        // let t1 = performance.now();
        // this.mainService.getAllData('closed_checks').then(res => {
        //   console.log(res.rows.map(obj => { return obj.doc }));
        //   let t2 = performance.now();
        //   console.log('Bulk', t2 - t1);
        // })
        // this.mainService.getAllBy('closed_checks', {}).then(res => {
        //   console.log('Pro', res.docs);
        //   let t2 = performance.now();
        //   console.log('Normal', t2 - t1);
        // });
        // fs.readFile('./data/all.txt', (err, data) => {
        //   const rdata = JSON.parse(data.toString('utf-8'));
        //   let products = rdata.filter(obj => obj.db_name == 'products');
        //   console.log('File', products);
        //   let t2 = performance.now();
        //   console.log(t2 - t1);
        // })
        // this.mainService.getAllBy('allData', { db_name: 'products' }).then(res => {
        //   console.log('All', res.docs);
        //   let t2 = performance.now();
        //   console.log(t2 - t1);
        // });
    }
    testEndDay() {
        let token = localStorage.getItem("AccessToken");
        let restaurantID = JSON.parse(localStorage['RestaurantInfo']).id;
        this.httpService.post(`v1/management/restaurants/${restaurantID}/report_generator/`, { timestamp: Date.now(), data: { hello: 'test' } }, token).subscribe(res => {
            console.log(res);
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('editArea'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], AdminComponent.prototype, "editArea", void 0);
AdminComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-admin',
        template: __webpack_require__("./src/app/components/admin/admin.component.html"),
        styles: [__webpack_require__("./src/app/components/admin/admin.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_1__services_http_service__["a" /* HttpService */]])
], AdminComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/cashbox/cashbox.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-lg-10 pr-0\">\n    <div class=\"card full-height\">\n      <div class=\"card-header\">Kasa Durumu</div>\n      <div class=\"card-header p-0\">\n        <table class=\"table table-hover mb-0\">\n          <thead class=\"thead-dark\">\n            <tr class=\"table-info\">\n              <td width=\"6%\">\n                <i class=\"fa fa-diamond\"></i>\n              </td>\n              <td width=\"94%\">\n                <b>Faliyet Gelirleri</b>\n                <span class=\"pull-right\">Toplam: {{sellingIncomes | price }}</span>\n              </td>\n            </tr>\n          </thead>\n        </table>\n      </div>\n      <div class=\"card-body p-0 flow\">\n        <table class=\"table  table-bordered table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"6%\">#</th>\n              <th width=\"44%\"><i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Açıklama</th>\n              <th width=\"15%\"><i class=\"fa fa-user\" aria-hidden=\"true\"></i> Kullanıcı</th>\n              <th width=\"15%\"><i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> Saat</th>\n              <th width=\"20%\"><i class=\"fa fa-money\" aria-hidden=\"true\"></i> Tutar</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let cash of cashboxData; let i=index\" (click)=\"updateData(cash)\" [ngClass]=\"{'table-danger': cash.type == 'Gider', 'table-success': cash.type == 'Gelir'}\">\n              <td>\n                <i class=\"fa\" [ngClass]=\"{'fa-arrow-up': cash.type == 'Gider' , 'fa-arrow-down': cash.type == 'Gelir'}\"></i>\n              </td>\n              <td><strong *ngIf=\"cashboxCategories.length > 0\">{{categoryName(cash.category)}}</strong><br>{{cash.description}}</td>\n              <td>{{cash.user}}</td>\n              <td>{{cash.timestamp | date:'HH:mm'}}</td>\n              <td>{{cash.cash + cash.card + cash.coupon  | price}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <div class=\"row\">\n          <div class=\"col-lg-4\">\n            <h4 class=\"text-success\">Gelir: {{incomes | price}}</h4>\n          </div>\n          <div class=\"col-lg-4 text-center\">\n            <h4 class=\"text-danger\">Gider: {{outcomes | price}}</h4>\n          </div>\n          <div class=\"col-lg-4\">\n            <h4 class=\"pull-right text-primary\">Toplam: {{leftTotal | price}}</h4>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id=\"sidebarHolder\" class=\"col-lg-2\">\n    <button (click)=\"type = 'Gelir'; setDefault();\" data-toggle=\"modal\" data-target=\"#cashboxModal\" class=\"btn btn-lg btn-success btn-block pt-5 pb-5\">Gelir Ekle</button>\n    <button (click)=\"type = 'Gider'; setDefault();\" data-toggle=\"modal\" data-target=\"#cashboxModal\" class=\"btn btn-lg btn-danger btn-block pt-5 pb-5\">Gider Ekle</button>\n  </div>\n</div>\n\n<div id=\"cashboxModal\" class=\"modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\">{{type}}</h5>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #cashboxForm=\"ngForm\" (ngSubmit)=\"addData(cashboxForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input type=\"hidden\" name=\"_id\" ngModel />\n            <input type=\"hidden\" name=\"_rev\" ngModel />\n          </div>\n          <input type=\"hidden\" name=\"timestamp\" class=\"form-control form-control-lg\" ngModel>\n          <input type=\"hidden\" name=\"user\" class=\"form-control form-control-lg\" ngModel>\n          <input id=\"type\" type=\"hidden\" name=\"type\" ngModel>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Kategori</div>\n            </div>\n            <select name=\"category\" class=\"form-control form-control-lg\"ngModel>\n              <option *ngFor=\"let cat of cashboxCategories\" value=\"{{cat._id}}\">{{cat.name}}</option>\n            </select>\n          </div>\n          <div class=\"form-group mb-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Açıklama</div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n            </div>\n          </div>\n          <div class=\"form-group mb-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Nakit</div>\n              </div>\n              <input type=\"number\" min=\"0\" name=\"cash\" class=\"form-control form-control-lg\" ngModel>\n              <div class=\"input-group-append\">\n                <div class=\"input-group-text\">TL</div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form-group mb-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kart</div>\n              </div>\n              <input type=\"number\" min=\"0\" name=\"card\" class=\"form-control form-control-lg\" ngModel>\n              <div class=\"input-group-append\">\n                <div class=\"input-group-text\">TL</div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form-group mb-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kupon</div>\n              </div>\n              <input type=\"number\" min=\"0\" name=\"coupon\" class=\"form-control form-control-lg\" ngModel>\n              <div class=\"input-group-append\">\n                <div class=\"input-group-text\">TL</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" (click)=\"removeData(selectedData._id)\" class=\"btn btn-danger btn-lg\" data-dismiss=\"modal\"> <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Kaydı Sil</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">\n            <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/cashbox/cashbox.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".cashbox-card {\n  height: 43vh; }\n\n.card-body {\n  height: 90%;\n  overflow-x: hidden;\n  overflow-y: scroll; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/cashbox/cashbox.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CashboxComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__ = __webpack_require__("./src/app/mocks/cashbox.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let CashboxComponent = class CashboxComponent {
    constructor(mainService, settingsService, messageService, logService) {
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.messageService = messageService;
        this.logService = logService;
        this.cashboxCategories = [];
        this.user = this.settingsService.getUser('name');
        this.sellingIncomes = 0;
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
    }
    ngOnInit() {
        this.fillData();
        this.onUpdate = false;
    }
    addData(cashboxForm) {
        let form = cashboxForm.value;
        if (form.description == '' || null) {
            this.messageService.sendMessage('Açıklama Girmek Zorundasınız.');
            return false;
        }
        if (form.cash == null && form.card == null && form.coupon == null) {
            this.messageService.sendMessage('Herhangi Bir ' + this.type + ' Miktarı Belirtmelisiniz.');
            return false;
        }
        if (form.cash == null) {
            form.cash = 0;
        }
        if (form.card == null) {
            form.card = 0;
        }
        if (form.coupon == null) {
            form.coupon = 0;
        }
        if (!form._id) {
            let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__["a" /* Cashbox */](this.type, form.description, Date.now(), form.cash, form.card, form.coupon, this.user, form.category);
            this.mainService.addData('cashbox', schema).then(res => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_4__services_log_service__["b" /* logType */].CASHBOX_CREATED, res.id, `Kasaya ${(form.cash + form.card + form.coupon)} tutarında ${this.type} eklendi.`);
                this.fillData();
                this.messageService.sendMessage(this.type + ' Eklendi');
            });
        }
        else {
            let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__["a" /* Cashbox */](this.type, form.description, Date.now(), form.cash, form.card, form.coupon, this.user, form._id, form._rev);
            this.mainService.updateData('cashbox', form._id, schema).then(res => {
                this.fillData();
                this.messageService.sendMessage(this.type + ' Düzenlendi');
            });
        }
        this.cashboxForm.reset();
        $('#cashboxModal').modal('hide');
    }
    categoryName(cat_id) {
        let isavailable = this.cashboxCategories.find(obj => obj._id == cat_id);
        if (isavailable) {
            return isavailable.name;
        }
        else {
            return 'Bilinmiyor';
        }
    }
    updateData(data) {
        this.onUpdate = true;
        this.selectedData = data;
        this.type = this.selectedData.type;
        this.mainService.getData('cashbox', data._id).then(res => {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_4__services_log_service__["b" /* logType */].CASHBOX_UPDATED, res.id, `Kasa '${this.selectedData.description}' adlı ${this.type}'i güncellendi.`);
            this.cashboxForm.setValue(res);
            this.fillData();
            $('#cashboxModal').modal('show');
        });
    }
    removeData(id) {
        this.mainService.removeData('cashbox', id).then(res => {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_4__services_log_service__["b" /* logType */].CASHBOX_DELETED, res.id, `Kasadan '${this.selectedData.description}' adlı ${this.type}'i silindi.`);
            this.messageService.sendMessage('Kayıt Silindi');
            this.fillData();
        });
        $('#cashboxModal').modal('hide');
    }
    setDefault() {
        this.cashboxForm.reset();
        this.onUpdate = false;
    }
    fillData() {
        this.sellingIncomes = 0;
        this.mainService.getAllBy('cashbox_categories', {}).then(res => {
            this.cashboxCategories = res.docs;
        }).catch(err => {
        });
        this.mainService.getAllBy('cashbox', {}).then(result => {
            this.cashboxData = result.docs;
            this.cashboxData.sort((a, b) => b.timestamp - a.timestamp);
            try {
                this.incomes = this.cashboxData.filter(obj => obj.type == 'Gelir').map(obj => obj.card + obj.cash + obj.coupon).reduce((a, b) => a + b);
            }
            catch (error) {
                this.incomes = 0;
            }
            try {
                this.outcomes = this.cashboxData.filter(obj => obj.type == 'Gider').map(obj => obj.card + obj.cash + obj.coupon).reduce((a, b) => a + b);
            }
            catch (error) {
                this.outcomes = 0;
            }
            let left = this.incomes - this.outcomes;
            this.mainService.getAllBy('reports', { type: 'Store' }).then(res => {
                let report = res.docs;
                report = report.filter(obj => obj.connection_id !== 'Genel').sort((a, b) => b.connection_id.localeCompare(a.connection_id));
                report.forEach((element, index) => {
                    if (element.connection_id !== 'İkram') {
                        this.sellingIncomes += element.weekly[this.day];
                    }
                    if (report.length - 1 == index) {
                        this.leftTotal = this.sellingIncomes + left;
                        this.leftTotal = Math.round(this.leftTotal);
                    }
                    ;
                });
            });
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('cashboxForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], CashboxComponent.prototype, "cashboxForm", void 0);
CashboxComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-cashbox',
        template: __webpack_require__("./src/app/components/cashbox/cashbox.component.html"),
        styles: [__webpack_require__("./src/app/components/cashbox/cashbox.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_6__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_5__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_6__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_3__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_4__services_log_service__["a" /* LogService */]])
], CashboxComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/endoftheday/day-detail/day-detail.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-xl-3 col-lg-3 pr-0\">\n    <div class=\"card\" style=\"height:625px\">\n      <div class=\"card-header p-1 text-center\">\n        <small>Başlıklar</small>\n      </div>\n      <div class=\"card-body p-0\">\n        <div class=\"list-group\">\n          <button (click)=\"currentSection = undefined; detailTitle = 'Genel Detaylar & Grafik';\" [ngClass]=\"{'list-group-item-warning' : currentSection == undefined}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-pie-chart fa-2x\" aria-hidden=\"true\"></i>\n            <span>Genel Detaylar</span>\n          </button>\n          <button (click)=\"filterOldData('Checks','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Checks'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-sticky-note fa-2x\" aria-hidden=\"true\"></i>\n            <span>Hesap Detayları</span>\n          </button>\n          <button (click)=\"filterOldData('Cashbox','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Cashbox'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-money fa-2x\" aria-hidden=\"true\"></i>\n            <span>Kasa Detayları</span>\n          </button>\n          <button (click)=\"filterOldData('Products','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Products'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-glass fa-2x\" aria-hidden=\"true\"></i>\n            <span>Ürün Raporları</span>\n          </button>\n          <button (click)=\"filterOldData('Users','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Users'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-user fa-2x\" aria-hidden=\"true\"></i>\n            <span>Kullanıcı Raporları</span>\n          </button>\n          <button (click)=\"filterOldData('Tables','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Tables'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-square fa-2x\" aria-hidden=\"true\"></i>\n            <span>Masa Raporları</span>\n          </button>\n          <button (click)=\"filterOldData('Activity','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Activity'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-line-chart fa-2x\" aria-hidden=\"true\"></i>\n            <span>Aktivite Grafiği</span>\n          </button>\n          <button (click)=\"filterOldData('Logs','All')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'Logs'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-bell fa-2x\" aria-hidden=\"true\"></i>\n            <span>Sistem Kayıtları</span>\n          </button>\n          <button (click)=\"printEndday()\" type=\"button\" class=\"list-group-item list-group-item-action\">\n            <i class=\"fa fa-print fa-2x\" aria-hidden=\"true\"></i>\n            <span>Yazdır</span>\n          </button>\n        </div>\n      </div>\n      <div class=\"card-footer p-1 text-center\">\n        <small *ngIf=\"oldBackupData == undefined\">\n          <i class=\"fa fa-refresh fa-spin\" aria-hidden=\"true\"></i> Veriler Senkorinize Ediliyor\n        </small>\n        <small *ngIf=\"syncStatus && oldBackupData !== undefined\" class=\"text-success\">\n          <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Senkorinize Edildi\n        </small>\n        <small *ngIf=\"!syncStatus && oldBackupData !== undefined\" class=\"text-danger\">\n          <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Senkorinize Edilemedi\n        </small>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-xl-9 col-lg-9 pl-0\">\n    <div class=\"card\" style=\"height:625px\">\n      <div class=\"card-header p-1 text-center\">\n        <small> {{detailTitle}}</small>\n      </div>\n      <div *ngIf=\"currentSection == 'Checks'\" class=\"card-header pt-1 pb-1 text-center\">\n        <div class=\"row\">\n          <div class=\"col pl-0 pr-1\">\n            <button (click)=\"filterOldData('Checks','Parçalı')\" class=\"btn btn-primary btn-block\">Parçalı</button>\n          </div>\n          <div class=\"col pr-1 pl-1\">\n            <button (click)=\"filterOldData('Checks','Nakit')\" class=\"btn btn-success btn-block\">Nakit</button>\n          </div>\n          <div class=\"col pr-1 pl-1\">\n            <button (click)=\"filterOldData('Checks','Kart')\" class=\"btn btn-warning btn-block\">Kart</button>\n          </div>\n          <div class=\"col pr-1 pl-1\">\n            <button (click)=\"filterOldData('Checks','Kupon')\" class=\"btn btn-info btn-block\">Kupon</button>\n          </div>\n          <div class=\"col pl-1 pr-0\">\n            <button (click)=\"filterOldData('Checks','İkram')\" class=\"btn btn-danger btn-block\">İkram</button>\n          </div>\n        </div>\n      </div>\n      <div *ngIf=\"currentSection == 'Cashbox'\" class=\"card-header pt-1 pb-1 text-center\">\n        <div class=\"row\">\n          <div class=\"col pl-0 pr-1\">\n            <button (click)=\"filterOldData('Cashbox','Gelir')\" class=\"btn btn-success btn-block\">Kasa Gelirleri</button>\n          </div>\n          <div class=\"col pl-1 pr-0\">\n            <button (click)=\"filterOldData('Cashbox','Gider')\" class=\"btn btn-danger btn-block\">Kasa Giderleri</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body flow p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-12\">\n            <section *ngIf=\"currentSection == undefined\" id=\"chart\" class=\"p-0\">\n              <div class=\"row\">\n                <div class=\"col-xl-5 col-lg-6 pr-0\">\n                  <strong>\n                    <table class=\"table table-striped table-hover mb-0\">\n                      <tbody>\n                        <tr (click)=\"currentSection = undefined\">\n                          <td width=\"13%\">\n                            <i class=\"fa fa-check\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td width=\"57%\">Genel Toplam:</td>\n                          <td width=\"30%\">{{detailData.total_income | price}}</td>\n                        </tr>\n                        <tr class=\"text-muted\" (click)=\"filterOldData('Checks','All')\">\n                          <td>\n                            <i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Toplam Hesap Sayısı:</td>\n                          <td>{{detailData.check_count}} Adet</td>\n                        </tr>\n                        <tr class=\"text-success\">\n                          <td width=\"4%\">\n                            <i class=\"fa fa-money\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td width=\"60%\">Nakit Hesap Toplamı:</td>\n                          <td>{{detailData.cash_total | price}} </td>\n                        </tr>\n                        <tr class=\"text-warning\" (click)=\"filterOldData('Checks','Kart')\">\n                          <td>\n                            <i class=\"fa fa-credit-card\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Kart Hesap Toplamı:</td>\n                          <td>{{detailData.card_total | price}} </td>\n                        </tr>\n                        <tr class=\"text-info\" (click)=\"filterOldData('Checks','Kupon')\">\n                          <td>\n                            <i class=\"fa fa-bookmark ml-1\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Kupon Hesap Toplamı:</td>\n                          <td>{{detailData.coupon_total | price}} </td>\n                        </tr>\n                        <tr class=\"text-danger\" (click)=\"filterOldData('Checks','İkram')\">\n                          <td>\n                            <i class=\"fa fa-handshake-o\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>İkram Hesap Toplamı:</td>\n                          <td>{{detailData.free_total | price}} </td>\n                        </tr>\n                        <tr class=\"text-primary\" (click)=\"filterOldData('Checks','İptal')\">\n                          <td>\n                            <i class=\"fa fa-times-rectangle\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>İptal Hesap Toplamı:</td>\n                          <td>{{detailData.canceled_total | price}} </td>\n                        </tr>\n                        <tr (click)=\"filterOldData('Cashbox','Gelir')\">\n                          <td>\n                            <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Kasa Geliri Toplamı:</td>\n                          <td>{{detailData.incomes | price}} </td>\n                        </tr>\n                        <tr (click)=\"filterOldData('Cashbox','Gider')\">\n                          <td>\n                            <i class=\"fa fa-arrow-up\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Kasa Gideri Toplamı:</td>\n                          <td>{{detailData.outcomes | price}} </td>\n                        </tr>\n                        <tr>\n                          <td>\n                            <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Kullanıcı:</td>\n                          <td>{{detailData.owner | general:'users' | async}}</td>\n                        </tr>\n                        <tr>\n                          <td>\n                            <i class=\"fa fa-calendar\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Tarih:</td>\n                          <td>{{detailData.timestamp | date:'d/M/y'}}</td>\n                        </tr>\n                        <tr>\n                          <td>\n                            <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i>\n                          </td>\n                          <td>Saat:</td>\n                          <td>{{detailData.timestamp | date:'HH:mm'}}</td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </strong>\n                </div>\n                <div class=\"col-xl-7 col-lg-6 pt-4 pl-0\">\n                  <canvas baseChart style=\"height:525px; width:95%;  margin:auto;\" [data]=\"pieData\" [colors]=\"pieColors\" [labels]=\"pieLabels\" [legend]=\"true\" chartType=\"pie\" [options]=\"pieOptions\"></canvas>\n                </div>\n              </div>\n            </section>\n            <section id=\"checks\" *ngIf=\"currentSection == 'Checks'\">\n              <table class=\"table table-striped table-hover  table-bordered mb-0\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"8%\">#</th>\n                    <th width=\"32%\">Hesap</th>\n                    <th width=\"15%\">Kullanıcı</th>\n                    <th width=\"20%\">Tutar</th>\n                    <th width=\"15%\">Ödeme</th>\n                    <th width=\"10%\">Saat</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let item of checksTable; let i = index\" (click)=\"showCheckDetail(item)\">\n                    <td>{{i+1}}</td>\n                    <td>{{item.table_id | general:'tables' | async}}\n                      <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                    </td>\n                    <td>{{item.owner}}</td>\n                    <td>{{item.total_price | price}}\n                      <small *ngIf=\"item.discount !== 0\" class=\"text-danger pull-right\">\n                        <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> <b>{{item.discount | price}}</b></small>\n                    </td>\n                    <td>{{item.payment_method}}</td>\n                    <td>{{item.timestamp | date:'HH:mm'}}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n            <section id=\"cashbox\" *ngIf=\"currentSection == 'Cashbox'\">\n              <table class=\"table  table-bordered table-hover table-striped\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"8%\">#</th>\n                    <th width=\"43%\">Açıklama</th>\n                    <th width=\"20%\">Kullanıcı</th>\n                    <th width=\"20%\">Tutar</th>\n                    <th width=\"11%\">Saat</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let cash of cashboxTable; let i=index\" (click)=\"showCashDetail(cash)\" [ngClass]=\"{'table-danger': cash.type == 'Gider', 'table-success': cash.type == 'Gelir'}\">\n                    <td>{{i+1}}</td>\n                    <td><strong *ngIf=\"cashboxCategories.length > 0\">{{categoryName(cash.category)}}</strong><br>{{cash.description}}</td>\n                    <td>{{cash.user}}</td>\n                    <td>{{cash.cash + cash.card + cash.coupon | price}} </td>\n                    <td>{{cash.timestamp | date:'HH:mm'}}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n            <section id=\"products\" *ngIf=\"currentSection == 'Products'\">\n              <table class=\"table table-sm  table-bordered table-hover table-striped\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"5%\">#</th>\n                    <th width=\"40%\">Ürün</th>\n                    <th width=\"15%\">Fiyat</th>\n                    <th width=\"15%\">Adet</th>\n                    <th width=\"15%\">Toplam</th>\n                    <th width=\"10%\">Yüzde</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let product of productsSales; let i=index\">\n                    <td class=\"text-center\">{{i+1}}</td>\n                    <td>{{product.name}}</td>\n                    <td>{{product.price | price }}</td>\n                    <td>{{product.count}} Adet</td>\n                    <td>{{product.total | price }} </td>\n                    <td><strong>% {{(product.total/detailData.total_income) * 100 | number:'1.0-2' }}</strong></td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n            <section id=\"users\" *ngIf=\"currentSection == 'Users'\">\n              <table class=\"table  table-bordered table-hover table-striped\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"8%\">#</th>\n                    <th width=\"37%\">Kullanıcı</th>\n                    <th width=\"15%\">Yüzde</th>\n                    <th width=\"15%\">Tutar</th>\n                    <th width=\"15%\">Adet</th>\n                    <th width=\"10%\">Saat</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let user of usersTable; let i=index\">\n                    <td>{{i+1}}</td>\n                    <td>{{user.connection_id | general:'users' | async}}</td>\n                    <td><strong>% {{(user.weekly[detailDay]/detailData.total_income) * 100 | number:'1.0-2' }}</strong></td>\n                    <td>{{user.weekly[detailDay] | price }} </td>\n                    <td>{{user.weekly_count[detailDay]}} Adet</td>\n                    <td>{{user.timestamp | date:'HH:mm'}}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n\n            <section id=\"tables\" *ngIf=\"currentSection == 'Tables'\">\n              <table class=\"table  table-bordered table-hover table-striped\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"8%\">#</th>\n                    <th width=\"37%\">Masa</th>\n                    <th width=\"15%\">Yüzde</th>\n                    <th width=\"15%\">Tutar</th>\n                    <th width=\"15%\">Adet</th>\n                    <th width=\"10%\">Saat</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let table of tablesTable; let i=index\">\n                    <td>{{i+1}}</td>\n                    <td>{{table.connection_id | general:'tables' | async}}</td>\n                    <td><strong>% {{(table.weekly[detailDay]/detailData.total_income) * 100 | number:'1.0-2'}}</strong></td>\n                    <td>{{table.weekly[detailDay] | price }} </td>\n                    <td>{{table.weekly_count[detailDay]}} Adet</td>\n                    <td>{{table.timestamp | date:'HH:mm'}}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n            <section id=\"activity\" *ngIf=\"currentSection == 'Activity'\">\n              <canvas *ngIf=\"currentSection == 'Activity'\" baseChart style=\"height: 590px; width:76vw; margin:auto;\" [datasets]=\"activityData\" [labels]=\"activityLabels\" [options]=\"activityOptions\" [legend]=\"activityLegend\" chartType=\"line\"></canvas>\n            </section>\n            <section id=\"logs\" *ngIf=\"currentSection == 'Logs'\">\n              <table class=\"table  table-bordered table-hover table-striped\">\n                <thead class=\"thead-dark\">\n                  <tr>\n                    <th width=\"8%\">#</th>\n                    <th width=\"62%\">Açıklama</th>\n                    <th width=\"20%\">Kullanıcı</th>\n                    <th width=\"10%\">Saat</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr *ngFor=\"let log of logsTable; let i=index\">\n                    <td>{{i+1}}</td>\n                    <td>{{log.description}}</td>\n                    <td>{{log.user}}</td>\n                    <td>{{log.timestamp | date:'HH:mm'}}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"checkDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Hesap Detayı\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card checkDetail\">\n          <div class=\"card-header\">\n            <b>{{checkDetail?.table_id | general:'tables' | async}}\n              <small class=\"text-muted\"> ({{checkDetail?.timestamp | date:'dd/M/y HH:mm'}})</small>\n            </b>\n            <span class=\"pull-right text-muted\"> Hesap Türü : {{checkDetail?.payment_method}}</span>\n          </div>\n          <div class=\"card-body flow p-0\">\n            <table *ngIf=\"checkDetail?.payment_method != 'Parçalı'\" class=\"table table-striped table-sm  table-bordered mb-0\">\n              <thead class=\"thead-dark\">\n                <th width=\"8%\">#</th>\n                <th width=\"46%\">Ürün</th>\n                <th width=\"17%\">Garson</th>\n                <th width=\"14%\">Saat</th>\n                <th width=\"14%\">Fiyat</th>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let item of checkDetail?.products; let i = index;\" [ngClass]=\"{'table-danger': item.status == 3}\">\n                  <td>{{i+1}}</td>\n                  <td>{{item.name}}\n                    <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                  </td>\n                  <td>{{item.owner | general:'users' | async}}</td>\n                  <td>{{item.timestamp |date:'HH:mm'}}</td>\n                  <td>{{item.price | price}} </td>\n                </tr>\n              </tbody>\n            </table>\n            <section *ngIf=\"checkDetail?.payment_method == 'Parçalı'\">\n              <table *ngFor=\"let item of checkDetail?.payment_flow; let i = index;\" class=\"table table-sm  table-bordered table-striped mb-0\">\n                <thead class=\"thead-dark\">\n                  <th width=\"8%\">#</th>\n                  <th width=\"44%\">{{item.owner}}</th>\n                  <th width=\"15%\">{{item.method}}</th>\n                  <th width=\"15%\">{{item.timestamp | date:'HH:mm'}}</th>\n                  <th width=\"17%\">{{item.amount + item.discount | price }} </th>\n                </thead>\n                <tbody>\n                  <tr *ngIf=\"item.discount > 0\" class=\"table-info\">\n                    <td width=\"5%\"><i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i></td>\n                    <td width=\"46%\" colspan=\"3\">İndirim Tutarı</td>\n                    <td width=\"17%\">{{item.discount | price }} </td>\n                  </tr>\n                  <tr *ngFor=\"let product of item.payed_products; let i = index;\" [ngClass]=\"{'table-danger': product.status == 3}\">\n                    <td>{{i+1}}</td>\n                    <td>{{product.name}}\n                      <small *ngIf=\"product.note !== '' && product.note !== undefined\" class=\"text-muted\">({{product.note}})</small>\n                    </td>\n                    <td>{{product.owner | general:'users' | async}}</td>\n                    <td>{{product.timestamp |date:'HH:mm'}}</td>\n                    <td>{{product.price | price}} </td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-user mr-1\" aria-hidden=\"true\"></i> Kullanıcı:\n              <span class=\"pull-right\">{{checkDetail?.owner}}</span>\n            </b>\n          </div>\n          <div *ngIf=\"checkDetail?.discount > 0\" class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> Toplam İndirim Tutarı:\n              <span class=\"pull-right\">{{checkDetail?.discount | price }} </span>\n            </b>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ödenen Miktar:\n              <span class=\"pull-right\">{{checkDetail?.total_price | price }} </span>\n            </b>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\" aria-label=\"Close\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"cashDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">{{cashDetail?.type}} Hareketi</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card\">\n          <div class=\"card-header\">\n            <h5 class=\"mb-0\">{{cashDetail?.description}}</h5>\n          </div>\n          <div class=\"card-body p-0\">\n            <strong>\n              <table class=\"table table-striped mb-0\">\n                <tbody>\n                  <tr class=\"table-success\">\n                    <td width=\"10%\">\n                      <i class=\"fa fa-money\" aria-hidden=\"true\"></i>\n                    </td>\n                    <td>Nakit:</td>\n                    <td width=\"20%\">\n                      <span class=\"pull-right\">{{cashDetail?.cash | price }} </span>\n                    </td>\n                  </tr>\n                  <tr class=\"table-warning\">\n                    <td width=\"10%\">\n                      <i class=\"fa fa-credit-card\" aria-hidden=\"true\"></i>\n                    </td>\n                    <td>Kart:</td>\n                    <td width=\"20%\">\n                      <span class=\"pull-right\">{{cashDetail?.card | price }} </span>\n                    </td>\n                  </tr>\n                  <tr class=\"table-info\">\n                    <td width=\"10%\">\n                      <i class=\"fa fa-bookmark ml-1\" aria-hidden=\"true\"></i>\n                    </td>\n                    <td>Kupon:</td>\n                    <td width=\"20%\">\n                      <span class=\"pull-right\">{{cashDetail?.coupon | price }} </span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <td width=\"10%\">\n                      <i class=\"fa fa-check\" aria-hidden=\"true\"></i>\n                    </td>\n                    <td>Toplam:</td>\n                    <td width=\"20%\">\n                      <span class=\"pull-right\">{{cashDetail?.coupon + cashDetail?.cash + cashDetail?.card |\n                        price\n                        }} </span>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </strong>\n          </div>\n          <div class=\"card-footer\">\n            <i class=\"fa fa-user\" aria-hidden=\"true\"></i> {{cashDetail?.user}}\n            <span class=\"pull-right\">\n              {{cashDetail?.timestamp | date:'HH:mm'}}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/endoftheday/day-detail/day-detail.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".print-detail {\n  cursor: pointer; }\n\n.checkDetail {\n  height: 72vh; }\n\n.list-group .list-group-item {\n  padding: 0.75rem 0.25rem; }\n\n.list-group i {\n  width: 50px;\n  text-align: center; }\n\n.list-group span {\n  font-size: 1.5vw;\n  height: 32px;\n  vertical-align: text-bottom; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/endoftheday/day-detail/day-detail.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DayDetailComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_endoftheday__ = __webpack_require__("./src/app/mocks/endoftheday.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let DayDetailComponent = class DayDetailComponent {
    constructor(electronService, mainService, printerService, settingsService) {
        this.electronService = electronService;
        this.mainService = mainService;
        this.printerService = printerService;
        this.settingsService = settingsService;
        this.cashboxCategories = [];
        this.pieOptions = { responsive: false, legend: { labels: { fontColor: 'rgb(255, 255, 255)' } } };
        this.activityOptions = {
            responsive: false,
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            legend: { labels: { fontColor: 'rgb(255, 255, 255)' } },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
    }
    ngOnInit() {
        // this.settingsService.getPrinters().subscribe(res => this.printers = res.value);
        console.log(this.detailData, this.printers);
        this.detailTitle = 'Genel Detaylar & Grafik';
        this.pieColors = [];
        this.pieData = [];
        this.pieLabels = [];
        this.cashboxTable = [];
        this.checksTable = [];
        this.fillData();
    }
    categoryName(cat_id) {
        let isavailable = this.cashboxCategories.find(obj => obj._id == cat_id);
        if (isavailable) {
            return isavailable.name;
        }
        else {
            return 'Bilinmiyor';
        }
    }
    filterOldData(section, filter) {
        if (this.syncStatus) {
            this.currentSection = section;
            switch (section) {
                case 'Checks':
                    this.detailTitle = 'Kapatılan Hesap Detayları';
                    if (filter == 'All') {
                        this.checksTable = this.oldChecks.docs.sort((a, b) => a.timestamp - b.timestamp);
                    }
                    else if (filter == 'İptal') {
                        this.checksTable = this.oldChecks.docs.filter(obj => obj.type == 3).sort((a, b) => a.timestamp - b.timestamp);
                    }
                    else {
                        this.checksTable = this.oldChecks.docs.filter(obj => obj.type !== 3).sort((a, b) => a.timestamp - b.timestamp);
                        this.checksTable = this.oldChecks.docs.filter(obj => obj.payment_method == filter).sort((a, b) => a.timestamp - b.timestamp);
                    }
                    break;
                case 'Cashbox':
                    this.detailTitle = 'Kasa Gelir-Gider Detayları';
                    if (filter == 'All') {
                        this.cashboxTable = this.oldCashbox.docs;
                    }
                    else if (filter == 'Gelir') {
                        this.cashboxTable = this.oldCashbox.docs.filter(obj => obj.type == 'Gelir').sort((a, b) => a.timestamp - b.timestamp);
                    }
                    else if (filter == 'Gider') {
                        this.cashboxTable = this.oldCashbox.docs.filter(obj => obj.type == 'Gider').sort((a, b) => a.timestamp - b.timestamp);
                    }
                    break;
                case 'Products':
                    this.detailTitle = 'Güne Ait Ürün Satış Detayları';
                    this.productsTable = this.oldReports.docs.filter(obj => obj.type == 'Product').sort((a, b) => b.weekly[this.detailDay] - a.weekly[this.detailDay]);
                    this.productsTable = this.productsTable.filter(obj => obj.weekly[this.detailDay] !== 0);
                    break;
                case 'Users':
                    this.detailTitle = 'Güne Ait Kullanıcı Satış Detayları';
                    this.usersTable = this.oldReports.docs.filter(obj => obj.type == 'User').sort((a, b) => b.weekly[this.detailDay] - a.weekly[this.detailDay]);
                    this.usersTable = this.usersTable.filter(obj => obj.weekly[this.detailDay] !== 0);
                    break;
                case 'Tables':
                    this.detailTitle = 'Güne Ait Masa Satış Detayları';
                    this.tablesTable = this.oldReports.docs.filter(obj => obj.type == 'Table').sort((a, b) => b.weekly[this.detailDay] - a.weekly[this.detailDay]);
                    this.tablesTable = this.tablesTable.filter(obj => obj.weekly[this.detailDay] !== 0);
                    break;
                case 'Logs':
                    this.detailTitle = 'Güne Ait Sistem Kayıtları';
                    this.logsTable = this.oldLogs.docs.sort((a, b) => b.timestamp - a.timestamp);
                    break;
                case 'Activity':
                    this.detailTitle = 'Güne Ait Aktivite Grafiği';
                    let sellingActivity = this.oldReports.docs.find(obj => obj.type == 'Activity');
                    this.activityData = [{ data: sellingActivity.activity, label: 'Gelir Endeksi' }, { data: sellingActivity.activity_count, label: 'Doluluk Oranı ( % )' }];
                    this.activityLabels = sellingActivity.activity_time;
                    break;
                default:
                    break;
            }
        }
        else {
            alert('Senkorinizasyon işleminin bitmesini bekleyin.');
        }
    }
    printEndday() {
        this.printerService.printEndDay(this.printers[0], this.detailData);
    }
    showCheckDetail(check) {
        this.checkDetail = check;
        $('#checkDetail').modal('show');
    }
    showCashDetail(cash) {
        this.cashDetail = cash;
        $('#cashDetail').modal('show');
    }
    ProductsReport(checks_to_count) {
        let dayProducts = [];
        let productSalesReport = [];
        try {
            checks_to_count.forEach(obj => {
                let productsPayed;
                if (obj.payment_flow) {
                    productsPayed = obj.payment_flow.map(payment => payment.payed_products);
                    productsPayed.forEach(element => {
                        dayProducts = dayProducts.concat(obj.products, element);
                    });
                }
                else {
                    dayProducts = dayProducts.concat(obj.products);
                }
            });
            dayProducts.forEach((product) => {
                try {
                    const contains = productSalesReport.some(obj => obj.name === product.name);
                    if (contains) {
                        let index = productSalesReport.findIndex(obj => obj.name === product.name);
                        productSalesReport[index].count++;
                        productSalesReport[index].total += product.price;
                    }
                    else {
                        let countObj = { product_id: product.id, owner_id: product.owner, category_id: product.cat_id, price: product.price, total: product.price, name: product.name, count: 1 };
                        productSalesReport.push(countObj);
                    }
                }
                catch (error) {
                    console.log(product, error);
                }
            });
            productSalesReport.sort((a, b) => b.count - a.count);
            return productSalesReport;
        }
        catch (error) {
            console.log(error);
        }
    }
    fillData() {
        this.mainService.getAllBy('cashbox_categories', {}).then(res => {
            this.cashboxCategories = res.docs;
        }).catch(err => {
        });
        this.pieColors = [{ backgroundColor: ['#5cb85c', '#f0ad4e', '#5bc0de', '#d9534f'] }];
        this.pieLabels.push('Nakit', 'Kart', 'Kupon', 'İkram');
        this.pieData.push(this.detailData.cash_total, this.detailData.card_total, this.detailData.coupon_total, this.detailData.free_total);
        this.detailDay = new Date(this.detailData.timestamp).getDay();
        this.electronService.readBackupData(this.detailData.data_file).then((result) => {
            this.oldBackupData = result;
            this.oldChecks = this.oldBackupData[0];
            this.productsSales = this.ProductsReport(this.oldChecks.docs);
            console.log(this.productsSales);
            this.oldCashbox = this.oldBackupData[1];
            this.oldReports = this.oldBackupData[2];
            this.oldLogs = this.oldBackupData[3];
            this.syncStatus = true;
        }).catch(err => {
            console.log(err);
            this.oldBackupData = [];
            this.syncStatus = false;
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])('data'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__mocks_endoftheday__["b" /* EndDay */])
], DayDetailComponent.prototype, "detailData", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])('printers'),
    __metadata("design:type", Object)
], DayDetailComponent.prototype, "printers", void 0);
DayDetailComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-day-detail',
        template: __webpack_require__("./src/app/components/endoftheday/day-detail/day-detail.component.html"),
        styles: [__webpack_require__("./src/app/components/endoftheday/day-detail/day-detail.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_5__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_3__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_4__services_settings_service__["a" /* SettingsService */]])
], DayDetailComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/endoftheday/endoftheday.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-lg-10 pr-0\" [ngClass]=\"{'col-lg-12 pr-3': selectedEndDay !== undefined}\">\n    <div class=\"card full-height\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-9\">\n            Gün Sonu\n          </div>\n          <div class=\"col-lg-3 pr-2 pl-0\">\n            <button *ngIf=\"selectedEndDay !== undefined\" (click)=\"selectedEndDay = undefined;\" class=\"btn btn-danger btn-sm btn-block\">\n              <i class=\"fa fa-backward\" aria-hidden=\"true\"></i> Geri Dön\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body p-0\" [ngClass]=\"{'flow': selectedEndDay == undefined}\">\n        <app-day-detail *ngIf=\"selectedEndDay !== undefined\" [printers]=\"printers\" [data]=\"selectedEndDay\"></app-day-detail>\n        <table *ngIf=\"selectedEndDay == undefined\" class=\"table table-striped  table-bordered table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"6%\">#</th>\n              <th width=\"34%\">\n                <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> Tarih\n              </th>\n              <th width=\"20%\" *ngIf=\"permissions?.end\">\n                <i class=\"fa fa-turkish-lira\" aria-hidden=\"true\"></i> Toplam Satış\n              </th>\n              <th width=\"20%\">\n                <i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Hesap Sayısı\n              </th>\n              <!-- <th width=\"20%\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i> Kullanıcı\n              </th> -->\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let item of endDayData; let i = index;\" (click)=\"getDetail(item)\">\n              <td>{{i+1}}</td>\n              <td>{{item.timestamp | date:'dd/M/y'}} <span class=\"pull-right\">{{item.timestamp | date:'HH:mm'}} - {{item.data_file.split('.')[0] | date:'HH:mm'}} </span></td>\n              <td *ngIf=\"permissions?.end\">{{item.total_income | price }}</td>\n              <td>{{item.check_count}} Adet</td>\n              <!-- <td>{{item.owner | general:'users' | async}}</td> -->\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-lg-2\" [hidden]=\"selectedEndDay !== undefined || appType?.type == '1'\">\n    <button [disabled]=\"isStarted\" (click)=\"startDay()\" class=\"btn btn-lg btn-success btn-block pt-5 pb-5\">Gün Başı</button>\n    <button [disabled]=\"!isStarted\" (click)=\"endDay()\" class=\"btn btn-lg btn-danger btn-block pt-5 pb-5\">Gün Sonu</button>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"endDayModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Gün Sonu Yapılıyor...</h4>\n      </div>\n      <div class=\"modal-body text-center p-5 text-info\">\n        <i class=\"fa fa-refresh fa-5x fa-spin\" style=\"font-size:50vh\" aria-hidden=\"true\"></i>\n      </div>\n      <div class=\"modal-footer\">\n        {{progress}}\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/endoftheday/endoftheday.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".card.mb-2 h2 {\n  font-size: 3vh; }\n\n.card-body {\n  height: 90%; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/endoftheday/endoftheday.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return EndofthedayComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__ = __webpack_require__("./src/app/mocks/endoftheday.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__services_conflict_service__ = __webpack_require__("./src/app/services/conflict.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__services_http_service__ = __webpack_require__("./src/app/services/http.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let EndofthedayComponent = class EndofthedayComponent {
    constructor(electronService, printerService, mainService, messageService, settingsService, httpService, conflictService) {
        this.electronService = electronService;
        this.printerService = printerService;
        this.mainService = mainService;
        this.messageService = messageService;
        this.settingsService = settingsService;
        this.httpService = httpService;
        this.conflictService = conflictService;
        this.StoreSalesReport = (checks) => {
            let SalesReport = { cash: 0, card: 0, coupon: 0, free: 0, canceled: 0, discount: 0, checks: checks.length, customers: { male: 0, female: 0 } };
            SalesReport.cash = checks.filter(obj => obj.payment_method == 'Nakit').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            SalesReport.card = checks.filter(obj => obj.payment_method == 'Kart').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            SalesReport.coupon = checks.filter(obj => obj.payment_method == 'Kupon').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            SalesReport.free = checks.filter(obj => obj.type !== __WEBPACK_IMPORTED_MODULE_1__mocks_check__["e" /* CheckType */].CANCELED && obj.payment_method == 'İkram').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            SalesReport.canceled = checks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_1__mocks_check__["e" /* CheckType */].CANCELED).map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            SalesReport.discount = checks.filter(obj => obj.type !== __WEBPACK_IMPORTED_MODULE_1__mocks_check__["e" /* CheckType */].CANCELED).map(obj => obj.discount).reduce((a, b) => a + b, 0);
            SalesReport.customers.male = checks.filter(obj => obj.type !== __WEBPACK_IMPORTED_MODULE_1__mocks_check__["e" /* CheckType */].CANCELED && obj.hasOwnProperty('occupation')).map(obj => obj.occupation.male).reduce((a, b) => a + b, 0);
            SalesReport.customers.female = checks.filter(obj => obj.type !== __WEBPACK_IMPORTED_MODULE_1__mocks_check__["e" /* CheckType */].CANCELED && obj.hasOwnProperty('occupation')).map(obj => obj.occupation.female).reduce((a, b) => a + b, 0);
            const partial = checks.filter(obj => obj.payment_method == 'Parçalı');
            partial.forEach(element => {
                SalesReport.discount += element.discount;
                element.payment_flow.forEach(payment => {
                    if (payment.method == 'Nakit') {
                        SalesReport.cash += payment.amount;
                    }
                    if (payment.method == 'Kart') {
                        SalesReport.card += payment.amount;
                    }
                    if (payment.method == 'Kupon') {
                        SalesReport.coupon += payment.amount;
                    }
                    if (payment.method == 'İkram') {
                        SalesReport.free += payment.amount;
                    }
                });
            });
            return SalesReport;
        };
        this.token = localStorage.getItem("AccessToken");
        this.owner = this.settingsService.getUser('id');
        this.permissions = JSON.parse(localStorage.getItem('userPermissions'));
    }
    ngOnInit() {
        this.progress = 'Veriler Senkorinize Ediliyor...';
        this.endDayData = [];
        this.backupData = [];
        this.settingsService.DateSettings.subscribe(res => {
            this.isStarted = res.value.started;
            this.day = res.value.day;
            this.dateToReport = res.value.time;
            this.endDayReport = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["b" /* EndDay */](this.dateToReport, this.owner, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, { male: 0, female: 0 }, '', false);
        });
        this.settingsService.AppSettings.subscribe(res => this.lastDay = res.value.last_day);
        this.settingsService.RestaurantInfo.subscribe(res => this.restaurantID = res.value.id);
        this.settingsService.ServerSettings.subscribe(res => {
            this.serverSet = res;
            this.appType = res.value;
        });
        this.settingsService.getPrinters().subscribe(res => this.printers = res.value);
        this.fillData();
    }
    getDetail(data) {
        if (this.permissions.end) {
            this.selectedEndDay = data;
        }
        else {
            this.messageService.sendMessage('Görüntüleme Yetkiniz Yok');
        }
    }
    startDay() {
        if (this.isStarted) {
            this.messageService.sendMessage('Gün Sonu Yapmalısınız!');
            return false;
        }
        else {
            // clearInterval(this.conflictService.conflictListener());
            let dateData = { started: true, day: new Date().getDay(), time: Date.now() };
            this.mainService.getAllBy('reports', { type: 'Activity' }).then(res => {
                res.docs.forEach(element => {
                    this.mainService.changeData('reports', element._id, (doc) => {
                        doc.activity = [0];
                        doc.activity_count = [0];
                        doc.activity_time = ['GB'];
                        return doc;
                    });
                });
            });
            this.messageService.sendMessage('Gün Başlatıldı. Program Yeniden Başlatılıyor..');
            if (this.day == 1) {
                this.mainService.getAllBy('reports', {}).then(res => {
                    let reports = res.docs.filter(obj => obj.type !== 'Activity');
                    reports.forEach(element => {
                        this.mainService.changeData('reports', element._id, (doc) => {
                            doc.weekly = [0, 0, 0, 0, 0, 0, 0];
                            doc.weekly_count = [0, 0, 0, 0, 0, 0, 0];
                            return doc;
                        });
                    });
                });
            }
            this.settingsService.setAppSettings('DateSettings', dateData).then((res) => {
                if (res.updated) {
                    this.isStarted = true;
                    this.messageService.sendAlert('Gün Başlatıldı!', 'Program 5 sn içinde yeniden başlatılacak.', 'success');
                    setTimeout(() => {
                        this.electronService.reloadProgram();
                    }, 5000);
                }
            });
        }
    }
    endDay() {
        if (this.isStarted) {
            this.mainService.getAllBy('checks', {}).then((res) => {
                if (res.docs.length == 0) {
                    $('#endDayModal').modal({ backdrop: 'static', keyboard: false });
                    // clearInterval(this.conflictService.conflictListener());
                    setTimeout(() => {
                        this.stepChecks();
                    }, 2000);
                }
                else {
                    this.messageService.sendAlert('Dikkat!', 'Ödenmesi alınmamış hesaplar var!', 'warning');
                }
            });
        }
        else {
            this.messageService.sendMessage('Gün Başı Yapmalısınız!');
            return false;
        }
    }
    stepChecks() {
        this.mainService.getAllBy('closed_checks', {}).then(res => {
            this.progress = 'Kapatılan Hesaplar Yedekleniyor...';
            this.checks = res.docs;
            const checksBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('closed_checks', this.checks);
            this.backupData.push(checksBackup);
            const Sales = this.StoreSalesReport(this.checks);
            this.endDayReport.card_total = Sales.card;
            this.endDayReport.cash_total = Sales.cash;
            this.endDayReport.coupon_total = Sales.coupon;
            this.endDayReport.free_total = Sales.free;
            this.endDayReport.discount_total = Sales.discount;
            this.endDayReport.canceled_total = Sales.canceled;
            this.endDayReport.total_income = Sales.cash + Sales.card + Sales.coupon;
            this.endDayReport.check_count = this.checks.length;
            this.endDayReport.customers.male = Sales.customers.male;
            this.endDayReport.customers.female = Sales.customers.female;
            this.mainService.removeAll('closed_checks', {}).then(() => {
                this.mainService.removeAll('allData', { db_name: 'closed_checks' }).then(() => {
                    this.progress = 'Kapatılan Hesaplar Temizlendi...';
                    this.stepCashbox();
                });
            });
        });
    }
    stepCashbox() {
        let incomes = 0;
        let outcomes = 0;
        this.mainService.getAllBy('cashbox', {}).then(res => {
            this.progress = 'Kasa Verileri Yedekleniyor...';
            this.cashbox = res.docs;
            const cashboxBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('cashbox', this.cashbox);
            this.backupData.push(cashboxBackup);
            try {
                incomes = this.cashbox.filter(obj => obj.type == 'Gelir').map(obj => obj.card + obj.cash + obj.coupon).reduce((a, b) => a + b);
                this.endDayReport.incomes = incomes;
            }
            catch (error) {
                this.endDayReport.incomes = 0;
                console.log('Kasa Geliri Yok..');
            }
            try {
                outcomes = this.cashbox.filter(obj => obj.type == 'Gider').map(obj => obj.card + obj.cash + obj.coupon).reduce((a, b) => a + b);
                this.endDayReport.outcomes = outcomes;
            }
            catch (error) {
                this.endDayReport.outcomes = 0;
                console.log('Kasa Gideri Yok..');
            }
            this.mainService.removeAll('cashbox', {}).then(res => {
                this.mainService.removeAll('allData', { db_name: 'cashbox' }).then(() => {
                    this.progress = 'Kasa Verileri Temizlendi...';
                    this.stepReports();
                });
            });
        });
    }
    stepReports() {
        this.mainService.getAllBy('reports', {}).then(res => {
            this.progress = 'Raporlar Yedekleniyor...';
            this.reports = res.docs.filter(obj => obj.type !== 'Activity');
            const reportsBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('reports', res.docs);
            this.backupData.push(reportsBackup);
            const activities = res.docs.filter(obj => obj.type == 'Activity');
            this.mainService.localSyncBeforeRemote('reports').on('complete', () => {
                this.progress = 'Raporlar Temizlendi...';
                this.stepLogs();
            });
            activities.forEach(element => {
                this.mainService.changeData('reports', element._id, (doc) => {
                    doc.activity = [];
                    doc.activity_count = [];
                    doc.activity_time = [];
                    return doc;
                });
            });
            if (this.day == this.lastDay) {
                this.reports.forEach((element) => {
                    this.mainService.changeData('reports', element._id, (doc) => {
                        doc.weekly = [0, 0, 0, 0, 0, 0, 0];
                        doc.weekly_count = [0, 0, 0, 0, 0, 0, 0];
                        return doc;
                    });
                });
            }
        });
    }
    stepLogs() {
        this.mainService.getAllBy('logs', {}).then(res => {
            this.progress = 'Kayıtlar Yedekleniyor...';
            this.logs = res.docs;
            const logsBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('logs', this.logs);
            this.backupData.push(logsBackup);
            this.mainService.removeAll('prints', {}).then(() => {
                this.progress = 'Yazıcı İşlemleri Temizlendi...';
            });
            this.mainService.removeAll('logs', {}).then(() => {
                this.mainService.removeAll('allData', { db_name: 'logs' }).then(() => {
                    this.progress = 'Kayıtlar Temizlendi...';
                    this.stepOrders();
                });
            });
        }).catch(err => {
            console.log('Logs Clearing Error:', err);
        });
    }
    stepOrders() {
        this.mainService.getAllBy('orders', {}).then((res) => {
            this.progress = 'Siparişler Yedekleniyor...';
            this.orders = res.docs;
            // let items:OrderItem[] = [];
            // this.orders.map(obj => {
            //   items = items.concat(obj.items);
            // });
            // let reports = [];
            // items.forEach(obj => {
            //   if(reports.includes(report => report.product_id == obj.product_id )){
            //   }else{
            //   }
            // })
            const logsBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('orders', this.orders);
            this.backupData.push(logsBackup);
            this.mainService.removeAll('orders', {}).then(() => {
                this.mainService.removeAll('allData', { db_name: 'orders' }).then(() => {
                    this.progress = 'Siparişler Temizlendi...';
                    this.stepReceipts();
                });
            });
        }).catch(err => {
            console.log('Orders Clearing Error:', err);
        });
    }
    stepReceipts() {
        this.mainService.getAllBy('receipts', {}).then(res => {
            this.progress = 'Ödemeler Yedekleniyor...';
            this.receipts = res.docs;
            const logsBackup = new __WEBPACK_IMPORTED_MODULE_2__mocks_endoftheday__["a" /* BackupData */]('receipts', this.receipts);
            this.backupData.push(logsBackup);
            this.mainService.removeAll('receipts', {}).then(() => {
                this.mainService.removeAll('allData', { db_name: 'receipts' }).then(() => {
                    this.progress = 'Ödemeler Temizlendi...';
                    this.stepFinal();
                });
            });
        }).catch(err => {
            console.log('Receipts Clearing Error:', err);
        });
    }
    stepFinal() {
        let finalDate = Date.now();
        this.endDayReport.data_file = finalDate.toString();
        this.progress = 'Yerel Süreç Tamamlanıyor...';
        this.mainService.addData('endday', this.endDayReport).then(() => {
            this.electronService.backupData(this.backupData, finalDate);
            this.printerService.printEndDay(this.printers[0], this.endDayReport);
            let dateData = { started: false, day: this.day, time: Date.now() };
            this.settingsService.setAppSettings('DateSettings', dateData).then((res) => {
                if (res.updated) {
                    this.fillData();
                    this.isStarted = false;
                    setTimeout(() => {
                        this.mainService.syncToRemote().cancel();
                        if (this.appType.type == 0) {
                            if (this.appType.status == 1) {
                                this.electronService.ipcRenderer.send('closeServer');
                                this.mainService.syncToServer().cancel();
                            }
                        }
                        this.progress = 'Veritabanı Yedekleniyor!';
                        this.uploadBackup(this.backupData, finalDate);
                    }, 5000);
                }
            });
        }).catch(err => {
            console.log('Final Step Error: Document Post Error', err);
        });
    }
    uploadBackup(data, timestamp) {
        this.httpService.post('/store/backup', { data: data, timestamp: timestamp }, this.token).subscribe(res => {
            if (res.ok) {
                this.coverData();
            }
        }, err => {
            console.log(err);
            this.messageService.sendAlert('Hata!', 'Veritabanı Yedeği İletilemedi', 'error');
            this.coverData();
        });
    }
    coverData() {
        this.mainService.getAllBy('allData', {}).then(res => {
            return res.docs.map((obj) => {
                delete obj._rev;
                return obj;
            });
        }).then((cleanDocs) => {
            this.electronService.fileSystem.writeFile(this.electronService.appRealPath + '/data/db.dat', JSON.stringify(cleanDocs), err => {
                if (!err) {
                    this.progress = 'Veritabanı Yedeği Alındı!';
                    this.refreshToken();
                }
            });
        }).catch(err => {
            console.log(err);
        });
    }
    refreshToken() {
        this.httpService.post('/store/refresh', null, this.token).subscribe(res => {
            if (res.ok) {
                const token = res.json().token;
                localStorage.setItem('AccessToken', token);
                this.purgeData(token);
            }
        }, err => {
            console.log(err);
            $('#endDayModal').modal('hide');
            this.messageService.sendAlert('Hata!', 'Sunucudan İzin Alınamadı', 'error');
            setTimeout(() => {
                this.electronService.relaunchProgram();
            }, 5000);
        });
    }
    purgeData(token) {
        this.mainService.getAllBy('allData', {}).then(res => {
            this.httpService.post(`/store/endday`, { docs: res.docs }, token).subscribe(res => {
                if (res.ok) {
                    this.progress = 'Uzak Sunucu İsteği Onaylandı!';
                    let databasesArray = Object.keys(this.mainService.LocalDB).filter(obj => obj !== 'settings');
                    this.mainService.destroyDB(databasesArray).then(res => {
                        if (res.ok) {
                            setTimeout(() => {
                                this.mainService.initDatabases();
                                setTimeout(() => {
                                    this.mainService.replicateFrom()
                                        .on('active', () => {
                                        this.progress = 'Veriler Sıfırlanıyor...';
                                    })
                                        .on('complete', (info) => {
                                        this.progress = 'Gün Sonu Tamamlanıyor..';
                                        $('#endDayModal').modal('hide');
                                        this.messageService.sendAlert('Gün Sonu Tamamlandı!', 'Program Yeniden Başlatılacak', 'success');
                                        setTimeout(() => {
                                            this.electronService.relaunchProgram();
                                        }, 5000);
                                    });
                                    // this.mainService.syncToLocal().then(res => {
                                    //   if (res) {
                                    //     delete this.serverSet._rev;
                                    //     this.mainService.putDoc('settings', this.serverSet).then(res => {
                                    //       if (res.ok) {
                                    //         $('#endDayModal').modal('hide');
                                    //         this.messageService.sendAlert('Gün Sonu Tamamlandı!', 'Program 5sn içinde kapatılacak.', 'success');
                                    //         setTimeout(() => {
                                    //           this.electronService.relaunchProgram();
                                    //         }, 5000);
                                    //       }
                                    //     })
                                    //   }
                                    // })
                                }, 3000);
                            }, 2000);
                        }
                    });
                }
            }, err => {
                console.log(err);
                $('#endDayModal').modal('hide');
                this.messageService.sendAlert('Gün Sonu Tamamlandı!', 'Program Yeniden Başlatılacak', 'success');
                setTimeout(() => {
                    this.electronService.relaunchProgram();
                }, 5000);
                // const serverSelectedRevs = res.json();
                // this.electronService.fileSystem.readFile(this.electronService.appRealPath + '/data/db.dat', 'utf-8', (err, data) => {
                //   if (!err) {
                //     let appData = JSON.parse(data);
                //     appData.map(obj => {
                //       obj._rev = serverSelectedRevs.find(serverRes => serverRes[1] == obj._id)[2];
                //     });
                //     this.mainService.putAll('allData', appData).then(res => {
                //       this.progress = 'Gün Sonu Tamamlanıyor..';
                //       this.loadAppData().then(res => {
                //         if (res) {
                //           $('#endDayModal').modal('hide');
                //           this.messageService.sendAlert('Gün Sonu Tamamlandı!', 'Program 5sn içinde kapatılacak.', 'success');
                //           setTimeout(() => {
                //             this.electronService.relaunchProgram();
                //           }, 5000);
                //         }
                //       })
                //     });
                //   }
                // });
            });
        });
    }
    fillData() {
        this.mainService.getAllBy('endday', {}).then((result) => {
            this.endDayData = result.docs;
            this.endDayData = this.endDayData.sort((a, b) => b.timestamp - a.timestamp).filter(obj => obj.total_income !== 0);
        });
    }
};
EndofthedayComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-endoftheday',
        template: __webpack_require__("./src/app/components/endoftheday/endoftheday.component.html"),
        styles: [__webpack_require__("./src/app/components/endoftheday/endoftheday.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_5__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_9__services_http_service__["a" /* HttpService */], __WEBPACK_IMPORTED_MODULE_8__services_conflict_service__["a" /* ConflictService */]])
], EndofthedayComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/helpers/caller/caller.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"modal fade\" id=\"callerModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"callerModal\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\"><i class=\"fa fa-phone\" aria-hidden=\"true\"></i> <strong>Gelen Çağrı</strong></h5>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <h4 class=\"text-center\">Arayan Numara:</h4>\n        <h1 class=\"text-center\">{{call?.number | mask: '0 (000) 000 00 00'}}</h1>\n        <div *ngIf=\"customer\">\n          <div class=\"alert alert-success text-center mt-5\" role=\"alert\">\n            <small>Müşteri Bulundu !</small>\n            <h1 class=\"mt-2\"><i class=\"fa fa-user-circle fa-2x\" aria-hidden=\"true\"></i></h1>\n            <h2 class=\"text-center\">{{customer.name }} {{customer.surname}}</h2>\n            <h5 class=\"text-center\"><b>{{customer.address}}</b></h5>\n          </div>\n\n        </div>\n        <div *ngIf=\"!customer\">\n          <div class=\"alert alert-danger text-center mt-5\" role=\"alert\">\n            <strong>Müşteri Bulunamadı !</strong>\n          </div>\n          <form #customerForm=\"ngForm\">\n            <div *ngIf=\"onUpdate\">\n              <input type=\"hidden\" name=\"_id\" ngModel>\n              <input type=\"hidden\" name=\"_rev\" ngModel>\n              <input type=\"hidden\" name=\"phone_number\" [value]=\"call?.number\" ngModel>\n              <input type=\"hidden\" name=\"type\" value=\"1\" ngModel>\n              <input type=\"hidden\" name=\"timestamp\" value=\"{{Date.now()}}\" ngModel>\n            </div>\n            <div class=\"form-group\">\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Adı</div>\n                </div>\n                <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Soyadı</div>\n                </div>\n                <input type=\"text\" name=\"surname\" class=\"form-control form-control-lg\" ngModel />\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">\n                    Adres\n                  </div>\n                </div>\n                <textarea type=\"text\" name=\"address\" rows=\"5\" class=\"form-control form-control-lg\" ngModel></textarea>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-lg btn-secondary\" data-dismiss=\"modal\">Kapat</button>\n        <button *ngIf=\"customer\" (click)=\"openCheck()\" type=\"button\" class=\"btn btn-lg btn-info\"><i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Hesap Aç</button>\n        <button *ngIf=\"!customer\" (click)=\"saveCustomer(customerForm)\" type=\"button\" class=\"btn btn-lg btn-info\"><i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Müşteriyi Kaydet ve Hesap Aç</button>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/helpers/caller/caller.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/helpers/caller/caller.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CallerComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_caller_id_service__ = __webpack_require__("./src/app/providers/caller-id.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_customer__ = __webpack_require__("./src/app/mocks/customer.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let CallerComponent = class CallerComponent {
    constructor(router, callerService, mainService, settingsService) {
        this.router = router;
        this.callerService = callerService;
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.owner = this.settingsService.getUser('name');
    }
    ngOnInit() {
        this.callerService.listenCallEvent().subscribe(res => {
            this.call = res;
            this.mainService.getAllBy('customers', { phone_number: this.call.number }).then(customers => {
                if (customers.docs.length > 0) {
                    this.customer = customers.docs[0];
                }
                else {
                    this.customer = null;
                }
                $('#callerModal').modal('show');
            });
        });
    }
    openCheck() {
        const checkWillOpen = new __WEBPACK_IMPORTED_MODULE_4__mocks_check__["a" /* Check */]('Paket Servis', 0, 0, this.owner, `${this.customer.name} | ${this.customer.phone_number}`, __WEBPACK_IMPORTED_MODULE_4__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_4__mocks_check__["e" /* CheckType */].ORDER, Object(__WEBPACK_IMPORTED_MODULE_4__mocks_check__["b" /* CheckNo */])());
        this.mainService.addData('checks', checkWillOpen).then(res => {
            $('#callerModal').modal('hide');
            this.router.navigate(['/selling-screen', 'Order', res.id]);
        });
    }
    saveCustomer() {
        const unknownCustomer = this.customerForm.value;
        const customerWillCreate = new __WEBPACK_IMPORTED_MODULE_3__mocks_customer__["a" /* Customer */](unknownCustomer.name, unknownCustomer.surname, this.call.number, unknownCustomer.address, '', __WEBPACK_IMPORTED_MODULE_3__mocks_customer__["b" /* CustomerType */].FAR, Date.now());
        this.mainService.addData('customers', customerWillCreate).then(res => {
            const checkWillOpen = new __WEBPACK_IMPORTED_MODULE_4__mocks_check__["a" /* Check */]('Paket Servis', 0, 0, this.owner, `${unknownCustomer.name} | ${this.call.number}`, __WEBPACK_IMPORTED_MODULE_4__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_4__mocks_check__["e" /* CheckType */].ORDER, Object(__WEBPACK_IMPORTED_MODULE_4__mocks_check__["b" /* CheckNo */])());
            this.mainService.addData('checks', checkWillOpen).then(res => {
                $('#callerModal').modal('hide');
                this.router.navigate(['/selling-screen', 'Order', res.id]);
            });
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('customerForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_7__angular_forms__["d" /* NgForm */])
], CallerComponent.prototype, "customerForm", void 0);
CallerComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-caller',
        template: __webpack_require__("./src/app/components/helpers/caller/caller.component.html"),
        styles: [__webpack_require__("./src/app/components/helpers/caller/caller.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__angular_router__["b" /* Router */],
        __WEBPACK_IMPORTED_MODULE_1__providers_caller_id_service__["a" /* CallerIDService */],
        __WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */],
        __WEBPACK_IMPORTED_MODULE_5__services_settings_service__["a" /* SettingsService */]])
], CallerComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/helpers/keyboard/keyboard.component.html":
/***/ (function(module, exports) {

module.exports = "<section *ngIf=\"keyboardStatus\" id=\"onKeyboard\">\n  <div *ngIf=\"onAir\" (mouseleave)=\"closeKeyboard()\" class=\"on-keyboard animated slideInUp\">\n    <div class=\"row text-center\">\n      <div [hidden]=\"true\" class=\"col-lg-12 center-block\">\n        <input [placeholder]=\"placeholder\" readonly type=\"text\" [class.numb]=\"inputType !== 'text'\" class=\"form-control form-control-lg inputKey\"\n          [(ngModel)]=\"keyboardInput\" />\n      </div>\n      <div class=\"col-lg-12\">\n        <button *ngFor=\"let key of keytype[0]\" (click)=\"pushKey(key[keyIndex])\" class=\"btn btn-outline-warning dark-bg btn-lg key\">{{key[keyIndex]}}</button>\n      </div>\n      <div class=\"col-lg-12\">\n        <button *ngFor=\"let key of keytype[1]\" [disabled]=\"key[keyIndex] == '▴' && keyIndex == 1\" (click)=\"pushKey(key[keyIndex])\"\n          class=\"btn btn-outline-warning dark-bg btn-lg key\">{{key[keyIndex]}}</button>\n      </div>\n      <div class=\"col-lg-12\">\n        <button *ngFor=\"let key of keytype[2]\" [disabled]=\"key[keyIndex] == '▾' && keyIndex == 0\" (click)=\"pushKey(key[keyIndex])\"\n          class=\"btn btn-outline-warning dark-bg btn-lg key\">{{key[keyIndex]}}</button>\n      </div>\n      <div class=\"col-lg-12\">\n        <button *ngFor=\"let key of keytype[3]\" (click)=\"pushKey(key[keyIndex])\" class=\"btn btn-outline-warning dark-bg btn-lg key\">{{key[keyIndex]}}</button>\n      </div>\n      <div class=\"col-lg-12\">\n        <button *ngFor=\"let key of keytype[4]\" (click)=\"pushKey(key[keyIndex])\" [class.numb]=\"inputType == 'number' || inputType == 'password'\"\n          class=\"btn btn-outline-warning dark-bg btn-lg space\">{{key[keyIndex]}}</button>\n      </div>\n    </div>\n  </div>\n</section>";

/***/ }),

/***/ "./src/app/components/helpers/keyboard/keyboard.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".on-keyboard {\n  position: absolute;\n  width: 100vw;\n  bottom: 0px;\n  padding: 15px;\n  z-index: 9999999;\n  background-color: #2b3e50;\n  -webkit-animation-duration: 0.3s;\n          animation-duration: 0.3s;\n  -webkit-animation-delay: 0s;\n          animation-delay: 0s;\n  -webkit-box-shadow: 0px -2px 10px 0px rgba(0, 0, 0, 0.4);\n          box-shadow: 0px -2px 10px 0px rgba(0, 0, 0, 0.4); }\n\n.key {\n  height: 8.8vh;\n  margin: 0.5vh;\n  width: 8.8vh;\n  font-size: 2rem; }\n\n.space {\n  height: 8.8vh;\n  margin: 0.5vh;\n  width: 126vh;\n  font-size: 2rem; }\n\n.inputKey {\n  height: 8.8vh;\n  margin-bottom: 0.5vh;\n  margin-left: auto;\n  margin-right: auto;\n  width: 126vh;\n  font-size: 2rem; }\n\n.numb {\n  width: 28.5vh !important; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/helpers/keyboard/keyboard.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return KeyboardComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_keyboard_service__ = __webpack_require__("./src/app/providers/keyboard.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let KeyboardComponent = class KeyboardComponent {
    constructor(keyboardService, settings, renderer) {
        this.keyboardService = keyboardService;
        this.settings = settings;
        this.renderer = renderer;
        this.settings.AppSettings.subscribe(res => {
            if (res) {
                if (res.value.keyboard == 'Açık') {
                    this.keyboardStatus = true;
                }
                else {
                    this.keyboardStatus = false;
                }
            }
            else {
                this.keyboardStatus = false;
            }
        });
        this.keyIndex = 0;
        this.keyboard = [
            [["1", "!"], ["2", "@"], ["3", "#"], ["4", "$"], ["5", "%"], ["6", "\u00a8"], ["7", "&"], ["8", "*"], ["9", "("], ["0", ")"], ["*", "?"], ["-", "_"], ["◂", "◂"]],
            [["q", "Q"], ["w", "W"], ["e", "E"], ["r", "R"], ["t", "T"], ["y", "Y"], ["u", "U"], ["ı", "I"], ["o", "O"], ["p", "P"], ["ğ", "Ğ"], ["ü", "Ü"], ["▴", "▴"]],
            [["a", "A"], ["s", "S"], ["d", "D"], ["f", "F"], ["g", "G"], ["h", "H"], ["j", "J"], ["k", "K"], ["l", "L"], ["ş", "Ş"], ["i", "İ"], [",", ";"], ["▾", "▾"]],
            [["\\", "|"], ["z", "Z"], ["x", "X"], ["c", "C"], ["v", "V"], ["b", "B"], ["n", "N"], ["m", "M"], ["ö", "Ö"], ["ç", "Ç"], [".", ":"], ["/", "/"], ["✔", "✔"]],
            [[" ", " "]]
        ];
        this.numboard = [
            [[1], [2], [3]],
            [[4], [5], [6]],
            [[7], [8], [9]],
            [["."], [0], ["◂"]],
            [["✔"]]
        ];
        this.keyboardInput = "";
        this.placeholder = "";
    }
    ngOnInit() {
        this.onAir = false;
        this.keyboardService.listenInput().subscribe(element => {
            this.selectedInput = element;
            this.selectedForm = element.nativeElement.form;
            this.inputType = element.nativeElement.type;
            this.keyboardInput = element.nativeElement.value;
            this.placeholder = element.nativeElement.placeholder;
            switch (this.inputType) {
                case "text":
                    this.keytype = this.keyboard;
                    this.onNumb = false;
                    break;
                case "number":
                    this.keytype = this.numboard;
                    this.onNumb = true;
                    break;
                case "password":
                    this.keytype = this.numboard;
                    this.onNumb = true;
                    break;
                default:
                    this.keytype = this.keyboard;
                    this.onNumb = false;
                    break;
            }
        });
        this.keyboardService.listenKeyboard().subscribe(signal => {
            if (signal == "Open") {
                this.onAir = true;
                let dBody = document.getElementsByTagName("body");
            }
            else if (signal == "Close") {
                this.onAir = false;
            }
        });
    }
    pushKey(key) {
        switch (key) {
            case "▴":
                this.keyIndex = 1;
                break;
            case "▾":
                this.keyIndex = 0;
                break;
            case "◂":
                this.keyboardInput = this.keyboardInput.slice(0, -1);
                break;
            case "✔":
                this.closeKeyboard();
                break;
            default:
                if (this.inputType == "number") {
                    this.selectedInput.nativeElement.type = "text";
                    this.keyboardInput += key;
                }
                else {
                    this.keyboardInput += key;
                }
                break;
        }
        this.selectedInput.nativeElement.value = this.keyboardInput;
        this.selectedInput.nativeElement.dispatchEvent(new Event('keyup'));
        this.selectedInput.nativeElement.dispatchEvent(new Event('input'));
        this.selectedInput.nativeElement.dispatchEvent(new Event('keydown'));
    }
    closeKeyboard() {
        this.keyboardInput = "";
        this.keyIndex = 0;
        if (this.onNumb) {
            this.selectedInput.nativeElement.type = 'number';
        }
        this.keyboardService.triggerKeyboard('Close', this.selectedInput);
    }
};
KeyboardComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-keyboard',
        template: __webpack_require__("./src/app/components/helpers/keyboard/keyboard.component.html"),
        styles: [__webpack_require__("./src/app/components/helpers/keyboard/keyboard.component.scss")],
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__providers_keyboard_service__["a" /* KeyboardService */], __WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_0__angular_core__["Renderer"]])
], KeyboardComponent);



/***/ }),

/***/ "./src/app/components/helpers/message/message.component.html":
/***/ (function(module, exports) {

module.exports = "<div id=\"note\" *ngIf=\"message\" class=\"alert alert-dismissible alert-danger m-0 text-center animated fadeIn\">\n      <!-- <h5 class=\"alert-heading\">Not</h5> -->\n      <strong>{{ message.text }}</strong>\n      <button type=\"button\" class=\"close float-right\" data-dismiss=\"alert\">&times;</button>\n</div>";

/***/ }),

/***/ "./src/app/components/helpers/message/message.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "#note {\n  position: absolute;\n  bottom: 0;\n  z-index: 999999;\n  width: 100vw; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/helpers/message/message.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MessageComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let MessageComponent = class MessageComponent {
    constructor(messageService) {
        this.messageService = messageService;
    }
    ngOnInit() {
        this.subscription = this.messageService.getMessage().subscribe((message) => {
            this.message = message;
        });
    }
    ngOnDestroy() {
        this.subscription.unsubscribe();
    }
};
MessageComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-message',
        template: __webpack_require__("./src/app/components/helpers/message/message.component.html"),
        styles: [__webpack_require__("./src/app/components/helpers/message/message.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__providers_message_service__["a" /* MessageService */]])
], MessageComponent);



/***/ }),

/***/ "./src/app/components/home/home.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row pr-2 pl-2 animated fadeIn\">\n  <div class=\"col-lg-4 pr-2 pl-2\" *ngFor=\"let menu of menus; let i = index;\">\n    <a routerLink=\"/{{menu.link}}\">\n      <div class=\"card text-white bg-{{menu.color}} mb-3 mainCard {{menu.link}}\">\n        <div class=\"card-body\">\n          <p>{{menu.name}}</p>\n        </div>\n      </div>\n    </a>\n  </div>\n  <div class=\"col-lg-4 pr-2 pl-2\">\n    <a href=\"#\">\n      <div class=\"card text-white mb-3 mainCard exit\" (click)=\"closeProgram()\" style=\"background-color: #333; border-color: #333;\">\n        <div class=\"card-body\">\n          <p>Çıkış</p>\n        </div>\n      </div>\n    </a>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/home/home.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".mainCard {\n  min-height: 43vh;\n  padding: 2vh;\n  overflow: hidden;\n  -webkit-box-shadow: 1px 1px 3px rgba(60, 58, 58, 0.6);\n          box-shadow: 1px 1px 3px rgba(60, 58, 58, 0.6); }\n  .mainCard p {\n    position: relative;\n    left: -5px;\n    top: -5px;\n    font-size: 4vw;\n    font-weight: bold; }\n\n.mainCard:before {\n  position: absolute;\n  font-family: 'FontAwesome';\n  font-size: 300px !important;\n  bottom: -60px;\n  right: -75px;\n  opacity: 0.35;\n  -webkit-transform: rotate(-45deg);\n          transform: rotate(-45deg); }\n\n.mainCard.store:before {\n  content: \"\\F000\"; }\n\n.mainCard.cashbox:before {\n  content: \"\\F0D6\"; }\n\n.mainCard.endoftheday:before {\n  font-size: 320px !important;\n  content: \"\\F017\"; }\n\n.mainCard.reports:before {\n  content: \"\\F200\"; }\n\n.mainCard.settings:before {\n  content: \"\\F085\"; }\n\n.mainCard.exit:before {\n  content: \"\\F08B\"; }\n\na {\n  color: #d4d4d4; }\n\na:hover {\n  color: #ebebeb;\n  text-decoration: none; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/home/home.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return HomeComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let HomeComponent = class HomeComponent {
    constructor(router) {
        this.router = router;
        this.menus = [
            { name: 'Satış', color: 'danger', icon: 'fa-glass', link: 'store' },
            { name: 'Kasa', color: 'success', icon: 'fa-money', link: 'cashbox' },
            { name: 'Gün Sonu', color: 'warning', icon: 'fa-clock-o', link: 'endoftheday' },
            { name: 'Raporlar', color: 'info', icon: 'fa-pie-chart', link: 'reports' },
            { name: 'Ayarlar', color: 'primary', icon: 'fa-cogs', link: 'settings' }
        ];
    }
    ngOnInit() {
    }
    closeProgram() {
        localStorage.removeItem('userType');
        localStorage.removeItem('userName');
        localStorage.removeItem('userAuth');
        this.router.navigate(['/']);
    }
};
HomeComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-home',
        template: __webpack_require__("./src/app/components/home/home.component.html"),
        styles: [__webpack_require__("./src/app/components/home/home.component.scss")],
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */]])
], HomeComponent);



/***/ }),

/***/ "./src/app/components/login/login.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row animated fadeIn\">\n    <div id=\"login-holder\" class=\"container text-center\">\n        <div id=\"pincodeHolder\">\n            <div *ngIf=\"message\" class=\"alert alert-danger\">\n                <h3>{{ message }}</h3>\n            </div>\n            <div *ngIf=\"!message\" class=\"input-group\">\n                <input  class=\"form-control text-center\" readonly maxlength=\"4\" type=\"password\" [(ngModel)]=\"pinInput\">\n                <div class=\"input-group-append\">\n                    <button class=\"btn btn-large btn-danger\" (click)=\"clearDigits()\"> <i class=\"fa fa-long-arrow-left fa-2x\" aria-hidden=\"true\"></i> </button>\n                </div>\n            </div>\n        </div>\n        <div class=\"login-buttons-holder mt-3\">\n            <button *ngFor=\"let item of buttons let i = index;\" class=\"btn btn-success btn-lg login-button\" href=\"#\" role=\"button\" (click)=\"onClick(item)\">{{item}}\n         </button>\n        </div>\n    </div>\n</div>\n\n";

/***/ }),

/***/ "./src/app/components/login/login.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "#app-logo {\n  height: 350px; }\n\n#login-holder {\n  margin-top: 17vh; }\n\n.login-buttons-holder {\n  width: 50vh;\n  margin-left: auto;\n  margin-right: auto; }\n\n.login-button {\n  height: 12vh;\n  width: 12vh;\n  margin: 5px;\n  font-size: 30px;\n  font-weight: 600; }\n\n.clear-button {\n  height: 12vh;\n  width: 12vh;\n  margin: 5px;\n  border: none; }\n\n#pincodeHolder {\n  margin-left: auto;\n  margin-right: auto;\n  width: 39vh;\n  background: transparent; }\n  #pincodeHolder input {\n    font-size: 5rem;\n    height: 64px !important; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/login/login.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LoginComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_auth_service__ = __webpack_require__("./src/app/services/auth.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let LoginComponent = class LoginComponent {
    constructor(mainService, messageService, authService, router, settingsService) {
        this.mainService = mainService;
        this.messageService = messageService;
        this.authService = authService;
        this.router = router;
        this.settingsService = settingsService;
        this.fastSelling = false;
    }
    ngOnInit() {
        this.authService.logout();
        this.buttons = [1, 2, 3, 4, 5, 6, 7, 8, 9, 0];
        this.pinInput = '';
        this.settingsService.AppSettings.subscribe(res => {
            if (res) {
                if (res.value.takeaway == 'Açık') {
                    this.fastSelling = true;
                }
                else {
                    this.fastSelling = false;
                }
            }
        });
    }
    logIn() {
        this.message = "İşleniyor";
        this.mainService.getAllBy('users', { pincode: { $eq: this.pinInput } }).then((result) => {
            this.user = result.docs[0];
            if (this.user) {
                this.authService.login(this.user);
                this.authService.setPermissions();
                this.messageService.sendMessage("Hoşgeldiniz " + this.user.name);
                if (this.fastSelling) {
                    this.router.navigate(['/selling-screen', 'Fast', 'New']);
                }
                else {
                    this.router.navigate(['/store']);
                }
                this.clearDigits();
            }
            else {
                this.message = "Hatalı giriş yaptınız.";
                this.clearDigits();
            }
        });
    }
    clearDigits() {
        this.pinInput = '';
        setTimeout(() => {
            this.message = '';
        }, 750);
    }
    onClick(digit) {
        this.message = null;
        this.pinInput = this.pinInput + '' + digit + '';
        if (this.pinInput.length == 4) {
            this.pinInput = parseInt(this.pinInput);
            this.logIn();
        }
    }
};
LoginComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-login',
        template: __webpack_require__("./src/app/components/login/login.component.html"),
        styles: [__webpack_require__("./src/app/components/login/login.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_5__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_4__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__services_auth_service__["a" /* AuthService */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_5__services_settings_service__["a" /* SettingsService */]])
], LoginComponent);



/***/ }),

/***/ "./src/app/components/reports/activity-reports/activity-reports.component.html":
/***/ (function(module, exports) {

module.exports = "  <ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n    <li class=\"nav-item\">\n      <a class=\"nav-link active\" data-toggle=\"tab\" (click)=\"dailySalesActivity()\" href=\"#sales\" role=\"tab\">\n        <i class=\"fa fa-turkish-lira\" aria-hidden=\"true\"></i> Gelir Endeksi</a>\n    </li>\n    <li class=\"nav-item\">\n      <a class=\"nav-link\" data-toggle=\"tab\" (click)=\"dailyCrowdActivity()\" href=\"#crowd\" role=\"tab\">\n        <i class=\"fa fa-users\" aria-hidden=\"true\"></i> Doluluk</a>\n    </li>\n    <li class=\"nav-item\">\n      <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#weekly\" role=\"tab\">\n        <i class=\"fa fa-exchange\" aria-hidden=\"true\"></i> Sirkülasyon</a>\n    </li>\n    <li class=\"nav-item disabled\">\n      <a class=\"nav-link\" data-toggle=\"tab\" href=\"#monthly\" role=\"tab\">\n        <i class=\"fa fa-table\" aria-hidden=\"true\"></i> Aylık</a>\n    </li>\n  </ul>\n\n  <div class=\"tab-content\">\n\n    <!-- <div class=\"tab-pane\" id=\"weekly\" role=\"tabpanel\">\n      <div class=\"card ntb\">\n        <div class=\"card-header\">\n          <h5 class=\"mt-2\">Haftalık Satış Raporu</h5>\n        </div>\n        <div class=\"card-body tab-height p-0\">\n          <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"ChartData\" [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [colors]=\"ChartColors\" [chartType]=\"ChartType\"></canvas>\n        </div>\n        <div class=\"card-footer\">\n          <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n        </div>\n      </div>\n    </div>\n\n    <div class=\"tab-pane\" id=\"monthly\" role=\"tabpanel\">\n      <div class=\"card ntb\">\n        <div class=\"card-header\">\n          <div class=\"row\">\n            <div class=\"col-lg-9\">\n              <h5 class=\"mt-2\">Aylık Satış Raporu</h5>\n            </div>\n            <div class=\"col-lg-3 pr-2 pl-0\">\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend normal\">\n                  <div class=\"input-group-text\">Yıl</div>\n                </div>\n                <select class=\"form-control\" (change)=\"getMonthlyReport($event.target.value)\">\n                  <option>2018</option>\n                  <option>2019</option>\n                  <option selected>2020</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"card-body tab-height p-0\">\n          <h1 *ngIf=\"monthlyData?.length == 0\">Yıla Ait Veri Bulunamadı</h1>\n          <canvas *ngIf=\"monthlyLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"monthlyData\" [labels]=\"monthlyLabels\" [options]=\"ChartOptions\" [legend]=\"monthlyLegends\" [colors]=\"ChartColors\" [chartType]=\"ChartType\"></canvas>\n        </div>\n        <div class=\"card-footer\">\n          <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n        </div>\n      </div>\n    </div>  -->\n\n    <div class=\"tab-pane active\" id=\"sales\" role=\"tabpanel\">\n      <div class=\"card ntb\">\n        <div class=\"card-header\">\n          <h5 class=\"mt-2\">Günlük Gelir Endeksi Aktivitesi</h5>\n        </div>\n        <div class=\"card-body tab-height p-0\">\n          <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"activityData\" [labels]=\"activityLabels\" [options]=\"SalesActivityOptions\" [legend]=\"activityLegend\" [colors]=\"SalesColor\" chartType=\"line\"></canvas>\n        </div>\n        <div class=\"card-footer\">\n          <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Belirtilen Saatlerde Oturan Müşterilerin Ortalama Hesap Tutarı\n        </div>\n      </div>\n    </div>\n\n    <div class=\"tab-pane\" id=\"crowd\" role=\"tabpanel\">\n      <div class=\"card ntb\">\n        <div class=\"card-header\">\n          <h5 class=\"mt-2\">Günlük Doluluk Aktivitesi</h5>\n        </div>\n        <div class=\"card-body tab-height p-0\">\n          <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"activityData\" [labels]=\"activityLabels\" [options]=\"CrowdActivityOptions\" [legend]=\"activityLegend\" [colors]=\"CrowdColor\" chartType=\"line\"></canvas>\n        </div>\n        <div class=\"card-footer\">\n          <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Zaman Bazlı Mekan Doluluk Oranı\n        </div>\n      </div>\n    </div>\n  </div>";

/***/ }),

/***/ "./src/app/components/reports/activity-reports/activity-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/activity-reports/activity-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ActivityReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let ActivityReportsComponent = class ActivityReportsComponent {
    constructor(mainService) {
        this.mainService = mainService;
        this.activityLegend = true;
        this.SalesColor = [{ backgroundColor: '#5bc0de' }];
        this.CrowdColor = [{ backgroundColor: '#f0ad4e' }];
        this.SalesActivityOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return ' ' + Number(value.yLabel).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
        this.CrowdActivityOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return 'Masaların %' + Number(value.yLabel) + ' Dolu';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return ' %' + value + ' ';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
    }
    ngOnInit() {
        this.fillData();
    }
    dailySalesActivity() {
        this.ChartLoaded = false;
        this.activityData = [{ data: this.sellingActivity.activity, label: 'Gelir Endeksi' }];
        this.activityLabels = this.sellingActivity.activity_time;
        this.ChartLoaded = true;
    }
    dailyCrowdActivity() {
        this.ChartLoaded = false;
        this.activityData = [{ data: this.sellingActivity.activity_count, label: 'Doluluk Oranı ( % )' }];
        this.activityLabels = this.sellingActivity.activity_time;
        this.ChartLoaded = true;
    }
    fillData() {
        this.mainService.getAllBy('reports', { type: 'Activity' }).then(res => {
            this.sellingActivity = res.docs[0];
            this.dailySalesActivity();
        });
    }
};
ActivityReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-activity-reports',
        template: __webpack_require__("./src/app/components/reports/activity-reports/activity-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/activity-reports/activity-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */]])
], ActivityReportsComponent);



/***/ }),

/***/ "./src/app/components/reports/cashbox-reports/cashbox-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<!-- <ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" (click)=\"dailySalesActivity()\" href=\"#sales\" role=\"tab\">\n      <i class=\"fa fa-turkish-lira\" aria-hidden=\"true\"></i> Gelir Endeksi</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" (click)=\"dailyCrowdActivity()\" href=\"#crowd\" role=\"tab\">\n      <i class=\"fa fa-users\" aria-hidden=\"true\"></i> Doluluk</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#weekly\" role=\"tab\">\n      <i class=\"fa fa-exchange\" aria-hidden=\"true\"></i> Sirkülasyon</a>\n  </li>\n  <li class=\"nav-item disabled\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#monthly\" role=\"tab\">\n      <i class=\"fa fa-table\" aria-hidden=\"true\"></i> Aylık</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n\n  <div class=\"tab-pane\" id=\"weekly\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Haftalık Satış Raporu</h5>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"ChartData\" [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [colors]=\"ChartColors\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n\n</div> -->\n";

/***/ }),

/***/ "./src/app/components/reports/cashbox-reports/cashbox-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/cashbox-reports/cashbox-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CashboxReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let CashboxReportsComponent = class CashboxReportsComponent {
    constructor() { }
    ngOnInit() {
    }
};
CashboxReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-cashbox-reports',
        template: __webpack_require__("./src/app/components/reports/cashbox-reports/cashbox-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/cashbox-reports/cashbox-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [])
], CashboxReportsComponent);



/***/ }),

/***/ "./src/app/components/reports/notifications-reports/notifications-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<!-- <p>\n  notifications-reports works!\n</p> -->\n";

/***/ }),

/***/ "./src/app/components/reports/notifications-reports/notifications-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/notifications-reports/notifications-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return NotificationsReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let NotificationsReportsComponent = class NotificationsReportsComponent {
    constructor() { }
    ngOnInit() {
    }
};
NotificationsReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-notifications-reports',
        template: __webpack_require__("./src/app/components/reports/notifications-reports/notifications-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/notifications-reports/notifications-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [])
], NotificationsReportsComponent);



/***/ }),

/***/ "./src/app/components/reports/product-reports/product-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#chart\" role=\"tab\">\n      <i class=\"fa fa-bar-chart\" aria-hidden=\"true\"></i> Grafik</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#list\" role=\"tab\">\n      <i class=\"fa fa-list\" aria-hidden=\"true\"></i> Liste</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-times\" aria-hidden=\"true\"></i> İkram & İptal</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-bell\" aria-hidden=\"true\"></i> Bildirimler</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"chart\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Haftalık En Çok Satan Ürün Grafiği</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeFilter($event.target.value)\">\n                <option>Tutar</option>\n                <option>Adet</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:76vw; margin:auto;\" [datasets]=\"ChartData\" [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"list\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Ürün Satış ve Gelir Listesi</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeListFilter($event.target.value)\">\n                <option>Genel</option>\n                <option>Haftalık</option>\n                <option>Günlük</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body p-0 tab-height\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button type=\"button\" (click)=\"fillData();\" [ngClass]=\"{'list-group-item-warning' : selectedCat == undefined}\" class=\"list-group-item list-group-item-action list-eq\">\n                    Bütün Ürünler\n                  </button>\n                  <button *ngFor=\"let cat of categoriesList\" type=\"button\" [ngClass]=\"{'list-group-item-warning' : selectedCat == cat._id}\" (click)=\"getReportsByCategory(cat._id)\" class=\"list-group-item list-group-item-action list-eq\">\n                    {{cat.name}}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                Ürünler\n                <button (click)=\"printReport()\" class=\"btn btn-sm btn-danger pull-right\">\n                  <i class=\"fa fa-print\"></i>\n                  Rapor Yazdır\n                </button>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <table class=\"table table-sm  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th class=\"text-center\" width=\"10%\">\n                        <i class=\"fa fa-glass\" aria-hidden=\"true\"></i>\n                      </th>\n                      <th class=\"text-center\" width=\"50%\">Ürün Adı</th>\n                      <th class=\"text-right\" width=\"20%\">Adet</th>\n                      <th class=\"text-right\" width=\"20%\">Getiri</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let item of productList; let i = index\" (click)=\"getItemReport(item)\">\n                      <td class=\"text-center\">{{i+1}}</td>\n                      <td style=\"text-transform:capitalize;\">\n                        <span>{{item.description}}</span>\n                        <!-- <small class=\"pull-right\"><i class=\"fa fa-clock-o\"></i> {{item.timestamp | timeAgo }}</small> -->\n                      </td>\n                      <td class=\"text-right\">{{item.count | number:'1.0-2'}} Adet</td>\n                      <td class=\"text-right\">{{item.amount | price }}</td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"notifications\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Bildirimler</h5>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table table-striped  table-bordered\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"10%\">Kullanıcı</th>\n              <th>Açıklama</th>\n              <th width=\"25%\" colspan=\"2\">Tarih</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let log of productLogs\">\n              <td>{{log.user}}</td>\n              <td>{{log.description}}</td>\n              <td>{{log.timestamp | date:'HH:mm'}}</td>\n              <td>{{log.timestamp | date:'dd/M/y'}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"reportDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">{{ItemReport?.connection_id | general:'products' | async}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <canvas *ngIf=\"DetailLoaded\" baseChart style=\"height: 350px; width:790px; margin:auto;\" [datasets]=\"DetailData\" [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/reports/product-reports/product-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/product-reports/product-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ProductReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_log__ = __webpack_require__("./src/app/mocks/log.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let ProductReportsComponent = class ProductReportsComponent {
    constructor(mainService, settingsService, printerService) {
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.printerService = printerService;
        this.ChartLabels = ['Pzt', 'Sa', 'Ça', 'Pe', 'Cu', 'Cmt', 'Pa'];
        this.ChartOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return ' ' + Number(value.yLabel).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
        this.ChartLegend = true;
        this.ChartType = 'bar';
        this.DetailLoaded = false;
        this.DetailData = [];
    }
    ngOnInit() {
        this.fillData(false);
        this.toDay = Date.now();
        this.settingsService.getPrinters().subscribe(res => {
            this.printers = res.value;
        });
    }
    normalWeekOrder(array) {
        var arrayLength = array.length;
        for (var i = 0; i < arrayLength - 1; i++) {
            var temp = array[i];
            array[i] = array[i + 1];
            array[i + 1] = temp;
        }
        return array;
    }
    dailyCount(arr, price) {
        let newArray = [];
        for (let item of arr) {
            item = item / price;
            newArray.push(item);
        }
        return newArray;
    }
    changeFilter(value) {
        switch (value) {
            case 'Adet':
                this.fillData(true);
                break;
            case 'Tutar':
                this.fillData(false);
                break;
            default:
                break;
        }
    }
    getItemReport(report) {
        this.DetailLoaded = false;
        this.ItemReport = report;
        this.mainService.getData('reports', report._id).then(res => {
            res.weekly = this.normalWeekOrder(res.weekly);
            res.weekly_count = this.normalWeekOrder(res.weekly_count);
            this.DetailData = [{ data: res.weekly, label: 'Satış Tutarı' }];
            this.DetailLoaded = true;
            $('#reportDetail').modal('show');
        });
    }
    changeListFilter(value) {
        let newArray = [];
        switch (value) {
            case 'Genel':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                break;
            case 'Günlük':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count[new Date().getDay()];
                    obj.amount = obj.weekly[new Date().getDay()];
                });
                break;
            case 'Haftalık':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count.reduce((a, b) => a + b);
                    obj.amount = obj.weekly.reduce((a, b) => a + b);
                });
                break;
            default:
                break;
        }
        newArray = newArray.sort((a, b) => b.count - a.count);
        this.productList = newArray;
        if (this.selectedCat) {
            this.mainService.getAllBy('products', { cat_id: this.selectedCat }).then(res => {
                let products_ids = res.docs.map(obj => obj._id);
                this.productList = this.productList.filter(obj => products_ids.includes(obj.connection_id));
            });
        }
    }
    getReportsByCategory(cat_id) {
        this.selectedCat = cat_id;
        this.mainService.getAllBy('products', { cat_id: cat_id }).then(res => {
            let products_ids = res.docs.map(obj => obj._id);
            this.productList = this.generalList.filter(obj => products_ids.includes(obj.connection_id));
        });
    }
    printReport() {
        if (this.selectedCat) {
            this.mainService.getAllBy('products', { cat_id: this.selectedCat }).then(res => {
                res.docs.forEach(element => {
                    this.productList.find(obj => obj.connection_id == element._id).description = element.name;
                });
                this.printerService.printReport(this.printers[0], 'Ürünler', this.productList);
            });
        }
        else {
            this.mainService.getAllBy('products', {}).then(res => {
                res.docs.forEach(element => {
                    this.productList.find(obj => obj.connection_id == element._id).description = element.name;
                });
                this.printerService.printReport(this.printers[0], 'Ürünler', this.productList);
            });
        }
    }
    fillData(daily) {
        this.selectedCat = undefined;
        this.ChartData = [];
        this.ChartLoaded = false;
        this.mainService.getAllBy('reports', { type: 'Product' }).then(res => {
            this.generalList = res.docs.sort((a, b) => b.count - a.count);
            this.productList = JSON.parse(JSON.stringify(this.generalList));
            this.chartList = this.productList.slice(0, 5);
            this.chartList.forEach((obj, index) => {
                this.mainService.getData('products', obj.connection_id).then(res => {
                    obj.weekly = this.normalWeekOrder(obj.weekly);
                    if (daily) {
                        obj.weekly = this.normalWeekOrder(obj.weekly_count);
                    }
                    let schema = { data: obj.weekly, label: res.name };
                    this.ChartData.push(schema);
                    if (this.chartList.length - 1 == index) {
                        this.ChartLoaded = true;
                    }
                    ;
                });
            });
        });
        this.mainService.getAllBy('categories', {}).then(res => {
            this.categoriesList = res.docs;
            this.categoriesList.sort((a, b) => b.order - a.order);
        });
        this.mainService.getAllBy('logs', {}).then(res => {
            this.productLogs = res.docs.filter(obj => obj.type >= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].PRODUCT_CREATED && obj.type <= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].PRODUCT_CHECKPOINT).sort((a, b) => b.timestamp - a.timestamp);
        });
    }
};
ProductReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-product-reports',
        template: __webpack_require__("./src/app/components/reports/product-reports/product-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/product-reports/product-reports.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_4__providers_printer_service__["a" /* PrinterService */]])
], ProductReportsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/reports/reports.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div id=\"settings-holder\" class=\"col-lg-2\">\n    <div class=\"card\">\n      <div class=\"card-body\" [ngClass]=\"{'bg-danger text-white':selected == undefined}\" (click)=\"selected = undefined\">\n        <h2>\n          <i class=\"fa fa-try\"></i>\n          <span>Satışlar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 1}\" (click)=\"selected = 1\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-sticky-note\"></i>\n          <span>Hesaplar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 2}\" (click)=\"selected = 2\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-glass\"></i>\n          <span>Ürünler</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 3}\" (click)=\"selected = 3\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-square\"></i>\n          <span>Masalar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 4}\" (click)=\"selected = 4\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-cube\"></i>\n          <span>Stoklar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 5}\" (click)=\"selected = 5\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-users\"></i>\n          <span>Kullanıcılar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 6}\" (click)=\"selected = 6\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-money\"></i>\n          <span>Kasa</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 7}\" (click)=\"selected = 7\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-area-chart\"></i>\n          <span>Aktivite</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 8}\" (click)=\"selected = 8\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-bell\"></i>\n          <span>Bildirimler</span>\n        </h2>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-lg-10 pl-0\">\n    <div class=\"card full-height\">\n      <div class=\"card-body\">\n        <div *ngIf=\"selected == undefined\">\n          <ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n            <li class=\"nav-item\">\n              <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#daily\" role=\"tab\">\n                <i class=\"fa fa-pie-chart\" aria-hidden=\"true\"></i> Günlük</a>\n            </li>\n            <li class=\"nav-item\">\n              <a class=\"nav-link\" data-toggle=\"tab\" href=\"#weekly\" role=\"tab\">\n                <i class=\"fa fa-bar-chart\" aria-hidden=\"true\"></i> Haftalık</a>\n            </li>\n            <li class=\"nav-item\">\n              <a class=\"nav-link\" data-toggle=\"tab\" href=\"#monthly\" role=\"tab\">\n                <i class=\"fa fa-table\" aria-hidden=\"true\"></i> Aylık</a>\n            </li>\n            <li class=\"nav-item\">\n              <a class=\"nav-link\" data-toggle=\"tab\" href=\"#activity\" role=\"tab\">\n                <i class=\"fa fa-area-chart\" aria-hidden=\"true\"></i> Aktivite</a>\n            </li>\n          </ul>\n\n          <div class=\"tab-content\">\n            <div class=\"tab-pane active\" id=\"daily\" role=\"tabpanel\">\n              <div class=\"card ntb\">\n                <div class=\"card-header\">\n                  <h5 class=\"mt-2\">Günlük Satış Raporu</h5>\n                </div>\n                <div class=\"card-body tab-height\">\n                  <div class=\"row\">\n                    <div class=\"col-lg-6\">\n                      <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 430px; width:37vw; margin:auto;\" [data]=\"pieData\" [colors]=\"pieColors\" [labels]=\"pieLabels\" [legend]=\"true\" chartType=\"pie\" [options]=\"pieOptions\"></canvas>\n                    </div>\n                    <div class=\"col-lg-6\">\n                      <div class=\"card\" style=\"height:56vh;\">\n                        <div class=\"card-header\">\n                          Ayrıntılar\n                        </div>\n                        <div class=\"card-body dark-bg\">\n                          <strong>\n                            <h5 class=\"text-success mt-1\">\n                              <i class=\"fa fa-money\"></i>\n                              Nakit Toplam:\n                              <span class=\"pull-right\">{{salesReport?.cash | price }}</span>\n                            </h5>\n                            <h5 class=\"text-warning mt-2\">\n                              <i class=\"fa fa-credit-card\"></i>\n                              Kart Toplam:\n                              <span class=\"pull-right\">{{salesReport?.card| price}}</span>\n                            </h5>\n                            <h5 class=\"text-info mt-2\">\n                              <i class=\"fa fa-bookmark\"></i>\n                              Kupon Toplam:\n                              <span class=\"pull-right\">{{salesReport?.coupon| price}}</span>\n                            </h5>\n                            <h5 class=\"text-danger mt-2\">\n                              <i class=\"fa fa-handshake-o\"></i>\n                              İkram Toplam:\n                              <span class=\"pull-right\">{{salesReport?.free | price}}</span>\n                            </h5>\n                            <h5 class=\"color-light-gray mt-2\">\n                              <i class=\"fa fa-percent\"></i>\n                              İndirim Toplam:\n                              <span class=\"pull-right\">{{salesReport?.discount | price}}</span>\n                            </h5>\n                            <h5 class=\"text-primary mt-2 mb-0\">\n                              <i class=\"fa fa-times\"></i>\n                              İptal Toplam:\n                              <span class=\"pull-right\">{{canceledTotal | price}}</span>\n                            </h5>\n                          </strong>\n                        </div>\n                        <div class=\"card-footer\">\n                          <p style=\"font-size: larger;\">\n                            <strong>Açık Hesaplar:\n                              <span class=\"pull-right\">{{activeTotal | price}}</span>\n                            </strong>\n                          </p>\n                          <p class=\"mb-0\" style=\"font-size: larger;\">\n                            <strong>Kapalı Hesaplar:\n                              <span class=\"pull-right\">{{closedTotal | price}}</span>\n                            </strong>\n                          </p>\n                        </div>\n                        <div class=\"card-footer\">\n                          <strong>\n                            <p class=\"mb-0\" style=\"font-size: larger;\">\n                              <strong>Genel Toplam:\n                                <span class=\"pull-right\">{{ closedTotal + activeTotal | price }}</span>\n                              </strong>\n                            </p>\n                          </strong>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"card-footer\">\n                  <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n                </div>\n              </div>\n            </div>\n\n            <div class=\"tab-pane\" id=\"weekly\" role=\"tabpanel\">\n              <div class=\"card ntb\">\n                <div class=\"card-header\">\n                  <h5 class=\"mt-2\">Haftalık Satış Raporu</h5>\n                </div>\n                <div class=\"card-body tab-height p-0\">\n                  <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"ChartData\" [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [colors]=\"ChartColors\" [chartType]=\"ChartType\"></canvas>\n                </div>\n                <div class=\"card-footer\">\n                  <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n                </div>\n              </div>\n            </div>\n\n            <div class=\"tab-pane\" id=\"monthly\" role=\"tabpanel\">\n              <div class=\"card ntb\">\n                <div class=\"card-header\">\n                  <div class=\"row\">\n                    <div class=\"col-lg-9\">\n                      <h5 class=\"mt-2\">Aylık Satış Raporu</h5>\n                    </div>\n                    <div class=\"col-lg-3 pr-2 pl-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend normal\">\n                          <div class=\"input-group-text\">Yıl</div>\n                        </div>\n                        <select class=\"form-control\" (change)=\"getMonthlyReport($event.target.value)\">\n                          <option>2018</option>\n                          <option>2019</option>\n                          <option>2020</option>\n                          <option>2021</option>\n                          <option selected>2022</option>\n                        </select>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"card-body tab-height p-0\">\n                  <h1 *ngIf=\"monthlyData?.length == 0\">Yıla Ait Veri Bulunamadı</h1>\n                  <canvas *ngIf=\"monthlyLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"monthlyData\" [labels]=\"monthlyLabels\" [options]=\"ChartOptions\" [legend]=\"monthlyLegends\" [colors]=\"ChartColors\" [chartType]=\"ChartType\"></canvas>\n                </div>\n                <div class=\"card-footer\">\n                  <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n                </div>\n              </div>\n            </div>\n\n            <div class=\"tab-pane\" id=\"activity\" role=\"tabpanel\">\n              <div class=\"card ntb\">\n                <div class=\"card-header\">\n                  <h5 class=\"mt-2\">Zaman Bazlı Satış Aktivitesi</h5>\n                </div>\n                <div class=\"card-body tab-height p-0\">\n                  <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:77vw; margin:auto;\" [datasets]=\"activityData\" [labels]=\"activityLabels\" [options]=\"ChartOptions\" [legend]=\"activityLegend\" chartType=\"line\"></canvas>\n                </div>\n                <div class=\"card-footer\">\n                  <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <app-store-reports *ngIf=\"selected == 1\"></app-store-reports>\n        <app-product-reports *ngIf=\"selected == 2\"></app-product-reports>\n        <app-table-reports *ngIf=\"selected == 3\"></app-table-reports>\n        <app-stock-reports *ngIf=\"selected == 4\"></app-stock-reports>\n        <app-user-reports *ngIf=\"selected == 5\"></app-user-reports>\n        <app-cashbox-reports *ngIf=\"selected == 6\"></app-cashbox-reports>\n        <app-activity-reports *ngIf=\"selected == 7\"></app-activity-reports>\n        <app-notifications-reports *ngIf=\"selected == 8\"></app-notifications-reports>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/reports/reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "@media screen and (min-width: 900px) {\n  #settings-holder .card {\n    height: 70px;\n    margin-bottom: 6px; }\n  #settings-holder .card-body {\n    padding: 23px 5px 20px 10px; }\n  #settings-holder h2 {\n    font-size: 17px;\n    margin-bottom: 0;\n    font-weight: bold; }\n    #settings-holder h2 i {\n      width: 14%;\n      text-align: center;\n      margin-right: 3px;\n      margin-left: 2px; } }\n\n@media screen and (min-width: 1200px) {\n  #settings-holder .card {\n    height: 70px;\n    margin-bottom: 6px; }\n  #settings-holder .card-body {\n    padding: 22px 5px 20px 10px; }\n  #settings-holder h2 {\n    font-size: 22px;\n    margin-bottom: 0;\n    font-weight: bold; }\n    #settings-holder h2 i {\n      width: 13%;\n      text-align: center;\n      margin-right: 3px;\n      margin-left: 2px; } }\n\nh5 {\n  font-weight: bold !important; }\n  h5 i {\n    text-align: center;\n    width: 35px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let ReportsComponent = class ReportsComponent {
    constructor(mainService, settingsService) {
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.ChartLegend = true;
        this.ChartType = 'bar';
        this.monthlyLegends = true;
        this.monthlyLoaded = false;
        this.activityLegend = true;
        this.salesReport = { cash: 0, card: 0, coupon: 0, free: 0, discount: 0, partial: null };
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
        this.closedTotal = 0;
        this.activeTotal = 0;
        this.generalTotal = 0;
        this.freeTotal = 0;
        this.canceledTotal = 0;
        this.selected = undefined;
        this.monthlyLabels = ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"];
        this.ChartLabels = ['Pzt', 'Sa', 'Ça', 'Pe', 'Cu', 'Cmt', 'Pa'];
        this.ChartOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return ' ' + Number(value.yLabel).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
        this.ChartColors = [
            { backgroundColor: '#5cb85c' },
            { backgroundColor: '#5bc0de' },
            { backgroundColor: '#f0ad4e' },
            { backgroundColor: '#d9534f' },
            { backgroundColor: '#DF691A' },
            { backgroundColor: '#FFFFFF' },
        ];
        this.pieColors = [{ backgroundColor: ['#5cb85c', '#f0ad4e', '#5bc0de', '#d9534f'] }];
        this.pieOptions = {
            legend: {
                labels: { fontColor: 'rgb(255, 255, 255)', fontStyle: 'bolder' }
            },
            tooltips: {
                callbacks: {
                    label: function (tooltipItem, data) {
                        var dataLabel = data.labels[tooltipItem.index];
                        var value = ': ' + Number(data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index]).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                        return dataLabel + value;
                    }
                }
            },
        };
    }
    ngOnInit() {
        this.fillData();
        this.dailySalesReport();
    }
    normalWeekOrder(array) {
        var arrayLength = array.length;
        for (var i = 0; i < arrayLength - 1; i++) {
            var temp = array[i];
            array[i] = array[i + 1];
            array[i + 1] = temp;
        }
        return array;
    }
    getMonthlyReport(year) {
        this.monthlyLoaded = false;
        if (!year) {
            year = new Date(Date.now()).getFullYear();
        }
        let Days = [];
        let Months = [];
        this.mainService.getAllBy('endday', {}).then(res => {
            let endDayData = res.docs;
            endDayData = endDayData.filter(obj => new Date(obj.timestamp).getFullYear() == year);
            if (endDayData.length > 0) {
                endDayData.forEach((obj, index) => {
                    let Schema = { cash: obj.cash_total, card: obj.card_total, coupon: obj.coupon_total, free: obj.free_total, total: obj.total_income, checks: obj.check_count, outcome: obj.outcomes, income: obj.incomes, month: new Date(obj.timestamp).getMonth(), year: new Date(obj.timestamp).getFullYear() };
                    Days.push(Schema);
                    if (index == endDayData.length - 1) {
                        let cash = { label: 'Nakit', data: [] };
                        let coupon = { label: 'Kupon', data: [] };
                        let card = { label: 'Kart', data: [] };
                        let free = { label: 'İkram', data: [] };
                        let total = { label: 'Toplam', data: [] };
                        this.monthlyLabels.forEach((monthName, index2) => {
                            let monthWillProcess = Days.filter(obj => obj.month == index2);
                            if (monthWillProcess.length > 1) {
                                cash.data[index2] = monthWillProcess.map(obj => obj.cash).reduce((a, b) => a + b, 0);
                                card.data[index2] = monthWillProcess.map(obj => obj.card).reduce((a, b) => a + b);
                                coupon.data[index2] = monthWillProcess.map(obj => obj.coupon).reduce((a, b) => a + b);
                                free.data[index2] = monthWillProcess.map(obj => obj.free).reduce((a, b) => a + b);
                                total.data[index2] = monthWillProcess.map(obj => obj.total).reduce((a, b) => a + b);
                            }
                            else if (monthWillProcess.length == 1) {
                                cash.data[index2] = monthWillProcess[0].cash;
                                card.data[index2] = monthWillProcess[0].card;
                                coupon.data[index2] = monthWillProcess[0].coupon;
                                free.data[index2] = monthWillProcess[0].free;
                                total.data[index2] = monthWillProcess[0].total;
                            }
                            else {
                                cash.data[index2] = 0;
                                card.data[index2] = 0;
                                coupon.data[index2] = 0;
                                free.data[index2] = 0;
                                total.data[index2] = 0;
                            }
                            if (index2 == this.monthlyLabels.length - 1) {
                                Months.push(cash, coupon, card, free, total);
                                this.monthlyData = Months;
                                this.monthlyLoaded = true;
                            }
                        });
                    }
                });
            }
        });
    }
    fillData() {
        this.getMonthlyReport();
        this.ChartData = [];
        this.pieData = [];
        this.pieLabels = [];
        this.ChartLoaded = false;
        this.mainService.getAllBy('reports', { type: 'Activity' }).then(res => {
            this.sellingActivity = res.docs[0];
            this.activityData = [{ data: this.sellingActivity.activity, label: 'Gelir Endeksi' }, { data: this.sellingActivity.activity_count, label: 'Doluluk Oranı ( % )' }];
            this.activityLabels = this.sellingActivity.activity_time;
        });
        this.mainService.getAllBy('reports', { type: 'Store' }).then(res => {
            let report = res.docs;
            report = report.filter(obj => obj.connection_id !== 'Genel').sort((a, b) => b.connection_id.localeCompare(a.connection_id));
            report.forEach((element, index) => {
                element.weekly = this.normalWeekOrder(element.weekly);
                let chartObj = { data: element.weekly, label: element.connection_id };
                this.ChartData.push(chartObj);
                if (report.length - 1 == index) {
                    this.ChartLoaded = true;
                }
                ;
            });
        });
        this.mainService.getAllBy('closed_checks', { type: 3 }).then(res => {
            if (res.docs.length > 0) {
                this.canceledTotal = res.docs.map((obj) => obj.total_price).reduce((a, b) => a + b);
            }
        });
    }
    dailySalesActivity() {
        this.mainService.getAllBy('reports', { type: 'Activity' }).then(res => {
            this.sellingActivity = res.docs[0];
            this.activityData = [{ data: this.sellingActivity.activity, label: 'Gelir Endeksi' }, { data: this.sellingActivity.activity_count, label: 'Doluluk Oranı ( % )' }];
            this.activityLabels = this.sellingActivity.activity_time;
        });
    }
    dailySalesReport() {
        this.mainService.getAllBy('checks', {}).then(res => {
            this.activeTotal = res.docs.map(obj => obj.total_price + obj.discount).reduce((a, b) => a + b, 0);
        });
        this.mainService.getAllBy('closed_checks', {}).then(res => {
            const checks = res.docs.filter(({ type }) => type !== 3);
            this.salesReport.cash = checks.filter(obj => obj.payment_method == 'Nakit').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            this.salesReport.card = checks.filter(obj => obj.payment_method == 'Kart').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            this.salesReport.coupon = checks.filter(obj => obj.payment_method == 'Kupon').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            this.salesReport.free = checks.filter(obj => obj.payment_method == 'İkram').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            this.salesReport.discount = checks.filter(obj => obj.hasOwnProperty('discount')).map(obj => obj.discount).reduce((a, b) => a + b, 0);
            this.salesReport.partial = checks.filter(obj => obj.payment_method == 'Parçalı');
            this.salesReport.partial.forEach(element => {
                element.payment_flow.forEach(payment => {
                    if (payment.method == 'Nakit') {
                        this.salesReport.cash += payment.amount;
                    }
                    if (payment.method == 'Kart') {
                        this.salesReport.card += payment.amount;
                    }
                    if (payment.method == 'Kupon') {
                        this.salesReport.coupon += payment.amount;
                    }
                    if (payment.method == 'İkram') {
                        this.salesReport.free += payment.amount;
                    }
                });
            });
            this.closedTotal = this.salesReport.cash + this.salesReport.card + this.salesReport.coupon;
            this.generalTotal = this.closedTotal + this.activeTotal;
            this.pieData.push(this.salesReport.cash);
            this.pieData.push(this.salesReport.card);
            this.pieData.push(this.salesReport.coupon);
            this.pieData.push(this.salesReport.free);
            this.pieLabels.push('Nakit');
            this.pieLabels.push('Kart');
            this.pieLabels.push('Kupon');
            this.pieLabels.push('İkram');
        });
    }
};
ReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-reports',
        template: __webpack_require__("./src/app/components/reports/reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/reports.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */]])
], ReportsComponent);



/***/ }),

/***/ "./src/app/components/reports/stock-reports/stock-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#general\" role=\"tab\">\n      <i class=\"fa fa-cube\" aria-hidden=\"true\"></i> Stok Durumu</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#list\" role=\"tab\">\n      <i class=\"fa fa-th\" aria-hidden=\"true\"></i> Stok Listesi</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-tasks\" aria-hidden=\"true\"></i> Harcamalar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-bell\" aria-hidden=\"true\"></i> Bildirimler</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"general\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Stok Durumu</h5>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">Kategoriler</div>\n              <div class=\"card-body p-0 flow\">\n                <button type=\"button\" (click)=\"fillData();\" [ngClass]=\"{'list-group-item-warning' : selectedCat == undefined}\"\n                  class=\"list-group-item list-group-item-action list-eq\">\n                  Bütün Stoklar\n                </button>\n                <button *ngFor=\"let cat of allCats\" type=\"button\" [ngClass]=\"{'list-group-item-warning' : selectedCat == cat._id}\"\n                  (click)=\"getStocksByCategory(cat._id)\" class=\"list-group-item list-group-item-action list-eq\">\n                  {{cat.name}}\n                </button>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">Stoklar</div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"row\">\n                  <div *ngFor=\"let stock of stocksView\" class=\"col-lg-6 stocksCard\">\n                    <div class=\"bodyquote\">\n                      <p class=\"mb-2\">\n                        <strong [ngClass]=\"{'text-danger': stock.left_total <= 0}\">{{stock.name}}</strong>\n                        <!-- <small>({{stock.cat_id | general:'stocks_cat' | async}})</small> -->\n                      </p>\n                      <div class=\"progress\">\n                        <div [ngClass]=\"{'bg-danger':stock.warning_limit >= stock.left_total}\" class=\"progress-bar bg-warning progress-bar-striped\"\n                          role=\"progressbar\" style=\"height: 20px;\" [ngStyle]=\"{width:stock.left_total/(stock.total*stock.first_quantity) | percent:'1.0-1'}\"\n                          [attr.aria-valuenow]=\"stock.left_total\" aria-valuemin=\"0\" [attr.aria-valuemax]=\"stock.total\"></div>\n                      </div>\n                      <small class=\"mt-2\">\n                        <span *ngIf=\"stock.left_total > 0\"> Kalan : {{stock.left_total | number:'1.0-2'}}\n                          {{stock.unit}}</span>\n                        <span *ngIf=\"stock.left_total <= 0\" class=\"text-danger\">Tükendi!</span>\n                        <span class=\"pull-right text-muted mt-1\">Stok Durumu:\n                          {{(stock.left_total/(stock.total*stock.first_quantity))*100 | number: '1.0-2'}}%</span>\n                      </small>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"list\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Stok listesi</h5>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table  table-bordered table-sm table-hover table-striped\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"6%\">\n                <i class=\"fa fa-truck\" aria-hidden=\"true\"></i>\n              </th>\n              <th width=\"19%\">Stok Adı</th>\n              <th colspan=\"3\" width=\"25%\">Son Toplam</th>\n              <th colspan=\"2\" width=\"15%\">Harcanan</th>\n              <th colspan=\"3\" width=\"30%\">Kalan Miktar</th>\n            </tr>\n          </thead>\n          <tbody>\n            <ng-container *ngFor=\"let stock of allStocks; let i = index;\" >\n              <tr >\n                <td>{{i+1}}</td>\n                <td>{{stock.name}}</td>\n                <td>{{stock.first_quantity | number: '1.0-2'}}x</td>\n                <td>{{stock.total*stock.first_quantity | number:'1.0-2'}} </td>\n                <td>{{stock.unit}}</td>\n                <td class=\"table-info\">{{stock.total*stock.first_quantity - stock.left_total | number:'1.0-2' }}</td>\n                <td class=\"table-info\">{{stock.unit}}</td>\n                <td>{{stock.quantity | number:'1.0-2' }}x</td>\n                <td>{{stock.left_total | number:'1.0-2' }}</td>\n                <td>{{stock.unit}}</td>\n              </tr>\n            </ng-container>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"notifications\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Bildirimler</h5>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table table-striped  table-bordered\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"10%\">Kullanıcı</th>\n              <th>Açıklama</th>\n              <th width=\"25%\" colspan=\"2\">Tarih</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let log of stockLogs\">\n              <td>{{log.user}}</td>\n              <td>{{log.description}}</td>\n              <td>{{log.timestamp | date:'HH:mm'}}</td>\n              <td>{{log.timestamp | date:'dd/M/y'}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/reports/stock-reports/stock-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".stocksCard:nth-of-type(even) {\n  padding-left: 0.25rem; }\n\n.stocksCard:nth-of-type(odd) {\n  padding-right: 0.25rem; }\n\n.stocksCard {\n  margin-bottom: 8px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/stock-reports/stock-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return StockReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_log__ = __webpack_require__("./src/app/mocks/log.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let StockReportsComponent = class StockReportsComponent {
    constructor(mainService) {
        this.mainService = mainService;
    }
    ngOnInit() {
        this.fillData();
    }
    getStocksByCategory(cat_id) {
        this.stocksView = this.allStocks.filter(obj => obj.sub_category == cat_id);
        this.selectedCat = cat_id;
    }
    fillData() {
        this.selectedCat = undefined;
        this.mainService.getAllBy('stocks', {}).then(result => {
            this.allStocks = result.docs;
            this.allStocks = this.allStocks.sort((b, a) => (b.left_total / (b.total * b.first_quantity)) * 100 - (a.left_total / (a.total * a.first_quantity)) * 100);
            this.stocksView = this.allStocks.sort((b, a) => (b.left_total / (b.total * b.first_quantity)) * 100 - (a.left_total / (a.total * a.first_quantity)) * 100);
        });
        this.mainService.getAllBy('stocks_cat', {}).then(result => {
            this.allCats = result.docs;
        });
        this.mainService.getAllBy('logs', {}).then(res => {
            this.stockLogs = res.docs.filter(obj => obj.type >= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].STOCK_CREATED && obj.type <= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].STOCK_CHECKPOINT).sort((a, b) => b.timestamp - a.timestamp);
        });
    }
};
StockReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-stock-reports',
        template: __webpack_require__("./src/app/components/reports/stock-reports/stock-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/stock-reports/stock-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */]])
], StockReportsComponent);



/***/ }),

/***/ "./src/app/components/reports/store-reports/store-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#normal\" role=\"tab\">\n      <i class=\"fa fa-th\" aria-hidden=\"true\"></i> Normal Satış</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#fast\" role=\"tab\">\n      <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> Hızlı Satış</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#delivery\" role=\"tab\">\n      <i class=\"fa fa-motorcycle\" aria-hidden=\"true\"></i> Paket Servis\n    </a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#canceled\" role=\"tab\">\n      <i class=\"fa fa-trash-o\" aria-hidden=\"true\"></i> İptal</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"normal\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Normal Satış</h5>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">Filtreleme</div>\n              <div class=\"card-body p-0\">\n                <div class=\"list-group\">\n                  <button type=\"button\" (click)=\"fillData()\" class=\"list-group-item list-group-item-action list-eq\">Bütün\n                    Masalar</button>\n                  <button type=\"button\" (click)=\"getNormalChecksBy('Parçalı')\" class=\"list-group-item list-group-item-action bg-primary text-white list-eq\">Parçalı</button>\n                  <button type=\"button\" (click)=\"getNormalChecksBy('Nakit')\" class=\"list-group-item list-group-item-action list-group-item-success list-eq\">Nakit</button>\n                  <button type=\"button\" (click)=\"getNormalChecksBy('Kart')\" class=\"list-group-item list-group-item-action list-group-item-warning list-eq\">Kart</button>\n                  <button type=\"button\" (click)=\"getNormalChecksBy('Kupon')\" class=\"list-group-item list-group-item-action list-group-item-info list-eq\">Kupon</button>\n                  <button type=\"button\" (click)=\"getNormalChecksBy('İkram')\" class=\"list-group-item list-group-item-action list-group-item-danger list-eq\">İkram</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pb-2 pt-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Masalar\n                  </div>\n                  <div class=\"col-lg-6 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #tableName type=\"text\" placeholder=\"Masa Adı Giriniz..\" (click)=\"fillData(); tableName.value = '';\" (keyup)=\"filterTables(tableName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <table class=\"table  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th width=\"7%\">#</th>\n                      <th width=\"25%\">Masa</th>\n                      <th width=\"27%\">Tutar</th>\n                      <th width=\"13%\">Saat</th>\n                      <th width=\"17%\">Ödeme</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let check of NormalChecks let i = index;\" (click)=\"getDetail(check)\">\n                      <td>{{i+1}}</td>\n                      <td>{{check.table_id | general:'tables' | async}}\n                        <small *ngIf=\"check.note !== '' && check.note !== undefined\" class=\"text-muted\">({{check.note}})</small>\n                      </td>\n                      <td>{{check.total_price + check.discount | price}}\n                        <small *ngIf=\"check.discount > 0\" class=\"pull-right text-danger\">\n                          <strong>\n                            <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> {{check.discount |  price}}\n                          </strong>\n                        </small>\n                      </td>\n                      <td>{{check.timestamp | date:\"HH:mm\" }}</td>\n                      <td>{{check.payment_method}}</td>\n                    </tr>\n                  </tbody>\n                </table>\n                <h3 *ngIf=\"NormalChecks == undefined || NormalChecks.length == 0\" class=\"text-center mt-5\">Eşleşen\n                  Hesap Bulunamadı</h3>\n              </div>\n              <div class=\"card-footer\">\n                <strong>\n                  Normal Hesap Toplamı:\n                  <span class=\"pull-right\">{{NormalTotal | price }} </span>\n                </strong>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"fast\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Hızlı Satış</h5>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">Filtreleme</div>\n              <div class=\"card-body p-0\">\n                <div class=\"list-group\">\n                  <button type=\"button\" (click)=\"fillData()\" class=\"list-group-item list-group-item-action list-eq\">Bütün\n                    Hesaplar</button>\n                  <button type=\"button\" (click)=\"getFastChecksBy('Parçalı')\" class=\"list-group-item list-group-item-action bg-primary text-white list-eq\">Parçalı</button>\n                  <button type=\"button\" (click)=\"getFastChecksBy('Nakit')\" class=\"list-group-item list-group-item-action list-group-item-success list-eq\">Nakit</button>\n                  <button type=\"button\" (click)=\"getFastChecksBy('Kart')\" class=\"list-group-item list-group-item-action list-group-item-warning list-eq\">Kart</button>\n                  <button type=\"button\" (click)=\"getFastChecksBy('Kupon')\" class=\"list-group-item list-group-item-action list-group-item-info list-eq\">Kupon</button>\n                  <button type=\"button\" (click)=\"getFastChecksBy('İkram')\" class=\"list-group-item list-group-item-action list-group-item-danger list-eq\">İkram</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Hesaplar\n                  </div>\n                  <div class=\"col-lg-6 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #ownerName type=\"text\" placeholder=\"Kullanıcı Adı Giriniz..\" (click)=\"fillData(); ownerName.value = '';\" (keyup)=\"filterChecks(ownerName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <table class=\"table  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th width=\"7%\">#</th>\n                      <th width=\"33%\">Hesap Türü</th>\n                      <th width=\"20%\">Tutar</th>\n                      <th width=\"13%\">Saat</th>\n                      <th width=\"17%\">Kullanıcı</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let check of FastChecks let i = index;\" (click)=\"getDetail(check)\">\n                      <td>{{i+1}}</td>\n                      <td>{{check.table_id}}\n                        <small *ngIf=\"check.note !== '' && check.note !== undefined\" class=\"text-muted\">({{check.note}})</small>\n                      </td>\n                      <td>{{check.total_price + check.discount | price}}\n                        <small *ngIf=\"check.discount > 0\" class=\"pull-right text-danger\">\n                          <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> {{check.discount | price}}\n                        </small>\n                      </td>\n                      <td>{{check.timestamp | date:\"HH:mm\" }}</td>\n                      <td>{{check.owner}}</td>\n                    </tr>\n                  </tbody>\n                </table>\n                <h3 *ngIf=\"FastChecks == undefined || FastChecks.length == 0\" class=\"text-center mt-5\">Eşleşen Hesap\n                  Bulunamadı</h3>\n              </div>\n              <div class=\"card-footer\">\n                <strong>\n                  Hızlı Hesap Toplamı:\n                  <span class=\"pull-right\">{{FastTotal | price }} </span>\n                </strong>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"canceled\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">İptal Edilen Hesaplar</h5>\n      </div>\n      <div class=\"card-body p-0 tab-height flow\">\n        <div class=\"row\">\n          <div class=\"col-lg-12\">\n            <table class=\"table  table-bordered table-striped table-hover\">\n              <thead>\n                <tr class=\"thead-dark\">\n                  <th width=\"6%\">#</th>\n                  <th width=\"14%\">Masa</th>\n                  <th width=\"25%\">Açıklama</th>\n                  <th width=\"10%\">Tür</th>\n                  <th width=\"10%\">Tutar</th>\n                  <th width=\"10%\">Saat</th>\n                  <th width=\"10%\">Kullanıcı</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let check of NotPayedChecks let i = index;\" (click)=\"getDetail(check)\">\n                  <td>{{i+1}}</td>\n                  <td>{{check.table_id | general:'tables' | async}}\n                    <small *ngIf=\"check.note !== '' && check.note !== undefined\" class=\"text-muted\">({{check.note}})</small>\n                  </td>\n                  <td>{{check.description}}</td>\n                  <td>{{check.payment_method}}</td>\n                  <td>{{check.total_price | price }} </td>\n                  <td>{{check.timestamp | date:\"HH:mm\" }}</td>\n                  <td>{{check.owner}}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"delivery\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Paket Servis</h5>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">Filtreleme</div>\n              <div class=\"card-body p-0\">\n                <div class=\"list-group\">\n                  <button type=\"button\" (click)=\"fillData()\" class=\"list-group-item list-group-item-action list-eq\">Bütün\n                    Hesaplar</button>\n                  <button type=\"button\" (click)=\"getDeliveryChecksBy('Parçalı')\" class=\"list-group-item list-group-item-action bg-primary text-white list-eq\">Parçalı</button>\n                  <button type=\"button\" (click)=\"getDeliveryChecksBy('Nakit')\" class=\"list-group-item list-group-item-action list-group-item-success list-eq\">Nakit</button>\n                  <button type=\"button\" (click)=\"getDeliveryChecksBy('Kart')\" class=\"list-group-item list-group-item-action list-group-item-warning list-eq\">Kart</button>\n                  <button type=\"button\" (click)=\"getDeliveryChecksBy('Kupon')\" class=\"list-group-item list-group-item-action list-group-item-info list-eq\">Kupon</button>\n                  <button type=\"button\" (click)=\"getDeliveryChecksBy('İkram')\" class=\"list-group-item list-group-item-action list-group-item-danger list-eq\">İkram</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Hesaplar\n                  </div>\n                  <div class=\"col-lg-6 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #ownerName type=\"text\" placeholder=\"Kullanıcı Adı Giriniz..\" (click)=\"fillData(); ownerName.value = '';\" (keyup)=\"filterChecks(ownerName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <table class=\"table  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th width=\"7%\">#</th>\n                      <th width=\"33%\">Hesap Türü</th>\n                      <th width=\"20%\">Tutar</th>\n                      <th width=\"13%\">Saat</th>\n                      <th width=\"17%\">Kullanıcı</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let check of DeliveryChecks let i = index;\" (click)=\"getDetail(check)\">\n                      <td>{{i+1}}</td>\n                      <td>{{check.table_id}}\n                        <small *ngIf=\"check.note !== '' && check.note !== undefined\" class=\"text-muted\">({{check.note}})</small>\n                      </td>\n                      <td>{{check.total_price + check.discount | price}}\n                        <small *ngIf=\"check.discount > 0\" class=\"pull-right text-danger\">\n                          <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> {{check.discount | price}}\n                        </small>\n                      </td>\n                      <td>{{check.timestamp | date:\"HH:mm\" }}</td>\n                      <td>{{check.owner}}</td>\n                    </tr>\n                  </tbody>\n                </table>\n                <h3 *ngIf=\"DeliveryChecks == undefined || DeliveryChecks.length == 0\" class=\"text-center mt-5\">Eşleşen Hesap\n                  Bulunamadı</h3>\n              </div>\n              <div class=\"card-footer\">\n                <strong>\n                  Paket Servis Toplamı:\n                  <span class=\"pull-right\">{{DeliveryTotal | price }} </span>\n                </strong>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"reportDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-tie\" id=\"modelTieId\">Hesap Detayı\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card checkDetail\">\n          <div class=\"card-header\">\n            <b>{{checkDetail?.table_id | general:'tables' | async}}\n              <small class=\"text-muted\"> ({{checkDetail?.timestamp | date:'dd/M/y HH:mm'}})</small>\n            </b>\n            <span class=\"pull-right text-muted\"> Hesap Türü : {{checkDetail?.payment_method}}</span>\n          </div>\n          <div class=\"card-body flow p-0\">\n            <table *ngIf=\"checkDetail?.payment_method != 'Parçalı'\" class=\"table table-striped  table-bordered table-sm mb-0\">\n              <thead class=\"thead-dark\">\n                <th width=\"6%\">#</th>\n                <th width=\"44%\">Ürün</th>\n                <th width=\"17%\">Garson</th>\n                <th width=\"14%\">Saat</th>\n                <th width=\"17%\">Fiyat</th>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let item of checkDetail?.products; let i = index;\" [ngClass]=\"{'table-danger': item.status == 3}\">\n                  <td>{{i+1}}</td>\n                  <td>{{item.name}}\n                    <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                  </td>\n                  <td>{{item.owner | general:'users' | async }}</td>\n                  <td>{{item.timestamp |date:'HH:mm'}}</td>\n                  <td>{{item.price | price}} </td>\n                </tr>\n              </tbody>\n            </table>\n            <section *ngIf=\"checkDetail?.payment_method == 'Parçalı'\">\n              <table *ngFor=\"let item of checkDetail?.payment_flow; let i = index;\" class=\"table table-sm  table-bordered table-striped mb-0\">\n                <thead class=\"thead-dark\">\n                  <th width=\"6%\">#</th>\n                  <th width=\"45%\">{{item.owner}}</th>\n                  <th width=\"15%\">{{item.method}}</th>\n                  <th width=\"15%\">{{item.timestamp | date:'HH:mm'}}</th>\n                  <th width=\"17%\">{{item.amount + item.discount | price}} </th>\n                </thead>\n                <tbody>\n                  <tr *ngIf=\"item.discount > 0\" class=\"table-info\">\n                    <td><i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i></td>\n                    <td colspan=\"3\">İndirim Tutarı</td>\n                    <td>{{item.discount | price }} </td>\n                  </tr>\n                  <tr *ngFor=\"let product of item.payed_products; let i = index;\" [ngClass]=\"{'table-danger': product.status == 3}\">\n                    <td width=\"4%\">{{i+1}}</td>\n                    <td width=\"48%\">{{product.name}}\n                      <small *ngIf=\"product.note !== '' && product.note !== undefined\" class=\"text-muted\">({{product.note}})</small>\n                    </td>\n                    <td width=\"15%\">{{product.owner | general:'users' | async }}</td>\n                    <td width=\"15%\">{{product.timestamp |date:'HH:mm'}}</td>\n                    <td width=\"17%\">{{product.price | price}} </td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-user mr-1\" aria-hidden=\"true\"></i> Ziyaretçi:\n              <span class=\"pull-right\"><i class=\"fa fa-male mr-1\" aria-hidden=\"true\"></i>{{checkDetail?.occupation?.male || \"-\" }} <i class=\"fa fa-female mr-1\" aria-hidden=\"true\"></i> {{checkDetail?.occupation?.female || \"-\"}}</span>\n            </b>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-user mr-1\" aria-hidden=\"true\"></i> Kullanıcı:\n              <span class=\"pull-right\">{{checkDetail?.owner}}</span>\n            </b>\n          </div>\n          <div *ngIf=\"checkDetail?.discount > 0\" class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> Toplam İndirim Tutarı:\n              <span class=\"pull-right\">{{checkDetail?.discount | price}} </span>\n            </b>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ödenen Miktar:\n              <span class=\"pull-right\">{{checkDetail?.total_price | price}} </span>\n            </b>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer pr-2 text-center\">\n        <button *ngIf=\"checkDetail?.type !== 3\" [disabled]=\"!permissions.cancelCheck\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#cancelDetail\" class=\"btn btn-danger btn-lg\">\n          <i class=\"fa fa-times\" aria-hidden=\"true\"></i> İptal Et</button>\n        <button (click)=\"rePrintCheck(checkDetail)\" class=\"btn btn-primary btn-lg\">\n          <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Yazdır</button>\n        <button *ngIf=\"checkDetail?.type !== 3\" [disabled]=\"!permissions.cancelCheck\" type=\"button\" class=\"btn btn-success btn-lg mr-1\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#editCheck\">\n          <i class=\"fa fa-edit\" aria-hidden=\"true\"></i> Hesap Düzelt</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"checkDetail\" class=\"modal fade\" id=\"cancelDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-tie\" id=\"modelTieId\">Hesap İptal Detayı</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"input-group\">\n          <div class=\"input-group-prepend\">\n            <div class=\"input-group-text\">\n              İptal Nedeni\n            </div>\n          </div>\n          <input #cancelNote type=\"text\" class=\"form-control form-control-lg\" placeholder=\"Açıklama Giriniz\">\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button [disabled]=\"cancelNote.value == '' || cancelNote.value == ' '\" (click)=\"cancelCheck(checkDetail._id,cancelNote.value)\" class=\"btn btn-danger btn-lg\">İptal Et</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"checkDetail\" class=\"modal fade\" id=\"editCheck\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-tie\" id=\"modelTieId\">Hesap Düzenle</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #checkEdit=\"ngForm\" (ngSubmit)=\"editCheck(checkEdit)\">\n        <div *ngIf=\"!checkDetail?.payment_flow\" class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Hesap Tutarı\n                </div>\n              </div>\n              <input type=\"number\" class=\"form-control form-control-lg\" name=\"total_price\" [ngModel]=\"checkDetail.total_price\">\n              <div class=\"input-group-append\">\n                <div class=\"input-group-text\"></div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Hesap Tipi</div>\n              </div>\n              <select name=\"payment_method\" class=\"form-control form-control-lg\" [ngModel]=\"checkDetail.payment_method\">\n                <option>Nakit</option>\n                <option>Kart</option>\n                <option>Kupon</option>\n                <option>İkram</option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <div *ngIf=\"checkDetail?.payment_flow\" class=\"modal-body\">\n          <p>Düzenlemek istediğiniz ödemeyi seçin</p>\n          <div *ngFor=\"let payment of checkDetail?.payment_flow; let i = index\">\n            <button type=\"button\" class=\"btn btn-block btn-lg btn-secondary text-left mb-1\" (click)=\"editPayment(i)\">{{payment.method}}\n              <span class=\"pull-right\">{{payment.amount | price}} </span>\n            </button>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" (click)=\"reOpenCheck(checkDetail)\" class=\"btn btn-info btn-lg\" data-dismiss=\"modal\">\n            <i class=\"fa fa-undo\"></i>\n            Hesabı Geri Aç</button>\n          <button *ngIf=\"!checkDetail?.payment_flow\" type=\"submit\" class=\"btn btn-success btn-lg\">\n            <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"paymentDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-tie\">Ödeme Düzenle</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #paymentEdit=\"ngForm\" (ngSubmit)=\"changePayment(paymentEdit)\">\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Ödeme Tutarı\n                </div>\n              </div>\n              <input type=\"number\" class=\"form-control form-control-lg\" name=\"amount\" [ngModel]=\"selectedPayment?.amount\">\n              <div class=\"input-group-append\">\n                <div class=\"input-group-text\">\n                    <i class=\"fa fa-turkish-lira fa-2x\" aria-hidden=\"true\"></i>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Ödeme Tipi</div>\n              </div>\n              <select name=\"method\" class=\"form-control form-control-lg\" [ngModel]=\"selectedPayment?.method\">\n                <option>Nakit</option>\n                <option>Kart</option>\n                <option>Kupon</option>\n                <option>İkram</option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-danger btn-lg\" data-dismiss=\"modal\" data-toggle=\"modal\" data-target=\"#editCheck\">İptal</button>\n          <button type=\"submit\" class=\"btn btn-success btn-lg\">\n            <i class=\"fa fa-check\"></i> Değiştir</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/reports/store-reports/store-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".full-flow {\n  overflow-y: scroll;\n  overflow-x: hidden; }\n\n.checkDetail {\n  height: 72vh; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/store-reports/store-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return StoreReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let StoreReportsComponent = class StoreReportsComponent {
    constructor(mainService, printerService, settingsService, messageService, logService) {
        this.mainService = mainService;
        this.printerService = printerService;
        this.settingsService = settingsService;
        this.messageService = messageService;
        this.logService = logService;
        this.NormalTotal = 0;
        this.FastTotal = 0;
        this.DeliveryTotal = 0;
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
        this.settingsService.getPrinters().subscribe(res => {
            this.printers = res.value;
        });
        this.fillData();
    }
    ngOnInit() {
        this.permissions = JSON.parse(localStorage['userPermissions']);
    }
    getDetail(check) {
        this.checkDetail = check;
        $('#reportDetail').modal('show');
    }
    filterTables(value) {
        if (value == '' || null) {
            this.fillData();
        }
        else {
            let regexp = new RegExp(value, 'i');
            this.mainService.getAllBy('tables', { name: { $regex: regexp } }).then(data => {
                if (data.docs.length > 0) {
                    let results = this.AllChecks.filter(obj => obj.table_id == data.docs[0]._id);
                    if (results.length > 0) {
                        this.NormalChecks = results;
                    }
                }
            });
        }
    }
    filterChecks(value) {
        if (this.AllChecks) {
            this.FastChecks = this.AllChecks.filter(obj => obj.owner.toLocaleLowerCase().includes(value.toLocaleLowerCase()) && obj.type == 2);
        }
    }
    getFastChecksBy(method) {
        if (this.AllChecks) {
            this.FastChecks = this.AllChecks.filter(obj => obj.payment_method == method && obj.type == 2);
        }
    }
    getNormalChecksBy(method) {
        if (this.AllChecks) {
            this.NormalChecks = this.AllChecks.filter(obj => obj.payment_method == method && obj.type == 1);
        }
    }
    rePrintCheck(check) {
        this.mainService.getData('tables', check.table_id).then(res => {
            if (check.products.length > 0) {
                this.printerService.printCheck(this.printers[0], res.name, check);
            }
            else {
                check.products = check.payment_flow.reduce((a, b) => a.payed_products.concat(b.payed_products));
                this.printerService.printCheck(this.printers[0], res.name, check);
            }
        }).catch(err => {
            this.printerService.printCheck(this.printers[0], check.table_id, check);
        });
    }
    reOpenCheck(check) {
        let checkWillReOpen;
        let discount = 0;
        if (check.payment_flow) {
            check.payment_flow.forEach(element => {
                discount += element.amount;
            });
            checkWillReOpen = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["a" /* Check */]('Hızlı Satış', 0, discount, check.owner, 'Geri Açılan', check.status, check.products, Date.now(), __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_2__mocks_check__["b" /* CheckNo */])(), check.payment_flow);
        }
        else {
            checkWillReOpen = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["a" /* Check */]('Hızlı Satış', check.total_price, check.discount, check.owner, 'Geri Açılan', check.status, check.products, Date.now(), __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_2__mocks_check__["b" /* CheckNo */])(), check.payment_flow);
        }
        this.mainService.addData('checks', checkWillReOpen).then(res => {
            this.mainService.removeData('closed_checks', check._id).then(res => {
                this.fillData();
                $('#checkDetail').modal('hide');
                this.messageService.sendAlert('Başarılı !', 'Hesap Geri Açıldı', 'success');
            });
        });
        if (check.payment_method !== 'Parçalı') {
            this.mainService.getAllBy('reports', { connection_id: check.payment_method }).then(res => {
                this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
                    doc.weekly[this.day] -= check.total_price;
                    doc.weekly_count[this.day]--;
                    return doc;
                });
            });
        }
        else {
            check.payment_flow.forEach(element => {
                this.mainService.getAllBy('reports', { connection_id: element.method }).then(res => {
                    this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
                        doc.weekly[this.day] -= element.amount;
                        return doc;
                    });
                });
            });
        }
    }
    editCheck(form) {
        let Form = form.value;
        if (this.checkDetail.payment_method !== Form.payment_method) {
            this.mainService.getAllBy('reports', { connection_id: this.checkDetail.payment_method }).then(res => {
                let docReport = res.docs[0];
                this.mainService.changeData('reports', docReport._id, (doc) => {
                    doc.weekly[this.day] -= this.checkDetail.total_price;
                    doc.weekly_count[this.day]--;
                    return doc;
                });
            });
            this.mainService.getAllBy('reports', { connection_id: Form.payment_method }).then(res => {
                let docReport = res.docs[0];
                this.mainService.changeData('reports', docReport._id, (doc) => {
                    doc.weekly[this.day] += Form.total_price;
                    doc.weekly_count[this.day]++;
                    return doc;
                });
            });
            this.mainService.updateData('closed_checks', this.checkDetail._id, { total_price: Form.total_price, payment_method: Form.payment_method }).then(res => {
                this.messageService.sendMessage('Hesap Düzenlendi!');
                this.fillData();
                $('#editCheck').modal('hide');
            });
        }
        else {
            if (this.checkDetail.total_price !== Form.total_price) {
                this.mainService.getAllBy('reports', { connection_id: this.checkDetail.payment_method }).then(res => {
                    let docReport = res.docs[0];
                    this.mainService.changeData('reports', docReport._id, (doc) => {
                        doc.weekly[this.day] -= this.checkDetail.total_price;
                        doc.weekly[this.day] += Form.total_price;
                        return doc;
                    });
                });
                this.mainService.updateData('closed_checks', this.checkDetail._id, { total_price: Form.total_price }).then(res => {
                    this.messageService.sendMessage('Hesap Düzenlendi!');
                    this.fillData();
                    $('#editCheck').modal('hide');
                });
            }
            else {
                return false;
            }
        }
        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].CHECK_UPDATED, Form._id, `${this.checkDetail.total_price} TL tutarındaki kapatılan ${this.checkDetail.payment_method} hesap ${Form.total_price} TL ${Form.payment_method} olarak güncellendi.`);
    }
    cancelCheck(id, note) {
        this.messageService.sendConfirm('Kapanmış Hesap İptal Edilecek! Bu işlem geri alınamaz!').then(isOK => {
            if (isOK) {
                this.mainService.updateData('closed_checks', id, { description: note, type: 3 }).then(res => {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].CHECK_CANCELED, id, `${this.checkDetail.total_price} TL tutarındaki kapatılan hesap iptal edildi. Açıklama:'${note}'`);
                    this.fillData();
                    $('#cancelDetail').modal('hide');
                });
            }
        });
    }
    editPayment(i) {
        $('#editCheck').modal('hide');
        this.selectedPayment = this.checkDetail.payment_flow[i];
        this.selectedPaymentIndex = i;
        $('#paymentDetail').modal('show');
    }
    changePayment(paymentDetail) {
        let Form = paymentDetail.value;
        if (Form.method !== this.selectedPayment.method) {
            this.mainService.getAllBy('reports', { connection_id: this.selectedPayment.method }).then(res => {
                let docReport = res.docs[0];
                this.mainService.changeData('reports', docReport._id, (doc) => {
                    doc.weekly[this.day] -= this.selectedPayment.amount;
                    doc.weekly_count[this.day]--;
                    return doc;
                });
                this.mainService.getAllBy('reports', { connection_id: Form.method }).then(res => {
                    let docReport = res.docs[0];
                    this.mainService.changeData('reports', docReport._id, (doc) => {
                        doc.weekly[this.day] += Form.amount;
                        doc.weekly_count[this.day]++;
                        return doc;
                    });
                }).then(res => {
                    this.checkDetail.total_price -= this.selectedPayment.amount;
                    this.checkDetail.total_price += Form.amount;
                    this.selectedPayment.amount = Form.amount;
                    this.selectedPayment.method = Form.method;
                    this.mainService.updateData('closed_checks', this.checkDetail._id, { total_price: this.checkDetail.total_price, payment_flow: this.checkDetail.payment_flow }).then(res => {
                        this.messageService.sendMessage('Hesap Düzenlendi!');
                        this.fillData();
                        $('#editCheck').modal('show');
                        $('#paymentDetail').modal('hide');
                    });
                });
            });
        }
        else {
            if (this.selectedPayment.amount !== Form.amount) {
                this.mainService.getAllBy('reports', { connection_id: this.selectedPayment.method }).then(res => {
                    let docReport = res.docs[0];
                    this.mainService.changeData('reports', docReport._id, (doc) => {
                        doc.weekly[this.day] -= this.selectedPayment.amount;
                        doc.weekly[this.day] += Form.amount;
                        return doc;
                    }).then(res => {
                        this.checkDetail.total_price -= this.selectedPayment.amount;
                        this.checkDetail.total_price += Form.amount;
                        this.selectedPayment.amount = Form.amount;
                        this.mainService.updateData('closed_checks', this.checkDetail._id, { total_price: this.checkDetail.total_price, payment_flow: this.checkDetail.payment_flow }).then(res => {
                            this.messageService.sendMessage('Hesap Düzenlendi!');
                            this.fillData();
                            $('#editCheck').modal('show');
                            $('#paymentDetail').modal('hide');
                        });
                    });
                });
            }
            else {
                return false;
            }
        }
    }
    getLogs() {
        this.mainService.getAllBy('logs', {}).then(res => {
            this.sellingLogs = res.docs.filter(obj => obj.type >= __WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].CHECK_CREATED && obj.type <= __WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].ORDER_MOVED || obj.type == __WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].DISCOUNT).sort((a, b) => b.timestamp - a.timestamp, 0);
        });
    }
    fillData() {
        this.mainService.getAllBy('closed_checks', {}).then(res => {
            if (res.docs.length > 0) {
                this.AllChecks = res.docs;
                this.AllChecks.sort((a, b) => b.timestamp - a.timestamp);
                this.NotPayedChecks = this.AllChecks.filter((obj) => obj.type == __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].CANCELED);
                this.FastChecks = this.AllChecks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].FAST);
                this.NormalChecks = this.AllChecks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].NORMAL);
                this.DeliveryChecks = this.AllChecks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].ORDER);
                this.NormalTotal = this.NormalChecks.filter(obj => obj.payment_method !== 'İkram').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
                this.FastTotal = this.FastChecks.filter(obj => obj.payment_method !== 'İkram').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
                this.DeliveryTotal = this.DeliveryChecks.filter(obj => obj.payment_method !== 'İkram').map(obj => obj.total_price).reduce((a, b) => a + b, 0);
            }
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('checkEdit'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], StoreReportsComponent.prototype, "editForm", void 0);
StoreReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-store-reports',
        template: __webpack_require__("./src/app/components/reports/store-reports/store-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/store-reports/store-reports.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_7__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_3__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_log_service__["a" /* LogService */]])
], StoreReportsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/reports/table-reports/table-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#chart\" role=\"tab\">\n      <i class=\"fa fa-bar-chart\" aria-hidden=\"true\"></i> Haftalık Grafik</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#list\" role=\"tab\">\n      <i class=\"fa fa-list\" aria-hidden=\"true\"></i> Liste</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" (click)=\"getLogs()\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-bell\" aria-hidden=\"true\"></i> Bildirimler</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"chart\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Haftalık Popüler Masa Grafiği</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeFilter($event.target.value)\">\n                <option>Tutar</option>\n                <option>Hesap Adedi</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:76vw; margin:auto;\" [datasets]=\"ChartData\"\n          [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"list\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Masa Gelir Listesi</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeListFilter($event.target.value)\">\n                <option>Genel</option>\n                <option>Haftalık</option>\n                <option>Günlük</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body p-0 tab-height\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Bölümler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button type=\"button\" (click)=\"fillData();\" [ngClass]=\"{'list-group-item-warning' : selectedCat == undefined}\"\n                    class=\"list-group-item list-group-item-action list-eq\">\n                    Bütün Bölümler\n                  </button>\n                  <button *ngFor=\"let cat of floorsList\" type=\"button\" [ngClass]=\"{'list-group-item-warning' : selectedCat == cat._id}\"\n                    (click)=\"getReportsByCategory(cat._id)\" class=\"list-group-item list-group-item-action list-eq\">\n                    {{cat.name}}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Masalar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <table class=\"table table-sm  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr >\n                      <th class=\"text-center\" width=\"8%\">#</th>\n                      <th class=\"text-center\" width=\"42%\">Masa Adı</th>\n                      <th class=\"text-right\" width=\"20%\">Hesap</th>\n                      <th class=\"text-right\" width=\"30%\">Getiri</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let item of tablesList; let i = index\" (click)=\"getItemReport(item)\">\n                      <td class=\"text-center\">{{i+1}}</td>\n                      <td style=\"text-transform:capitalize;\">\n                        {{item.description}}\n                        <small class=\"pull-right\"><i class=\"fa fa-clock-o\"></i> {{item.timestamp | timeAgo }}</small>\n                      </td>\n                      <td class=\"text-right\">{{item.count | number:'1.0-2'}} Adet</td>\n                      <td class=\"text-right\">{{item.amount | price }}</td>\n                    </tr>\n                  </tbody>\n                </table>\n                <!-- <table class=\"table  table-bordered table-striped table-hover\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th width=\"6%\">#</th>\n                      <th width=\"29%\">Masa</th>\n                      <th width=\"20%\">Hesap Sayısı</th>\n                      <th width=\"20%\">Toplam Gelir</th>\n                      <th width=\"25%\">Son Güncellenme</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let item of tablesList; let i = index\" (click)=\"getItemReport(item)\">\n                      <td>{{i+1}}</td>\n                      <td>{{item.description}}</td>\n                      <td>{{item.count}} Adet</td>\n                      <td>{{item.amount | number:'1.0-2'}} TL</td>\n                      <td>{{item.timestamp | date: 'd/M/y HH:mm'}}</td>\n                    </tr>\n                  </tbody>\n                </table> -->\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"notifications\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Bildirimler</h5>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table table-striped  table-bordered\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"10%\">Kullanıcı</th>\n              <th>Açıklama</th>\n              <th width=\"25%\" colspan=\"2\">Tarih</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let log of tableLogs\">\n              <td>{{log.user}}</td>\n              <td>{{log.description}}</td>\n              <td>{{log.timestamp | date:'HH:mm'}}</td>\n              <td>{{log.timestamp | date:'dd/M/y'}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"reportDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">{{ItemReport?.connection_id | general:'tables' | async}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <canvas *ngIf=\"DetailLoaded\" baseChart style=\"height: 350px; width:790px; margin:auto;\" [datasets]=\"DetailData\"\n          [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/reports/table-reports/table-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/table-reports/table-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TableReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_log__ = __webpack_require__("./src/app/mocks/log.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let TableReportsComponent = class TableReportsComponent {
    constructor(mainService) {
        this.mainService = mainService;
        this.ChartOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return ' ' + Number(value.yLabel).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
        this.ChartLabels = ['Pzt', 'Sa', 'Ça', 'Pe', 'Cu', 'Cmt', 'Pa'];
        this.ChartLegend = true;
        this.ChartType = 'bar';
        this.DetailLoaded = false;
        this.DetailData = [];
    }
    ngOnInit() {
        this.fillData(false);
    }
    normalWeekOrder(array) {
        var arrayLength = array.length;
        for (var i = 0; i < arrayLength - 1; i++) {
            var temp = array[i];
            array[i] = array[i + 1];
            array[i + 1] = temp;
        }
        return array;
    }
    dailyCount(arr, price) {
        let newArray = [];
        for (let item of arr) {
            item = item / price;
            newArray.push(item);
        }
        return newArray;
    }
    changeFilter(value) {
        switch (value) {
            case 'Hesap Adedi':
                this.fillData(true);
                break;
            case 'Tutar':
                this.fillData(false);
                break;
            default:
                break;
        }
    }
    getItemReport(report) {
        this.DetailLoaded = false;
        this.ItemReport = report;
        this.mainService.getData('reports', report._id).then(res => {
            res.weekly = this.normalWeekOrder(res.weekly);
            res.weekly_count = this.normalWeekOrder(res.weekly_count);
            this.DetailData = [{ data: res.weekly, label: 'Hesap Tutarı' }]; // { data: res.weekly_count, label: 'Hesap Adedi' }
            this.DetailLoaded = true;
            $('#reportDetail').modal('show');
        });
    }
    changeListFilter(value) {
        let newArray = [];
        switch (value) {
            case 'Genel':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                break;
            case 'Günlük':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count[new Date().getDay()];
                    obj.amount = obj.weekly[new Date().getDay()];
                });
                break;
            case 'Haftalık':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count.reduce((a, b) => a + b);
                    obj.amount = obj.weekly.reduce((a, b) => a + b);
                });
                break;
            default:
                break;
        }
        newArray = newArray.sort((a, b) => b.count - a.count);
        this.tablesList = newArray;
        if (this.selectedCat) {
            this.mainService.getAllBy('tables', { floor_id: this.selectedCat }).then(res => {
                let floors_ids = res.docs.map(obj => obj._id);
                this.tablesList = this.tablesList.filter(obj => floors_ids.includes(obj.connection_id));
            });
        }
    }
    getReportsByCategory(cat_id) {
        this.selectedCat = cat_id;
        this.mainService.getAllBy('tables', { floor_id: cat_id }).then(res => {
            let floors_ids = res.docs.map(obj => obj._id);
            this.tablesList = this.generalList.filter(obj => floors_ids.includes(obj.connection_id));
        });
    }
    getLogs() {
        this.mainService.getAllBy('logs', {}).then(res => {
            this.tableLogs = res.docs.filter(obj => obj.type >= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].TABLE_CREATED && obj.type <= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].TABLE_CHECKPOINT).sort((a, b) => b.timestamp - a.timestamp);
        });
    }
    fillData(daily) {
        this.selectedCat = undefined;
        this.ChartData = [];
        this.ChartLoaded = false;
        this.mainService.getAllBy('reports', { type: 'Table' }).then(res => {
            this.generalList = res.docs.sort((a, b) => b.count - a.count);
            this.tablesList = JSON.parse(JSON.stringify(this.generalList));
            let chartTable = this.tablesList.slice(0, 5);
            chartTable.forEach((obj, index) => {
                this.mainService.getData('tables', obj.connection_id).then(res => {
                    obj.weekly = this.normalWeekOrder(obj.weekly);
                    obj.weekly_count = this.normalWeekOrder(obj.weekly_count);
                    let schema;
                    if (daily) {
                        schema = { data: obj.weekly_count, label: res.name };
                    }
                    else {
                        schema = { data: obj.weekly, label: res.name };
                    }
                    this.ChartData.push(schema);
                    if (chartTable.length - 1 == index) {
                        this.ChartLoaded = true;
                    }
                    ;
                });
            });
        });
        this.mainService.getAllBy('floors', {}).then(res => {
            this.floorsList = res.docs;
        });
    }
};
TableReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-table-reports',
        template: __webpack_require__("./src/app/components/reports/table-reports/table-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/table-reports/table-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */]])
], TableReportsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/reports/user-reports/user-reports.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#general\" role=\"tab\">\n      <i class=\"fa fa-bar-chart\" aria-hidden=\"true\"></i> Aktivite Grafiği</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#list\" role=\"tab\">\n      <i class=\"fa fa-th\" aria-hidden=\"true\"></i> Kullanıcı Listesi</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" (click)=\"getLogs()\" data-toggle=\"tab\" href=\"#notifications\" role=\"tab\">\n      <i class=\"fa fa-bell\" aria-hidden=\"true\"></i> Bildirimler</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"general\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Haftalık Kullanıcı Aktivite Grafiği</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeFilter($event.target.value)\">\n                <option>Satış Tutarı</option>\n                <option>Sipariş Adedi</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <canvas *ngIf=\"ChartLoaded\" baseChart style=\"height: 468px; width:76vw; margin:auto;\" [datasets]=\"ChartData\"\n          [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"list\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Kullanıcı Listesi</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\">Filtre</div>\n              </div>\n              <select class=\"form-control\" (change)=\"changeListFilter($event.target.value)\">\n                <option>Genel</option>\n                <option>Haftalık</option>\n                <option>Günlük</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table  table-bordered table-striped table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"6%\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n              </th>\n              <th width=\"29%\">Kullanıcı</th>\n              <th width=\"20%\">Sipariş Adedi</th>\n              <th width=\"20%\">Satış Tutarı</th>\n              <th width=\"25%\">Son Satış</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let item of usersList; let i = index\" (click)=\"getItemReport(item)\">\n              <td>{{i+1}}</td>\n              <td>{{item.connection_id | general: 'users' | async}}</td>\n              <td>{{item.count}} Adet</td>\n              <td>{{item.amount | number:'1.0-2' }} TL</td>\n              <td>{{item.timestamp | date: 'd/M/y HH:mm'}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"notifications\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Bildirimler</h5>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table table-striped  table-bordered\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"10%\">Kullanıcı</th>\n              <th>Açıklama</th>\n              <th width=\"25%\" colspan=\"2\">Tarih</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let log of userLogs\">\n              <td>{{log.user}}</td>\n              <td>{{log.description}}</td>\n              <td>{{log.timestamp | date:'HH:mm'}}</td>\n              <td>{{log.timestamp | date:'dd/M/y'}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"reportDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">{{ItemReport?.connection_id | general:'users' | async}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <canvas *ngIf=\"DetailLoaded\" baseChart style=\"height: 350px; width:790px; margin:auto;\" [datasets]=\"DetailData\"\n          [labels]=\"ChartLabels\" [options]=\"ChartOptions\" [legend]=\"ChartLegend\" [chartType]=\"ChartType\"></canvas>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/reports/user-reports/user-reports.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/reports/user-reports/user-reports.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UserReportsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_log__ = __webpack_require__("./src/app/mocks/log.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let UserReportsComponent = class UserReportsComponent {
    constructor(mainService) {
        this.mainService = mainService;
        this.ChartOptions = {
            responsive: false,
            legend: {
                labels: {
                    fontColor: 'rgb(255, 255, 255)',
                    fontStyle: 'bolder'
                }
            },
            tooltips: {
                callbacks: {
                    label: function (value) {
                        return ' ' + Number(value.yLabel).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                    }
                }
            },
            elements: {
                line: {
                    tension: 0.5,
                }
            },
            scales: {
                xAxes: [{
                        ticks: {
                            beginAtZero: true,
                            fontColor: 'rgba(255,255,255)'
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }],
                yAxes: [{
                        ticks: {
                            fontColor: 'rgba(255,255,255)',
                            callback: function (value, index, values) {
                                return value.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') + ' ₺';
                            }
                        },
                        gridLines: {
                            color: 'rgba(255,255,255)',
                            lineWidth: 0.4
                        }
                    }]
            },
        };
        this.ChartLabels = ['Pzt', 'Sa', 'Ça', 'Pe', 'Cu', 'Cmt', 'Pa'];
        this.ChartLegend = true;
        this.ChartType = 'bar';
        this.DetailLoaded = false;
        this.DetailData = [];
        this.fillData(false);
    }
    ngOnInit() {
    }
    normalWeekOrder(array) {
        var arrayLength = array.length;
        for (var i = 0; i < arrayLength - 1; i++) {
            var temp = array[i];
            array[i] = array[i + 1];
            array[i + 1] = temp;
        }
        return array;
    }
    changeFilter(value) {
        switch (value) {
            case 'Sipariş Adedi':
                this.fillData(true);
                break;
            case 'Satış Tutarı':
                this.fillData(false);
                break;
            default:
                break;
        }
    }
    getItemReport(report) {
        this.DetailLoaded = false;
        this.ItemReport = report;
        let detailLabel;
        this.mainService.getData('reports', report._id).then(res => {
            res.weekly = this.normalWeekOrder(res.weekly);
            res.weekly_count = this.normalWeekOrder(res.weekly_count);
            this.DetailData = [{ data: res.weekly, label: 'Sipariş Tutarı' }, { data: res.weekly_count, label: 'Sipariş Adedi' }];
            this.DetailLoaded = true;
            $('#reportDetail').modal('show');
        });
    }
    changeListFilter(value) {
        let newArray = [];
        switch (value) {
            case 'Genel':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                break;
            case 'Günlük':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count[new Date().getDay()];
                    obj.amount = obj.weekly[new Date().getDay()];
                });
                break;
            case 'Haftalık':
                newArray = JSON.parse(JSON.stringify(this.generalList));
                newArray.filter((obj) => {
                    obj.count = obj.weekly_count.reduce((a, b) => a + b);
                    obj.amount = obj.weekly.reduce((a, b) => a + b);
                });
                break;
            default:
                break;
        }
        newArray = newArray.sort((a, b) => b.count - a.count);
        this.usersList = newArray;
    }
    getLogs() {
        this.mainService.getAllBy('logs', {}).then(res => {
            this.userLogs = res.docs.filter(obj => obj.type >= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].USER_CREATED && obj.type <= __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].USER_CHECKPOINT || obj.type == __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b" /* logType */].ORDER_CREATED).sort((a, b) => b.timestamp - a.timestamp);
        });
    }
    fillData(daily) {
        this.mainService.getAllBy('reports', { type: 'User' }).then(res => {
            this.usersList = res.docs;
        });
        this.ChartData = [];
        this.ChartLoaded = false;
        this.mainService.getAllBy('reports', { type: 'User' }).then(res => {
            this.generalList = res.docs.sort((a, b) => b.count - a.count);
            this.usersList = JSON.parse(JSON.stringify(this.generalList));
            let chartTable = this.usersList.slice(0, 5);
            chartTable.forEach((obj, index) => {
                this.mainService.getData('users', obj.connection_id).then(res => {
                    obj.weekly = this.normalWeekOrder(obj.weekly);
                    obj.weekly_count = this.normalWeekOrder(obj.weekly_count);
                    let schema;
                    if (daily) {
                        schema = { data: obj.weekly_count, label: res.name };
                    }
                    else {
                        schema = { data: obj.weekly, label: res.name };
                    }
                    this.ChartData.push(schema);
                    if (chartTable.length - 1 == index) {
                        this.ChartLoaded = true;
                    }
                    ;
                });
            });
        });
    }
};
UserReportsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-user-reports',
        template: __webpack_require__("./src/app/components/reports/user-reports/user-reports.component.html"),
        styles: [__webpack_require__("./src/app/components/reports/user-reports/user-reports.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__services_main_service__["a" /* MainService */]])
], UserReportsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/application-settings/application-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#general\" role=\"tab\">\n      <i class=\"fa fa-cog\" aria-hidden=\"true\"></i> Program</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#printer\" role=\"tab\">\n      <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Yazıcılar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#store\" role=\"tab\">\n      <i class=\"fa fa-briefcase\" aria-hidden=\"true\"></i> İşletme</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#account\" role=\"tab\">\n      <i class=\"fa fa-asterisk\" aria-hidden=\"true\"></i> Hesap</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"general\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Genel Ayarlar</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button data-toggle=\"modal\" data-target=\"#adminModal\" class=\"btn btn-danger btn-block\">Uygulama Konsolu</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Ayarlar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"getSettingsDetail('AppSettings')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'AppSettings'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n                    Uygulama Ayarları\n                  </button>\n                  <button (click)=\"getSettingsDetail('ServerSettings')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'ServerSettings'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n                    Sunucu Ayarları\n                  </button>\n                  <button (click)=\"getSettingsDetail('CurrencySettings')\" [ngClass]=\"{'list-group-item-warning' : currentSection == 'CurrencySettings'}\" type=\"button\" class=\"list-group-item list-group-item-action\">\n                    Döviz Ayarları\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <section [hidden]=\"currentSection !== 'AppSettings'\">\n              <form #settingsForm=\"ngForm\" (ngSubmit)=\"saveSettings(settingsForm)\">\n                <div class=\"card tab-inside-height\">\n                  <div class=\"card-header\">Uygulama Ayarları</div>\n                  <div class=\"card-body flow p-2\">\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group text-center\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Zaman Aşımı</div>\n                        </div>\n                        <input name=\"timeout\" type=\"number\" class=\"form-control form-control-lg\" ngModel />\n                        <div class=\"input-group-append\">\n                          <div class=\"input-group-text\">Saniye</div>\n                        </div>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Ekran Klavyesi</div>\n                        </div>\n                        <select name=\"keyboard\" class=\"form-control form-control-lg\" id=\"\" ngModel>\n                          <option>Açık</option>\n                          <option>Kapalı</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\"> Parakende Satış</div>\n                        </div>\n                        <select name=\"takeaway\" class=\"form-control form-control-lg\" id=\"\" ngModel>\n                          <option>Açık</option>\n                          <option>Kapalı</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sipariş Fişi İçin</div>\n                        </div>\n                        <select name=\"ask_print_order\" class=\"form-control form-control-lg\" ngModel>\n                          <option>Sor</option>\n                          <option>Sorma</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Hesap Fişi İçin</div>\n                        </div>\n                        <select name=\"ask_print_check\" class=\"form-control form-control-lg\" ngModel>\n                          <option>Sor</option>\n                          <option>Sorma</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Son Gün</div>\n                        </div>\n                        <select name=\"last_day\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"1\">Pazartesi</option>\n                          <option value=\"2\">Salı</option>\n                          <option value=\"3\">Çarşamba</option>\n                          <option value=\"4\">Perşembe</option>\n                          <option value=\"5\">Cuma</option>\n                          <option value=\"6\">Cumartesi</option>\n                          <option value=\"0\">Pazar</option>\n                        </select>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"card-footer\">\n                    <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                      <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ayarları Kaydet</button>\n                  </div>\n                </div>\n              </form>\n            </section>\n            <section [hidden]=\"currentSection !== 'ServerSettings'\">\n              <form #serverSettingsForm=\"ngForm\" (ngSubmit)=\"saveServerSettings(serverSettingsForm)\">\n                <div class=\"card tab-inside-height\">\n                  <div class=\"card-header\">Sunucu Ayarları</div>\n                  <div class=\"card-body p-2 flow\">\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sunucu Modu</div>\n                        </div>\n                        <select name=\"type\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"0\">Birincil</option>\n                          <option value=\"1\">İkincil</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sunucu Durumu</div>\n                        </div>\n                        <select name=\"status\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"0\">Kapalı</option>\n                          <option value=\"1\">Açık</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sunucu Adresi</div>\n                        </div>\n                        <input type=\"text\" name=\"ip_address\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sunucu Portu</div>\n                        </div>\n                        <input type=\"text\" name=\"ip_port\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Sunucu Anahtarı</div>\n                        </div>\n                        <textarea rows=\"3\" name=\"key\" class=\"form-control form-control-lg\" ngModel></textarea>\n                        <div class=\"input-group-append\">\n                          <button type=\"button\" (click)=\"generateKey(serverSettingsForm)\" class=\"btn btn-primary\">\n                            <i class=\"fa fa-key\"></i>\n                            <br> Anahtar Üret</button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"card-footer\">\n                    <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                      <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ayarları Kaydet</button>\n                  </div>\n                </div>\n              </form>\n            </section>\n            <section [hidden]=\"currentSection !== 'AccountSettings'\">\n              <!-- <form #restaurantForm=\"ngForm\" (ngSubmit)=\"saveRestSettings(restaurantForm)\">\n                <input type=\"hidden\" name=\"state\" ngModel />\n                <input type=\"hidden\" name=\"city\" ngModel />\n                <input type=\"hidden\" name=\"geolocation\" ngModel />\n                <input type=\"hidden\" name=\"_order\" ngModel />\n                <input type=\"hidden\" name=\"created_at\" ngModel />\n                <input type=\"hidden\" name=\"logo\" ngModel />\n                <input type=\"hidden\" name=\"is_premium\" ngModel />\n                <input type=\"hidden\" name=\"owner\" ngModel />\n                <div class=\"card tab-inside-height\">\n                  <div class=\"card-header\">\n                    Hesap Ayarları\n                  </div>\n                  <div class=\"card-body flow p-2\">\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">İşletme Logo</div>\n                        </div>\n                        <div class=\"img-thumbnail subCatInput\">\n                          <img src=\"{{appLogo}}\" class=\"img-responsive mx-auto d-body\" alt=\"\">\n                        </div>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">İşletme Adı</div>\n                        </div>\n                        <input name=\"name\" type=\"text\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">İşletme No</div>\n                        </div>\n                        <input name=\"_id\" type=\"string\" class=\"form-control form-control-lg\" readonly ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Telefon</div>\n                        </div>\n                        <input name=\"phone_number\" type=\"text\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Şehir</div>\n                        </div>\n                        <input name=\"city\" type=\"text\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Bölge</div>\n                        </div>\n                        <input name=\"state\" type=\"text\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Adres</div>\n                        </div>\n                        <textarea name=\"address\" rows=\"2\" class=\"form-control form-control-lg\" ngModel></textarea>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"card-footer\">\n                    <button type=\"submit\" class=\"btn btn-success btn-block btn-md\">\n                      <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ayarları Kaydet</button>\n                  </div>\n                </div>\n              </form> -->\n            </section>\n            <section [hidden]=\"currentSection !== 'CurrencySettings'\">\n              <form #currencySettingsForm=\"ngForm\" (ngSubmit)=\"saveCurrencySettings(currencySettingsForm)\">\n                <div class=\"card tab-inside-height\">\n                  <div class=\"card-header\">\n                    Hesap Ayarları\n                  </div>\n                  <div class=\"card-body flow p-2\">\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Dolar</div>\n                        </div>\n                        <input name=\"USD\" type=\"number\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Euro</div>\n                        </div>\n                        <input name=\"EUR\" type=\"number\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Pound - Sterlin</div>\n                        </div>\n                        <input name=\"GBP\" type=\"number\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n\n                  </div>\n                  <div class=\"card-footer\">\n                    <button type=\"submit\" class=\"btn btn-success btn-block btn-md\">\n                      <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Ayarları Kaydet</button>\n                  </div>\n                </div>\n              </form>\n            </section>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n\n  <div class=\"tab-pane\" id=\"printer\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Yazıcı Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#printerModal\">\n              <i class=\"fa fa-plus\"></i> Yazıcı Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Yazıcılar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button *ngFor=\"let item of printers\" (click)=\"getPrinterDetail(item)\" type=\"button\" class=\"list-group-item list-group-item-action\">\n                    {{item.name}} ({{item.type}} Yazıcı)\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #printerDetailForm=\"ngForm\" (ngSubmit)=\"updatePrinter(printerDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Detaylar\n                </div>\n                <div class=\"card-body flow p-2\">\n                  <section [hidden]=\"choosenPrinter == undefined\" id=\"detailForm\">\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Yazıcı Adı</div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Açıklama</div>\n                        </div>\n                        <textarea name=\"note\" rows=\"3\" class=\"form-control form-control-lg\" ngModel></textarea>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Tip</div>\n                        </div>\n                        <input type=\"text\" readonly name=\"type\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Adres</div>\n                        </div>\n                        <input type=\"text\" readonly name=\"device_port\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Tür</div>\n                        </div>\n                        <select name=\"mission\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"Adisyon\">Hesap Yazıcısı</option>\n                          <option value=\"Sipariş\">Sipariş Yazıcısı</option>\n                        </select>\n                      </div>\n                    </div>\n                  </section>\n                  <h1 *ngIf=\"choosenPrinter == undefined\" class=\"text-center mt-5\">Listeden Yazıcı Seçiniz</h1>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"choosenPrinter == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col-lg-4 pr-1\">\n                      <button type=\"button\" (click)=\"removePrinter(choosenPrinter)\" class=\"btn btn-md btn-danger btn-block \">\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Yazıcıyı Kaldır\n                      </button>\n                    </div>\n                    <div class=\"col-lg-4 pr-1 pl-1\">\n                      <button type=\"button\" (click)=\"printTest(choosenPrinter)\" class=\"btn btn-md btn-warning btn-block \">\n                        <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Sınama Yazdır\n                      </button>\n                    </div>\n                    <div class=\"col-lg-4 pl-1\">\n                      <button type=\"submit\" class=\"btn btn-md btn-success btn-block\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Kaydet\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n\n  <div class=\"tab-pane\" id=\"server\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Sunucu Durumu</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"adminModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Uygulama Konsolu</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <input #adminPass type=\"password\" placeholder=\"Şifre Giriniz\" class=\"form-control form-control-lg\">\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button type=\"button\" (click)=\"makeAdmin(adminPass.value); adminPass.value = '';\" class=\"btn btn-primary btn-lg\">Giriş Yap</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div class=\"modal fade\" id=\"printerModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Yazıcı Ekle</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #printerForm=\"ngForm\" (ngSubmit)=\"addPrinter(printerForm)\">\n        <div class=\"modal-body\">\n          <section *ngIf=\"printerProcess == undefined\" id=\"selection\">\n            <p class=\"text-muted\">Lütfen eklemek istediğiniz yazıcı tipini seçiniz.</p>\n            <div class=\"row\">\n              <div class=\"col-lg-6 pr-2\">\n                <button type=\"button\" (click)=\"getPrinters('USB')\" class=\"btn btn-primary btn-lg btn-block\">\n                  <i class=\"fa fa-usb\" aria-hidden=\"true\"></i> USB</button>\n              </div>\n              <div class=\"col-lg-6 pl-2\">\n                <button type=\"button\" (click)=\"getPrinters('LAN')\" class=\"btn btn-primary btn-lg btn-block\">\n                  <i class=\"fa fa-sitemap\" aria-hidden=\"true\"></i> LAN</button>\n              </div>\n            </div>\n            <div class=\"row mt-2\">\n              <div class=\"col-lg-6 pr-2\">\n                <button type=\"button\" (click)=\"getPrinters('SERIAL')\" class=\"btn btn-primary btn-lg btn-block\">\n                  <i class=\"fa fa-plug\" aria-hidden=\"true\"></i> SERIAL</button>\n              </div>\n              <div class=\"col-lg-6 pl-2\">\n                <button type=\"button\" (click)=\"getPrinters('BLUETOOTH')\" class=\"btn btn-primary btn-lg btn-block\">\n                  <i class=\"fa fa-bluetooth\" aria-hidden=\"true\"></i> BLUETOOTH</button>\n              </div>\n            </div>\n          </section>\n          <section *ngIf=\"printerProcess !== undefined\" id=\"form\">\n            <section *ngIf=\"printersFound !== undefined && selectedPrinter == undefined\" id=\"usbPrinters\">\n              <p class=\"text-muted\">Kurulum yapmak istediğiniz yazıcıyı seçiniz.</p>\n              <div class=\"row\">\n                <div *ngFor=\"let item of printersFound\" class=\"col\">\n                  <div class=\"card p-3 card-primary text-white\">\n                    <div class=\"card-body\">\n                      <h4 class=\"card-title\">\n                        <i class=\"fa fa-print\" aria-hidden=\"true\"></i> USB Yazıcı</h4>\n                      <p class=\"card-text\">Bulunduğu Port: {{item.portNumbers[0]}}</p>\n                      <div class=\"row\">\n                        <div class=\"col-lg-6 pr-1\">\n                          <button type=\"button\" (click)=\"printTest(item)\" class=\"btn btn-md btn-secondary btn-block\">\n                            <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Sınama Yazdır\n                          </button>\n                        </div>\n                        <div class=\"col-lg-6 pl-1\">\n                          <button type=\"button\" (click)=\"selectedPrinter = item\" class=\"btn btn-md btn-success btn-block\">\n                            <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Yazıcıyı Seç\n                          </button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </section>\n            <section *ngIf=\"selectedPrinter !== undefined\" id=\"printerFormHolder\">\n              <h4 class=\"font-weight-bold mb-3\">{{printerProcess}} Yazıcı\n                <span *ngIf=\"printerProcess == 'USB'\" class=\"pull-right text-muted\">Bulunduğu Port: {{selectedPrinter.portNumbers[0]}}</span>\n              </h4>\n              <div class=\"form-group\">\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">\n                      Yazıcı Adı\n                    </div>\n                  </div>\n                  <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">\n                      Açıklama\n                    </div>\n                  </div>\n                  <input type=\"text\" name=\"note\" class=\"form-control form-control-lg\" ngModel>\n                </div>\n                <div *ngIf=\"printerProcess == 'LAN'\" class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">\n                      IP Adresi\n                    </div>\n                  </div>\n                  <input type=\"text\" name=\"port_number\" class=\"form-control form-control-lg\" ngModel>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">\n                      Tür\n                    </div>\n                  </div>\n                  <select name=\"mission\" class=\"form-control form-control-lg\" ngModel>\n                    <option value=\"Adisyon\">Hesap Yazıcısı</option>\n                    <option value=\"Sipariş\">Sipariş Yazıcısı</option>\n                  </select>\n                </div>\n              </div>\n            </section>\n          </section>\n        </div>\n        <div *ngIf=\"selectedPrinter !== undefined\" class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">İptal</button>\n          <button type=\"submit\" class=\"btn btn-danger btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/settings/application-settings/application-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/application-settings/application-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ApplicationSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mocks_settings__ = __webpack_require__("./src/app/mocks/settings.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let ApplicationSettingsComponent = class ApplicationSettingsComponent {
    constructor(settings, mainService, router, printerService, electronService, message) {
        this.settings = settings;
        this.mainService = mainService;
        this.router = router;
        this.printerService = printerService;
        this.electronService = electronService;
        this.message = message;
        this.appLogo = "";
        this.fillData();
    }
    ngOnInit() {
        this.currentSection = 'AppSettings';
        this.settings.AppSettings.subscribe(res => {
            this.appSettings = res.value;
            this.settingsForm.setValue(this.appSettings);
        });
        this.settings.RestaurantInfo.subscribe(res => {
            delete res.value.auth;
            delete res.value.remote;
            delete res.value.settings;
            this.restInfo = res.value;
            this.restMap = res.value.geolocation;
            this.appLogo = this.restInfo.logo;
            // if (this.restInfo.last_seen) delete this.restInfo.last_seen;
            // this.restaurantForm.setValue(this.restInfo);
        });
        this.settings.ServerSettings.subscribe(res => {
            this.serverSettingsForm.setValue(res.value);
        });
        this.mainService.getAllBy('settings', { key: 'CurrencySettings' }).then(currencySettings => {
            console.log(currencySettings.docs[0].value);
            this.currencySettingsForm.setValue(currencySettings.docs[0].value);
        }).catch(err => {
            console.log(err);
        });
    }
    getSettingsDetail(section) {
        this.currentSection = section;
    }
    saveSettings(Form) {
        this.settings.setAppSettings('AppSettings', Form.value);
        this.message.sendMessage('Ayarlar Kaydediliyor.. Program Yeniden Başlatılıyor.');
        setTimeout(() => {
            this.electronService.reloadProgram();
        }, 1500);
    }
    saveRestSettings(Form) {
        this.settings.setAppSettings('RestaurantInfo', Form.value);
        this.message.sendMessage('Ayarlar Kaydediliyor.. Program Yeniden Başlatılıyor.');
        setTimeout(() => {
            this.electronService.reloadProgram();
        }, 1500);
    }
    saveCurrencySettings(Form) {
        console.log(Form.value);
        this.settings.setAppSettings('CurrencySettings', Form.value);
        this.message.sendMessage('Döviz Ayarları Kaydediliyor.. ');
        // setTimeout(() => {
        //   this.electronService.reloadProgram();
        // }, 1500)
    }
    saveServerSettings(Form) {
        this.settings.setAppSettings('ServerSettings', Form.value);
        this.message.sendMessage('Sunucu Ayarları Kaydediliyor.. Makina Yeniden Başlatılıyor.');
        setTimeout(() => {
            this.electronService.ipcRenderer.send('closeServer');
            this.electronService.relaunchProgram();
        }, 1500);
    }
    generateKey(Form) {
        let newKey = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        Form.value.key = newKey;
        Form.value.ip_address = this.electronService.getLocalIP();
        this.serverSettingsForm.setValue(Form.value);
    }
    getPrinterDetail(printer) {
        this.choosenPrinter = printer;
        this.printerDetailForm.setValue(printer);
    }
    addPrinter(Form) {
        let form = Form.value;
        let address;
        if (form.port_number == undefined) {
            address = this.selectedPrinter.portNumbers[0];
        }
        if (form.name) {
            if (this.printerProcess == 'LAN') {
                if (form.port_number) {
                    address = form.port_number;
                }
                else {
                    this.message.sendMessage('IP Adresi Girmek Zorundasınız.');
                    return false;
                }
            }
            let printer = new __WEBPACK_IMPORTED_MODULE_4__mocks_settings__["c" /* Printer */](form.name, this.printerProcess, form.note, address, form.mission);
            let printersData = this.printers.filter(obj => obj.name == form.name);
            if (printersData.length == 0) {
                this.settings.addPrinter(printer);
                $('#printerModal').modal('hide');
                this.message.sendMessage('Yazıcı Oluşturuldu.');
                this.fillData();
            }
            else {
                this.message.sendMessage('Farklı Bir İsim Girmek Zorundasınız');
            }
        }
        else {
            this.message.sendMessage('Yazıcı Adı Girmek Zorundasınız.');
            return false;
        }
    }
    updatePrinter(Form) {
        let form = Form.value;
        this.settings.updatePrinter(form, this.choosenPrinter);
        this.choosenPrinter = undefined;
        this.message.sendMessage('Yazıcı Düzenlendi.');
        this.fillData();
    }
    removePrinter(Printer) {
        this.settings.removePrinter(Printer);
        this.message.sendMessage('Yazıcı Kaldırıldı..');
        this.choosenPrinter = undefined;
        this.fillData();
    }
    getPrinters(Type) {
        switch (Type) {
            case 'USB':
                if (this.printerService.getUSBPrinters().length > 0) {
                    this.printerProcess = 'USB';
                    this.printersFound = this.printerService.getUSBPrinters();
                }
                else {
                    this.message.sendMessage('USB portlarında takılı yazıcı bulunamadı..');
                    return false;
                }
                break;
            case 'LAN':
                this.printerProcess = 'LAN';
                this.printersFound = [];
                this.selectedPrinter = {};
                break;
            case 'SERIAL':
                this.printerProcess = 'SERIAL';
                this.printersFound = this.printerService.getSerialPrinters('/dev/ttyS0');
                this.selectedPrinter = {};
                break;
            case 'BLUETOOTH':
                this.printerProcess = 'BLUETOOTH';
                this.printersFound = [];
                this.selectedPrinter = {};
                break;
            default:
                break;
        }
    }
    printTest(Device) {
        this.printerService.printTest(Device);
    }
    makeAdmin(pass) {
        if (pass === 'asdtd155+1' || pass === "1551903") {
            this.router.navigate(['/admin']);
            this.electronService.openDevTools();
        }
        else {
            alert('Yanlış Şifre');
        }
        $('#adminModal').modal('hide');
    }
    setDefault() {
        this.printerForm.reset();
        this.choosenPrinter = undefined;
        this.printerProcess = undefined;
        this.selectedPrinter = undefined;
    }
    fillData() {
        this.settings.getPrinters().subscribe(res => this.printers = res.value);
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('settingsForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "settingsForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('appServerForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "appServerForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('restaurantForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "restaurantForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('printerForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "printerForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('printerDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "printerDetailForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('serverSettingsForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "serverSettingsForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('currencySettingsForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], ApplicationSettingsComponent.prototype, "currencySettingsForm", void 0);
ApplicationSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-application-settings',
        template: __webpack_require__("./src/app/components/settings/application-settings/application-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/application-settings/application-settings.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_8__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_8__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_3__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_7__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_5__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_6__providers_message_service__["a" /* MessageService */]])
], ApplicationSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/cashbox-settings/cashbox-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#categories\" role=\"tab\">\n      <i class=\"fa fa-book\" aria-hidden=\"true\"></i> Kategoriler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#table\" role=\"tab\">\n      <!-- <i class=\"fa fa-square\" aria-hidden=\"true\"></i> - -->\n     </a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#store\" role=\"tab\">\n      <!-- <i class=\"fa fa-map-marker\" aria-hidden=\"true\"></i> - -->\n    </a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#store\" role=\"tab\">\n      <!-- <i class=\"fa fa-suitcase\" aria-hidden=\"true\"></i> - -->\n    </a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"categories\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Gider Kategorileri</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#cashboxCatModal\">\n              <i class=\"fa fa-plus\"></i> Gider Kategorisi Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let item of categories\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getCategory(item)\" [ngClass]=\"{'list-group-item-warning' : selectedCategory == item._id}\" type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #cashboxDetailForm=\"ngForm\" (ngSubmit)=\"updateCategory(cashboxDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedCategory == undefined\" class=\"text-center mt-5\">Listeden Kategori Seçiniz</h1>\n                  <div [hidden]=\"selectedCategory == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel>\n                    <input type=\"hidden\" name=\"_rev\" ngModel>\n                    <input type=\"hidden\" name=\"timestamp\" ngModel>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Kategori Adı\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Açıklama\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedCategory == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col pr-1\">\n                      <button type=\"button\" (click)=\"removeCategory()\" class=\"btn btn-md btn-block btn-danger\">\n                        <i class=\"fa fa-remove\" aria-hidden=\"true\"></i> Kategoriyi Sil\n                      </button>\n                    </div>\n                    <div class=\"col pl-1\">\n                      <button type=\"submit\" class=\"btn btn-md btn-block btn-success\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"table\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Masa Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button [disabled]=\"Categorys?.length == 0\" class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#tableModal\">\n              <i class=\"fa fa-plus\"></i> Masa Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Bölgeler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"fillData()\" type=\"button\" class=\"list-group-item list-group-item-action\">Bütün\n                    Masalar</button>\n                  <div *ngFor=\"let item of Categorys\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getTablesByCategory(item._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Masalar\n                  </div>\n                  <div class=\"col-lg-6 pl-0 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #tableName type=\"text\" placeholder=\"Masa Adı Giriniz..\" (focus)=\"getTablesByCategory(null)\" (click)=\"tableName.value = '';\" (keydown)=\"filterTables(tableName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div *ngIf=\"tables?.length == 0\" class=\"row mt-5\">\n                  <div class=\"col-lg-12 mt-5\">\n                    <h2 class=\"text-center mt3\">Eşleşen Masa Bulunamadı</h2>\n                  </div>\n                </div>\n                <div *ngIf=\"tables?.length > 0\">\n                  <table class=\"table table-hover  table-bordered table-striped table-dark mb-0\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"7%\">#</th>\n                        <th width=\"43%\">Masa Adı</th>\n                        <th width=\"25%\">Kapasite</th>\n                        <th width=\"25%\">Bölüm</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let table of tables; let i = index;\" (click)=\"updateTable(table._id)\">\n                        <td>{{i+1}}</td>\n                        <td>{{table.name}}</td>\n                        <td><i class=\"fa fa-user\"></i> {{table.capacity}} Kişilik</td>\n                        <td>{{table.Category_id | general:'Categorys':'name' | async}}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                  <!-- <div class=\"col-lg-4 mb-2 col-card\">\n                    <div  class=\"card tableCard\">\n                      <div class=\"card-body\">\n                        <h2 class=\"card-title\">{{table.name}}</h2>\n                        <p class=\"card-text\">\n                           {{table.capacity}} </p>\n                      </div>\n                    </div>\n                  </div> -->\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"store\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">İşletme Ayarları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div class=\"modal fade\" id=\"cashboxCatModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"modelTitleId\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Kategori Oluştur</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #cashboxCatForm=\"ngForm\" (ngSubmit)=\"addCategory(cashboxCatForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input type=\"hidden\" name=\"_id\" ngModel />\n          <input type=\"hidden\" name=\"_rev\" ngModel />\n          <input type=\"hidden\" name=\"timestamp\" ngModel />\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kategori Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Açıklama</div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/cashbox-settings/cashbox-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/cashbox-settings/cashbox-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CashboxSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__ = __webpack_require__("./src/app/mocks/cashbox.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let CashboxSettingsComponent = class CashboxSettingsComponent {
    constructor(mainService, messageService, logService) {
        this.mainService = mainService;
        this.messageService = messageService;
        this.logService = logService;
        this.onUpdate = false;
        this.fillData();
    }
    ngOnInit() {
    }
    setDefault() {
        this.onUpdate = false;
        this.selectedCategory = undefined;
        this.cashboxCatForm.reset();
    }
    getCategory(category) {
        this.selectedCategory = category._id;
        this.cashboxDetailForm.setValue(category);
    }
    addCategory(cashboxCatForm) {
        let form = cashboxCatForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Kategori Adı Belirtmelisiniz');
            return false;
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__["b" /* CashboxCategory */](form.name, form.description, Date.now());
        this.mainService.addData('cashbox_categories', schema).then(() => {
            this.fillData();
            this.messageService.sendMessage('Kategori Oluşturuldu!');
            cashboxCatForm.reset();
        });
        $('#cashboxCatModal').modal('hide');
    }
    updateCategory(cashboxDetailForm) {
        let form = cashboxDetailForm.value;
        let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_cashbox__["b" /* CashboxCategory */](form.name, form.description, Date.now(), form._id, form._rev);
        this.mainService.updateData('cashbox_categories', form._id, schema).then(res => {
            this.selectedCategory = undefined;
            this.fillData();
            this.messageService.sendMessage('Kategori Güncellendi!');
        });
    }
    removeCategory() {
        let isOk = confirm('Kategoriyi Silmek Üzeresiniz!');
        if (isOk) {
            this.mainService.removeData('cashbox_categories', this.selectedCategory).then(() => {
                this.messageService.sendMessage('Kategori Silindi!');
                this.selectedCategory = undefined;
                this.fillData();
            });
        }
    }
    // filterTables(value: string) {
    //   let regexp = new RegExp(value, 'i');
    //   this.mainService.getAllBy('tables', { name: { $regex: regexp } }).then(res => {
    //     this.tables = res.docs;
    //     this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name));
    //   });
    // }
    fillData() {
        this.mainService.getAllBy('cashbox_categories', {}).then((result) => {
            this.categories = result.docs;
            this.categories = this.categories.sort((a, b) => a.timestamp - b.timestamp);
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('cashboxCatForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], CashboxSettingsComponent.prototype, "cashboxCatForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('cashboxDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], CashboxSettingsComponent.prototype, "cashboxDetailForm", void 0);
CashboxSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-cashbox-settings',
        template: __webpack_require__("./src/app/components/settings/cashbox-settings/cashbox-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/cashbox-settings/cashbox-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_5__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_3__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_4__services_log_service__["a" /* LogService */]])
], CashboxSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/customer-settings/customer-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#customers\" role=\"tab\">\n      <i class=\"fa fa-user-circle\" aria-hidden=\"true\"></i> Müşteriler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#accounts\" role=\"tab\">\n      <i class=\"fa fa-address-card\" aria-hidden=\"true\"></i> Hesaplar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#credits\" role=\"tab\">\n      <i class=\"fa fa-envelope-open\" aria-hidden=\"true\"></i> Krediler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#cards\" role=\"tab\">\n      <i class=\"fa fa-credit-card\" aria-hidden=\"true\"></i> Kartlar</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"customers\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Müşteriler</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#customerModal\">\n              <i class=\"fa fa-plus\"></i> Müşteri Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0 flow\">\n        <table class=\"table table-sm table-bordered table-striped table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th class=\"text-center\" width=\"8%\">#</th>\n              <th class=\"text-center\" width=\"62%\">Müşteri</th>\n              <th class=\"text-right\" width=\"30%\">Telefon</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let item of customers; let i = index\" (click)=\"updateCustomer(item._id)\">\n              <td class=\"text-center\">{{i+1}}</td>\n              <td style=\"text-transform:capitalize;\">\n                {{item.name}} {{item.surname}}\n                <br>\n                <strong class=\"text-success\">{{item.address }}</strong>\n              </td>\n              <td class=\"text-right\">\n                0{{item.phone_number | mask: ' (000) 000 00 00' }}\n                <br>\n                <small class=\"pull-right\"><i class=\"fa fa-clock-o\"></i> {{item.timestamp | timeAgo }}</small>\n              </td>\n\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"accounts\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Hesaplar</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <!-- <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#groupModal\">\n              <i class=\"fa fa-plus\"></i> Müşteri Ekle\n            </button> -->\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Müşteriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let customer of customers\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"filterChecks(customer._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{customer.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #stockCatDetailForm=\"ngForm\" (ngSubmit)=\"updateCategory(stockCatDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Hesaplar\n                </div>\n                <div class=\"card-body p-0 flow\">\n                  <table class=\"table table-sm table-bordered table-striped table-hover\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th class=\"text-center\" width=\"8%\">#</th>\n                        <th class=\"text-left\" width=\"62%\">Müşteri</th>\n                        <th class=\"text-right\" width=\"30%\">Tutar</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let item of creditsView; let i = index\" (click)=\"getDetail(item)\">\n                        <td class=\"text-center\">\n                          {{i+1}}\n                        </td>\n                        <td style=\"text-transform:capitalize;\">\n                          {{item.table_id | general: 'customers' | async }}\n                          <br>\n                          <strong class=\"text-muted\">\n                            Açıklama: {{item.note}}\n                          </strong>\n                        </td>\n                        <td class=\"text-right text-success\">\n                          {{item.total_price | price }}\n                          <br>\n                          <small class=\"pull-right\"><i class=\"fa fa-clock-o\"></i>\n                            {{item.timestamp | timeAgo }}\n                          </small>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedCat == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col-lg-6 pr-1\">\n                      <button type=\"button\" (click)=\"removeCategory(selectedCat._id)\" class=\"btn btn-danger btn-md btn-block\">\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Kategoriyi Sil</button>\n                    </div>\n                    <div class=\"col-lg-6 pl-1\">\n                      <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"credits\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Müşteri Kredileri</h5>\n      </div>\n      <div class=\"card-body tab-height flow p-0\">\n        <table class=\"table table-sm table-bordered table-striped table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th class=\"text-center\" width=\"8%\">#</th>\n              <th class=\"text-center\" width=\"42%\">Müşteri</th>\n              <th class=\"text-center\" width=\"20%\">Telefon</th>\n              <th class=\"text-center\" width=\"30%\">Kredi Tutarı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let item of customers; let i = index\">\n              <td class=\"text-center\">{{i+1}}</td>\n              <td style=\"text-transform:capitalize;\">\n                {{item.name}} {{item.surname}}\n                <br>\n                <strong class=\"text-success\">{{item.address }}</strong>\n              </td>\n              <td class=\"text-center\">\n                0{{item.phone_number | mask: ' (000) 000 00 00' }}\n              </td>\n              <td class=\"text-center text-success\">\n                <h3>\n                  <strong>\n                    {{ customerCredit(item._id) | price }}\n                  </strong>\n                </h3>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"cards\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Müşteri Kartları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"customerModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"customerModal\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\"><strong>Müşteri Ekle</strong></h5>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #customerForm=\"ngForm\" (ngSubmit)=\"addCustomer(customerForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input type=\"hidden\" name=\"_id\" ngModel>\n            <input type=\"hidden\" name=\"_rev\" ngModel>\n            <input type=\"hidden\" name=\"picture\" ngModel>\n            <input type=\"hidden\" name=\"timestamp\" ngModel>\n          </div>\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Soyadı</div>\n              </div>\n              <input type=\"text\" name=\"surname\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Telefon\n                </div>\n              </div>\n              <input type=\"text\" prefix=\"0\" mask=\" (000) 000 00 00\" placeholder=\"0 (000) 000 00 00\" name=\"phone_number\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Adres\n                </div>\n              </div>\n              <input type=\"text\" name=\"address\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Müşteri Tipi</div>\n              </div>\n              <select #role name=\"type\" class=\"form-control form-control-lg\" ngModel>\n                <option value=\"0\">Restoran</option>\n                <option value=\"1\">Paket Servis</option>\n              </select>\n            </div>\n\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" class=\"btn btn-danger btn-lg\" (click)=\"removeCustomer(selectedCustomer)\">\n            Müşteriyi Sil</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"reportDetail\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-tie\" id=\"modelTieId\">Hesap Detayı\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card checkDetail\">\n          <div class=\"card-header\">\n            <b>{{checkDetail?.table_id | general:'customers' | async}}\n              <small class=\"text-muted\"> ({{checkDetail?.timestamp | date:'dd/M/y HH:mm'}})</small>\n            </b>\n            <span class=\"pull-right text-muted\"> Hesap Türü : Cari</span>\n          </div>\n          <div class=\"card-body flow p-0\">\n            <table *ngIf=\"checkDetail?.payment_method != 'Parçalı'\" class=\"table table-striped  table-bordered table-sm mb-0\">\n              <thead class=\"thead-dark\">\n                <th width=\"6%\">#</th>\n                <th width=\"44%\">Ürün</th>\n                <th width=\"17%\">Garson</th>\n                <th width=\"14%\">Saat</th>\n                <th width=\"17%\">Fiyat</th>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let item of checkDetail?.products; let i = index;\" [ngClass]=\"{'table-danger': item.status == 3}\">\n                  <td>{{i+1}}</td>\n                  <td>{{item.name}}\n                    <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                  </td>\n                  <td>{{item.owner | general:'users' | async}}</td>\n                  <td>{{item.timestamp |date:'HH:mm'}}</td>\n                  <td>{{item.price | price}} </td>\n                </tr>\n              </tbody>\n            </table>\n            <section *ngIf=\"checkDetail?.payment_method == 'Parçalı'\">\n              <table *ngFor=\"let item of checkDetail?.payment_flow; let i = index;\" class=\"table table-sm  table-bordered table-striped mb-0\">\n                <thead class=\"thead-dark\">\n                  <th width=\"6%\">#</th>\n                  <th width=\"45%\">{{item.owner}}</th>\n                  <th width=\"15%\">{{item.method}}</th>\n                  <th width=\"15%\">{{item.timestamp | date:'HH:mm'}}</th>\n                  <th width=\"17%\">{{item.amount + item.discount | price}} </th>\n                </thead>\n                <tbody>\n                  <tr *ngIf=\"item.discount > 0\" class=\"table-info\">\n                    <td><i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i></td>\n                    <td colspan=\"3\">İndirim Tutarı</td>\n                    <td>{{item.discount | price }} </td>\n                  </tr>\n                  <tr *ngFor=\"let product of item.payed_products; let i = index;\" [ngClass]=\"{'table-danger': product.status == 3}\">\n                    <td width=\"4%\">{{i+1}}</td>\n                    <td width=\"48%\">{{product.name}}\n                      <small *ngIf=\"product.note !== '' && product.note !== undefined\" class=\"text-muted\">({{product.note}})</small>\n                    </td>\n                    <td width=\"15%\">{{product.owner}}</td>\n                    <td width=\"15%\">{{product.timestamp |date:'HH:mm'}}</td>\n                    <td width=\"17%\">{{product.price | price}} </td>\n                  </tr>\n                </tbody>\n              </table>\n            </section>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-user mr-1\" aria-hidden=\"true\"></i> Kullanıcı:\n              <span class=\"pull-right\">{{checkDetail?.owner}}</span>\n            </b>\n          </div>\n          <div *ngIf=\"checkDetail?.discount > 0\" class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> Toplam İndirim Tutarı:\n              <span class=\"pull-right\">{{checkDetail?.discount | price}} </span>\n            </b>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Cari Tutarı:\n              <span class=\"pull-right\">{{checkDetail?.total_price | price}} </span>\n            </b>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer pr-2 text-center\">\n        <button (click)=\"rePrintCheck(checkDetail)\" class=\"btn btn-primary btn-lg\">\n          <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Yazdır</button>\n        <button type=\"button\" (click)=\"reOpenCheck(checkDetail)\" class=\"btn btn-info btn-lg\" data-dismiss=\"modal\">\n          <i class=\"fa fa-undo\"></i> Hesabı Geri Aç</button>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/customer-settings/customer-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".checkDetail {\n  height: 72vh; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/customer-settings/customer-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CustomerSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mocks_customer__ = __webpack_require__("./src/app/mocks/customer.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mocks_report__ = __webpack_require__("./src/app/mocks/report.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let CustomerSettingsComponent = class CustomerSettingsComponent {
    constructor(mainService, settingsService, printerService, messageService, logService) {
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.printerService = printerService;
        this.messageService = messageService;
        this.logService = logService;
    }
    ngOnInit() {
        this.onUpdate = false;
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
        this.settingsService.getPrinters().subscribe(res => {
            this.printers = res.value;
        });
        this.fillData();
    }
    setDefault() {
        this.onUpdate = false;
        this.selectedCustomer = undefined;
        this.customerForm.reset();
    }
    addCustomer(customerForm) {
        let form = customerForm.value;
        if (form.name == undefined) {
            this.messageService.sendMessage('Müşteri Adı Girmek Zorundasınız.');
            return false;
        }
        if (form.type == undefined) {
            this.messageService.sendMessage('Müşteri Tipi Seçmek Zorundasınız.');
            return false;
        }
        if (form.phone_number == undefined) {
            this.messageService.sendMessage('Telefon Numarası Girmek Zorundasınız.');
            return false;
        }
        if (form.address == undefined) {
            this.messageService.sendMessage('Adres Girmek Zorundasınız.');
            return false;
        }
        form.phone_number = parseInt(form.phone_number);
        if (form._id == undefined) {
            this.mainService.getAllBy('customers', { phone_number: form.phone_number }).then(result => {
                if (result.docs.length > 0) {
                    this.messageService.sendMessage('Bu telefon numarası ile başka bir Müşteri kayıtlı. Lütfen başka bir numara deneyin.');
                    customerForm.reset();
                }
                else {
                    let schema = new __WEBPACK_IMPORTED_MODULE_5__mocks_customer__["a" /* Customer */](form.name, form.surname, form.phone_number, form.address, '', form.type, Date.now());
                    this.mainService.addData('customers', schema).then((response) => {
                        this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_6__mocks_report__["b" /* Report */]('Customer', response.id, 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), form.name, Date.now())).then(res => {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_3__services_log_service__["b" /* logType */].CUSTOMER_CREATED, res.id, `${form.name} Adlı Müşteri Oluşturuldu`);
                        });
                        this.messageService.sendMessage('Müşteri Oluşturuldu!');
                        this.fillData();
                        customerForm.reset();
                        $('#customerModal').modal('hide');
                    });
                }
            });
        }
        else {
            this.mainService.getAllBy('customers', { phone_number: form.phone_number }).then(result => {
                if (result.docs.length > 0 && result.docs[0].phone_number != form.phone_number) {
                    this.messageService.sendMessage('Bu telefon numarası ile başka bir Müşteri kayıtlı. Lütfen başka bir numara deneyin.');
                }
                else {
                    this.mainService.updateData('customers', form._id, form).then((res) => {
                        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_3__services_log_service__["b" /* logType */].CUSTOMER_UPDATED, res.id, `${form.name} Adlı Müşteri Güncellendi`);
                        this.messageService.sendMessage('Bilgiler Güncellendi!');
                        this.fillData();
                        customerForm.reset();
                        $('#customerModal').modal('hide');
                    });
                }
            });
        }
    }
    updateCustomer(id) {
        this.onUpdate = true;
        this.selectedCustomer = id;
        this.mainService.getData('customers', id).then(result => {
            delete result.role;
            this.customerForm.setValue(result);
            $('#customerModal').modal('show');
        });
    }
    removeCustomer(id) {
        let isOk = confirm('Müşteriyi Silmek Üzerisiniz. Bu işlem Geri Alınamaz.');
        if (isOk) {
            this.mainService.removeData('customers', id).then((result) => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_3__services_log_service__["b" /* logType */].CUSTOMER_DELETED, result.id, `${this.customerForm.value.name} Adlı Müşteri Silindi`);
                this.mainService.getAllBy('reports', { connection_id: result.id }).then(res => {
                    this.mainService.removeData('reports', res.docs[0]._id);
                });
                this.messageService.sendMessage('Müşteri Silindi!');
                this.fillData();
                $('#customerModal').modal('hide');
            });
        }
    }
    reOpenCheck(check) {
        let checkWillReOpen;
        let discount = 0;
        if (check.payment_flow) {
            check.payment_flow.forEach(element => {
                discount += element.amount;
            });
            checkWillReOpen = new __WEBPACK_IMPORTED_MODULE_7__mocks_check__["a" /* Check */]('Hızlı Satış', 0, discount, check.owner, 'Geri Açılan', check.status, check.products, Date.now(), __WEBPACK_IMPORTED_MODULE_7__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_7__mocks_check__["b" /* CheckNo */])(), check.payment_flow);
        }
        else {
            checkWillReOpen = new __WEBPACK_IMPORTED_MODULE_7__mocks_check__["a" /* Check */]('Hızlı Satış', check.total_price, check.discount, check.owner, 'Geri Açılan', check.status, check.products, Date.now(), __WEBPACK_IMPORTED_MODULE_7__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_7__mocks_check__["b" /* CheckNo */])(), check.payment_flow);
        }
        this.mainService.addData('checks', checkWillReOpen).then(() => {
            this.mainService.removeData('credits', check._id).then(() => {
                this.fillData();
                $('#checkDetail').modal('hide');
                this.messageService.sendAlert('Başarılı !', 'Hesap Geri Açıldı', 'success');
            });
        });
        // if (check.payment_method !== 'Parçalı') {
        //   this.mainService.getAllBy('reports', { connection_id: check.payment_method }).then(res => {
        //     this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
        //       doc.weekly[this.day] -= check.total_price;
        //       doc.weekly_count[this.day]--;
        //       return doc;
        //     });
        //   });
        // } else {
        //   check.payment_flow.forEach(element => {
        //     this.mainService.getAllBy('reports', { connection_id: element.method }).then(res => {
        //       this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
        //         doc.weekly[this.day] -= element.amount;
        //         return doc;
        //       });
        //     });
        //   });
        // }
    }
    rePrintCheck(check) {
        this.mainService.getData('tables', check.table_id).then(res => {
            if (check.products.length > 0) {
                this.printerService.printCheck(this.printers[0], res.name, check);
            }
            else {
                check.products = check.payment_flow.reduce((a, b) => a.payed_products.concat(b.payed_products));
                this.printerService.printCheck(this.printers[0], res.name, check);
            }
        }).catch(err => {
            this.printerService.printCheck(this.printers[0], check.table_id, check);
        });
    }
    getDetail(check) {
        this.checkDetail = check;
        $('#reportDetail').modal('show');
    }
    cancelCheck(id, note) {
        this.messageService.sendConfirm('Kapanmış Hesap İptal Edilecek! Bu işlem geri alınamaz!').then(isOK => {
            if (isOK) {
                this.mainService.updateData('closed_checks', id, { description: note, type: 3 }).then(res => {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_3__services_log_service__["b" /* logType */].CHECK_CANCELED, id, `${this.checkDetail.total_price} TL tutarındaki kapatılan hesap iptal edildi. Açıklama:'${note}'`);
                    this.fillData();
                    $('#cancelDetail').modal('hide');
                });
            }
        });
    }
    customerCredit(customer_id) {
        return this.credits.filter(obj => obj.table_id == customer_id).map(obj => obj.total_price).reduce((a, b) => a + b, 0) || 0;
    }
    filterChecks(customer_id) {
        this.creditsView = this.credits.filter(obj => obj.table_id == customer_id);
    }
    filterCustomers(value) {
        let regexp = new RegExp(value, 'i');
        this.mainService.getAllBy('customers', { name: { $regex: regexp } }).then(res => {
            this.customers = res.docs;
        });
    }
    fillData() {
        this.mainService.getAllBy('customers', {}).then(result => {
            this.customers = result.docs;
        });
        this.mainService.getAllBy('credits', {}).then(res => {
            this.credits = res.docs;
            this.creditsView = this.credits.sort((a, b) => a.timestamp - b.timestamp);
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('customerForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_4__angular_forms__["d" /* NgForm */])
], CustomerSettingsComponent.prototype, "customerForm", void 0);
CustomerSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-customer-settings',
        template: __webpack_require__("./src/app/components/settings/customer-settings/customer-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/customer-settings/customer-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_9__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_8__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_2__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__services_log_service__["a" /* LogService */]])
], CustomerSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/menu-settings/menu-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#menu\" role=\"tab\">\n      <i class=\"fa fa-book\" aria-hidden=\"true\"></i> Kategoriler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#products\" role=\"tab\">\n      <i class=\"fa fa-glass\" aria-hidden=\"true\"></i> Ürünler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#occations\" role=\"tab\">\n      <i class=\"fa fa-cutlery\" aria-hidden=\"true\"></i> Kampanya</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#occations\" role=\"tab\">\n      <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> Tarifeler</a>\n  </li>\n</ul>\n\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"menu\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Menu ve Kategori Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#categoryModal\">\n              <i class=\"fa fa-plus\"></i> Kategori Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let cat of categories\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getCategory(cat)\" [ngClass]=\"{'list-group-item-warning' : selectedCat == cat}\"\n                      type=\"button\" class=\"list-group-item list-group-item-action\">{{cat.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #catDetails=\"ngForm\" (ngSubmit)=\"updateCategory(catDetails)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedCat == undefined\" class=\"text-center mt-5\">Listeden Kategori Seçiniz</h1>\n                  <div [hidden]=\"selectedCat == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel>\n                    <input type=\"hidden\" name=\"_rev\" ngModel>\n                    <input type=\"hidden\" name=\"order\" ngModel>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Kategori Adı\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Durum</div>\n                        </div>\n                        <select name=\"status\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"1\">Herkese Açık</option>\n                          <option value=\"2\">Özel Kategori</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Açıklama\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Yazıcı\n                          </div>\n                        </div>\n                        <select [disabled]=\"printers?.length == 0\" name=\"printer\" class=\"form-control form-control-lg\"\n                          ngModel>\n                          <option *ngFor=\"let item of printers\">{{item.name}}</option>\n                        </select>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Etiketler\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"tags\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-0\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Alt Kategoriler\n                          </div>\n                        </div>\n                        <div class=\"img-thumbnail pl-2 subCatInput\">\n                          <span *ngFor=\"let sub of subCats\" (click)=\"updateSubCategory(sub);\" class=\"badge badge-warning text-dark mr-1 subCat\">{{sub.name}}</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedCat == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col pr-1 pl-2\">\n                      <button type=\"button\" (click)=\"removeCategory(selectedCat._id)\" class=\"btn btn-md btn-block btn-danger\">\n                        <i class=\"fa fa-remove\" aria-hidden=\"true\"></i> Kategoriyi Sil\n                      </button>\n                    </div>\n                    <div class=\"col pr-1 pl-1\">\n                      <button type=\"button\" *ngIf=\"selectedCat !== undefined\" [disabled]=\"subCats.length == 4\" (click)=\"onUpdate = false; subCatForm.reset();\"\n                        class=\"btn btn-warning btn-block btn-md\" data-toggle=\"modal\" data-target=\"#subCatModal\">\n                        <i class=\"fa fa-plus\"></i> Alt Kategori Ekle\n                      </button>\n                    </div>\n                    <div class=\"col pl-1\">\n                      <button type=\"submit\" class=\"btn btn-md btn-block btn-success\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"products\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Ürün Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button [disabled]=\"categories == undefined || categories.length == 0\" class=\"btn btn-danger btn-md btn-block\"\n              (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#productModal\">\n              <i class=\"fa fa-plus\"></i> Ürün Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"getProductsByCategory(null)\" type=\"button\" class=\"list-group-item list-group-item-action\">Bütün\n                    Ürünler</button>\n                  <button *ngFor=\"let cat of categories\" (click)=\"getProductsByCategory(cat._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{cat.name}}</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Ürünler\n                  </div>\n                  <div class=\"col-lg-6 pl-0 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #productName type=\"text\" placeholder=\"Ürün Adı Giriniz..\" (focus)=\"getProductsByCategory(null)\"\n                        (click)=\"productName.value = '';\" (keydown)=\"filterProducts(productName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div *ngIf=\"sub_categories !== undefined && sub_categories.length > 0\" class=\"card-header pt-1 pb-1\">\n                <div class=\"row\">\n                  <div *ngFor=\"let item of sub_categories\" class=\"col p-0 pr-1 pl-1\">\n                    <button (click)=\"getProductsBySubCat(item._id)\" class=\"btn btn-md btn-warning btn-block\">\n                      <b>{{item.name}}</b>\n                    </button>\n                  </div>\n                </div>\n              </div>\n              <div id=\"productHolder\" class=\"card-body p-0 flow\">\n                <div *ngIf=\"products !== undefined && products.length > 0\">\n                  <table class=\"table table-dark  table-bordered table-hover table-striped mb-0\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"7%\">#</th>\n                        <th width=\"43%\">Ürün Adı</th>\n                        <th width=\"17%\">Fiyatı</th>\n                        <th width=\"13%\">Kdv</th>\n                        <th width=\"20%\">Kategori</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let product of products; let i = index;\" (click)=\"updateProduct(product._id)\">\n                        <td>{{i+1}}</td>\n                        <td>{{product.name}}</td>\n                        <td class=\"font-weight-bold\">{{product.price}} TL</td>\n                        <td>{{product.tax_value}} %</td>\n                        <td>{{product.cat_id | general:'categories':'name' | async}}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n                <div *ngIf=\"products == undefined || products.length == 0\" class=\"row mt-5\">\n                  <div class=\"col-lg-12 mt-5\">\n                    <h2 class=\"text-center mt-3\">Eşleşen Ürün Bulunamadı</h2>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"occations\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Tarife Ayarları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"categoryModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Kategori</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #categoryForm=\"ngForm\" (ngSubmit)=\"addCategory(categoryForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input name=\"_id\" type=\"hidden\" ngModel />\n          <input name=\"_rev\" type=\"hidden\" ngModel />\n          <input name=\"status\" type=\"hidden\" ngModel />\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kategori Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Durum</div>\n              </div>\n              <select name=\"status\" class=\"form-control form-control-lg\" ngModel>\n                <option value=\"1\">Herkese Açık</option>\n                <option value=\"2\">Özel Kategori</option>\n              </select>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Açıklama</div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Yazıcı</div>\n              </div>\n              <select [disabled]=\"printers?.length == 0\" name=\"printer\" class=\"form-control form-control-lg\" ngModel>\n                <option *ngFor=\"let item of printers\">{{item.name}}</option>\n              </select>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Etiketler</div>\n              </div>\n              <input type=\"text\" name=\"tags\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"button\" type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"subCatModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Alt Kategori {{onUpdate ? 'Düzenle':'Ekle'}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #subCatForm=\"ngForm\" (ngSubmit)=\"addSubCategory(subCatForm)\">\n        <input type=\"hidden\" name=\"_id\" ngModel />\n        <input type=\"hidden\" name=\"_rev\" ngModel />\n        <input type=\"hidden\" name=\"status\" ngModel />\n        <input type=\"hidden\" name=\"cat_id\" ngModel />\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Alt Kategori Adı\n                </div>\n              </div>\n              <input type=\"text\" class=\"form-control form-control-lg\" name=\"name\" ngModel>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Açıklama\n                </div>\n              </div>\n              <input type=\"text\" class=\"form-control form-control-lg\" name=\"description\" ngModel>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" (click)=\"removeSubCategory(selectedSubCat._id)\" type=\"button\" class=\"btn btn-warning btn-lg\"\n            data-dismiss=\"modal\">Alt Kategoriyi Sil</button>\n          <button type=\"submit\" class=\"btn btn-danger btn-lg\">\n            <span *ngIf=\"onUpdate\">Değişiklikleri</span> Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"productModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-xl\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Ürün</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #productForm=\"ngForm\" (ngSubmit)=\"addProduct(productForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input name=\"_id\" type=\"hidden\" ngModel />\n          <input name=\"_rev\" type=\"hidden\" ngModel />\n          <input name=\"status\" type=\"hidden\" ngModel />\n          <input name=\"note\" type=\"hidden\" ngModel />\n          <input name=\"specifies\" type=\"hidden\" ngModel />\n          <input name=\"extras\" type=\"hidden\" ngModel />\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"row\">\n            <div class=\"col-lg-5 pr-2\">\n              <div class=\"form-group mb-0\">\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Ürün Adı</div>\n                  </div>\n                  <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Kategori</div>\n                  </div>\n                  <select (change)=\"getSubCategories($event.target.value)\" name=\"cat_id\" class=\"form-control form-control-lg\"\n                    ngModel>\n                    <option *ngFor=\"let cat of categories\" value=\"{{cat._id}}\">{{cat.name}}</option>\n                  </select>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Alt Kategori</div>\n                  </div>\n                  <select [disabled]=\"subCats.length == 0 || subCats == undefined\" name=\"subcat_id\" class=\"form-control form-control-lg\"\n                    ngModel>\n                    <option *ngFor=\"let cat of subCats\" value=\"{{cat._id}}\">{{cat.name}}</option>\n                  </select>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Ürün Tipi</div>\n                  </div>\n                  <select #productTypeSelect (change)=\"setProductType($event.target.value)\" name=\"type\" class=\"form-control form-control-lg\"\n                    ngModel>\n                    <option value=\"1\">Otomatik Stok</option>\n                    <option value=\"2\">Manuel Stok</option>\n                  </select>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">{{ (productType == 2) ? 'Birim' : ''}} Fiyat</div>\n                  </div>\n                  <input type=\"number\" name=\"price\" class=\"form-control form-control-lg\" ngModel />\n                  <div class=\"input-group-append\">\n                    <div class=\"input-group-text\">TL</div>\n                  </div>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Kdv</div>\n                  </div>\n                  <input type=\"number\" name=\"tax_value\" class=\"form-control form-control-lg\" ngModel />\n                  <div class=\"input-group-append\">\n                    <div class=\"input-group-text\">%</div>\n                  </div>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Barkod</div>\n                  </div>\n                  <input type=\"number\" name=\"barcode\" class=\"form-control form-control-lg\" ngModel />\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Ürün Hakkında</div>\n                  </div>\n                  <textarea name=\"description\" rows=\"2\" class=\"form-control form-control-lg\" ngModel></textarea>\n                </div>\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <div class=\"input-group-text\">Ürün Notları</div>\n                  </div>\n                  <textarea name=\"notes\" rows=\"3\" class=\"form-control form-control-lg\" ngModel></textarea>\n\n                </div>\n              </div>\n            </div>\n            <!-- <div class=\"col pl-0 pr-1\">\n              <div class=\"card\" style=\"height:100%\">\n                <div class=\"card-header\">\n                  <i class=\"fa fa-plus\"></i> Ürün İçeriği Oluştur\n                </div>\n                <div class=\"card-header p-0\">\n                  <form #recipesForm=\"ngForm\" (ngSubmit)=\"addRecipe(recipesForm)\">\n                    <div class=\"input-group\">\n                      <select placeholder=\"Stok Seçiniz...\" [disabled]=\"stocks?.length == 0 || productType == 2 && productRecipe.length > 0 || productType == 2 && oldRecipes.length > 0\"\n                        name=\"stock_id\" (change)=\"onStockChange($event.target.value)\" class=\"form-control form-control-lg\"\n                        ngModel>\n                        <option *ngFor=\"let stock of stocks\" value=\"{{stock._id}}\">{{stock.name}}</option>\n                      </select>\n                    </div>\n                    <div class=\"input-group\">\n                      <input [disabled]=\"stocks?.length == 0 || productType == 2 && productRecipe.length > 0 || productType == 2 && oldRecipes.length > 0\"\n                        type=\"number\" placeholder=\"0 {{stockUnit}}\" name=\"amount\" class=\"form-control form-control-lg\"\n                        ngModel />\n                      <span class=\"input-group-append\">\n                        <button [disabled]=\"stocks?.length == 0 || productType == 2 && productRecipe.length > 0 || productType == 2 && oldRecipes.length > 0\"\n                          class=\"btn btn-success\" type=\"submit\">Ekle</button>\n                      </span>\n                    </div>\n                  </form>\n                </div>\n                <div class=\"card-header\">Ürün İçeriği</div>\n                <div class=\"card-body p-0 flow\" style=\"height:277px;\">\n                  <div *ngIf=\"hasRecipe\">\n                    <table class=\"table  table-bordered table-hover table-dark table-striped\">\n                      <thead class=\"thead-dark\">\n                        <tr>\n                          <th width=\"85%\">İçerik</th>\n                          <th width=\"15%\">Sil</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr *ngFor=\"let item of oldRecipes; let i = index;\">\n                          <td>{{item.amount}} {{item.unit}} {{item.name}}</td>\n                          <td>\n                            <b (click)=\"removeRecipe('old',item.id)\">\n                              <i class=\"fa fa-trash-o text-danger\" aria-hidden=\"true\"></i>\n                            </b>\n                          </td>\n                        </tr>\n                        <tr *ngFor=\"let item of recipesTable\" class=\"table-success\">\n                          <td>{{item.amount}} {{item.unit}} {{item.name}}</td>\n                          <td>\n                            <i class=\"fa fa-undo\" (click)=\"removeRecipe('new',item.id)\" aria-hidden=\"true\"></i>\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              </div>\n            </div> -->\n            <div class=\"col pl-1 pr-1\">\n              <div class=\"card\" style=\"height:100%\">\n                <div class=\"card-header\">\n                  <i class=\"fa fa-plus\"></i> Ürün İlaveleri Oluştur\n                </div>\n                <div class=\"card-header p-0\">\n                  <form #extrasForm=\"ngForm\" (ngSubmit)=\"addExtras(extrasForm)\">\n                    <input type=\"text\" [disabled]=\"productType == 2\" name=\"extra_name\" placeholder=\"İlave Notu...\" class=\"form-control form-control-lg\"\n                      ngModel />\n                    <div class=\"input-group\">\n                      <input type=\"number\" [disabled]=\"productType == 2\" name=\"extra_price\" placeholder=\"İlave Fiyatı..\"\n                        class=\"form-control form-control-lg\" ngModel />\n                      <div class=\"input-group-append\">\n                        <button type=\"submit\" [disabled]=\"productType == 2\" class=\"btn btn-success\">Ekle</button>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n                <div class=\"card-header\">Ürün İlaveleri</div>\n                <div class=\"card-body p-0 flow\" style=\"height:277px;\">\n                  <table *ngIf=\"productExtras.length > 0\" class=\"table table-hover  table-bordered table-dark table-striped\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"85%\">Durum</th>\n                        <th width=\"15%\">Sil</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let extra of productExtras; let i = index;\">\n                        <td>{{extra.extra_name}}\n                          <span class=\"pull-right\">{{extra.extra_price}} TL</span>\n                        </td>\n                        <td>\n                          <i class=\"fa fa-trash-o text-danger\" (click)=\"removeExtras(i)\" aria-hidden=\"true\"></i>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n            <div class=\"col pl-1\">\n              <div class=\"card\" style=\"height:100%\">\n                <div class=\"card-header\">\n                  <i class=\"fa fa-plus\"></i> Ürün Servis Durumu Oluştur\n                </div>\n                <div class=\"card-header p-0\">\n                  <form #speciesForm=\"ngForm\" (ngSubmit)=\"addSpecies(speciesForm)\">\n                    <input type=\"text\" [disabled]=\"productType == 2\" name=\"spec_name\" placeholder=\"Durum Notu...\" class=\"form-control form-control-lg\"\n                      ngModel />\n                    <div class=\"input-group\">\n                      <input type=\"number\" [disabled]=\"productType == 2\" name=\"spec_price\" placeholder=\"Durum Fiyatı..\"\n                        class=\"form-control form-control-lg\" ngModel />\n                      <div class=\"input-group-append\">\n                        <button type=\"submit\" [disabled]=\"productType == 2\" class=\"btn btn-success\">Ekle</button>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n                <div class=\"card-header\">Ürün Durumları</div>\n                <div class=\"card-body p-0 flow\" style=\"height:277px;\">\n                  <table *ngIf=\"productSpecs.length > 0\" class=\"table table-hover  table-bordered table-dark table-striped\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"85%\">Durum</th>\n                        <th width=\"15%\">Sil</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let spec of productSpecs; let i = index;\">\n                        <td>{{spec.spec_name}}\n                          <span class=\"pull-right\">{{spec.spec_price}} TL</span>\n                        </td>\n                        <td>\n                          <i class=\"fa fa-trash-o text-danger\" (click)=\"removeSpecies(i)\" aria-hidden=\"true\"></i>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n   \n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" (click)=\"removeProduct()\" class=\"btn btn-danger btn-lg\" data-dismiss=\"modal\">Ürünü\n            Sil</button>\n          <button type=\"button\" type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/menu-settings/menu-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "#productHolder {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-top: 5px; }\n\n.inside-height {\n  height: 74.5vh; }\n\n.subCatInput {\n  text-align: center;\n  height: 64px; }\n\n.subCat {\n  padding: 1.25em;\n  margin-top: 0.40rem;\n  cursor: pointer;\n  width: 23.8%;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/menu-settings/menu-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MenuSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_product__ = __webpack_require__("./src/app/mocks/product.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_report__ = __webpack_require__("./src/app/mocks/report.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let MenuSettingsComponent = class MenuSettingsComponent {
    constructor(mainService, messageService, logService) {
        this.mainService = mainService;
        this.messageService = messageService;
        this.logService = logService;
        this.subCats = [];
        this.fillData();
    }
    ngOnInit() {
        this.stockUnit = 'Birim';
        this.productRecipe = [];
        this.productSpecs = [];
        this.productExtras = [];
        this.recipesTable = [];
        this.oldRecipes = [];
        this.recipe = [];
        this.onUpdate = false;
        this.hasRecipe = false;
    }
    getCategory(category) {
        this.selectedCat = category;
        this.catDetails.setValue(category);
        this.mainService.getAllBy('sub_categories', { cat_id: category._id }).then(res => {
            this.subCats = res.docs;
        });
    }
    getSubCategories(id) {
        this.mainService.getAllBy('sub_categories', { cat_id: id }).then(res => {
            this.subCats = res.docs;
        });
    }
    getProductsByCategory(id) {
        if (!id) {
            this.mainService.getAllBy('products', {}).then(res => {
                this.setDefault();
                this.products = res.docs;
                this.products = this.products.sort((a, b) => a.price - b.price);
            });
        }
        else {
            this.mainService.getAllBy('sub_categories', { cat_id: id }).then(res => {
                this.sub_categories = res.docs;
            });
            this.mainService.getAllBy('products', { cat_id: id }).then(result => {
                this.products = result.docs;
                this.products = this.products.sort((a, b) => a.price - b.price);
            });
        }
    }
    getProductsBySubCat(id) {
        this.mainService.getAllBy('products', { subcat_id: id }).then(result => {
            this.products = result.docs;
            this.products = this.products.sort((a, b) => a.price - b.price);
        });
    }
    addCategory(categoryForm) {
        let form = categoryForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Kategori Adı Belirtmelisiniz');
            return false;
        }
        if (!form.printer) {
            form.printer = '';
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["a" /* Category */](form.name, form.description, 1, form.printer, 0, form.tags);
        this.mainService.addData('categories', schema).then(() => {
            this.fillData();
            this.messageService.sendMessage('Kategori Oluşturuldu');
        });
        categoryForm.reset();
        $('#categoryModal').modal('hide');
    }
    updateCategory(catDetails) {
        let form = catDetails.value;
        this.mainService.updateData('categories', form._id, form).then(() => {
            this.fillData();
            this.messageService.sendMessage('Kategori Düzenlendi');
            this.selectedCat = undefined;
        });
    }
    removeCategory(id) {
        let isOk = confirm('Kategoriyi Silmek Üzeresiniz. Kategoriye Dahil Olan Ürünlerde Silinecektir.');
        if (isOk) {
            this.mainService.getAllBy('products', { cat_id: id }).then(result => {
                let data = result.docs;
                if (data.length > 0) {
                    for (let prop in data) {
                        this.mainService.removeData('products', data[prop]._id);
                        this.mainService.getAllBy('reports', { connection_id: data[prop]._id }).then(res => {
                            if (res.docs.length > 0)
                                this.mainService.removeData('reports', res.docs[0]._id);
                        });
                        this.mainService.getAllBy('recipes', { product_id: data[prop]._id }).then(res => {
                            if (res.docs.length > 0)
                                this.mainService.removeData('recipes', res.docs[0]._id);
                        });
                    }
                }
            });
            this.mainService.getAllBy('sub_categories', { cat_id: id }).then(res => {
                let data = res.docs;
                if (data.length > 0) {
                    for (let prop in data) {
                        this.mainService.removeData('sub_categories', data[prop]._id);
                    }
                }
            });
            this.mainService.removeData('categories', id).then(() => {
                this.selectedCat = undefined;
                this.messageService.sendMessage('Kategori ve Ürünler Silindi');
                this.fillData();
            });
        }
    }
    addSubCategory(subCatForm) {
        let form = subCatForm.value;
        if (form._id == '' || form._id == undefined || form._id == null) {
            let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["i" /* SubCategory */](this.selectedCat._id, form.name, form.description, 1);
            this.mainService.addData('sub_categories', schema).then(res => {
                this.getCategory(this.selectedCat);
            });
        }
        else {
            this.mainService.updateData('sub_categories', form._id, form).then(res => {
                this.getCategory(this.selectedCat);
            });
        }
        this.selectedSubCat = undefined;
        this.onUpdate = false;
        subCatForm.reset();
        $('#subCatModal').modal('hide');
    }
    updateSubCategory(subCat) {
        this.selectedSubCat = subCat;
        this.onUpdate = true;
        this.subCatForm.setValue(subCat);
        $('#subCatModal').modal('show');
    }
    removeSubCategory(id) {
        this.mainService.removeData('sub_categories', id).then(res => {
            this.getCategory(this.selectedCat);
            this.onUpdate = false;
        });
        this.subCatForm.reset();
        $('#subCatModal').modal('hide');
    }
    addProduct(productForm) {
        let form = productForm.value;
        console.log(form);
        if (!form.name || !form.cat_id || !form.price || !form.tax_value) {
            this.messageService.sendMessage('Gerekli Alanları Doldurmalısınız');
            return false;
        }
        if (form.type == 2 && this.oldRecipes.length == 0) {
            if (form.type == 2 && this.productRecipe.length == 0) {
                this.messageService.sendMessage('Stok Girişi Yapmalısınız!');
                return false;
            }
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["c" /* Product */](form.cat_id, form.type, form.description, form.name, form.price, 1, form.tax_value, form.barcode, form.notes, form.subcat_id, this.productSpecs, this.productExtras, form._id, form._rev);
        if (form._id == undefined) {
            this.mainService.addData('products', schema).then((response) => {
                this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_3__mocks_report__["b" /* Report */]('Product', response.id, 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), schema.name, Date.now())).then(res => {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].PRODUCT_CREATED, res.id, `${form.name} adlı Ürün Oluşturuldu`);
                });
                if (this.productRecipe.length > 0) {
                    let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["h" /* Recipe */](response.id, this.productRecipe);
                    this.mainService.addData('recipes', schema);
                }
                // this.fillData();
                this.messageService.sendMessage('Ürün Oluşturuldu');
            }).catch(err => {
                console.log(err);
                this.messageService.sendMessage('Ürün Oluşturulurken Hata Oluştu Tekrar Deneyiniz!');
            });
        }
        else {
            console.log(form);
            this.mainService.updateData('products', form._id, schema).then((res) => {
                if (res.updated) {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].PRODUCT_UPDATED, res.id, `${form.name} adlı Ürün Güncellendi`);
                    if (this.productRecipe.length > 0) {
                        if (this.recipe.length == 0) {
                            let schema = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["h" /* Recipe */](form._id, this.productRecipe);
                            this.mainService.addData('recipes', schema);
                        }
                        else {
                            this.productRecipe = this.productRecipe.concat(this.recipe);
                            this.mainService.updateData('recipes', this.recipeId, { recipe: this.productRecipe });
                        }
                    }
                    // this.fillData();
                    this.messageService.sendMessage('Ürün Düzenlendi');
                }
            });
        }
        // this.recipesForm.reset();
        this.productForm.reset();
        $('#productModal').modal('hide');
    }
    updateProduct(id) {
        this.selectedId = id;
        this.productRecipe = [];
        this.recipesTable = [];
        this.oldRecipes = [];
        this.recipe = [];
        this.productSpecs = [];
        this.productExtras = [];
        this.onUpdate = true;
        this.mainService.getData('products', id).then(result => {
            this.selectedProduct = result;
            this.mainService.getAllBy('sub_categories', { cat_id: result.cat_id }).then(res => {
                this.subCats = res.docs;
            });
            result.note = "";
            if (result.specifies == undefined || result.specifies == null) {
                result.specifies = [];
            }
            if (result.extras == undefined || result.extras == null) {
                result.extras = [];
            }
            this.productSpecs = result.specifies;
            this.productExtras = result.extras;
            if (result.subcat_id == undefined) {
                result.subcat_id = "";
            }
            if (!result.notes) {
                result.notes = '';
            }
            this.productType = result.type;
            console.log(result);
            this.productForm.setValue(result);
            $('#productModal').modal('show');
        });
        this.mainService.getAllBy('recipes', { product_id: id }).then(result => {
            if (result.docs.length > 0) {
                this.hasRecipe = true;
                this.recipeId = result.docs[0]._id;
                let recipes = result.docs[0].recipe;
                this.recipe = result.docs[0].recipe;
                for (let prop in recipes) {
                    this.mainService.getData('stocks', recipes[prop].stock_id).then(result => {
                        this.oldRecipes.push({ id: recipes[prop].stock_id, name: result.name, amount: recipes[prop].amount, unit: result.unit });
                    });
                }
            }
            else {
                this.hasRecipe = false;
            }
        });
    }
    removeProduct() {
        let isOk = confirm('Ürünü Silmek Üzerisiniz..');
        if (isOk) {
            this.mainService.removeData('products', this.selectedId).then((result) => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].PRODUCT_DELETED, result.id, `${this.productForm.value.name} adlı Ürün Silindi`);
                this.mainService.getAllBy('reports', { connection_id: result.id }).then(res => {
                    if (res.docs.length > 0)
                        this.mainService.removeData('reports', res.docs[0]._id);
                });
                this.mainService.getAllBy('recipes', { product_id: result.id }).then(res => {
                    if (res.docs.length > 0)
                        this.mainService.removeData('recipes', res.docs[0]._id);
                });
                this.messageService.sendMessage('Ürün Silindi!');
                // this.fillData();
            });
        }
    }
    setProductType(value) {
        this.productType = value;
        if (value == 2) {
            if (this.oldRecipes.length > 1) {
                let isOK = confirm('Manuel Stok tipi için tek bir Stok kaydı girebilirsiniz. 2. Stok ve Ürün Durumları silinecektir.');
                if (isOK) {
                    let recipeWillLost = this.oldRecipes.pop();
                    this.removeRecipe('old', recipeWillLost.id);
                }
                else {
                    this.productType = 1;
                    this.productTypeSelect.nativeElement.value = 1;
                }
            }
            if (this.productRecipe.length > 0) {
                this.productRecipe.pop();
                this.recipesTable.pop();
            }
            this.productSpecs = [];
        }
    }
    addSpecies(speciesForm) {
        let form = speciesForm.value;
        if (form.spec_name == '' || form.spec_name == null || form.spec_price <= 0 || form.spec_price == undefined) {
            this.messageService.sendMessage('Durum Notu ve Fiyatı Boş Bırakılamaz');
            return false;
        }
        let spec = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["e" /* ProductSpecs */](form.spec_name, form.spec_price);
        this.productSpecs.push(spec);
        speciesForm.reset();
    }
    addExtras(extrasForm) {
        let form = extrasForm.value;
        if (form.extra_name == '' || form.extra_name == null || form.extra_price <= 0 || form.extra_price == undefined) {
            this.messageService.sendMessage('İlave Notu ve Fiyatı Boş Bırakılamaz');
            return false;
        }
        let extra = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["d" /* ProductExtras */](form.extra_name, form.extra_price);
        this.productExtras.push(extra);
        extrasForm.reset();
    }
    removeSpecies(index) {
        this.productSpecs.splice(index, 1);
    }
    removeExtras(index) {
        this.productExtras.splice(index, 1);
    }
    addRecipe(recipesForm) {
        let form = recipesForm.value;
        if (!form.stock_id) {
            this.messageService.sendMessage('Stok Seçimi Yapmalısınız!');
            return false;
        }
        if (!form.amount || form.amount == 0) {
            this.messageService.sendMessage('Birim Miktarı Girmelisiniz!');
            return false;
        }
        let item = new __WEBPACK_IMPORTED_MODULE_2__mocks_product__["b" /* Ingredient */](form.stock_id, form.amount);
        this.mainService.getData('stocks', form.stock_id).then(result => {
            // if (form.amount < result.left_total) {
            if (this.productRecipe.find(item => item.stock_id == form.stock_id)) {
                this.messageService.sendMessage('İçerik daha önce tanımlanmış!');
            }
            else if (this.oldRecipes.find(item => item.id == form.stock_id)) {
                this.messageService.sendMessage('İçerik daha önce tanımlanmış!');
            }
            else {
                this.productRecipe.push(item);
                this.recipesTable.push({ id: form.stock_id, name: this.stockName, amount: form.amount, unit: this.stockUnit });
                this.hasRecipe = true;
            }
            // } else {
            //   this.messageService.sendMessage('Elinizdeki  kalan stok miktarından fazla giremezsiniz.')
            // }
            recipesForm.reset();
        });
    }
    removeRecipe(type, id) {
        switch (type) {
            case 'new':
                this.productRecipe = this.productRecipe.filter(item => item.stock_id != id);
                this.recipesTable = this.recipesTable.filter(item => item.id != id);
                if (this.recipesTable.length == 0) {
                    if (this.oldRecipes.length == 0) {
                        this.hasRecipe = false;
                    }
                }
                break;
            case 'old':
                this.recipe = this.recipe.filter(item => item.stock_id != id);
                this.productRecipe = this.productRecipe.filter(item => item.stock_id != id);
                this.oldRecipes = this.oldRecipes.filter(item => item.id != id);
                if (this.oldRecipes.length == 0) {
                    if (this.recipesTable.length == 0) {
                        this.hasRecipe = false;
                    }
                    this.mainService.removeData('recipes', this.recipeId);
                }
                else {
                    this.mainService.updateData('recipes', this.recipeId, { recipe: this.recipe });
                }
                break;
            default:
                break;
        }
    }
    onStockChange(value) {
        this.mainService.getData('stocks', value).then(result => {
            this.stockUnit = result.unit;
            this.stockName = result.name;
        });
    }
    filterProducts(value) {
        let regexp = new RegExp(value, 'i');
        this.mainService.getAllBy('products', { name: { $regex: regexp } }).then(res => {
            this.products = res.docs;
            this.products = this.products.sort((a, b) => a.price - b.price);
        });
    }
    setDefault() {
        this.productRecipe = [];
        this.productSpecs = [];
        this.productExtras = [];
        this.recipesTable = [];
        this.oldRecipes = [];
        this.recipe = [];
        this.subCats = [];
        this.sub_categories = [];
        this.selectedProduct = undefined;
        this.selectedCat = undefined;
        this.selectedSubCat = undefined;
        this.selectedId = undefined;
        this.onUpdate = false;
        this.hasRecipe = false;
        this.productForm.reset();
        this.catDetails.reset();
        this.categoryForm.reset();
        this.subCatForm.reset();
    }
    fillData() {
        this.mainService.getAllBy('categories', {}).then(result => this.categories = result.docs);
        this.mainService.getAllBy('products', {}).then(result => {
            this.products = result.docs;
            this.products = this.products.sort((a, b) => a.price - b.price);
        });
        this.mainService.getAllBy('stocks', {}).then(result => this.stocks = result.docs);
        this.mainService.getAllBy('settings', { key: 'Printers' }).then(res => this.printers = res.docs[0].value);
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('catDetails'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], MenuSettingsComponent.prototype, "catDetails", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('subCatForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], MenuSettingsComponent.prototype, "subCatForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('productForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], MenuSettingsComponent.prototype, "productForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('categoryForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], MenuSettingsComponent.prototype, "categoryForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('recipesForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], MenuSettingsComponent.prototype, "recipesForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('productTypeSelect'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], MenuSettingsComponent.prototype, "productTypeSelect", void 0);
MenuSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-menu-settings',
        template: __webpack_require__("./src/app/components/settings/menu-settings/menu-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/menu-settings/menu-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_log_service__["a" /* LogService */]])
], MenuSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/printer-settings/printer-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n    <li class=\"nav-item\">\n      <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#recipes\" role=\"tab\">\n        <i class=\"fa fa-print\" aria-hidden=\"true\"></i> Yazıcılar</a>\n    </li>\n    <li class=\"nav-item\">\n      <a class=\"nav-link\" data-toggle=\"tab\" href=\"#users\" role=\"tab\">\n        <i class=\"fa fa-scroll\" aria-hidden=\"true\"></i> Kağıt</a>\n    </li>\n    <li class=\"nav-item\">\n      <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#auths\" role=\"tab\">\n        <i class=\"fa fa-shield\" aria-hidden=\"true\"></i> Durumlar</a>\n    </li>\n    <li class=\"nav-item\">\n      <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#auths\" role=\"tab\">\n        <i class=\"fa fa-credit-card\" aria-hidden=\"true\"></i> Koşullar</a>\n    </li>\n  </ul>\n\n  <div class=\"tab-content\">\n      <div class=\"tab-pane active\" id=\"recipes\" role=\"tabpanel\">\n          <div class=\"card ntb\">\n            <div class=\"card-header\">\n              <h5 class=\"mt-2\">Reçeteler</h5>\n            </div>\n            <div class=\"card-body tab-height flow\">\n      \n            </div>\n            <div class=\"card-footer\">\n              <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n            </div>\n          </div>\n        </div>\n      <div class=\"tab-pane\" id=\"auths\" role=\"tabpanel\">\n        <div class=\"card ntb\">\n          <div class=\"card-header\">\n            <h5 class=\"mt-2\">Kullanıcı İzinleri</h5>\n          </div>\n          <div class=\"card-body tab-height flow\">\n    \n          </div>\n          <div class=\"card-footer\">\n            <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n          </div>\n        </div>\n      </div>\n    </div>";

/***/ }),

/***/ "./src/app/components/settings/printer-settings/printer-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/printer-settings/printer-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PrinterSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let PrinterSettingsComponent = class PrinterSettingsComponent {
    constructor() { }
    ngOnInit() {
    }
};
PrinterSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-printer-settings',
        template: __webpack_require__("./src/app/components/settings/printer-settings/printer-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/printer-settings/printer-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [])
], PrinterSettingsComponent);



/***/ }),

/***/ "./src/app/components/settings/recipe-settings/recipe-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#recipes\" role=\"tab\">\n      <i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Reçeteler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#ingredients\" role=\"tab\">\n      <i class=\"fa fa-glass\" aria-hidden=\"true\"></i> Ürünler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#occations\" role=\"tab\">\n      <i class=\"fa fa-question\" aria-hidden=\"true\"></i> Durumlar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#conditions\" role=\"tab\">\n      <i class=\"fa fa-exclamation\" aria-hidden=\"true\"></i> Koşullar</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <!-- <div class=\"tab-pane active\" id=\"groups\" role=\"tabpanel\">\n        <div class=\"card ntb\">\n          <div class=\"card-header\">\n            <div class=\"row\">\n              <div class=\"col-lg-8\">\n                <h5 class=\"mt-2\">Kullanıcı Grupları</h5>\n              </div>\n              <div class=\"col-lg-4 pr-2 pl-0\">\n                <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#groupModal\">\n                  <i class=\"fa fa-plus\"></i> Kullanıcı Grubu Ekle\n                </button>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-body p-0 tab-height\">\n            <div class=\"row\">\n              <div class=\"col-lg-3 pr-0\">\n                <div class=\"card tab-inside-height\">\n                  <div class=\"card-header\">\n                    Gruplar\n                  </div>\n                  <div class=\"card-body p-0 flow\">\n                    <div class=\"list-group\">\n                      <div *ngFor=\"let item of groups\" class=\"btn-group btn-group-justify\">\n                        <button (click)=\"getGroup(item._id)\" [ngClass]=\"{'list-group-item-warning' : selectedGroup == item._id}\"\n                          type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"col-lg-9 pl-0\">\n                <form #groupDetailForm=\"ngForm\" (ngSubmit)=\"updateGroup(groupDetailForm)\">\n                  <div class=\"card tab-inside-height\">\n                    <div class=\"card-header\">\n                      Ayrıntılar\n                    </div>\n                    <div class=\"card-body p-2 flow\">\n                      <h1 *ngIf=\"selectedGroup == undefined\" class=\"text-center mt-5\">Listeden Grup Seçiniz</h1>\n                      <div [hidden]=\"selectedGroup == undefined\">\n                        <input type=\"hidden\" name=\"_id\" ngModel />\n                        <input type=\"hidden\" name=\"_rev\" ngModel />\n                        <input type=\"hidden\" name=\"status\" ngModel />\n                        <input type=\"hidden\" name=\"timestamp\" ngModel />\n                        <div class=\"form-group mb-2\">\n                          <div class=\"input-group\">\n                            <div class=\"input-group-prepend\">\n                              <div class=\"input-group-text\">Grup Adı</div>\n                            </div>\n                            <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n                          </div>\n                        </div>\n                        <div class=\"form-group mb-2\">\n                          <div class=\"input-group\">\n                            <div class=\"input-group-prepend\">\n                              <div class=\"input-group-text\">Grup Açıklaması</div>\n                            </div>\n                            <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n                          </div>\n                        </div>\n                        <h5 class=\"mt-4\">Erişim Hakları</h5>\n                        <table class=\"table  table-bordered text-center mb-0\">\n                          <thead>\n                            <tr>\n                              <th class=\"text-center\">Satış</th>\n                              <th class=\"text-center\">Kasa</th>\n                              <th class=\"text-center\">Gün Sonu</th>\n                              <th class=\"text-center\">Raporlar</th>\n                              <th class=\"text-center\">Ayarlar</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            <tr class=\"text-center\">\n                              <td>\n                                <input type=\"checkbox\" name=\"store\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"cashbox\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"endoftheday\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"reports\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"settings\" class=\"form-control\" ngModel />\n                              </td>\n                            </tr>\n                          </tbody>\n                        </table>\n                        <h5 class=\"mt-3\">Grup İzinleri</h5>\n                        <table class=\"table  table-bordered text-center\">\n                          <thead>\n                            <tr>\n                              <th width=\"20%\" class=\"text-center\">Hesap İptal</th>\n                              <th width=\"20%\" class=\"text-center\">Ürün İptal</th>\n                              <th width=\"20%\" class=\"text-center\">Ödeme</th>\n                              <th width=\"20%\" class=\"text-center\">İndirim</th>\n                              <th width=\"20%\" class=\"text-center\">Gün Sonu</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            <tr class=\"text-center\">\n                              <td>\n                                <input type=\"checkbox\" name=\"cancelCheck\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"cancelProduct\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"payment\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"discount\" class=\"form-control\" ngModel />\n                              </td>\n                              <td>\n                                <input type=\"checkbox\" name=\"end\" class=\"form-control\" ngModel />\n                              </td>\n                            </tr>\n                          </tbody>\n                        </table>\n                      </div>\n                    </div>\n                    <div class=\"card-footer\" [hidden]=\"selectedGroup == undefined\">\n                      <div class=\"row\">\n                        <div class=\"col pr-1\">\n                          <button type=\"button\" (click)=\"removeGroup(selectedGroup)\" class=\"btn btn-danger btn-md btn-block\">\n                            <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Grubu Sil</button>\n                        </div>\n                        <div class=\"col pl-1\">\n                          <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                            <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer\">\n            <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n          </div>\n        </div>\n      </div> -->\n  <div class=\"tab-pane\" id=\"recipes\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Reçeteler</h5>\n      </div>\n      <div class=\"card-body p-0 tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane active\" id=\"ingredients\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Ürün İçerikleri</h5>\n      </div>\n      <div class=\"card-body tab-height flow p-0\">\n        <table class=\"table table-striped  table-bordered\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"6%\"><i class=\"fa fa-glass\"></i></th>\n              <th width=\"20%\">Ürün</th>\n              <th>İçerik</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let recipe of recipes let i = index;\">\n              <td>{{i+1}}</td>\n              <td><b>{{recipe.product_id | general:'products' | async}}</b></td>\n              <td>\n                <span *ngFor=\"let ing of recipe.recipe\" class=\"badge badge-success mr-1 p-2\">\n                  {{ing.amount}} {{ing.stock_id | general:'stocks':'unit' | async}} {{ing.stock_id | general:'stocks' |\n                  async}}\n                </span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"occations\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Reçete Durumları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n\n  <div class=\"tab-pane\" id=\"conditions\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Reçete Sayım Koşulları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/recipe-settings/recipe-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".badge {\n  font-size: 15px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/recipe-settings/recipe-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecipeSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let RecipeSettingsComponent = class RecipeSettingsComponent {
    constructor(mainService) {
        this.mainService = mainService;
    }
    ngOnInit() {
        this.fillData();
    }
    fillData() {
        this.mainService.getAllBy('recipes', {}).then(res => {
            this.recipes = res.docs;
        });
    }
};
RecipeSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-recipe-settings',
        template: __webpack_require__("./src/app/components/settings/recipe-settings/recipe-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/recipe-settings/recipe-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */]])
], RecipeSettingsComponent);



/***/ }),

/***/ "./src/app/components/settings/restaurant-settings/restaurant-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#floor\" role=\"tab\">\n      <i class=\"fa fa-sitemap\" aria-hidden=\"true\"></i> Bölgeler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#table\" role=\"tab\">\n      <i class=\"fa fa-square\" aria-hidden=\"true\"></i> Masalar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#store\" role=\"tab\">\n      <i class=\"fa fa-map-marker\" aria-hidden=\"true\"></i> Kroki</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#store\" role=\"tab\">\n      <i class=\"fa fa-suitcase\" aria-hidden=\"true\"></i> İşletme</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"floor\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Bölge Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#areaModal\">\n              <i class=\"fa fa-plus\"></i> Bölge Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Bölgeler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let item of floors\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getFloor(item)\" [ngClass]=\"{'list-group-item-warning' : selectedFloor == item._id}\" type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #areaDetailForm=\"ngForm\" (ngSubmit)=\"updateFloor(areaDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedFloor == undefined\" class=\"text-center mt-5\">Listeden Bölge Seçiniz</h1>\n                  <div [hidden]=\"selectedFloor == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel>\n                    <input type=\"hidden\" name=\"_rev\" ngModel>\n                    <input type=\"hidden\" name=\"status\" ngModel>\n                    <input type=\"hidden\" name=\"timestamp\" ngModel>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Bölge Adı\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Açıklama\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Durum\n                          </div>\n                        </div>\n                        <select name=\"special\" class=\"form-control form-control-lg\" ngModel>\n                          <option value=\"1\">Herkese Açık</option>\n                          <option value=\"2\">Sadece Rezervasyon</option>\n                          <option value=\"3\">İşletmeye Özel</option>\n                        </select>\n                      </div>\n                    </div>\n                    <h5 class=\"mt-4 hidden-lg-down\">Bölge Özellikleri</h5>\n                    <table class=\"table  table-bordered text-center mb-0\">\n                      <thead>\n                        <tr>\n                          <th width=\"20%\" class=\"text-center\">Rezervasyon</th>\n                          <th width=\"20%\" class=\"text-center\">Açık Hava</th>\n                          <th width=\"20%\" class=\"text-center\">Sigara</th>\n                          <th width=\"20%\" class=\"text-center\">Müzik</th>\n                          <th width=\"20%\" class=\"text-center\">Etkinlik</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr class=\"text-center\">\n                          <td>\n                            <input type=\"checkbox\" name=\"reservation\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"air\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"cigarate\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"music\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"events\" class=\"form-control\" ngModel />\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedFloor == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col pr-1\">\n                      <button type=\"button\" (click)=\"removeFloor()\" class=\"btn btn-md btn-block btn-danger\">\n                        <i class=\"fa fa-remove\" aria-hidden=\"true\"></i> Bölgeyi Sil\n                      </button>\n                    </div>\n                    <div class=\"col pl-1\">\n                      <button type=\"submit\" class=\"btn btn-md btn-block btn-success\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"table\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Masa Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button [disabled]=\"floors?.length == 0\" class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#tableModal\">\n              <i class=\"fa fa-plus\"></i> Masa Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Bölgeler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"fillData()\" type=\"button\" class=\"list-group-item list-group-item-action\">Bütün\n                    Masalar</button>\n                  <div *ngFor=\"let item of floors\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getTablesByFloor(item._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Masalar\n                  </div>\n                  <div class=\"col-lg-6 pl-0 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #tableName type=\"text\" placeholder=\"Masa Adı Giriniz..\" (focus)=\"getTablesByFloor(null)\" (click)=\"tableName.value = '';\" (keydown)=\"filterTables(tableName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div *ngIf=\"tables?.length == 0\" class=\"row mt-5\">\n                  <div class=\"col-lg-12 mt-5\">\n                    <h2 class=\"text-center mt3\">Eşleşen Masa Bulunamadı</h2>\n                  </div>\n                </div>\n                <div *ngIf=\"tables?.length > 0\">\n                  <table class=\"table table-hover  table-bordered table-striped table-dark mb-0\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"7%\">#</th>\n                        <th width=\"43%\">Masa Adı</th>\n                        <th width=\"25%\">Kapasite</th>\n                        <th width=\"25%\">Bölüm</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let table of tables; let i = index;\" (click)=\"updateTable(table._id)\">\n                        <td>{{i+1}}</td>\n                        <td>{{table.name}}</td>\n                        <td><i class=\"fa fa-user\"></i> {{table.capacity}} Kişilik</td>\n                        <td>{{table.floor_id | general:'floors':'name' | async}}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                  <!-- <div class=\"col-lg-4 mb-2 col-card\">\n                    <div  class=\"card tableCard\">\n                      <div class=\"card-body\">\n                        <h2 class=\"card-title\">{{table.name}}</h2>\n                        <p class=\"card-text\">\n                           {{table.capacity}} </p>\n                      </div>\n                    </div>\n                  </div> -->\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"store\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">İşletme Ayarları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div *ngIf=\"false\" class=\"row\">\n  <div class=\"col-lg-4\">\n    <button class=\"btn btn-danger btn-lg btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#areaModal\">\n      <i class=\"fa fa-plus\"></i> Bölüm Ekle</button>\n    <div class=\"card inside-height mt-3\">\n      <div class=\"card-header\">\n        Bölümler\n      </div>\n      <div class=\"card-body p-0 flow\">\n        <div class=\"list-group\">\n          <button type=\"button\" (click)=\"fillData()\" class=\"list-group-item list-group-item-action\">Bütün Bölümler</button>\n          <div *ngFor=\"let floor of floors\" class=\"btn-group btn-group-justify\">\n            <button (click)=\"getTablesBy(floor._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{floor.name}}</button>\n            <button (click)=\"removeFloor(floor._id)\" class=\"btn btn-danger\">\n              <i class=\"fa fa-remove\" aria-hidden=\"true\"></i>\n            </button>\n            <button (click)=\"updateData('floors',floor._id,areaForm)\" class=\"btn btn-warning\">\n              <i class=\"fa fa-edit\" aria-hidden=\"true\"></i>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-lg-8\">\n    <button class=\"btn btn-danger btn-lg btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#tableModal\">\n      <i class=\"fa fa-plus\"></i> Masa Ekle</button>\n    <div class=\"card inside-height mt-3\">\n      <div class=\"card-header\">\n        Masalar\n      </div>\n      <div id=\"productHolder\" class=\"card-body\">\n        <div class=\"row\">\n          <div *ngFor=\"let table of tables\" class=\"col-lg-4 mb-2 col-card\">\n            <div (click)=\"updateData('tables',table._id,tableForm)\" class=\"card tableCard\">\n              <div class=\"card-body\">\n                <h2 class=\"card-title\">{{table.name}}</h2>\n                <p class=\"card-text\">\n                  <i class=\"fa fa-user\"></i> {{table.capacity}} Kişilik</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"areaModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"modelTitleId\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Bölge Oluştur</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #areaForm=\"ngForm\" (ngSubmit)=\"addFloor(areaForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input type=\"hidden\" name=\"_id\" ngModel />\n          <input type=\"hidden\" name=\"_rev\" ngModel />\n          <input type=\"hidden\" name=\"status\" ngModel />\n          <input type=\"hidden\" name=\"timestamp\" ngModel />\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Bölüm Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Durum</div>\n              </div>\n              <select name=\"special\" class=\"form-control form-control-lg\" ngModel>\n                <option value=\"1\">Herkese Açık</option>\n                <option value=\"2\">Sadece Rezervasyon</option>\n                <option value=\"3\">İşletmeye Özel</option>\n              </select>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Açıklama</div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n          <h5 class=\"mt-3\">Bölge Özellikleri</h5>\n          <table class=\"table  table-bordered text-center\">\n            <thead>\n              <tr>\n                <th width=\"20%\" class=\"text-center\">Rezervasyon</th>\n                <th width=\"20%\" class=\"text-center\">Açık Hava</th>\n                <th width=\"20%\" class=\"text-center\">Sigara</th>\n                <th width=\"20%\" class=\"text-center\">Müzik</th>\n                <th width=\"20%\" class=\"text-center\">Etkinlik</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"text-center\">\n                <td>\n                  <input type=\"checkbox\" name=\"reservation\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"air\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"cigarate\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"music\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"events\" class=\"form-control\" ngModel />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"tableModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Masa</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #tableForm=\"ngForm\" (ngSubmit)=\"addTable(tableForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input type=\"hidden\" name=\"_id\" ngModel>\n          <input type=\"hidden\" name=\"_rev\" ngModel>\n          <input type=\"hidden\" name=\"status\" ngModel>\n          <input type=\"hidden\" name=\"timestamp\" ngModel>\n          <input type=\"hidden\" name=\"position\" ngModel>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Masa Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Bağlı Bölüm</div>\n              </div>\n              <select type=\"text\" name=\"floor_id\" class=\"form-control form-control-lg\" ngModel>\n                <option *ngFor=\"let item of floors\" value=\"{{item._id}}\">{{item.name}}</option>\n              </select>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kişi Sayısı</div>\n              </div>\n              <input type=\"number\" name=\"capacity\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Açıklama</div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" (click)=\"removeTable(id)\" class=\"btn btn-danger btn-lg\">Masayı Sil</button>\n          <button type=\"button\" type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/settings/restaurant-settings/restaurant-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/restaurant-settings/restaurant-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RestaurantSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_report__ = __webpack_require__("./src/app/mocks/report.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_table__ = __webpack_require__("./src/app/mocks/table.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let RestaurantSettingsComponent = class RestaurantSettingsComponent {
    constructor(mainService, messageService, logService) {
        this.mainService = mainService;
        this.messageService = messageService;
        this.logService = logService;
        this.onUpdate = false;
        this.fillData();
    }
    ngOnInit() {
    }
    setDefault() {
        this.onUpdate = false;
        this.selectedTable = undefined;
        this.selectedFloor = undefined;
        this.areaForm.reset();
        this.tableForm.reset();
    }
    getTablesByFloor(id) {
        if (id) {
            this.mainService.getAllBy('tables', { floor_id: id }).then(result => {
                this.tables = result.docs;
                this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name));
            });
        }
        else {
            this.mainService.getAllBy('tables', {}).then(result => {
                this.tables = result.docs;
                this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name));
            });
        }
    }
    getFloor(floor) {
        this.selectedFloor = floor._id;
        floor = Object.assign(floor, floor.conditions);
        delete floor.conditions;
        this.areaDetailForm.setValue(floor);
    }
    addFloor(areaForm) {
        let form = areaForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Bölüm Adı Belirtmelisiniz');
            return false;
        }
        let areaSpecs = new __WEBPACK_IMPORTED_MODULE_3__mocks_table__["b" /* FloorSpecs */](form.air, form.cigarate, form.reservation, form.music, form.events);
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_table__["a" /* Floor */](form.name, form.description, 1, Date.now(), form.special, areaSpecs);
        this.mainService.addData('floors', schema).then(() => {
            this.fillData();
            this.messageService.sendMessage('Bölüm Oluşturuldu!');
            areaForm.reset();
        });
        $('#areaModal').modal('hide');
    }
    updateFloor(areaDetailForm) {
        let form = areaDetailForm.value;
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_table__["a" /* Floor */](form.name, form.description, 1, Date.now(), form.special, new __WEBPACK_IMPORTED_MODULE_3__mocks_table__["b" /* FloorSpecs */](form.air, form.cigarate, form.reservation, form.music, form.events), form._id, form._rev);
        this.mainService.updateData('floors', form._id, schema).then(res => {
            this.selectedFloor = undefined;
            this.fillData();
            this.messageService.sendMessage('Bölüm Güncellendi!');
        });
    }
    removeFloor() {
        let isOk = confirm('Bölümü Silmek Üzeresiniz. Bölüme Dahil Olan Masalarda Silinecektir.');
        if (isOk) {
            this.mainService.removeData('floors', this.selectedFloor).then(() => {
                this.mainService.getAllBy('tables', { floor_id: this.selectedFloor }).then(result => {
                    let data = result.docs;
                    for (let prop in data) {
                        this.mainService.removeData('tables', data[prop]._id).then(result => {
                            this.mainService.getAllBy('reports', { connection_id: result.id }).then((res) => {
                                if (res.docs.length > 0)
                                    this.mainService.removeData('reports', res.docs[0]._id);
                            });
                        });
                    }
                    this.messageService.sendMessage('Bölüm ve Masalar Silindi!');
                    this.selectedFloor = undefined;
                    this.fillData();
                });
            });
        }
    }
    addTable(tableForm) {
        let form = tableForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Masa Adı Belirtmelisiniz');
            return false;
        }
        else if (!form.floor_id) {
            this.messageService.sendMessage('Kategori Seçmelisiniz');
            return false;
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_table__["c" /* Table */](form.name, form.floor_id, form.capacity, form.description, 1, Date.now(), [], { height: 75, width: 75, x: 0, y: 0, type: __WEBPACK_IMPORTED_MODULE_3__mocks_table__["e" /* TableType */].SQUARE }, form._id, form._rev);
        if (form._id == undefined) {
            this.mainService.addData('tables', schema).then((response) => {
                this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_2__mocks_report__["b" /* Report */]('Table', response.id, 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), form.name, Date.now())).then(res => {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].TABLE_CREATED, res.id, `${form.name} adlı Masa oluşturuldu.`);
                });
                this.fillData();
                this.messageService.sendMessage('Masa Oluşturuldu.');
                tableForm.reset();
            });
        }
        else {
            this.mainService.updateData('tables', form._id, schema).then(() => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].TABLE_UPDATED, form._id, `${this.tableForm.value.name} adlı Masa Güncellendi.`);
                this.fillData();
                this.messageService.sendMessage('Masa Güncellendi.');
                tableForm.reset();
            });
        }
        $('#tableModal').modal('hide');
    }
    updateTable(id) {
        this.onUpdate = true;
        this.selectedTable = id;
        this.mainService.getData('tables', id).then((result) => {
            delete result.customers;
            if (!result.position) {
                result.position = { height: 75, width: 75, x: 0, y: 0, type: __WEBPACK_IMPORTED_MODULE_3__mocks_table__["e" /* TableType */].SQUARE };
            }
            this.tableForm.setValue(result);
            $('#tableModal').modal('show');
        });
    }
    removeTable() {
        let isOk = confirm('Masayı Silmek Üzeresiniz!');
        if (isOk) {
            this.mainService.removeData('tables', this.selectedTable).then((result) => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].TABLE_DELETED, result._id, `${this.tableForm.value.name} adlı Masa Silindi.`);
                this.mainService.getAllBy('reports', { connection_id: result.id }).then((res) => {
                    if (res.docs.length > 0)
                        this.mainService.removeData('reports', res.docs[0]._id);
                });
                this.fillData();
                this.messageService.sendMessage('Masa Silindi.');
                $('#tableModal').modal('hide');
            });
        }
        else {
            return false;
        }
    }
    filterTables(value) {
        let regexp = new RegExp(value, 'i');
        this.mainService.getAllBy('tables', { name: { $regex: regexp } }).then(res => {
            this.tables = res.docs;
            this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name));
        });
    }
    fillData() {
        this.mainService.getAllBy('floors', {}).then((result) => {
            this.floors = result.docs;
            this.floors = this.floors.sort((a, b) => a.timestamp - b.timestamp);
        });
        this.mainService.getAllBy('tables', {}).then((result) => {
            this.tables = result.docs;
            this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name));
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('areaForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], RestaurantSettingsComponent.prototype, "areaForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('areaDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], RestaurantSettingsComponent.prototype, "areaDetailForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('tableForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], RestaurantSettingsComponent.prototype, "tableForm", void 0);
RestaurantSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-restaurant-settings',
        template: __webpack_require__("./src/app/components/settings/restaurant-settings/restaurant-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/restaurant-settings/restaurant-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_log_service__["a" /* LogService */]])
], RestaurantSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/settings.component.html":
/***/ (function(module, exports, __webpack_require__) {

module.exports = "<div class=\"row\">\n  <div id=\"settings-holder\" class=\"col-lg-2\">\n    <div class=\"card\">\n      <div class=\"card-body\" [ngClass]=\"{'bg-danger text-white':selected == 1}\" (click)=\"selected = 1\">\n        <h2>\n          <i class=\"fa fa-users\"></i>\n          <span>Kullanıcılar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 2}\" (click)=\"selected = 2\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-glass\"></i>\n          <span>Ürünler</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 3}\" (click)=\"selected = 3\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-square\"></i>\n          <span>Masalar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 4}\" (click)=\"selected = 4\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-cube\"></i>\n          <span>Stoklar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 5}\" (click)=\"selected = 5\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-file\"></i>\n          <span>Reçeteler</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 6}\" (click)=\"selected = 6\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-address-card\"></i>\n          <span>Müşteriler</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 7}\" (click)=\"selected = 7\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-print\"></i>\n          <span>Yazıcılar</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 8}\" (click)=\"selected = 8\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-server\"></i>\n          <span>Kasa</span>\n        </h2>\n      </div>\n    </div>\n    <div class=\"card\" [ngClass]=\"{'bg-danger text-white':selected == 9}\" (click)=\"selected = 9\">\n      <div class=\"card-body\">\n        <h2>\n          <i class=\"fa fa-cogs\"></i>\n          <span>Ayarlar</span>\n        </h2>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-lg-10 pl-0\">\n    <div class=\"card full-height\">\n      <div class=\"card-body\">\n        <div *ngIf=\"selected == undefined\" class=\"container text-center\">\n          <div class=\"jumbotron m-0 p-0\">\n            <img src=\"" + __webpack_require__("./src/assets/logo.svg") + "\" height=\"200px\" style=\"margin-top:15px; margin-bottom:15px;\" alt=\"\">\n            <p><strong>Quickly Yazılım Kurumsal Hizmetler Sanayii ve Dış Tic. Ltd. Şti.</strong></p>\n            <hr class=\"my-4\">\n          </div>\n          <img src=\"{{logo}}\" class=\"logo\" alt=\"\">\n          <p>{{storeInfo?.name}}</p>\n        </div>\n        <app-user-settings *ngIf=\"selected == 1\"></app-user-settings>\n        <app-menu-settings *ngIf=\"selected == 2\"></app-menu-settings>\n        <app-restaurant-settings *ngIf=\"selected == 3\"></app-restaurant-settings>\n        <app-stock-settings *ngIf=\"selected == 4\"></app-stock-settings>\n        <app-recipe-settings *ngIf=\"selected == 5\"></app-recipe-settings>\n        <app-customer-settings *ngIf=\"selected == 6\"></app-customer-settings>\n        <app-cashbox-settings *ngIf=\"selected == 8\"></app-cashbox-settings>\n        <app-application-settings *ngIf=\"selected == 9\"></app-application-settings>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".logo {\n  width: 300px; }\n\n@media screen and (min-width: 900px) {\n  #settings-holder .card {\n    height: 70px;\n    margin-bottom: 6px; }\n  #settings-holder .card-body {\n    padding: 23px 5px 20px 10px; }\n  #settings-holder h2 {\n    font-size: 17px;\n    margin-bottom: 0;\n    font-weight: bold; }\n    #settings-holder h2 i {\n      width: 14%;\n      text-align: center; } }\n\n@media screen and (min-width: 1200px) {\n  #settings-holder .card {\n    height: 70px;\n    margin-bottom: 6px; }\n  #settings-holder .card-body {\n    padding: 22px 5px 20px 10px; }\n  #settings-holder h2 {\n    font-size: 22px;\n    margin-bottom: 0;\n    font-weight: bold; }\n    #settings-holder h2 i {\n      width: 13%;\n      text-align: center; } }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let SettingsComponent = class SettingsComponent {
    constructor(electron, settingsService) {
        this.electron = electron;
        this.settingsService = settingsService;
        this.logo = this.electron.appRealPath + '/data/customer.png';
    }
    ngOnInit() {
        this.settingsService.RestaurantInfo.subscribe(res => {
            this.storeInfo = res.value;
        });
    }
    ngOnDestroy() {
    }
};
SettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-settings',
        template: __webpack_require__("./src/app/components/settings/settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/settings.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */]])
], SettingsComponent);



/***/ }),

/***/ "./src/app/components/settings/stock-settings/stock-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#categories\" role=\"tab\">\n      <i class=\"fa fa-book\" aria-hidden=\"true\"></i> Kategoriler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#products\" role=\"tab\">\n      <i class=\"fa fa-archive\" aria-hidden=\"true\"></i> Stoklar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#occations\" role=\"tab\">\n      <i class=\"fa fa-truck\" aria-hidden=\"true\"></i> Tedarik</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#warehouse\" role=\"tab\">\n      <i class=\"fa fa-industry\" aria-hidden=\"true\"></i> Depo</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"categories\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Stok Kategori Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" data-toggle=\"modal\" data-target=\"#stockCat\" (click)=\"setDefault()\">\n              <i class=\"fa fa-plus\"></i> Kategori Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let cat of categories\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getStockCatDetail(cat)\" [ngClass]=\"{'list-group-item-warning' : selectedCat == cat}\"\n                      type=\"button\" class=\"list-group-item list-group-item-action\">{{cat.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #stockCatDetailForm=\"ngForm\" (ngSubmit)=\"updateCategory(stockCatDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedCat == undefined\" class=\"text-center mt-5\">Listeden Kategori Seçiniz</h1>\n                  <section [hidden]=\"selectedCat == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel>\n                    <input type=\"hidden\" name=\"_rev\" ngModel>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Kategori Adı\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Açıklama\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                  </section>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedCat == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col-lg-6 pr-1\">\n                      <button type=\"button\" (click)=\"removeCategory(selectedCat._id)\" class=\"btn btn-danger btn-md btn-block\">\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Kategoriyi Sil</button>\n                    </div>\n                    <div class=\"col-lg-6 pl-1\">\n                      <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"products\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Stoklar</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button [disabled]=\"categories == undefined || categories.length == 0\" class=\"btn btn-danger btn-md btn-block\"\n              (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#stock\">\n              <i class=\"fa fa-plus\"></i> Stok Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-xl-3 col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Kategoriler\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"fillData()\" type=\"button\" class=\"list-group-item list-group-item-action\">Bütün\n                    Stoklar</button>\n                  <button *ngFor=\"let cat of categories\" (click)=\"getStocks(cat._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">{{cat.name}}</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-xl-9 col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1 pr-0\">\n                    Stoklar\n                  </div>\n                  <div class=\"col-lg-6 pl-0 pr-2\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #stockName type=\"text\" placeholder=\"Stok Adı Giriniz..\" (focus)=\"fillData()\" (click)=\"stockName.value = '';\"\n                        (keydown)=\"filterStocks(stockName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body flow p-0\">\n                <section>\n                  <table class=\"table  table-bordered table-dark table-striped table-hover\">\n                    <thead class=\"thead-dark\">\n                      <tr>\n                        <th width=\"6%\">#</th>\n                        <th width=\"29%\">Stok</th>\n                        <th colspan=\"2\" width=\"30%\">Son Giriş</th>\n                        <th colspan=\"3\" width=\"35%\">Kalan Miktar</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr *ngFor=\"let item of stocks; let i=index;\" (click)=\"getStockDetail(item);\">\n                        <td>{{i+1}}</td>\n                        <td>{{item.name}}</td>\n                        <td>{{item.first_quantity}}x</td>\n                        <td>{{item.total}} {{item.unit}}</td>\n                        <td>{{item.quantity | number:'1.0-2'}}x</td>\n                        <td>{{item.left_total | number:'1.0-2'}}</td>\n                        <td>{{item.unit}}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                  <div *ngIf=\"stocks == undefined || stocks.length == 0\" class=\"row mt-5\">\n                    <div class=\"col-lg-12 mt-5\">\n                      <h2 class=\"text-center mt-3\">Eşleşen Stok Bulunamadı</h2>\n                    </div>\n                  </div>\n                </section>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"warehouse\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Depo Ayarları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" data-toggle=\"modal\" data-target=\"#warehouseModal\" (click)=\"setDefault()\">\n              <i class=\"fa fa-plus\"></i> Depo Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Depolar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let warehouse of warehouses\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getWarehouseDetail(warehouse)\" [ngClass]=\"{'list-group-item-warning' : selectedWarehouse == ware}\"\n                      type=\"button\" class=\"list-group-item list-group-item-action\">{{warehouse.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #stockCatDetailForm=\"ngForm\" (ngSubmit)=\"updateCategory(stockCatDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedWarehouse == undefined\" class=\"text-center mt-5\">Listeden Depo Seçiniz</h1>\n                  <section [hidden]=\"selectedWarehouse == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel>\n                    <input type=\"hidden\" name=\"_rev\" ngModel>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Kategori Adı\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">\n                            Açıklama\n                          </div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n                      </div>\n                    </div>\n                  </section>\n                </div>\n                  <div class=\"card-footer\" [hidden]=\"selectedWarehouse == undefined\">\n                    <div class=\"row\">\n                    <div class=\"col-lg-6 pr-1\">\n                      <button type=\"button\" (click)=\"removeWarehouse(selectedWarehouse._id)\" class=\"btn btn-danger btn-md btn-block\">\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Kategoriyi Sil</button>\n                    </div>\n                    <div class=\"col-lg-6 pl-1\">\n                      <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"occations\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Stok Ayarları</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"warehouseModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Depo</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #warehouseForm=\"ngForm\" (ngSubmit)=\"addWarehouse(warehouseForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input name=\"_id\" type=\"hidden\" ngModel />\n            <input name=\"_rev\" type=\"hidden\" ngModel />\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Depo Adı</div>\n            </div>\n            <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Açıklama</div>\n            </div>\n            <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Depo Türü</div>\n            </div>\n            <select name=\"category\" class=\"form-control form-control-lg\" ngModel>\n              <option value=\"0\">İşletme İçi Depo</option>\n              <option value=\"1\">İşletme Dışı Depo</option>\n            </select>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"stockCat\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Kategori</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #stockCatForm=\"ngForm\" (ngSubmit)=\"addCategory(stockCatForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input name=\"_id\" type=\"hidden\" ngModel />\n            <input name=\"_rev\" type=\"hidden\" ngModel />\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Kategori Adı</div>\n            </div>\n            <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">Açıklama</div>\n            </div>\n            <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"stock\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Stok</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #stockForm=\"ngForm\" (ngSubmit)=\"addStock(stockForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input name=\"_id\" type=\"hidden\" ngModel />\n            <input name=\"_rev\" type=\"hidden\" ngModel />\n            <input name=\"first_total\" type=\"hidden\" ngModel />\n            <input name=\"first_quantity\" type=\"hidden\" ngModel />\n            <input name=\"category\" type=\"hidden\" ngModel />\n            <input name=\"producer\" type=\"hidden\" ngModel />\n            <input name=\"product\" type=\"hidden\" ngModel />\n            <input name=\"supplier\" type=\"hidden\" ngModel />\n            <input name=\"total\" type=\"hidden\" ngModel />\n            <input name=\"warning_limit\" type=\"hidden\" ngModel />\n            <input type=\"hidden\" name=\"quantity\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-lg-12\">\n              <div *ngIf=\"onUpdate && selectedStock\" class=\"bodyquote mb-0 pr-1 pl-1\">\n                <p class=\"mb-2\">\n                  <strong [ngClass]=\"{'text-danger': selectedStock.left_total <= 0}\">{{selectedStock.name}}</strong>\n                  <small>({{selectedStock.category | general:'stocks_cat' | async}})</small>\n                </p>\n                <div class=\"progress\">\n                  <div [ngClass]=\"{'bg-danger':selectedStock.warning_limit >= selectedStock.left_total}\" class=\"progress-bar bg-warning progress-bar-striped\"\n                    role=\"progressbar\" style=\"height: 20px;\" [ngStyle]=\"{width:selectedStock.left_total/(selectedStock.total*selectedStock.first_quantity) | percent:'1.0-1'}\"\n                    [attr.aria-valuenow]=\"selectedStock.left_total\" aria-valuemin=\"0\" [attr.aria-valuemax]=\"selectedStock.total\"></div>\n                </div>\n                <small class=\"mt-2\">\n                  <span *ngIf=\"selectedStock.left_total > 0\"> Kalan : {{selectedStock.left_total | number:'1.0-2'}}\n                    {{selectedStock.unit}}</span>\n                  <span *ngIf=\"selectedStock.left_total <= 0\" class=\"text-danger\">Tükendi!</span>\n                  <span class=\"pull-right text-muted mt-1\">Stok Durumu:\n                    {{(selectedStock.left_total/(selectedStock.total*selectedStock.first_quantity))*100 | number:\n                    '1.0-2'}}%\n                  </span>\n                </small>\n              </div>\n              <div *ngIf=\"onUpdate\" class=\"input-group mb-3\">\n                <!-- <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Kalan</div>\n                </div> -->\n                <input type=\"hidden\" readonly name=\"left_total\" mask=\"separator.2\" thousandSeparator=\".\" class=\"form-control form-control-lg\" ngModel>\n                <input type=\"hidden\" name=\"timestamp\" ngModel>\n                <!-- <div class=\"input-group-append\">\n                  <div class=\"input-group-text\">{{unitName.value}}</div>\n                </div> -->\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\"> Stok Adı</div>\n                </div>\n                <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Kategori</div>\n                </div>\n                <select name=\"category\" (change)=\"onCategoryChange($event.target.value)\" class=\"form-control form-control-lg\" ngModel>\n                  <option *ngFor=\"let cat of categories\" value=\"{{cat?._id}}\">{{cat?.name}}</option>\n                </select>\n                <select name=\"sub_category\" class=\"form-control form-control-lg\" ngModel>\n                  <option *ngFor=\"let subcat of sub_categories\" value=\"{{subcat?._id}}\">{{subcat?.name}}</option>\n                </select>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Depo</div>\n                </div>\n                <select name=\"warehouse\" class=\"form-control form-control-lg\" ngModel>\n                  <option *ngFor=\"let warehouse of warehouses\" value=\"{{warehouse._id}}\">{{warehouse.name}}</option>\n                </select>\n              </div>\n              <div *ngIf=\"!onUpdate\" class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Adet</div>\n                </div>\n                <input type=\"number\" name=\"quantity\" class=\"form-control form-control-lg\" ngModel>\n              </div>\n\n              <!-- <div class=\"input-group\">\n                <div *ngIf=\"!onUpdate\" class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Adet</div>\n                </div>\n                <input type=\"number\" name=\"quantity\" class=\"form-control form-control-lg\" [readonly]='onUpdate' ngModel>\n              </div> -->\n\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Miktar</div>\n                </div>\n                <input type=\"number\" name=\"total\"  mask=\"separator.2\" thousandSeparator=\".\" class=\"form-control form-control-lg\" ngModel>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Porsiyon</div>\n                </div>\n                <input type=\"number\" name=\"portion\"  mask=\"separator.2\" thousandSeparator=\".\" class=\"form-control form-control-lg\" ngModel>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Birim</div>\n                </div>\n                <select #unitName name=\"unit\" class=\"form-control form-control-lg\" ngModel>\n                  <option *ngFor=\"let unit of units\" value=\"{{unit}}\">{{unit}}</option>\n                </select>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Uyarı Limiti</div>\n                </div>\n                <input type=\"number\" name=\"warning_value\" class=\"form-control form-control-lg\" ngModel>\n                <div class=\"input-group-append\">\n                  <div class=\"input-group-text\">%</div>\n                </div>\n              </div>\n              <div class=\"input-group\">\n                <div class=\"input-group-prepend\">\n                  <div class=\"input-group-text\">Açıklama</div>\n                </div>\n                <textarea name=\"description\" rows=\"1\" class=\"form-control form-control-lg\" ngModel></textarea>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" (click)=\"removeStock(selectedStock._id)\" class=\"btn btn-danger btn-lg\">\n            <i class=\"fa fa-times\"></i> Stok Sil</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#quantityModal\"\n            class=\"btn btn-success btn-lg\">\n            <i class=\"fa fa-plus\"></i> Adet Ekle</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">\n            <i class=\"fa fa-check\"></i> Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"selectedStock\" class=\"modal fade\" id=\"quantityModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">{{selectedStock.name}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" data-toggle=\"modal\" data-target=\"#stock\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"input-group\">\n          <input #quantityInput type=\"number\" class=\"form-control form-control-lg\" placeholder=\"Lütfen Stok Adedi Giriniz\">\n          <div class=\"input-group-append\">\n            <div class=\"input-group-text\">Adet</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\" data-toggle=\"modal\" data-target=\"#stock\">Kapat</button>\n        <button type=\"button\" (click)=\"addQuantity(quantityInput.value); quantityInput.value = null;\" class=\"btn btn-primary btn-lg\">\n          <i class=\"fa fa-plus\"></i> Ekle</button>\n      </div>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/stock-settings/stock-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".inside-height {\n  height: 74.5vh; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/stock-settings/stock-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return StockSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_http_service__ = __webpack_require__("./src/app/services/http.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_stocks__ = __webpack_require__("./src/app/mocks/stocks.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let StockSettingsComponent = class StockSettingsComponent {
    constructor(mainService, httpService, messageService, logService) {
        this.mainService = mainService;
        this.httpService = httpService;
        this.messageService = messageService;
        this.logService = logService;
        this.categories = [];
        this.sub_categories = [];
        this.units = ['Gram', 'Mililitre', 'Adet'];
        this.authToken = localStorage.getItem('AccessToken');
        this.fillData();
    }
    ngOnInit() {
        this.onUpdate = false;
    }
    setDefault() {
        this.stockCatForm.reset();
        this.stockForm.reset();
        this.onUpdate = false;
    }
    getStockCatDetail(Category) {
        this.selectedCat = Category;
        this.stockCatDetailForm.setValue(Category);
    }
    getStocks(id) {
        this.mainService.getAllBy('stocks', { sub_category: id }).then((result) => {
            this.stocks = result.docs;
        });
    }
    removeStock(id) {
        this.messageService.sendConfirm('Kaydı Silmek Üzeresiniz. Bu İşlem Geri Alınamaz').then(isOk => {
            if (isOk) {
                this.mainService.removeData('stocks', id).then(res => {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].STOCK_DELETED, res.id, `${this.selectedStock.name} adlı Stok silindi.`);
                    this.fillData();
                    $('#stock').modal('hide');
                    this.messageService.sendMessage('Stok Silindi!');
                });
            }
        });
    }
    getStockDetail(stock) {
        this.onUpdate = true;
        this.mainService.getData('stocks', stock._id).then(result => {
            this.stockForm.setValue(result);
            this.selectedStock = stock;
            $('#stock').modal('show');
        });
    }
    getWarehouseDetail(warehouse) {
    }
    addQuantity(value) {
        const old_quantity = this.selectedStock.left_total / this.selectedStock.total;
        const new_quantity = (old_quantity + parseFloat(value));
        let after = { quantity: new_quantity, left_total: this.selectedStock.left_total + (this.selectedStock.total * parseFloat(value)), first_quantity: new_quantity, warning_limit: (this.selectedStock.total * new_quantity) * 25 / 100 };
        this.stockForm.setValue(Object.assign(this.selectedStock, after));
        $('#quantityModal').modal('hide');
        $('#stock').modal('show');
    }
    addStock(stockForm) {
        let form = stockForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Stok Adı Belirtmelisiniz');
            return false;
        }
        else if (!form.category) {
            this.messageService.sendMessage('Kategori Seçmelisiniz');
            return false;
        }
        if (form._id == undefined) {
            let newStock = new __WEBPACK_IMPORTED_MODULE_3__mocks_stocks__["a" /* Stock */](form.name, form.description, form.unit, form.portion, form.quantity, form.quantity, form.total, form.total * form.quntity, form.total, (form.total * form.quantity) * form.warning_value / 100, form.warning_value, form.category, form.sub_category, '', '', form.warehouse, '', Date.now());
            this.mainService.addData('stocks', newStock).then((res) => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].STOCK_CREATED, res.id, `${form.name} adlı Stok oluşturuldu.`);
                this.fillData();
                stockForm.reset();
                this.messageService.sendMessage('Stok oluşturuldu');
            });
        }
        else {
            form.warning_limit = (form.total * form.quantity) * form.warning_value / 100;
            this.mainService.updateData('stocks', form._id, form).then(() => {
                this.fillData();
                stockForm.reset();
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].STOCK_UPDATED, form._id, `${form.name} adlı Stok Güncellendi.`);
                this.messageService.sendMessage('Stok Düzenlendi');
            });
        }
        $('#stock').modal('hide');
    }
    addCategory(stockCatForm) {
        let form = stockCatForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Kategori İsmi Belirtmelisiniz!');
            return false;
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_stocks__["b" /* StockCategory */](form.name, form.description);
        this.mainService.addData('stocks_cat', schema).then(() => {
            this.fillData();
            this.messageService.sendMessage('Stok Kategorisi Oluşturuldu.');
            stockCatForm.reset();
        });
        $('#stockCat').modal('hide');
    }
    addWarehouse(warehouseForm) {
        let form = warehouseForm.value;
        if (!form.name) {
            this.messageService.sendMessage('Depo Belirtmelisiniz!');
            return false;
        }
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_stocks__["c" /* Warehouse */](form.name, form.description, form.type, Date.now());
        this.mainService.addData('warehouses', schema).then(() => {
            this.fillData();
            this.messageService.sendMessage('Depo Oluşturuldu.');
            warehouseForm.reset();
        });
        $('#warehouse').modal('hide');
    }
    updateWarehouse(Form) {
        let form = Form.value;
        this.mainService.updateData('warehouses', form._id, form).then(() => {
            this.fillData();
            this.messageService.sendMessage('Depo Güncellendi.');
            this.selectedWarehouse = undefined;
        });
    }
    updateCategory(Form) {
        let form = Form.value;
        this.mainService.updateData('stocks_cat', form._id, form).then(() => {
            this.fillData();
            this.messageService.sendMessage('Stok Kategorisi Güncellendi.');
            this.selectedCat = undefined;
        });
    }
    removeCategory(id) {
        let isOk = confirm('Kategoriyi Silmek Üzeresiniz. Kategoriye Dahil Olan Stoklarda Silinecektir.');
        if (isOk) {
            this.mainService.removeData('stocks_cat', id).then(() => {
                this.mainService.getAllBy('stocks', { cat_id: id }).then(result => {
                    let data = result.docs;
                    if (data.length > 0) {
                        for (let prop in data) {
                            this.mainService.removeData('stocks', data[prop]._id);
                        }
                    }
                    this.messageService.sendMessage('Stok Kategorisi ve Bağlı Stoklar Silindi.');
                    this.selectedCat = undefined;
                    this.fillData();
                });
            });
        }
    }
    filterStocks(value) {
        let regexp = new RegExp(value, 'i');
        this.mainService.getAllBy('stocks', { name: { $regex: regexp } }).then(res => {
            this.stocks = res.docs;
            this.stocks = this.stocks.sort((a, b) => a.left_total - b.left_total);
        });
    }
    fillData() {
        this.mainService.getAllBy('stocks_cat', {}).then(result => {
            this.categories = result.docs;
        });
        this.mainService.getAllBy('stocks', {}).then(result => {
            this.stocks = result.docs;
            this.stocks = this.stocks.sort((a, b) => b.timestamp - a.timestamp);
        });
        this.mainService.getAllBy('warehouses', {}).then(result => {
            this.warehouses = result.docs;
        });
        // this.getProducers();
        this.getCategories();
        this.getSubCategories();
        // this.getProducers();
    }
    onCategoryChange(cat_id) {
        console.log(cat_id);
        this.sub_categories = this.sub_categories.filter(obj => obj.category_id == cat_id);
    }
    getCategories() {
        this.httpService.get('/market/categories', this.authToken).toPromise().then((res) => {
            this.categories = res.json();
        });
    }
    getSubCategories() {
        this.httpService.get('/market/sub_categories', this.authToken).toPromise().then((res) => {
            this.sub_categories = res.json();
        });
    }
    getBrands() {
        this.httpService.get('/market/brands', this.authToken).toPromise().then(res => {
            console.log(res);
        });
    }
    getSuppliers() {
        this.httpService.get('/market/suppliers', this.authToken).toPromise().then(res => {
            console.log(res);
        }, err => {
            console.log(err);
        });
    }
    getProducers() {
        this.httpService.get('/market/producers', this.authToken).subscribe(res => {
            console.log(res);
        }, err => {
            console.log(err);
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('stockCatForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], StockSettingsComponent.prototype, "stockCatForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('stockCatDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], StockSettingsComponent.prototype, "stockCatDetailForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('stockForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], StockSettingsComponent.prototype, "stockForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('stockDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], StockSettingsComponent.prototype, "stockDetailForm", void 0);
StockSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-stock-settings',
        template: __webpack_require__("./src/app/components/settings/stock-settings/stock-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/stock-settings/stock-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__services_http_service__["a" /* HttpService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_log_service__["a" /* LogService */]])
], StockSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/settings/user-settings/user-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<ul class=\"nav nav-tabs nav-justified\" id=\"reportTab\" role=\"tablist\">\n  <li class=\"nav-item\">\n    <a class=\"nav-link active\" data-toggle=\"tab\" href=\"#groups\" role=\"tab\">\n      <i class=\"fa fa-users\" aria-hidden=\"true\"></i> Gruplar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link\" data-toggle=\"tab\" href=\"#users\" role=\"tab\">\n      <i class=\"fa fa-user\" aria-hidden=\"true\"></i> Kullanıcılar</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#auths\" role=\"tab\">\n      <i class=\"fa fa-shield\" aria-hidden=\"true\"></i> İzinler</a>\n  </li>\n  <li class=\"nav-item\">\n    <a class=\"nav-link disabled\" data-toggle=\"tab\" href=\"#auths\" role=\"tab\">\n      <i class=\"fa fa-id-badge\" aria-hidden=\"true\"></i> Kartlar</a>\n  </li>\n</ul>\n\n<div class=\"tab-content\">\n  <div class=\"tab-pane active\" id=\"groups\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Kullanıcı Grupları</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#groupModal\">\n              <i class=\"fa fa-plus\"></i> Kullanıcı Grubu Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body p-0 tab-height\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Gruplar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <div *ngFor=\"let item of groups\" class=\"btn-group btn-group-justify\">\n                    <button (click)=\"getGroup(item._id)\" [ngClass]=\"{'list-group-item-warning' : selectedGroup == item._id}\"\n                      type=\"button\" class=\"list-group-item list-group-item-action\">{{item.name}}</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <form #groupDetailForm=\"ngForm\" (ngSubmit)=\"updateGroup(groupDetailForm)\">\n              <div class=\"card tab-inside-height\">\n                <div class=\"card-header\">\n                  Ayrıntılar\n                </div>\n                <div class=\"card-body p-2 flow\">\n                  <h1 *ngIf=\"selectedGroup == undefined\" class=\"text-center mt-5\">Listeden Grup Seçiniz</h1>\n                  <div [hidden]=\"selectedGroup == undefined\">\n                    <input type=\"hidden\" name=\"_id\" ngModel />\n                    <input type=\"hidden\" name=\"_rev\" ngModel />\n                    <input type=\"hidden\" name=\"status\" ngModel />\n                    <input type=\"hidden\" name=\"timestamp\" ngModel />\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Grup Adı</div>\n                        </div>\n                        <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <div class=\"form-group mb-2\">\n                      <div class=\"input-group\">\n                        <div class=\"input-group-prepend\">\n                          <div class=\"input-group-text\">Grup Açıklaması</div>\n                        </div>\n                        <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n                      </div>\n                    </div>\n                    <h5 class=\"mt-4\">Erişim Hakları</h5>\n                    <table class=\"table  table-bordered text-center mb-0\">\n                      <thead>\n                        <tr>\n                          <th class=\"text-center\">Satış</th>\n                          <th class=\"text-center\">Kasa</th>\n                          <th class=\"text-center\">Gün Sonu</th>\n                          <th class=\"text-center\">Raporlar</th>\n                          <th class=\"text-center\">Ayarlar</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr class=\"text-center\">\n                          <td>\n                            <input type=\"checkbox\" name=\"store\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"cashbox\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"endoftheday\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"reports\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"settings\" class=\"form-control\" ngModel />\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                    <h5 class=\"mt-3\">Grup İzinleri</h5>\n                    <table class=\"table  table-bordered text-center\">\n                      <thead>\n                        <tr>\n                          <th width=\"20%\" class=\"text-center\">Hesap İptal</th>\n                          <th width=\"20%\" class=\"text-center\">Ürün İptal</th>\n                          <th width=\"20%\" class=\"text-center\">Ödeme</th>\n                          <th width=\"20%\" class=\"text-center\">İndirim</th>\n                          <th width=\"20%\" class=\"text-center\">Gün Sonu</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr class=\"text-center\">\n                          <td>\n                            <input type=\"checkbox\" name=\"cancelCheck\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"cancelProduct\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"payment\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"discount\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"end\" class=\"form-control\" ngModel />\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n\n                    <table class=\"table  table-bordered text-center\">\n                      <thead>\n                        <tr>\n                          <th width=\"20%\" class=\"text-center\">Masa Taşıma</th>\n                          <th width=\"20%\" class=\"text-center\">Ürün Taşıma</th>\n                          <th width=\"20%\" class=\"text-center\">İkram</th>\n                          <th width=\"20%\" class=\"text-center\">Ödeme İptal</th>\n                          <th width=\"20%\" class=\"text-center\">Sipariş Onay</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        <tr class=\"text-center\">\n                          <td>\n                            <input type=\"checkbox\" name=\"moveTable\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"moveProduct\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"giveFree\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"undoPayment\" class=\"form-control\" ngModel />\n                          </td>\n                          <td>\n                            <input type=\"checkbox\" name=\"acceptOrder\" class=\"form-control\" ngModel />\n                          </td>\n                        </tr>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n                <div class=\"card-footer\" [hidden]=\"selectedGroup == undefined\">\n                  <div class=\"row\">\n                    <div class=\"col pr-1\">\n                      <button type=\"button\" (click)=\"removeGroup(selectedGroup)\" class=\"btn btn-danger btn-md btn-block\">\n                        <i class=\"fa fa-times\" aria-hidden=\"true\"></i> Grubu Sil</button>\n                    </div>\n                    <div class=\"col pl-1\">\n                      <button type=\"submit\" class=\"btn btn-success btn-md btn-block\">\n                        <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Değişiklikleri Kaydet</button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"users\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-lg-8\">\n            <h5 class=\"mt-2\">Kullanıcılar</h5>\n          </div>\n          <div class=\"col-lg-4 pr-2 pl-0\">\n            <button class=\"btn btn-danger btn-md btn-block\" (click)=\"setDefault()\" data-toggle=\"modal\" data-target=\"#userModal\">\n              <i class=\"fa fa-plus\"></i> Kullanıcı Ekle\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body tab-height p-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-3 pr-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header\">\n                Gruplar\n              </div>\n              <div class=\"card-body p-0 flow\">\n                <div class=\"list-group\">\n                  <button (click)=\"getUsersByGroup(null)\" type=\"button\" class=\"list-group-item list-group-item-action\">Bütün\n                    Kullanıcılar</button>\n                  <button *ngFor=\"let item of groups\" (click)=\"getUsersByGroup(item._id)\" type=\"button\" class=\"list-group-item list-group-item-action\">\n                    {{item.name}}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-9 pl-0\">\n            <div class=\"card tab-inside-height\">\n              <div class=\"card-header pt-2 pb-2\">\n                <div class=\"row\">\n                  <div class=\"col-lg-6 pt-1\">\n                    Kullanıcılar\n                  </div>\n                  <div class=\"col-lg-6 pr-2 pl-0\">\n                    <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text\">\n                          <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                        </div>\n                      </div>\n                      <input #userName type=\"text\" placeholder=\"Kullanıcı Adı Giriniz..\" (click)=\"userName.value = '';\"\n                        (keydown)=\"filterUsers(userName.value)\" class=\"form-control form-contol-sm\">\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-body flow p-0\">\n                <table class=\"table table-striped table-hover  table-bordered\">\n                  <thead class=\"thead-dark\">\n                    <tr>\n                      <th width=\"7%\">\n                        <i class=\"fa fa-user\"></i>\n                      </th>\n                      <th width=\"43%\">Kullanıcı Adı</th>\n                      <th width=\"25%\">Görevi</th>\n                      <th width=\"25%\">Tarih</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr *ngFor=\"let user of users; let i = index;\" (click)=\"updateUser(user._id)\">\n                      <td>{{ i+1 }}</td>\n                      <td>{{ user.name }}</td>\n                      <td>{{ user.role_id | general:'users_group' | async }}</td>\n                      <td>{{ user.timestamp | date:'dd/MM/y'}}</td>\n                    </tr>\n                  </tbody>\n                </table>\n                <div *ngIf=\"users == undefined || users.length == 0\" class=\"row mt-5\">\n                  <div class=\"col-lg-12 mt-5\">\n                    <h2 class=\"text-center mt-3\">Eşleşen Kullanıcı Bulunamadı</h2>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n  <div class=\"tab-pane\" id=\"auths\" role=\"tabpanel\">\n    <div class=\"card ntb\">\n      <div class=\"card-header\">\n        <h5 class=\"mt-2\">Kullanıcı İzinleri</h5>\n      </div>\n      <div class=\"card-body tab-height flow\">\n\n      </div>\n      <div class=\"card-footer\">\n        <i class=\"fa fa-question-circle\" aria-hidden=\"true\"></i> Yardım\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"groupModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Grup</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #groupForm=\"ngForm\" (ngSubmit)=\"addGroup(groupForm)\">\n        <div *ngIf=\"onUpdate\">\n          <input type=\"hidden\" name=\"_id\" ngModel />\n          <input type=\"hidden\" name=\"_rev\" ngModel />\n          <input type=\"hidden\" name=\"status\" ngModel />\n          <input type=\"hidden\" name=\"timestamp\" ngModel />\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Grup Adı\n                </div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Grup Açıklaması\n                </div>\n              </div>\n              <input type=\"text\" name=\"description\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n          <h5 class=\"mt-3\">Bölüm Erişim Hakları</h5>\n          <table class=\"table  table-bordered text-center\">\n            <thead>\n              <tr>\n                <th width=\"20%\" class=\"text-center\">Satış</th>\n                <th width=\"20%\" class=\"text-center\">Kasa</th>\n                <th width=\"20%\" class=\"text-center\">Gün Sonu</th>\n                <th width=\"20%\" class=\"text-center\">Raporlar</th>\n                <th width=\"20%\" class=\"text-center\">Ayarlar</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"text-center\">\n                <td>\n                  <input type=\"checkbox\" name=\"store\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"cashbox\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"endoftheday\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"reports\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"settings\" class=\"form-control\" ngModel />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <h5 class=\"mt-3\">Grup İzinleri</h5>\n          <table class=\"table  table-bordered text-center\">\n            <thead>\n              <tr>\n                <th width=\"20%\" class=\"text-center\">Hesap İptal</th>\n                <th width=\"20%\" class=\"text-center\">Ürün İptal</th>\n                <th width=\"20%\" class=\"text-center\">Ödeme</th>\n                <th width=\"20%\" class=\"text-center\">İndirim</th>\n                <th width=\"20%\" class=\"text-center\">Gün Sonu</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"text-center\">\n                <td>\n                  <input type=\"checkbox\" name=\"cancelCheck\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"cancelProduct\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"payment\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"discount\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"end\" class=\"form-control\" ngModel />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <table class=\"table  table-bordered text-center\">\n            <thead>\n              <tr>\n                <th width=\"20%\" class=\"text-center\">Masa Taşıma</th>\n                <th width=\"20%\" class=\"text-center\">Ürün Taşıma</th>\n                <th width=\"20%\" class=\"text-center\">İkram</th>\n                <th width=\"20%\" class=\"text-center\">Ödeme İptal</th>\n                <th width=\"20%\" class=\"text-center\">Sipariş Onay</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr class=\"text-center\">\n                <td>\n                  <input type=\"checkbox\" name=\"moveTable\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"moveProduct\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"giveFree\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"undoPayment\" class=\"form-control\" ngModel />\n                </td>\n                <td>\n                  <input type=\"checkbox\" name=\"acceptOrder\" class=\"form-control\" ngModel />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"userModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"modelTitleId\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Kullanıcı</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #userForm=\"ngForm\" (ngSubmit)=\"addUser(userForm)\">\n        <div class=\"modal-body\">\n          <div *ngIf=\"onUpdate\">\n            <input type=\"hidden\" name=\"_id\" ngModel>\n            <input type=\"hidden\" name=\"_rev\" ngModel>\n            <input type=\"hidden\" name=\"status\" ngModel>\n            <input type=\"hidden\" name=\"timestamp\" ngModel>\n          </div>\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Kullanıcı Adı</div>\n              </div>\n              <input type=\"text\" name=\"name\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Görevi</div>\n              </div>\n              <select #role name=\"role_id\" class=\"form-control form-control-lg\" ngModel>\n                <option *ngFor=\"let item of groups\" value=\"{{item._id}}\">{{item.name}}</option>\n              </select>\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Parola\n                </div>\n              </div>\n              <input type=\"password\" maxlength=\"4\" name=\"pincode\" class=\"form-control form-control-lg\" ngModel />\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button *ngIf=\"onUpdate\" type=\"button\" class=\"btn btn-danger btn-lg\" (click)=\"removeUser(selectedUser)\">\n            Kullanıcıyı Sil</button>\n          <button type=\"submit\" class=\"btn btn-primary btn-lg\">Kaydet</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>";

/***/ }),

/***/ "./src/app/components/settings/user-settings/user-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".inside-height {\n  height: 74.5vh; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/settings/user-settings/user-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UserSettingsComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_report__ = __webpack_require__("./src/app/mocks/report.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_user__ = __webpack_require__("./src/app/mocks/user.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let UserSettingsComponent = class UserSettingsComponent {
    constructor(mainService, messageService, logService) {
        this.mainService = mainService;
        this.messageService = messageService;
        this.logService = logService;
    }
    ngOnInit() {
        this.onUpdate = false;
        this.fillData();
    }
    setDefault() {
        this.onUpdate = false;
        this.selectedGroup = undefined;
        this.selectedUser = undefined;
        this.groupForm.reset();
        this.userForm.reset();
    }
    getGroup(id) {
        this.selectedGroup = id;
        this.mainService.getData('users_group', id).then(res => {
            res = Object.assign(res, res.auth.components);
            delete res.auth.components;
            res = Object.assign(res, res.auth);
            delete res.auth;
            this.groupDetailForm.setValue(res);
        });
    }
    getUsersByGroup(id) {
        if (id) {
            this.mainService.getAllBy('users', { role_id: id }).then(res => {
                this.users = res.docs;
            });
        }
        else {
            this.mainService.getAllBy('users', {}).then(res => {
                this.users = res.docs;
            });
        }
    }
    addGroup(groupForm) {
        let form = groupForm.value;
        if (form.name == undefined) {
            this.messageService.sendMessage('Grup Adı Girmek Zorundasınız.');
            return false;
        }
        let userAuth = new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["c" /* UserAuth */](new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["a" /* ComponentsAuth */](form.store, form.cashbox, form.endoftheday, form.reports, form.settings), form.cancelCheck, form.cancelProduct, form.discount, form.payment, form.end, form.moveTable, form.moveProduct, form.giveFree, form.undoPayment, form.acceptOrder);
        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["d" /* UserGroup */](form.name, form.description, userAuth, 1, Date.now());
        this.mainService.getAllBy('users_group', { name: form.name }).then(result => {
            if (result.docs.length > 0 && result.docs[0].name == form.name) {
                this.messageService.sendMessage('Belirtilen Grup İsmi Kullanılmaktadır..');
            }
            else {
                this.mainService.addData('users_group', schema).then(() => {
                    this.fillData();
                    this.messageService.sendMessage('Grup Oluşturuldu!');
                    this.groupForm.reset();
                    $('#groupModal').modal('hide');
                });
            }
        });
    }
    updateGroup(groupDetailForm) {
        let form = groupDetailForm.value;
        this.mainService.getAllBy('users_group', { name: form.name }).then(result => {
            if (result.docs.length > 0 && result.docs[0].name != form.name) {
                this.messageService.sendMessage('Belirtilen Grup İsmi Kullanılmaktadır..');
            }
            else {
                let userAuth = new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["c" /* UserAuth */](new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["a" /* ComponentsAuth */](form.store, form.cashbox, form.endoftheday, form.reports, form.settings), form.cancelCheck, form.cancelProduct, form.discount, form.payment, form.end, form.moveTable, form.moveProduct, form.giveFree, form.undoPayment, form.acceptOrder);
                let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["d" /* UserGroup */](form.name, form.description, userAuth, 1, Date.now(), form._id, form._rev);
                this.mainService.updateData('users_group', form._id, schema).then(() => {
                    this.messageService.sendMessage('Grup Bilgileri Güncellendi!');
                    this.selectedGroup = undefined;
                    this.fillData();
                });
            }
        });
    }
    removeGroup(id) {
        let isOk = confirm('Grubu Silmek Üzerisiniz. Gruba Bağlı Üyeleride Silmiş Olacaksınız.');
        if (isOk) {
            this.mainService.removeData('users_group', id).then(() => {
                this.mainService.getAllBy('users', { role_id: id }).then(result => {
                    let data = result.docs;
                    for (let prop in data) {
                        this.mainService.removeData('users', data[prop]._id).then((result) => {
                            this.mainService.getAllBy('reports', { connection_id: result.id }).then(res => {
                                this.mainService.removeData('reports', res.docs[0]._id);
                            });
                        });
                    }
                    this.messageService.sendMessage('Grup ve Kullanıcılar Silindi.');
                    this.selectedGroup = undefined;
                    this.fillData();
                });
            });
        }
    }
    addUser(userForm) {
        let form = userForm.value;
        if (form.name == undefined) {
            this.messageService.sendMessage('Kullanıcı Girmek Zorundasınız.');
            return false;
        }
        if (form.role_id == undefined) {
            this.messageService.sendMessage('Görev Seçmek Zorundasınız.');
            return false;
        }
        if (form.pincode == undefined) {
            this.messageService.sendMessage('Şifre Girmek Zorundasınız.');
            return false;
        }
        form.pincode = parseInt(form.pincode);
        if (form._id == undefined) {
            this.mainService.getAllBy('users', { pincode: form.pincode }).then(result => {
                if (result.docs.length > 0) {
                    this.messageService.sendMessage('Bu giriş kodu ile başka bir kullanıcı kayıtlı. Lütfen başka bir giriş kodu deneyin.');
                    userForm.reset();
                }
                else {
                    this.mainService.getData('users_group', form.role_id).then(result => {
                        let role = result.name;
                        let schema = new __WEBPACK_IMPORTED_MODULE_3__mocks_user__["b" /* User */](form.name, role, form.role_id, form.pincode, 1, Date.now());
                        this.mainService.addData('users', schema).then((response) => {
                            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_2__mocks_report__["b" /* Report */]('User', response.id, 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), form.name, Date.now())).then(res => {
                                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].USER_CREATED, res.id, `${form.name} Adlı Kullanıcı Oluşturuldu`);
                            });
                            this.messageService.sendMessage('Kullanıcı Oluşturuldu!');
                            this.fillData();
                            userForm.reset();
                            $('#userModal').modal('hide');
                        });
                    });
                }
            });
        }
        else {
            this.mainService.getAllBy('users', { pincode: form.pincode }).then(result => {
                if (result.docs.length > 0 && result.docs[0].name != form.name) {
                    this.messageService.sendMessage('Bu giriş kodu ile başka bir kullanıcı kayıtlı. Lütfen başka bir giriş kodu deneyin.');
                }
                else {
                    this.mainService.updateData('users', form._id, form).then((res) => {
                        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].USER_UPDATED, res.id, `${form.name} Adlı Kullanıcı Güncellendi`);
                        this.messageService.sendMessage('Bilgiler Güncellendi!');
                        this.fillData();
                        userForm.reset();
                        $('#userModal').modal('hide');
                    });
                }
            });
        }
    }
    updateUser(id) {
        this.onUpdate = true;
        this.selectedUser = id;
        this.mainService.getData('users', id).then(result => {
            delete result.role;
            this.userForm.setValue(result);
            $('#userModal').modal('show');
        });
    }
    removeUser(id) {
        let isOk = confirm('Kulanıcıyı Silmek Üzerisiniz. Bu işlem Geri Alınamaz.');
        if (isOk) {
            this.mainService.removeData('users', id).then((result) => {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_5__services_log_service__["b" /* logType */].USER_DELETED, result.id, `${this.userForm.value.name} Adlı Kullanıcı Silindi`);
                this.mainService.getAllBy('reports', { connection_id: result.id }).then(res => {
                    this.mainService.removeData('reports', res.docs[0]._id);
                });
                this.messageService.sendMessage('Kullanıcı Silindi!');
                this.fillData();
                $('#userModal').modal('hide');
            });
        }
    }
    filterUsers(value) {
        let regexp = new RegExp(value, 'i');
        this.mainService.getAllBy('users', { name: { $regex: regexp } }).then(res => {
            this.users = res.docs;
        });
    }
    fillData() {
        this.mainService.getAllBy('users', {}).then(result => {
            this.users = result.docs;
        });
        this.mainService.getAllBy('users_group', {}).then(result => {
            this.groups = result.docs;
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('userForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], UserSettingsComponent.prototype, "userForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('groupForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], UserSettingsComponent.prototype, "groupForm", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('groupDetailForm'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["d" /* NgForm */])
], UserSettingsComponent.prototype, "groupDetailForm", void 0);
UserSettingsComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-user-settings',
        template: __webpack_require__("./src/app/components/settings/user-settings/user-settings.component.html"),
        styles: [__webpack_require__("./src/app/components/settings/user-settings/user-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_5__services_log_service__["a" /* LogService */]])
], UserSettingsComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/setup/setup.component.html":
/***/ (function(module, exports, __webpack_require__) {

module.exports = "<div class=\"card full-height\">\n  <div class=\"card-header\">\n    İlk Kurulum\n  </div>\n  <div class=\"card-body p-0\">\n    <div class=\"row justify-content-md-center\">\n      <div class=\"col-lg-8 text-center\" style=\"height:220px\">\n        <img src=\"" + __webpack_require__("./src/assets/logo.svg") + "\" class=\"mt-4\" style=\"width: 350px; margin-left:auto; margin-right:auto;\" alt=\"\">\n      </div>\n    </div>\n    <div class=\"row justify-content-md-center\">\n      <div *ngIf=\"setupStep == 0\" class=\"col-lg-10 col-xl-10 animated fadeIn\">\n        <div class=\"alert alert-success text-center\" role=\"alert\">\n          <h5 class=\"alert-heading font-weight-bold\">Program Kurulumu</h5>\n          <p>Programın Çalışma Türünü Seçiniz.</p>\n        </div>\n        <div class=\"row justify-content-md-center mt-3\">\n          <div class=\"col-lg-6\">\n            <button (click)=\"setupStep = 1\" class=\"btn btn-outline-primary btn-lg btn-block p-4\">\n              <i class=\"fa fa-server fa-5x\"></i>\n              <br> Birincil\n              <br>\n              <small class=\"text-muted\">(Ana Makina)</small>\n            </button>\n          </div>\n          <div class=\"col-lg-6\">\n            <button (click)=\"setupStep = 4;\" class=\"btn btn-outline-primary btn-lg btn-block work-type p-4\">\n              <i class=\"fa fa-desktop fa-5x\"></i>\n              <br> İkincil\n              <br>\n              <small class=\"text-muted\">(Ekran)</small>\n            </button>\n          </div>\n        </div>\n      </div>\n      <div *ngIf=\"setupStep == 1\" class=\"col-lg-10 col-xl-10 animated fadeIn\">\n        <div class=\"alert alert-success text-center\" role=\"alert\">\n          <h5 class=\"alert-heading font-weight-bold\">İşletme Hesabı Bilgileri</h5>\n          <p>Quickly Hesabı Kullanıcı Adı ve Şifrenizi giriniz</p>\n        </div>\n        <form #loginForm=\"ngForm\" class=\"mt-3\" (ngSubmit)=\"makeLogin(loginForm)\">\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">\n                Kullanıcı Adı\n              </div>\n            </div>\n            <input name=\"username\" type=\"text\" placeholder=\"Kullanıcı Adı Giriniz..\" class=\"form-control form-control-lg\" ngModel />\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">\n                Şifre\n              </div>\n            </div>\n            <input name=\"password\" type=\"password\" placeholder=\"Şifre Giriniz..\" class=\"form-control form-control-lg\" ngModel />\n          </div>\n          <div class=\"mt-3\">\n            <button type=\"submit\" class=\"btn btn-danger btn-lg pull-right\">Bilgileri Kaydet</button>\n          </div>\n        </form>\n      </div>\n      <div *ngIf=\"setupStep == 2\" class=\"col-lg-12 animated fadeIn\">\n        <!-- <div class=\"row justify-content-md-center\">\n          <div class=\"col-xl-8 col-lg-10\">\n            <div class=\"bodyquote mt-3\">\n              <p class=\"mb-0\">İşletme Kurulum Bilgileri</p>\n              <footer class=\"bodyquote-footer\">Programı Kurmak İstediğiniz İşletmeyi Seçiniz. </footer>\n            </div>\n          </div>\n        </div> -->\n        <div class=\"row justify-content-md-center storeList\">\n          <div *ngFor=\"let store of stores\" class=\"col-xl-4 col-lg-5\"  style=\"min-height: 130px; max-height: 300px; margin-bottom: 5px;\">\n            <div (click)=\"makeAuth(store)\" class=\"card storeCard\">\n              <!-- <div class=\"card-header\">\n                <strong>{{store.name}}</strong>\n              </div> -->\n              <div class=\"card-body p-1\">\n                <div class=\"row\">\n                  <div class=\"col-lg-4 pr-2\">\n                    <img class=\"card-img-top\" width=\"100%\" src=\"{{store.logo}}\" alt=\"\">\n                  </div>\n                  <div class=\"col-lg-8 pl-2\">\n                    <p class=\"mt-3 mb-0\"><strong>{{store.name}}</strong></p>\n                    <p><small>{{store.address.description}}</small></p>\n                    <!-- <img style=\"width:100%; height:100px;\" src=\"https://maps.googleapis.com/maps/api/staticmap?center={{store.address.cordinates.latitude}},{{store.address.cordinates.longitude}}&zoom=16&size=310x100&markers=size:small%7Ccolor:red|{{store.address.cordinates.latitude}},{{store.address.cordinates.longitude}}&key=AIzaSyCcRjnHqayHzuia_biO4XDsNPbpxZE690A\"> -->\n                  </div>\n                </div>\n              </div>\n              <!-- <div class=\"card-footer\">\n                {{store.address.description}}\n              </div> -->\n            </div>\n          </div>\n        </div>\n      </div>\n      <div *ngIf=\"setupStep == 3\" class=\"col-lg-6 col-xl-5 animated fadeIn\">\n        <div class=\"bodyquote mt-3\">\n          <p class=\"mb-0\">Yönetici Bilgileri</p>\n          <footer class=\"bodyquote-footer\">Lütfen bir Yönetici Adı ve Şifresi giriniz.</footer>\n        </div>\n        <form #setupForm=\"ngForm\" class=\"mt-3\" (ngSubmit)=\"makeAdmin(setupForm)\">\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">\n                Yönetici Adı\n              </div>\n            </div>\n            <input name=\"admin_name\" placeholder=\"Yönetici Adı Giriniz..\" type=\"text\" class=\"form-control form-control-lg\" ngModel />\n          </div>\n          <div class=\"input-group\">\n            <div class=\"input-group-prepend\">\n              <div class=\"input-group-text\">\n                Yönetici Parolası\n              </div>\n            </div>\n            <input name=\"admin_pass\" type=\"password\" placeholder=\"Şifre Giriniz.. ( 4 Haneli Sayı )\" maxlength=\"4\" class=\"form-control form-control-lg\" ngModel />\n          </div>\n          <div class=\"mt-3\">\n            <button type=\"submit\" class=\"btn btn-danger btn-lg pull-right\">Bilgileri Kaydet</button>\n          </div>\n        </form>\n      </div>\n      <div *ngIf=\"setupStep == 4\" class=\"col-lg-10 col-xl-10 animated fadeIn\">\n        <div class=\"alert alert-success text-center\" role=\"alert\">\n          <h5 class=\"alert-heading font-weight-bold\">Ana Makinaya Bağlanın</h5>\n          <p>Ana Makinanın Çalıştığı Adresi ve Anahtarı Giriniz..</p>\n        </div>\n        <form #connectionForm=\"ngForm\" class=\"mt-3\" (ngSubmit)=\"getConfigrations(connectionForm)\">\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">\n                  Makina Adresi\n                </div>\n              </div>\n              <input type=\"text\" name=\"address\" class=\"form-control form-control-lg\" placeholder=\"IP adresini giriniz.\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Makina Portu</div>\n              </div>\n              <input type=\"text\" name=\"port\" class=\"form-control form-control-lg\" placeholder=\"Port giriniz.\" ngModel />\n            </div>\n            <div class=\"input-group\">\n              <div class=\"input-group-prepend\">\n                <div class=\"input-group-text\">Anahtar</div>\n              </div>\n              <input type=\"text\" name=\"key\" class=\"form-control form-control-lg\" placeholder=\"Ana Makina anahtarını giriniz.\" ngModel />\n            </div>\n          </div>\n          <div class=\"mt-3\">\n            <button type=\"submit\" class=\"btn btn-danger btn-lg pull-right\">Makinaya Bağlan</button>\n          </div>\n        </form>\n      </div>\n    </div>\n    <div class=\"row mt-5 justify-content-md-center\">\n      <div *ngIf=\"setupStep == 5\" class=\"col-lg-8\">\n        <div class=\"animated fadeIn text-center\">\n          <h1 class=\"text-muted mt-5\">{{statusMessage}}</h1>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class=\"card-footer text-muted\">\n    <div class=\"progress\">\n      <div class=\"progress-bar progress-bar-striped progress-bar-animated bg-warning\" role=\"progressbar\" [ngStyle]=\"{'width': progress}\"></div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/setup/setup.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".storeCard:hover {\n  border-color: red !important;\n  cursor: pointer; }\n\n.storeList {\n  overflow-y: scroll;\n  height: 320px;\n  margin-right: 0px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/setup/setup.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SetupComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mocks_settings__ = __webpack_require__("./src/app/mocks/settings.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__mocks_report__ = __webpack_require__("./src/app/mocks/report.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__mocks_user__ = __webpack_require__("./src/app/mocks/user.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let SetupComponent = class SetupComponent {
    constructor(mainService, settingsService, http, electron, message, router) {
        this.mainService = mainService;
        this.settingsService = settingsService;
        this.http = http;
        this.electron = electron;
        this.message = message;
        this.router = router;
        this.status = 0;
        this.showMessage = false;
        this.setupStep = 0;
        this.headers = new __WEBPACK_IMPORTED_MODULE_1__angular_http__["a" /* Headers */]({ 'Content-Type': 'application/json', 'charset': 'UTF-8' });
        this.options = new __WEBPACK_IMPORTED_MODULE_1__angular_http__["d" /* RequestOptions */]({ headers: this.headers });
        this.baseUrl = 'https://hq.quickly.com.tr';
    }
    ngOnInit() {
        if (!navigator.onLine) {
            alert('İnternet Bağlantınızı Kontol Edin...');
            setTimeout(() => {
                this.electron.reloadProgram();
            }, 5000);
        }
        this.settingsService.ActivationStatus.subscribe(res => {
            if (res) {
                this.router.navigate(['']);
            }
        });
    }
    getConfigrations(connectionForm) {
        let Form = connectionForm.value;
        let serverSettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('ServerSettings', { type: 1, status: 1, ip_address: Form.address, ip_port: parseInt(Form.port), key: Form.key }, 'Sunucu Ayarları', Date.now());
        localStorage.setItem('AppType', 'Secondary');
        this.electron.openDevTools();
        this.mainService.replicateDB(serverSettings.value)
            .on('active', () => {
            this.progressBar(5);
        })
            .on('denied', (ass) => {
            console.log(ass, 'denied');
        })
            .on('error', (err) => {
            console.log(err);
            this.mainService.syncToLocal().then(res => {
                this.getConfigrations(connectionForm);
            });
        })
            .on('change', (sync) => {
            this.statusMessage = `${sync.docs_written} - Senkronize Ediliyor `;
        })
            .on('complete', info => {
            this.mainService.addData('settings', serverSettings);
            this.mainService.syncToLocal().then(res => {
                if (res) {
                    this.statusMessage = 'Kurulum Tamamlandı !';
                    setTimeout(() => {
                        this.electron.relaunchProgram();
                    }, 30000);
                }
            });
        }).catch(err => {
            // connectionForm.reset();
            // this.message.sendMessage('Sunucuya Bağlanılamıyor.');
            console.log(err);
            this.mainService.syncToLocal().then(res => {
                this.getConfigrations(connectionForm);
            });
        });
    }
    makeLogin(loginForm) {
        let Form = loginForm.value;
        this.http.post(this.baseUrl + '/store/login/', { username: Form.username, password: Form.password }, this.options).subscribe((res) => {
            localStorage.setItem('AccessToken', res.json().token);
            this.headers.append('Authorization', res.json().token);
            this.http.get(this.baseUrl + '/store/list/', new __WEBPACK_IMPORTED_MODULE_1__angular_http__["d" /* RequestOptions */]({ headers: this.headers })).subscribe((body) => {
                this.message.sendMessage('Giriş Başarılı!');
                if (body.json().length > 1) {
                    this.stores = body.json();
                    this.setupStep = 2;
                }
                else {
                    this.makeAuth(body.json()[0]);
                }
            }, (err) => {
                this.message.sendMessage('Giriş Başarısız!');
            });
        }, (err) => {
            let response = err._body;
            response = JSON.parse(response);
            if (response.non_field_errors) {
                this.message.sendMessage(response.non_field_errors);
            }
            else {
                this.message.sendMessage("Geçerli bir kullanıcı adı ve şifre giriniz.");
            }
        });
    }
    makeAuth(Data) {
        this.electron.saveLogo(Data.logo);
        let activationStatus = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('ActivationStatus', true, Data.auth.database_name, Date.now());
        let dateSettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('DateSettings', { started: true, day: new Date().getDay(), time: Date.now() }, 'Tarih-Zaman Ayarları', Date.now());
        let authInfo = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('AuthInfo', new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["a" /* AuthInfo */](Data.auth.database_host, Data.auth.database_port, Data.auth.database_name, Data.auth.database_user, Data.auth.database_password), 'Giriş Bilgileri Oluşturuldu', Date.now());
        let restaurantInfo = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('RestaurantInfo', Data, 'Restoran Bilgileri', Date.now());
        let appSettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('AppSettings', { timeout: 120, keyboard: 'Kapalı', takeaway: 'Açık', ask_print_order: 'Sor', ask_print_check: 'Sor', last_day: 0 }, 'Uygulama Ayarları', Date.now());
        let serverSettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('ServerSettings', { type: 0, status: 0, ip_address: this.electron.getLocalIP(), ip_port: 3000, key: Data.auth.database_id }, 'Sunucu Ayarları', Date.now());
        let printerSettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('Printers', [], 'Yazıcılar', Date.now());
        let currencySettings = new __WEBPACK_IMPORTED_MODULE_7__mocks_settings__["d" /* Settings */]('CurrencySettings', { USD: 0, EUR: 0, GBP: 0 }, 'Kur Bilgileri', Date.now());
        // let lastSeenSettings = new Settings('LastSeen', { last_seen: new Date().toLocaleString('tr-TR'), user: 'Setup' }, 'Son Görülme', Date.now());
        // this.mainService.addData('settings', Object.assign({ _id: 'lastseen' }, lastSeenSettings));
        localStorage.setItem('AppType', 'Primary');
        localStorage.setItem('Slug', restaurantInfo.value.slug);
        this.mainService.addData('settings', restaurantInfo);
        this.mainService.addData('settings', authInfo);
        this.mainService.addData('settings', appSettings);
        this.mainService.addData('settings', printerSettings);
        this.mainService.addData('settings', serverSettings);
        this.mainService.addData('settings', currencySettings);
        this.mainService.addData('settings', dateSettings);
        this.mainService.addData('settings', activationStatus).then((result) => {
            this.progressBar(3);
        });
        this.progressBar(3);
    }
    makeAdmin(adminForm) {
        let Form = adminForm.value;
        let userAuth = new __WEBPACK_IMPORTED_MODULE_9__mocks_user__["c" /* UserAuth */](new __WEBPACK_IMPORTED_MODULE_9__mocks_user__["a" /* ComponentsAuth */](true, true, true, true, true), true, true, true, true, true, true, true, true, true, true);
        this.mainService.addData('users_group', new __WEBPACK_IMPORTED_MODULE_9__mocks_user__["d" /* UserGroup */]('Yönetici', 'Yönetici Grubu', userAuth, 1, Date.now())).then(res => {
            this.mainService.addData('users', new __WEBPACK_IMPORTED_MODULE_9__mocks_user__["b" /* User */](Form.admin_name, 'Yönetici', res.id, parseInt(Form.admin_pass), 1, Date.now())).then((user) => {
                this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["b" /* Report */]('User', user.id, 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), user.name, Date.now()));
                localStorage.setItem('userName', Form.admin_name);
                localStorage.setItem('userType', 'Yönetici');
                localStorage.setItem('userAuth', res.id);
            });
        }).then(() => {
            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["b" /* Report */]('Store', 'Nakit', 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), 'Nakit Satış Raporu', Date.now()));
            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["b" /* Report */]('Store', 'Kart', 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), 'Kart Satış Raporu', Date.now()));
            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["b" /* Report */]('Store', 'Kupon', 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), 'Kupon Satış Raporu', Date.now()));
            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["b" /* Report */]('Store', 'İkram', 0, 0, 0, [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], new Date().getMonth(), new Date().getFullYear(), 'İkram Satış Raporu', Date.now()));
            this.mainService.addData('reports', new __WEBPACK_IMPORTED_MODULE_8__mocks_report__["a" /* Activity */]('Activity', 'Selling', [0], ['GB'], [0]));
            this.message.sendMessage('Program Yeniden Başlatıyor..');
            setTimeout(() => {
                this.electron.reloadProgram();
            }, 3000);
        });
    }
    progressBar(step) {
        this.statusMessage = 'Program Ayarlanıyor...';
        this.setupStep = 5;
        let stat = setInterval(() => {
            this.progress = this.status + '%';
            this.status++;
            this.showMessage = true;
            if (this.status == 25) {
                this.statusMessage = 'Bilgiler Kontrol Ediliyor...';
                this.showMessage = false;
            }
            if (this.status == 50) {
                this.statusMessage = 'Yapılandırma Yapılıyor...';
                this.showMessage = true;
            }
            if (this.status == 75) {
                this.statusMessage = 'Yapılandırma Kontrol Ediliyor...';
                this.showMessage = true;
            }
            if (this.status == 101) {
                clearInterval(stat);
                this.statusMessage = 'Kurulum Tamamlanıyor...';
                this.showMessage = true;
                this.setupStep = step;
                this.progress = '100%';
            }
        }, 200);
    }
};
SetupComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-setup',
        template: __webpack_require__("./src/app/components/setup/setup.component.html"),
        styles: [__webpack_require__("./src/app/components/setup/setup.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_4__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_4__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_5__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_6__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_2__angular_router__["b" /* Router */]])
], SetupComponent);



/***/ }),

/***/ "./src/app/components/store/payment-screen/payment-screen.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-xl-12\">\n    <div class=\"card full-height\">\n      <div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-xl-10 col-lg-9\">\n            <div class=\"table-name\">\n              <b>{{check?.table_id | general:'tables' | async}}</b>\n            </div>\n          </div>\n          <div class=\"col-xl-2 col-lg-3 pr-1\">\n            <button type=\"button\" [routerLink]=\"['/selling-screen',check_type, check_id]\" class=\"btn btn-danger btn-sm btn-block\">\n              <i class=\"fa fa-backward\" aria-hidden=\"true\"></i> <strong>Geri Dön</strong></button>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body pt-2\">\n        <div class=\"row\">\n          <div class=\"col-lg-7 col-xl-6\">\n            <div class=\"row\">\n              <div class=\"col-xl-6 col-lg-6 pl-1 pr-0\">\n                <div class=\"card inside-height\">\n                  <div class=\"card-header\"><b>Adisyon</b></div>\n                  <div class=\"card-body p-2 check-flow dark-bg\">\n                    <div *ngFor=\"let item of check?.products; let i = index\">\n                      <div *ngIf=\"item.status == 2\" style=\"cursor:pointer\" (click)=\"addProductToList(item)\" class=\"check-product text-danger mb-0\">\n                        <div class=\"product-name\">\n                          {{item.name}}\n                          <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                        </div>\n                        <div class=\"product-price\">\n                          {{item.price | price}}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"card-footer p-1\">\n                    <p class=\"pr-1 pl-1 mt-2\">\n                      <strong>\n                        Kalan Toplam:\n                        <span *ngIf=\"check?.products.length > 0\" class=\"float-right\">{{ leftTotal() | price}} </span>\n                        <span *ngIf=\"check?.products.length == 0\" class=\"float-right\">{{ leftTotal() | price}} </span>\n                      </strong>\n                    </p>\n                    <button (click)=\"sendAllProducts()\" [disabled]=\"check?.products.length == 0\" class=\"btn btn-lg btn-danger btn-block text-left\">\n                      <strong>Hepsini Öde</strong>\n                      <span class=\"float-right\">\n                        <i class=\"fa fa-arrow-right\" aria-hidden=\"true\"></i>\n                      </span>\n                    </button>\n                  </div>\n                </div>\n              </div>\n              <div class=\"col-xl-6 col-lg-6 pl-1 pr-0\">\n                <div class=\"card inside-height\">\n                  <div class=\"card-header pr-2\">\n                    <b>Ödenecek Ürünler</b>\n                    <i *ngIf=\"productsWillPay.length > 0\" data-toggle=\"modal\" data-target=\"#calculator\" class=\"fa fa-calculator pull-right\" style=\"font-size: 1.5em;\" aria-hidden=\"true\"></i>\n                  </div>\n                  <div class=\"card-body p-2 check-flow dark-bg\">\n                    <div *ngFor=\"let item of productsWillPay\" class=\"animated slideInLeft\">\n                      <div *ngIf=\"item.status == 2\" style=\"cursor:pointer\" (click)=\"addProductToCheck(item)\" class=\"check-product text-danger mb-0\">\n                        <div class=\"product-name\">\n                          {{item.name}}\n                          <small *ngIf=\"item.note !== '' && item.note !== undefined\" class=\"text-muted\">({{item.note}})</small>\n                        </div>\n                        <div class=\"product-price\">\n                          {{item.price | price}}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div *ngIf=\"check?.discount > 0\" class=\"card-footer p-1\">\n                    <p *ngIf=\"check?.discount > 0\" class=\"pr-1 pl-1 mt-2\">\n                      <strong>\n                        Ödenen Miktar:\n                        <span class=\"pull-right\">{{check?.discount | price }} </span>\n                      </strong>\n                    </p>\n                    <button (click)=\"togglePayed()\" class=\"btn btn-lg btn-secondary btn-block text-left\">{{payedTitle}}\n                      <span class=\"float-right\">\n                        <i [ngClass]=\"(payedShow) ? 'fa-caret-down':'fa-caret-up'\" class=\"fa hidden-lg-down\" aria-hidden=\"true\"></i>\n                      </span>\n                    </button>\n                  </div>\n                  <div *ngIf=\"check?.discount > 0 && payedShow\" class=\"card-body check-flow p-2 payed-things\">\n                    <div *ngFor=\"let payment of check.payment_flow\" class=\"mb-2 payedLayer\">\n                      <p class=\"mb-0\">{{payment.method}}\n                        <small>( {{payment.owner}} - {{payment.timestamp | date:'HH:mm'}} )</small>\n                        <span class=\"pull-right\">{{payment.amount + payment.discount | price}} </span>\n                      </p>\n                      <p *ngFor=\"let product of payment.payed_products\" class=\"m-0 text-warning pl-3\" style=\"text-transform: capitalize;\">\n                        <small>\n                          <strong>\n                            {{product.name}}\n                            <span class=\"pull-right\">{{product.price | price}} </span>\n                          </strong>\n                        </small>\n                      </p>\n                      <p *ngIf=\"payment.discount > 0\" class=\"text-danger m-0\">\n                        <small>\n                          <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> İndirim Tutarı\n                          <span class=\"pull-right\">{{payment.discount.toFixed(2) | price}} </span>\n                        </small>\n                      </p>\n                      <p class=\"m-0 font-weight-bold\">\n                        <small>\n                          <i class=\"fa fa-arrow-right\" aria-hidden=\"true\"></i> Alınan Ödeme\n                          <span class=\"pull-right\">{{payment.amount | price}} </span>\n                        </small>\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-1 pl-1 pr-0 d-lg-none d-xl-block\">\n            <button [disabled]=\"priceWillPay == 0 || payedPrice > 0 && changePrice >= 0\" (click)=\"getPayment(100)\" class=\"btn btn-block cashButton btn-outline-info\">\n              100\n            </button>\n            <button [disabled]=\"priceWillPay == 0 || payedPrice > 0 && changePrice >= 0\" (click)=\"getPayment(50)\" class=\"btn btn-block cashButton btn-outline-primary\">\n              50\n            </button>\n            <button [disabled]=\"priceWillPay == 0 || payedPrice > 0 && changePrice >= 0\" (click)=\"getPayment(20)\" class=\"btn btn-block cashButton btn-outline-success\">\n              20\n            </button>\n            <button [disabled]=\"priceWillPay == 0 || payedPrice > 0 && changePrice >= 0\" (click)=\"getPayment(10)\" class=\"btn btn-block cashButton btn-outline-danger\">\n              10\n            </button>\n            <button [disabled]=\"priceWillPay == 0 || payedPrice > 0 && changePrice >= 0\" (click)=\"getPayment(5)\" class=\"btn btn-block cashButton btn-outline-warning\">\n              5\n            </button>\n          </div>\n          <div class=\"col-xl-4 col-lg-4 pl-1 pr-0\">\n            <div class=\"card inside-height\">\n              <div class=\"card-header p-2\">\n                <h3 class=\"mb-1 mt-1 will-pay\">\n                  <b>Ödenecek Miktar:</b>\n                  <span class=\"text-white pull-right\">\n                    <strong>{{currentAmount | price }} </strong>\n                  </span>\n                </h3>\n              </div>\n              <div class=\"card-body dark-bg p-2\">\n                <h5 *ngIf=\"currentAmount > 0\" class=\"mb-0\">Ürünlerin Toplamı:\n                  <span class=\"text-primary pull-right\">\n                    <b>{{priceWillPay | price}} </b>\n                  </span>\n                </h5>\n                <h5 *ngIf=\"discount !== undefined\" class=\"mb-1\">İndirim Tutarı:\n                  <span class=\"text-danger pull-right\">\n                    <small>{{discount.toFixed(2)}} %</small> -\n                    <b>{{discountAmount | price }} </b>\n                  </span>\n                </h5>\n                <h5 *ngIf=\"payedPrice > 0\" class=\"mt-0 mb-1\">Alınan Miktar:\n                  <span class=\"text-success pull-right\">\n                    <b>{{payedPrice | price}} </b>\n                  </span>\n                </h5>\n                <h5 *ngIf=\"payedPrice > 0 && changePrice !== 0\" class=\"mb-1\">{{changeMessage}}:\n                  <span class=\"text-warning pull-right\">\n                    <b>{{(changePrice < 0 ? changePrice*-1 : changePrice) | price }} </b> </span>\n                </h5>\n              </div>\n              <div class=\"card-footer p-1 pr-2 pl-2\">\n                <div class=\"input-group\">\n                  <input type=\"text\" class=\"form-control form-control-lg text-right\" readonly [ngModel]=\"numpad\" style=\"font-size: 2rem;\">\n                  <div class=\"input-group-append\">\n                    <div class=\"input-group-text\">\n                      <i class=\"fa fa-turkish-lira fa-2x\" aria-hidden=\"true\"></i>\n                    </div>\n                  </div>\n                  <span class=\"input-group-append\">\n                    <button class=\"btn btn-secondary\" (click)=\"cleanPad()\" type=\"button\">\n                      <i class=\"fa fa-arrow-left\" aria-hidden=\"true\"></i> Temizle\n                    </button>\n                  </span>\n                </div>\n              </div>\n              <div class=\"card-footer\">\n                <div *ngFor=\"let keys of numboard;\" class=\"row mb-1\">\n                  <div *ngFor=\"let key of keys;\" class=\"col-lg-4 pr-1 pl-1\">\n                    <button type=\"button\" [ngClass]=\"{'btn-success text-white': key == '✔' && numpad > 0}\" [disabled]=\"key == '✔' && numpad == '' || key == '.' && numpad == '' || key == '0' && numpad == ''\" (click)=\"pushKey(key)\" class=\"btn btn-outline-warning btn-lg btn-block numpad\">{{key}}</button>\n                  </div>\n                </div>\n              </div>\n              <div class=\"card-footer p-1\">\n                <p class=\"pr-1 pl-1 mt-1 mb-0\">\n                  <strong class=\"text-primary\" style=\"font-size: large;\">Hesap Toplamı:\n                    <span class=\"pull-right\">{{(check?.discount + check?.total_price + priceWillPay) | price}}\n                    </span>\n                  </strong>\n                </p>\n                <p class=\"text-muted pr-1 pl-1 mb-2\">\n                  <strong>Adisyon No:\n                    <span class=\"pull-right\">#{{check?.check_no}}</span>\n                  </strong>\n                </p>\n                <div class=\"btn-group btn-group-justify btn-block\">\n                  <button [disabled]=\"productsWillPay.length == 0 || !permissions.discount\" type=\"button\" data-toggle=\"modal\" data-target=\"#discount\" class=\"btn btn-secondary btn-block btn-lg\"><strong>İndirim Yap</strong>\n                    <span class=\"float-right\">\n                      <i class=\"fa fa-chevron-down\" aria-hidden=\"true\"></i>\n                    </span>\n                  </button>\n                  <button [disabled]=\"check?.products.length !== 0 || productsWillPay.length == 0 || !permissions.discount\" type=\"button\" data-toggle=\"modal\" data-target=\"#otherOptions\" class=\"btn btn-info btn-lg mt-0\"><strong>İşlemler</strong>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-1 pl-1 pr-0\">\n            <button *ngFor=\"let method of paymentMethods\" [disabled]=\"currentAmount == 0 ||  payedPrice == 0 || currentAmount == 0 && productsWillPay.length == 0\" (click)=\"payProducts(method.name)\" class=\"btn btn-block btn-secondary sellButton\" [ngStyle]=\"{'color': method.color, 'border': '1px solid', 'border-color': method.color}\">\n              <i class=\"fa {{method.icon}}\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>{{method.name}}</b>\n              </p>\n            </button>\n            <!-- <button [disabled]=\"currentAmount == 0 || payedPrice == 0 || currentAmount == 0 && productsWillPay.length == 0\" (click)=\"payProducts('Kart')\" class=\"btn btn-block sellButton btn-outline-warning\">\n              <i class=\"fa fa-credit-card ml-1\"></i>\n              <br> Kart\n            </button>\n            <button [disabled]=\"currentAmount == 0 || payedPrice == 0 || currentAmount == 0 && productsWillPay.length == 0\" (click)=\"payProducts('Kupon')\" class=\"btn btn-block sellButton btn-outline-info\">\n              <i class=\"fa fa-bookmark ml-1\"></i>\n              <br> Kupon\n            </button>\n            <button [disabled]=\"currentAmount == 0 || payedPrice == 0 || currentAmount == 0 && productsWillPay.length == 0\" (click)=\"payProducts('İkram')\" class=\"btn btn-block sellButton btn-outline-danger\">\n              <i class=\"fa fa-handshake-o ml-1\" aria-hidden=\"true\"></i>\n              <br> İkram\n            </button> -->\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"discount\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">İndirim Yap</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col\">\n            <div class=\"input-group\">\n              <input #discountInput type=\"number\" min=\"1\" placeholder=\"İndirim Tutarı Giriniz\" class=\"form-control form-control-lg\">\n              <div class=\"input-group-append normal\">\n                <div class=\"input-group-text\">\n                  <i class=\"fa fa-turkish-lira fa-2x\" aria-hidden=\"true\"></i>\n                </div>\n              </div>\n              <span class=\"input-group-append\">\n                <button class=\"btn btn-primary btn-lg\" [disabled]=\"discountInput.value >= currentAmount || discountInput.value <= 0\" (click)=\"setDiscount((discountInput.value*100)/priceWillPay)\" type=\"button\">\n                  <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> İndirim Yap\n                </button>\n              </span>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mt-4 pr-2 pl-2\">\n          <div *ngFor=\"let item of discounts;\" class=\"col-lg-4 mb-2 pr-1 pl-1\">\n            <button type=\"button\" (click)=\"setDiscount(item)\" class=\"btn btn-primary btn-block btn-lg btn-discount\">{{item}}\n              %</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"calculator\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Ödeme Bölme</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col\">\n            <div class=\"input-group\">\n              <!-- <input type=\"number\" [value]=\"priceWillPay\" min=\"1\" placeholder=\"İndirim Tutarı Giriniz\" class=\"form-control form-control-lg\"> -->\n              <div class=\"input-group-append normal\">\n                <div class=\"input-group-text\">\n                  Bölünecek Tutar:\n                </div>\n              </div>\n              <div class=\"input-group-append normal\">\n                <div class=\"input-group-text\">\n                  <h2 style=\"font-weight: bold; width: 100%;\" class=\"m-0 text-right\">{{priceWillPay | price }}</h2>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mt-4\">\n          <div class=\"col-lg-12 pr-3 pl-3\">\n            <h4>Bölüm Sayısı:</h4>\n          </div>\n        </div>\n        <div class=\"row mt-4 pr-2 pl-2\">\n          <div *ngFor=\"let item of [2,3,4,5];\" class=\"col-lg-3 mb-2 pr-1 pl-1\">\n            <button type=\"button\" (click)=\"divideWillPay(item)\" class=\"btn btn-outline-warning btn-block btn-lg btn-discount\">{{item}}</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div class=\"modal fade\" id=\"otherOptions\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Alacaklı Kapat</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"form-group\">\n          <select #customerInput class=\"form-control form-control-lg\">\n            <option *ngFor=\"let customer of customers\" value={{customer._id}}>{{customer.name}} {{customer.surname}}</option>\n          </select>\n        </div>\n        <div class=\"form-group mb-0\">\n          <input #creditNote type=\"text\" placeholder=\"Cari Hesap Notu\" class=\"form-control form-control-lg\">\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button class=\"btn btn-primary btn-lg\" [disabled]=\"creditNote.value == '' || creditNote.value == ' ' || customerInput.value == '' || customerInput.value == ' '\" (click)=\"createCredit(customerInput.value,creditNote.value)\" type=\"button\">\n          <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> Cari Kapat\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/store/payment-screen/payment-screen.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".sellButton {\n  height: 145.8px;\n  margin-bottom: 3.8px;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  padding-right: 0px;\n  padding-left: 0px;\n  font-size: 1.35rem;\n  font-weight: bold; }\n  .sellButton i {\n    font-size: 3.5vw; }\n\n.cashButton {\n  height: 114.5px;\n  margin-bottom: 3.8px;\n  padding-left: 7px;\n  font-size: 5vh;\n  font-weight: bold; }\n\n.payment-flow {\n  height: 35vh;\n  overflow: hidden;\n  overflow-y: scroll;\n  overflow-x: hidden; }\n  .payment-flow p {\n    font-weight: bolder; }\n\n#productHolder {\n  overflow-y: scroll;\n  background-color: #ebebeb; }\n\n.proCard {\n  height: 112.4px; }\n  .proCard h2 {\n    font-size: 3vh;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    text-transform: capitalize; }\n  .proCard :hover {\n    background-color: #ebcccc; }\n  .proCard .long-name {\n    font-size: 2.4vh; }\n  .proCard p {\n    position: absolute;\n    bottom: 15px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n\n.normal {\n  width: auto !important; }\n\n.tFlow {\n  height: 60vh;\n  overflow-y: scroll;\n  overflow-x: hidden; }\n\n.ikiyuzTL {\n  background-color: #d65f84;\n  color: #162c5b;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.yuzTL {\n  background-color: #83a8d4;\n  color: #163d82;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.elliTL {\n  background-color: #f7d0a7;\n  color: #e04e3c;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.yirmiTL {\n  background-color: #bfcbab;\n  color: #3c5c1d;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.onTL {\n  background-color: #efa2b6;\n  color: #d84861;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.besTL {\n  background-color: #eed9c1;\n  color: #85453b;\n  -webkit-text-stroke: #ebebeb 1px; }\n\n.numpad {\n  font-weight: 900;\n  font-size: 26px;\n  padding: 5px; }\n\n.payedLayer {\n  border-top: 1px solid white; }\n\n.payed-things {\n  min-height: 200px; }\n\n.will-pay {\n  font-size: 2vw; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/store/payment-screen/payment-screen.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PaymentScreenComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_settings__ = __webpack_require__("./src/app/mocks/settings.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let PaymentScreenComponent = class PaymentScreenComponent {
    constructor(route, router, settingsService, mainService, printerService, messageService, logService) {
        this.route = route;
        this.router = router;
        this.settingsService = settingsService;
        this.mainService = mainService;
        this.printerService = printerService;
        this.messageService = messageService;
        this.logService = logService;
        this.route.params.subscribe(params => {
            this.id = params['id'];
            this.fillData();
        });
        this.paymentMethods = [
            new __WEBPACK_IMPORTED_MODULE_3__mocks_settings__["b" /* PaymentMethod */]('Nakit', 'Nakit Ödeme', '#5cb85c', 'fa-money', 1, 1),
            new __WEBPACK_IMPORTED_MODULE_3__mocks_settings__["b" /* PaymentMethod */]('Kart', 'Kredi veya Banka Kartı', '#f0ad4e', 'fa-credit-card', 2, 1),
            new __WEBPACK_IMPORTED_MODULE_3__mocks_settings__["b" /* PaymentMethod */]('Kupon', 'İndirim Kuponu veya Yemek Çeki', '#5bc0de', 'fa-bookmark', 3, 1),
            new __WEBPACK_IMPORTED_MODULE_3__mocks_settings__["b" /* PaymentMethod */]('İkram', 'İkram Hesap', '#c9302c', 'fa-handshake-o', 4, 1)
        ];
        this.permissions = JSON.parse(localStorage['userPermissions']);
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
        this.settingsService.getPrinters().subscribe(res => this.printers = res.value);
    }
    ngOnInit() {
        this.discounts = [5, 10, 15, 20, 25, 40];
        this.numboard = [[1, 2, 3], [4, 5, 6], [7, 8, 9], [".", 0, "✔"]];
        this.setDefault();
        this.payedShow = false;
        this.payedTitle = 'Ödemeleri Göster';
        this.userId = this.settingsService.getUser('id');
        this.userName = this.settingsService.getUser('name');
        this.onClosing = false;
        this.changes = this.mainService.LocalDB['checks'].changes({ since: 'now', live: true }).on('change', (change) => {
            if (change.id == this.id) {
                if (!change.deleted) {
                    this.mainService.getData('checks', change.id).then(res => {
                        console.log(res.products.length, this.productsWillPay.length, this.check.products.length);
                        let newOrderedProducts = res.products.filter(obj => !this.productsWillPay.some(pp => pp.timestamp == obj.timestamp) && !this.check.products.some(cp => cp.timestamp == obj.timestamp));
                        this.check.products = this.check.products.concat(newOrderedProducts);
                        this.check.products = this.check.products.filter(obj => obj.status == 2);
                    });
                }
                else {
                    this.router.navigate(['/store']);
                }
            }
        });
    }
    leftTotal() {
        if (this.check.products.length > 0) {
            return this.check.products.map(obj => obj.price).reduce((a, b) => a + b, 0);
        }
    }
    ngOnDestroy() {
        this.changes.cancel();
        if (this.onClosing) {
            this.productsWillPay.forEach(element => {
                this.check.products.push(element);
                this.check.total_price += element.price;
            });
            this.check.status = __WEBPACK_IMPORTED_MODULE_2__mocks_check__["d" /* CheckStatus */].READY;
            this.mainService.updateData('checks', this.check._id, this.check);
        }
        else {
            // this.mainService.updateData('checks', this.check._id, {status:CheckStatus.READY});
        }
    }
    checkTotal() {
        return this.check.products.filter(obj => obj.status !== 3).map(obj => obj.price).reduce((a, b) => a + b, 0);
    }
    payProducts(method) {
        // if(method == 'Nakit'){
        //   this.printerService.kickCashdraw(this.printers[0])
        // }
        if (method == 'İkram' && this.permissions.giveFree !== true) {
            this.messageService.sendMessage('İkram Yetkiniz Yok !');
            return false;
        }
        if (this.discountAmount > 0) {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_6__services_log_service__["b" /* logType */].DISCOUNT, this.userId, `${this.table} Hesabına ${this.discountAmount} TL tutarında indirim yapıldı.`);
        }
        if (this.check.total_price == 0 && this.changePrice >= 0) {
            this.closeCheck(method);
        }
        else {
            this.onClosing = true;
            let newPayment;
            let isAnyEqual = this.productsWillPay.some(obj => obj.price == (this.payedPrice + (this.discount ? this.discountAmount : 0)));
            let isAnyGreat = this.productsWillPay.some(obj => obj.price > (this.payedPrice + (this.discount ? this.discountAmount : 0)));
            let isAnyLittle = this.productsWillPay.some(obj => obj.price < (this.payedPrice + (this.discount ? this.discountAmount : 0)));
            if (this.changePrice < 0) {
                if (this.discount) {
                    this.payedPrice = this.payedPrice + this.discountAmount;
                }
                if (isAnyEqual) {
                    let equalProduct = this.productsWillPay.filter(obj => obj.price == this.payedPrice)[0];
                    let indexOfEqual = this.productsWillPay.findIndex(obj => obj == equalProduct);
                    newPayment = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["g" /* PaymentStatus */](this.userName, method, (this.payedPrice - this.discountAmount), this.discountAmount, Date.now(), [equalProduct]);
                    this.productsWillPay.splice(indexOfEqual, 1);
                }
                else if (isAnyGreat) {
                    let greatOne = this.productsWillPay.sort((a, b) => b.price - a.price)[0];
                    let greatOneCopy = Object.assign({}, greatOne);
                    greatOneCopy.price = this.payedPrice;
                    newPayment = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["g" /* PaymentStatus */](this.userName, method, (this.payedPrice - this.discountAmount), this.discountAmount, Date.now(), [greatOneCopy]);
                    greatOne.price -= this.payedPrice;
                }
                else if (isAnyLittle) {
                    newPayment = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["g" /* PaymentStatus */](this.userName, method, (this.payedPrice - this.discountAmount), this.discountAmount, Date.now(), []);
                    let priceCount = this.payedPrice;
                    let willRemove = 0;
                    this.productsWillPay = this.productsWillPay.filter(obj => obj).sort((a, b) => b.price - a.price);
                    this.productsWillPay.forEach((product, index) => {
                        if (priceCount > 0) {
                            if (priceCount >= product.price) {
                                newPayment.payed_products.push(Object.assign({}, product));
                                willRemove++;
                                priceCount -= product.price;
                            }
                            else {
                                const productWillPush = Object.assign({}, product);
                                productWillPush.price = priceCount;
                                newPayment.payed_products.push(productWillPush);
                                if (product.price - priceCount == 0) {
                                    willRemove++;
                                }
                                else {
                                    let pro = this.productsWillPay[index];
                                    pro.price -= priceCount;
                                }
                                priceCount = 0;
                            }
                        }
                    });
                    this.productsWillPay.splice(0, willRemove);
                }
                this.priceWillPay -= this.payedPrice;
                this.currentAmount -= (this.payedPrice - this.discountAmount);
                this.numpad = this.priceWillPay.toFixed(2).toString();
            }
            else {
                newPayment = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["g" /* PaymentStatus */](this.userName, method, this.currentAmount, this.discountAmount, Date.now(), this.productsWillPay);
            }
            if (this.check.payment_flow == undefined) {
                this.check.payment_flow = [];
            }
            this.check.payment_flow.push(newPayment);
            this.check.discount += newPayment.amount;
            this.payedPrice = 0;
            if (this.changePrice >= 0) {
                this.setPayment();
                this.messageService.sendMessage(`Ürünler ${method} olarak ödendi`);
            }
            else {
                delete this.check._rev;
                this.messageService.sendMessage(`Ürünlerin ${newPayment.amount} TL'si ${method} olarak ödendi`);
                this.discount = undefined;
                this.discountAmount = 0;
            }
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_6__services_log_service__["b" /* logType */].CHECK_PAYED, this.check._id, `${this.table} Hesabından ${newPayment.amount} TL tutarında ${method} ödeme alındı.`);
            this.togglePayed();
            this.isFirstTime = true;
        }
    }
    closeCheck(method) {
        let total_discounts = 0;
        let checkWillClose;
        this.onClosing = false;
        if (this.check.payment_flow !== undefined && this.check.payment_flow.length > 0) {
            let realMethod = method;
            method = 'Parçalı';
            let lastPayment = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["g" /* PaymentStatus */](this.userName, realMethod, this.currentAmount, this.discountAmount, Date.now(), this.productsWillPay);
            this.check.payment_flow.push(lastPayment);
            this.check.discount += this.priceWillPay;
            total_discounts = this.check.payment_flow.map(obj => obj.discount).reduce((a, b) => a + b);
            let total_price = this.check.payment_flow.map(obj => obj.amount).reduce((a, b) => a + b);
            checkWillClose = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["f" /* ClosedCheck */](this.check.table_id, total_price, total_discounts, this.userName, this.check.note, this.check.status, this.check.products, Date.now(), this.check.type, method, this.check.payment_flow, null, this.check.occupation);
        }
        else {
            total_discounts = this.discountAmount;
            checkWillClose = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["f" /* ClosedCheck */](this.check.table_id, this.currentAmount, total_discounts, this.userName, this.check.note, this.check.status, this.productsWillPay, Date.now(), this.check.type, method, null, null, this.check.occupation);
        }
        if (this.askForPrint) {
            this.messageService.sendConfirm('Fiş Yazdırılsın mı ?').then(isOK => {
                if (isOK) {
                    this.printerService.printCheck(this.printers[0], this.table, checkWillClose);
                }
            });
        }
        else {
            this.printerService.printCheck(this.printers[0], this.table, checkWillClose);
        }
        this.mainService.addData('closed_checks', checkWillClose).then(res => {
            if (res.ok) {
                this.mainService.removeData('checks', this.check._id).then(res => {
                    if (this.check.type == 1) {
                        this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                    }
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_6__services_log_service__["b" /* logType */].CHECK_CLOSED, res.id, `${this.table} Hesabı ${this.currentAmount} TL tutarında ödeme alınarak kapatıldı.`);
                    this.messageService.sendMessage(`Hesap '${method}' olarak kapatıldı`);
                });
                this.updateSellingReport(method);
                if (this.check.type == 1) {
                    this.updateTableReport(this.check, method);
                }
                this.router.navigate(['/store']);
            }
        });
    }
    createCredit(customer, creditNote) {
        if (this.check.payment_flow !== undefined) {
            let paymentMethod;
            (this.check.payment_flow.length > 0) ? paymentMethod = 'Parçalı' : paymentMethod = this.check.payment_flow[0].method;
            let checkWillClose = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["f" /* ClosedCheck */](this.check.table_id, this.check.discount, 0, this.userName, '', this.check.status, this.check.products, Date.now(), this.check.type, paymentMethod, this.check.payment_flow, null, this.check.occupation);
            this.updateSellingReport(paymentMethod);
            this.updateTableReport(this.check, paymentMethod);
            this.mainService.addData('closed_checks', checkWillClose);
        }
        let newCredit = new __WEBPACK_IMPORTED_MODULE_2__mocks_check__["a" /* Check */](customer, this.priceWillPay, __WEBPACK_IMPORTED_MODULE_2__mocks_check__["d" /* CheckStatus */].PASSIVE, this.userName, creditNote, 0, this.productsWillPay, Date.now(), __WEBPACK_IMPORTED_MODULE_2__mocks_check__["e" /* CheckType */].PASSIVE, Object(__WEBPACK_IMPORTED_MODULE_2__mocks_check__["b" /* CheckNo */])());
        this.mainService.addData('credits', newCredit).then(res => {
            if (res.ok) {
                if (this.check.type == 1) {
                    this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                }
                this.mainService.removeData('checks', this.check._id).then(res => {
                    if (res.ok) {
                        $('#otherOptions').modal('hide');
                        this.router.navigate(['/store']);
                    }
                });
            }
        });
    }
    setDiscount(discount) {
        this.discount = discount;
        if (this.payedPrice == 0) {
            this.payedPrice = this.priceWillPay;
        }
        this.setChange();
        this.discountInput.nativeElement.value = 0;
        $('#discount').modal('hide');
    }
    divideWillPay(division) {
        this.payedPrice = this.priceWillPay / division;
        this.setChange();
        this.numpad = this.payedPrice.toFixed(2).toString();
        $('#calculator').modal('hide');
    }
    togglePayed() {
        if (this.payedShow) {
            this.payedShow = false;
            this.payedTitle = 'Ödemeleri Göster';
        }
        else {
            this.payedShow = true;
            this.payedTitle = 'Ödemeleri Gizle';
        }
    }
    addProductToList(product) {
        this.isFirstTime = true;
        this.check.products = this.check.products.filter(obj => obj !== product);
        this.productsWillPay.push(product);
        this.check.total_price -= product.price;
        this.priceWillPay += product.price;
        this.numpad = this.priceWillPay.toFixed(2).toString();
        this.payedShow = false;
        this.payedTitle = 'Ödemeleri Göster';
        this.setChange();
    }
    addProductToCheck(product) {
        this.isFirstTime = true;
        this.productsWillPay = this.productsWillPay.filter(obj => obj !== product);
        this.check.products.push(product);
        this.check.total_price += product.price;
        this.priceWillPay -= product.price;
        this.numpad = this.priceWillPay.toFixed(2).toString();
        this.setChange();
    }
    sendAllProducts() {
        this.check.products.forEach(element => {
            this.productsWillPay.push(element);
            this.check.products = this.check.products.filter(obj => obj !== element);
        });
        this.priceWillPay = this.productsWillPay.map(obj => obj.price).reduce((a, b) => a + b);
        this.check.products = [];
        this.numpad = this.priceWillPay.toFixed(2).toString();
        this.check.total_price = 0;
        this.setChange();
    }
    getPayment(number) {
        this.payedPrice += number;
        this.setChange();
    }
    setChange() {
        if (this.discount) {
            this.discountAmount = ((this.priceWillPay * this.discount) / 100);
        }
        this.currentAmount = this.priceWillPay - this.discountAmount;
        this.changePrice = this.payedPrice - this.priceWillPay;
        this.changePrice += this.discountAmount;
        if (this.changePrice > 0) {
            this.changeMessage = 'Para Üstü';
        }
        else {
            this.changeMessage = 'Kalan Ödeme';
        }
    }
    pushKey(key) {
        if (key === "✔") {
            this.payedPrice = parseFloat(this.numpad);
            this.setChange();
            this.numpad = '';
        }
        else {
            if (this.isFirstTime) {
                this.numpad = '';
                this.isFirstTime = false;
            }
            this.numpad += key;
        }
    }
    cleanPad() {
        this.numpad = '';
        this.payedPrice = 0;
        this.discount = undefined;
        this.discountAmount = 0;
        this.currentAmount = 0;
        this.setChange();
    }
    printCheck() {
        this.printerService.printCheck(this.printers[0], this.table, this.check);
    }
    setDefault() {
        this.numpad = '';
        this.isFirstTime = true;
        this.productsWillPay = [];
        this.currentAmount = 0;
        this.priceWillPay = 0;
        this.changePrice = 0;
        this.payedPrice = 0;
        this.discountAmount = 0;
        this.discount = undefined;
    }
    setPayment() {
        this.productsWillPay = [];
        this.discountAmount = 0;
        this.changePrice = 0;
        this.currentAmount = 0;
        this.priceWillPay = 0;
        this.numpad = '';
        this.isFirstTime = true;
        this.discount = undefined;
    }
    updateSellingReport(method) {
        if (method !== 'Parçalı') {
            this.mainService.getAllBy('reports', { connection_id: method }).then(res => {
                if (res.docs.length > 0) {
                    let doc = res.docs[0];
                    doc.count++;
                    doc.weekly_count[this.day]++;
                    doc.monthly_count[new Date().getMonth()]++;
                    doc.amount += this.currentAmount;
                    doc.weekly[this.day] += this.currentAmount;
                    doc.monthly[new Date().getMonth()] += this.currentAmount;
                    doc.timestamp = Date.now();
                    this.mainService.updateData('reports', doc._id, doc);
                }
            });
        }
        else {
            this.mainService.getAllBy('reports', { type: "Store" }).then(res => {
                let sellingReports = res.docs;
                this.check.payment_flow.forEach((obj, index) => {
                    let reportWillChange = sellingReports.find(report => report.connection_id == obj.method);
                    reportWillChange.count++;
                    reportWillChange.weekly_count[this.day]++;
                    reportWillChange.monthly_count[new Date().getMonth()] += obj.amount;
                    reportWillChange.amount += obj.amount;
                    reportWillChange.weekly[this.day] += obj.amount;
                    reportWillChange.monthly[new Date().getMonth()] += obj.amount;
                    reportWillChange.timestamp = Date.now();
                    if (this.check.payment_flow.length == index + 1) {
                        sellingReports.forEach((report) => {
                            if (this.check.payment_flow.some(obj => obj.method == report.connection_id)) {
                                this.mainService.updateData('reports', report._id, report);
                            }
                        });
                    }
                });
            });
        }
    }
    updateTableReport(check, method) {
        this.mainService.getAllBy('reports', { connection_id: check.table_id }).then(res => {
            let report = res.docs[0];
            if (method !== 'Parçalı') {
                report.count++;
                report.amount += this.currentAmount;
                report.timestamp = Date.now();
                report.weekly[this.day] += this.currentAmount;
                report.weekly_count[this.day]++;
                report.monthly[new Date().getMonth()] += this.currentAmount;
                report.monthly_count[new Date().getMonth()]++;
            }
            else {
                report.count++;
                report.weekly_count[this.day]++;
                report.monthly_count[new Date().getMonth()]++;
                report.timestamp = Date.now();
                this.check.payment_flow.forEach((obj, index) => {
                    report.amount += obj.amount;
                    report.weekly[this.day] += obj.amount;
                    report.monthly[new Date().getMonth()] += obj.amount;
                });
            }
            this.mainService.updateData('reports', report._id, report);
        });
    }
    fillData() {
        this.mainService.getData('checks', this.id).then(res => {
            this.check = res;
            if (this.check.type == 1) {
                this.check_id = this.check.table_id;
                this.check_type = 'Normal';
                this.mainService.getData('tables', this.check.table_id).then(res => {
                    this.table = res.name;
                });
            }
            else {
                this.check_id = this.id;
                this.check_type = 'Fast';
                this.table = (this.check.note == '' ? 'Hızlı Satış' : this.check.note);
            }
            if (this.check.discountPercent) {
                this.setDiscount(this.check.discountPercent);
            }
            this.canceledProducts = this.check.products.filter(obj => obj.status == 3);
            this.check.products = this.check.products.filter(obj => obj.status == 2);
        });
        this.settingsService.getAppSettings().subscribe((res) => {
            if (res.value.ask_print_check == 'Sor') {
                this.askForPrint = true;
            }
            else {
                this.askForPrint = false;
            }
        });
        this.mainService.getAllBy('customers', {}).then(res => {
            this.customers = res.docs;
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('discountInput'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], PaymentScreenComponent.prototype, "discountInput", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('customerInput'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], PaymentScreenComponent.prototype, "customerInput", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('creditNote'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], PaymentScreenComponent.prototype, "creditNote", void 0);
PaymentScreenComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-payment-screen',
        template: __webpack_require__("./src/app/components/store/payment-screen/payment-screen.component.html"),
        styles: [__webpack_require__("./src/app/components/store/payment-screen/payment-screen.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_8__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_router__["a" /* ActivatedRoute */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_8__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_7__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_5__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_4__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_6__services_log_service__["a" /* LogService */]])
], PaymentScreenComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/store/selling-screen/selling-screen.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-xl-12\">\n    <div class=\"card full-height\">\n      <div class=\"card-header border-bottom-0\">\n        <div class=\"row\">\n          <div class=\"col-xl-8 col-lg-7\">\n            <div class=\"row\">\n              <div class=\"col-lg-3\">\n                <div class=\"table-name\">\n                  <!-- <span *ngIf=\"check?.type == 1\">Masa:</span> -->\n                  <b>{{check?.table_id | general:'tables' | async}}</b>\n                  <span *ngIf=\"check.note !== '' && check.note !== null && check.note !== undefined\" class=\"text-warning\">\n                    ({{check.note}})\n                  </span>\n                </div>\n              </div>\n              <div class=\"col-lg-5 humanIcon pr-2 pl-0 text-right\" style=\"white-space: nowrap;\">\n                <span><small style=\"text-transform: capitalize;\">{{check?.owner}}</small></span> -\n                <i class=\"fa fa-clock-o\"></i> {{check?.timestamp | timeAgo}}\n              </div>\n              <div class=\"col-lg-4 pl-1 pr-0\">\n                <div class=\"input-group input-group-sm\">\n                  <div class=\"input-group-prepend normal\">\n                    <div class=\"input-group-text humanIcon\"><i class=\"fa fa-search\" aria-hidden=\"true\"></i></div>\n                  </div>\n                  <input #productName type=\"text\" style=\"font-size: 17px;\" placeholder=\"Ürün Adı Giriniz..\" (keydown)=\"filterProducts(productName.value)\" (click)=\"subCatsView = undefined;\" class=\"form-control form-contol-sm\">\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-xl-4 col-lg-5\">\n            <div class=\"row\">\n              <div class=\"col-lg-4 pr-0 pl-2\">\n                <!-- || !permissions.discount -->\n                <button data-toggle=\"modal\" (click)=\"onProductChange = false\" data-target=\"#splitTable\" [disabled]=\"tablesView?.length == 0 || check.products.length == 0 || check.status == 0 || !permissions.moveTable\" class=\"btn btn-danger btn-block btn-sm\">\n                  <strong>Masa Değiştir</strong>\n                </button>\n              </div>\n              <div class=\"col-lg-4 pr-1 pl-1\">\n                <button data-toggle=\"modal\" data-target=\"#checkOptions\" [disabled]=\"check.products.length == 0\" class=\"btn btn-danger btn-block btn-sm\">\n                  <strong>Hesap İşlemleri</strong>\n                </button>\n              </div>\n              <div class=\"col-lg-4 pr-0 pl-0\">\n                <button data-toggle=\"modal\" data-target=\"#qrPrintersModal\" class=\"btn btn-secondary text-info border-info btn-block btn-sm \" [disabled]=\"tablesView?.length == 0 || check.type == 2\">\n                  <i class=\"fa fa-qrcode\"></i>\n                  <strong>QR Yazdır</strong>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body pt-2\">\n        <div class=\"row\">\n          <div class=\"col-xl-8 col-lg-7\">\n            <div class=\"row\">\n              <!-- <div class=\"col-xl-3 col-lg-3 inside-height check-flow pl-0 pr-0\">\n                <div class=\"btn-group-vertical btn-block btn-group-lg\">\n                  <button (click)=\"productsView = products; selectedCat = undefined; subCatsView = undefined;\" [ngClass]=\"{'btn-danger bg-danger text-white':selectedCat == undefined}\" class=\"btn btn-secondary dark-bg catButton\">Bütün\n                    Ürünler\n                  </button>\n                  <button *ngFor=\"let cat of categories\" [ngClass]=\"{'btn-danger bg-danger text-white':selectedCat == cat._id}\" (click)=\"getProductsBy(cat._id)\" class=\"btn btn-secondary dark-bg catButton\">{{cat.name}}</button>\n                </div>\n              </div> -->\n              <div *ngIf=\"selectedCat == undefined\" class=\"col-xl-11 col-lg-11  pr-0 pl-0\">\n                <div class=\"card inside-height\">\n                  <div id=\"categoryHolder\" class=\"card-body pt-0 pb-0 flow\">\n                    <div class=\"row\">\n                      <div *ngFor=\"let cat of categories\" (click)=\"getProductsBy(cat._id)\" class=\"col-xl-3 col-lg-4 col-card\">\n                        <div class=\"card mb-1 mt-1 catCard\">\n                          <div class=\"card-body\">\n                            <h2 class=\"card-title text-center\">{{cat.name}}</h2>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div *ngIf=\"selectedCat !== undefined\" class=\"col-xl-11 col-lg-11  pr-0 pl-0\">\n                <div class=\"card inside-height\">\n                  <div>\n                    <div class=\"card-header pt-1 pb-1 pr-1 pl-1\">\n                      <div class=\"row ml-0 mr-0\">\n                        <div class=\"col-xl-3 col-lg-4 p-0 pr-1 pl-1 mb-0\">\n                          <button (click)=\"selectedCat = undefined\" class=\"btn btn-md btn-danger text-dark btn-block\">\n                            <b><i class=\"fa fa-chevron-left\" aria-hidden=\"true\"></i> Geri</b>\n                          </button>\n                        </div>\n                        <ng-container *ngIf=\"subCatsView !== undefined && subCatsView.length > 0\">\n                          <div *ngFor=\"let item of subCatsView\" class=\"col p-0 pr-1 pl-1 mb-1\">\n                            <button (click)=\"getProductsBySubCat(item._id)\" class=\"btn btn-md btn-warning text-dark btn-block\">\n                              <b>{{item.name}}</b>\n                            </button>\n                          </div>\n                        </ng-container>\n                      </div>\n                    </div>\n                  </div>\n                  <div id=\"productHolder\" class=\"card-body pt-0 pb-0 flow\">\n                    <div class=\"row\">\n                      <div *ngFor=\"let product of productsView\" (click)=\"addToCheck(product)\" class=\"col-xl-3 col-lg-4 col-card\">\n                        <div class=\"card mb-1 mt-1 proCard\">\n                          <div class=\"card-body\">\n                            <h2 class=\"card-title\" [ngClass]=\"{'long-name': product.name.length > 12 }\">{{product.name}}</h2>\n                            <p class=\"card-text text-danger\">\n                              <span class=\"price\">\n                                <b> {{product.price | price }} </b>\n                              </span>\n                              <small class=\"category mt-1 text-white\">\n                                {{catName(product.cat_id)}}\n                                <!-- {{product.cat_id | general:'categories':'name'| async}} -->\n                              </small>\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    <div *ngIf=\"productsView == undefined || productsView.length == 0\" class=\"row mt-5\">\n                      <div class=\"col-xl-12 mt-5\">\n                        <h2 class=\"text-center mt-3\">Eşleşen Ürün Bulunamadı</h2>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div class=\"col-lg-1 col-xl-1\">\n                <div class=\"row\">\n                  <div *ngFor=\"let item of [0.5,1,1.5,2,3,4,5,6,7,8]\" class=\"col pr-0 pl-1\">\n                    <button (click)=\"selectedQuantity = item\" class=\"btn btn-block {{ selectedQuantity == item ? 'btn-warning' : 'btn-outline-warning'}}\" style=\"height: 60.6px; font-weight: bold; font-size:1.5vw;\"><strong>{{item}}</strong></button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"col-xl-3 col-lg-4 pr-0 pl-1\">\n            <div class=\"card inside-height\">\n              <div class=\"card-header pt-1 pb-1\">\n                <div class=\"row\">\n                  <div class=\"col-lg-5 pl-0 pr-1\">\n                    <button class=\"btn btn-sm btn-block btn-warning\" data-toggle=\"modal\" data-target=\"#occupationModal\"><i class=\"fa fa-male\" aria-hidden=\"true\"></i> Kuver</button>  \n\n                    <!-- <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text humanIcon\"><i class=\"fa fa-male\" aria-hidden=\"true\"></i></div>\n                      </div>\n                      <input type=\"number\" readonly value=\"{{check.occupation.male}}\" class=\"form-control form-contol-sm\" style=\"font-weight: bolder; font-size: 20px;\">\n                      <div class=\"input-group-append normal\">\n                        <button (click)=\"check.occupation.male = check.occupation.male +1\" class=\"btn btn-success\"><i class=\"fa fa-plus\"></i></button>\n                      </div>\n                      <div class=\"input-group-append normal\">\n                        <button [disabled]=\"check.occupation.male == 0\" (click)=\"check.occupation.male = check.occupation.male -1\" class=\"btn btn-danger\"><i class=\"fa fa-minus\"></i></button>\n                      </div>\n                    </div> -->\n                  </div>\n                  <div class=\"col-lg-5 pl-0 pr-0\">\n                    <button (click)=\"addServiceCharge(10)\" [disabled]=\"!permissions.discount || check.products.length == 0\" class=\"btn btn-sm btn-block btn-success\"><i class=\"fa fa-percent\" aria-hidden=\"true\"></i> Servis Ücreti</button>  \n                    <!-- <div class=\"input-group input-group-sm\">\n                      <div class=\"input-group-prepend normal\">\n                        <div class=\"input-group-text humanIcon\"><i class=\"fa fa-female\" aria-hidden=\"true\"></i></div>\n                      </div>\n                      <input type=\"number\" readonly value=\"{{check.occupation.female}}\" class=\"form-control form-contol-sm\" style=\"font-weight: bolder; font-size: 20px;\">\n                      <div class=\"input-group-append normal\">\n                        <button (click)=\"check.occupation.female = check.occupation.female +1\" class=\"btn btn-success\"><i class=\"fa fa-plus\"></i></button>\n                      </div>\n                      <div class=\"input-group-append normal\">\n                        <button [disabled]=\"check.occupation.female == 0\" (click)=\"check.occupation.female = check.occupation.female -1\" class=\"btn btn-danger\"><i class=\"fa fa-minus\"></i></button>\n                      </div>\n                    </div> -->\n                  </div>\n                  <div class=\"col-lg-2 pl-1 pr-1\">\n                    <button  (click)=\"toggleProduct()\" class=\"btn btn-sm btn-block btn-info\">\n                      <i *ngIf=\"!isCollapsedView\" class=\"fa fa-list-ol\" aria-hidden=\"true\"></i>\n                      <i *ngIf=\"isCollapsedView\" class=\"fa fa-list-ul\" aria-hidden=\"true\"></i>\n                    </button>  \n                  </div>\n                </div>\n              </div>\n              <div id=\"check-products\" class=\"card-body check-flow p-2 dark-bg\">\n                <ng-container *ngIf=\"!isCollapsedView\" >\n                  <div *ngFor=\"let item of check.products; let i = index\" [ngClass]=\"{'animated slideInLeft':item.status == 1}\">\n                    <div [ngClass]=\"{'text-danger': item.status == 2 && selectedIndex != i, 'text-warning':selectedIndex == i}\" style=\"cursor:pointer\" (click)=\"selectProduct(i)\" class=\"check-product\">\n                      <div class=\"product-name\">\n                        <i *ngIf=\"item.status == 3\" class=\"fa fa-times-rectangle text-danger\" aria-hidden=\"true\"></i>\n                        {{item.name}}\n                        <br>\n                        <small *ngIf=\"item.note !== '' && item.note !== undefined\">({{item.note}})</small>\n                      </div>\n                      <div class=\"product-price\">{{item.price | price }} </div>\n                      <div *ngIf=\"selectedIndex == i && item.status !== 1\" style=\"font-size: 13px; padding-bottom: 0.25rem;\">\n                        <p *ngFor=\"let extra of item.extras\" class=\"mb-1\">+ {{extra.extra_name}}</p>\n                        <div class=\"mt-1\">\n                          <i class=\"fa fa-user\" aria-hidden=\"true\"></i> {{item.owner | general:'users' | async }}\n                          <span class=\"pull-right\">\n                            <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> {{item.timestamp | date:'HH:mm'}}</span>\n                          <br>\n                        </div>\n                      </div>\n                      <!-- <ul *ngIf=\"item.extras.length > 0\">\n                        <li *ngFor=\"let extra of item.extras.extras\">{{extra.extra_name}}</li>\n                      </ul> -->\n                    </div>\n                  </div>\n                </ng-container>\n                \n                <ng-container *ngIf=\"isCollapsedView\" >\n                  <div *ngFor=\"let item of checkItems(); let i = index\">\n                    <p style=\"font-weight:bold; width:100%; display: flex; flex-direction: row; padding-bottom: 5px;\" class=\"check-product\" [ngClass]=\"{ 'text-danger' : item.status == 2}\">\n                      <span  style=\"min-width: 10%; float: left; text-align: center; font-weight: bolder;\">{{ item.quantity }} x</span>\n                      <span  style=\"min-width: 65%; max-width: 65%; padding-left: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-transform: capitalize;\"> {{ item.name }}</span> \n                      <span  style=\"min-width: 25%; float: right; text-align: right;\">{{ item.price * item.quantity  | price}}</span>\n                    </p>\n                  </div>\n                </ng-container>\n              </div>\n              <div *ngIf=\"check.discount > 0\" class=\"card-footer p-1\">\n                <button (click)=\"togglePayed()\" class=\"btn btn-sm btn-secondary btn-block text-left\">{{payedTitle}}\n                  <i [ngClass]=\"(payedShow) ? 'fa-caret-down':'fa-caret-up'\" class=\"fa pull-right\" aria-hidden=\"true\"></i>\n                </button>\n              </div>\n              <div *ngIf=\"check.discount > 0 && payedShow\" class=\"card-body check-flow p-2 payed-things\">\n                <div *ngFor=\"let payment of check.payment_flow\" class=\"mb-2 payedLayer\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#paymentOptions\" (click)=\"selectedPayment = payment\">\n                  <p class=\"mb-0\">\n                    <strong>{{payment.method}}</strong>\n                    <small>( {{payment.owner}} - {{payment.timestamp | date:'HH:mm'}} )</small>\n                    <span class=\"pull-right\">{{payment.amount + payment.discount | price}} </span>\n                  </p>\n                  <p *ngFor=\"let product of payment.payed_products\" class=\"text-warning m-0 pl-3\" style=\"text-transform: capitalize;\">\n                    <small>\n                      <strong>\n                        {{product.name}}\n                        <span class=\"pull-right\">{{product.price | price}} </span>\n                      </strong>\n                    </small>\n                  </p>\n                  <p *ngIf=\"payment.discount > 0\" class=\"text-danger m-0\">\n                    <small>\n                      <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> İndirim Miktarı\n                      <span class=\"pull-right\">{{payment.discount | price}} </span>\n                    </small>\n                  </p>\n                  <p class=\"m-0 font-weight-bold\">\n                    <small>\n                      <i class=\"fa fa-arrow-right\" aria-hidden=\"true\"></i> Alınan Ödeme\n                      <span class=\"pull-right\">{{payment.amount | price}} </span>\n                    </small>\n                  </p>\n                </div>\n              </div>\n              <div class=\"card-footer p-2\">\n                <p class=\"text-primary mb-0\">\n                  <strong style=\"font-size: large;\">Hesap Toplamı:\n                    <span class=\"pull-right\">{{checkTotal() + check.discount + (check.freeAmount ? check.freeAmount : 0) | price}} </span>\n                  </strong>\n                </p>\n                <p *ngIf=\"check.discount > 0\" class=\"text-warning mb-0\">\n                  <strong style=\"font-size: medium;\">\n                    Ödenen Miktar:\n                    <span class=\"pull-right\">{{check.discount | price }} </span>\n                  </strong>\n                </p>\n                <p *ngIf=\"check.freeAmount > 0\" class=\"text-info mb-0\">\n                  <strong style=\"font-size: medium;\">\n                    İkram Toplamı:\n                    <span class=\"pull-right\">{{check.freeAmount | price }} </span>\n                  </strong>\n                </p>\n                <p *ngIf=\"check.discountPercent > 0\" class=\"text-danger mb-0\">\n                  <strong>İndirim Tutarı:</strong>\n                  <span class=\"pull-right\">{{ check.discountPercent.toFixed(2) }}% -\n                    {{(checkTotal() * check.discountPercent)/100 | price}} </span>\n                </p>\n                <p *ngIf=\"check.discount > 0 || check.discountPercent !== undefined || check.freeAmount > 0\" class=\"mb-0\">\n                  <strong style=\"font-size: larger;\">Kalan Toplam:\n                    <span class=\"pull-right\">\n                      {{checkTotal() - (checkTotal() *(check.discountPercent ? check.discountPercent : 0 ))/100 | price}} </span>\n                  </strong>\n                </p>\n                <p class=\"text-muted mb-0\">\n                  <strong>Adisyon No:\n                    <span class=\"pull-right\">#{{check.check_no}}</span>\n                  </strong>\n                </p>\n                <div class=\"btn-group btn-group-justify btn-block mt-2\" data-toggle=\"buttons\">\n                  <button *ngIf=\"this.check.type == 1 || this.check.type == 2\" (click)=\"goPayment()\" [disabled]=\"check.products.length == 0 || check.type == 1 && check.products[0]?.status == 1 || !permissions.payment\" class=\"btn btn-danger btn-lg btn-block\"><strong>Ödeme Al</strong></button>\n                  <button *ngIf=\"this.check.type == 1 || this.check.type == 2\" [disabled]=\"check.products.length == 0 || check.type == 1 && check.products[0]?.status == 1 || !permissions.payment\" class=\"btn btn-lg btn-primary\" data-toggle=\"modal\" data-target=\"#closeCheck\"><strong>Kapat</strong></button>\n\n                  <button *ngIf=\"this.check.type == 1 && check.payment_flow && checkTotal() == 0\" (click)=\"endCheck()\" [disabled]=\"check?.payment_flow.length == 0 || check.type == 1 && check.products[0]?.status == 1 || !permissions.payment\" class=\"btn btn-lg btn-success\"><strong><i style=\"font-size: 1.5em;\" class=\"fa fa-check-square animated tada slow infinite\"></i></strong></button>\n\n                  <button *ngIf=\"this.check.type == 5\" [routerLink]=\"['/store']\" class=\"btn btn-secondary btn-lg btn-block\"><strong><i class=\"fa fa-backward\" aria-hidden=\"true\"></i> Geri Dön</strong></button>\n                  <button *ngIf=\"this.check.type == 5 && this.check.status !== 2\" [disabled]=\"check.products.length == 0 || check.type == 1 && check.products[0]?.status == 1 || !permissions.payment\" class=\"btn btn-lg btn-primary\" data-toggle=\"modal\" data-target=\"#closeCheck\"><strong>Kapat</strong></button>\n\n                  <!-- <button *ngIf=\"this.check.type == 7\" [disabled]=\"check.products.length == 0 || check.type == 1 && check.products[0]?.status == 1 || !permissions.payment\" class=\"btn btn-lg btn-primary\"><strong>Kapat</strong></button> -->\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-xl-1 col-lg-1 pr-0 pl-1\">\n            <button (click)=\"sendCheck()\" [oneShot]=\"check.type == 1\" [disabled]=\"check.products.length == 0 || newOrders.length == 0\" class=\"btn btn-success btn-block sendButton\">\n              <div>\n                <i class=\"fa fa-paper-plane fa-5x\"></i>\n                <p>Gönder</p>\n              </div>\n            </button>\n            <!-- (click)=\"getSpecies(selectedProduct)\" -->\n            <button data-toggle=\"modal\" (click)=\"noteInput.value = ''\" [disabled]=\"check.products.length == 0 || selectedProduct == undefined  || selectedProduct.status == 3\" data-target=\"#noteModal\" class=\"btn btn-warning btn-block sendButton\">\n              <div>\n                <i class=\"fa fa-sticky-note fa-5x\"></i>\n                <p>Not Ekle</p>\n              </div>\n            </button>\n            <button (click)=\"undoChanges()\" [disabled]=\"newOrders.length == 0\" class=\"btn btn-primary btn-block sendButton\">\n              <div>\n                <i class=\"fa fa-undo fa-5x\"></i>\n                <p>Geri Al</p>\n              </div>\n            </button>\n            <button data-toggle=\"modal\" data-target=\"#cancelProduct\" [disabled]=\"check.products.length == 0 || selectedProduct == undefined || selectedProduct.status !== 2 || !permissions.cancelProduct\" class=\"btn btn-danger btn-block sendButton\">\n              <div>\n                <i class=\"fa fa-times fa-5x\"></i>\n                <p>İptal Et</p>\n              </div>\n            </button>\n            <button data-toggle=\"modal\" (click)=\"onProductChange = true\" [disabled]=\"check.products.length == 0 || selectedProduct == undefined || selectedProduct.status !== 2 || !permissions.moveProduct\" data-target=\"#splitTable\" class=\"btn btn-info btn-block sendButton\">\n              <div>\n                <i class=\"fa fa-exchange fa-5x\"></i>\n                <p>Ürün Taşı</p>\n              </div>\n            </button>\n            <button data-toggle=\"modal\" data-target=\"#printersModal\" oneShot [disabled]=\"check.products.length == 0 || check.status == 0\" class=\"btn dark-bg btn-block sendButton\">\n              <div>\n                <i style=\"color:lightgray !important;\" class=\"fa fa-print fa-5x\"></i>\n                <p style=\"color:lightgray !important;\">Yazdır</p>\n              </div>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"noteModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Not Ekle ( {{selectedProduct?.name}} )\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #noteForm=\"ngForm\" (ngSubmit)=\"addNote(noteForm)\">\n        <div class=\"modal-body\">\n          <ng-container *ngIf=\"selectedProduct\">\n            <div *ngIf=\"selectedProduct.extras.length > 0\" class=\"row mb-3\">\n              <div class=\"col-lg-3\">\n                <h1>{{selectedProduct.price | price}}</h1>\n              </div>\n              <div class=\"col-lg-5\">\n                <ul class=\"mb-3\">\n                  <li *ngFor=\"let extra of selectedProduct.extras\">{{extra.extra_name}}  <span class=\"pull-right\">+ {{extra.extra_price | price}}</span></li>\n                </ul>\n              </div>\n              <div class=\"col-lg-2\">\n\n              </div>\n              <div class=\"col-lg-2 pl-2\">\n                <button type=\"button\" style=\"min-height: 100%;\" data-dismiss=\"modal\" class=\"btn btn-block btn-lg sendButton bg-default\">\n                  Tamam\n                </button>\n              </div>\n            </div>\n          </ng-container>\n          <div class=\"form-group\">\n            <div class=\"input-group\">\n              <input #noteInput type=\"text\" placeholder=\"Notunuz...\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n              <span class=\"input-group-btn\">\n                <button type=\"submit\" class=\"btn btn-primary btn-lg\">Not Ekle</button>\n              </span>\n            </div>\n          </div>\n          <div *ngIf=\"productExtras?.length > 0 && selectedProduct\" class=\"row pr-0 pl-0 mb-3\">\n            <div *ngFor=\"let extra of productExtras\" class=\"col-lg-4 mb-2\">\n              <div class=\"btn-group btn-block\" (click)=\"addExtras(extra)\" role=\"group\" aria-label=\"Basic example\">\n                <button style=\"min-width: 80%;\" type=\"button\" class=\"btn btn-success\">{{extra.extra_name}} <br> <small> + {{extra.extra_price | price }}</small></button>\n                <button type=\"button\" class=\"btn bg-success text-center color-white btn-lg btn-block p-2\" >\n                   <i *ngIf=\"isAlreadyAdded(extra)\" class=\"fa fa-check\" aria-hidden=\"true\"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n          <div *ngIf=\"readyNotes?.length > 0 && readyNotes[0]?.length > 0\" class=\"row pr-0 pl-0\">\n            <div *ngFor=\"let note of readyNotes\" class=\"col-lg-4 mb-2\">\n              <button type=\"button\" class=\"btn bg-teal btn-lg btn-block\" (click)=\"addReadyNotes(note)\">\n                {{note}}\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"button\" (click)=\"dontGive()\" class=\"btn btn-warning btn-lg\">Verme</button>\n          <button *ngIf=\"permissions.giveFree\" type=\"button\" (click)=\"makeGift()\" class=\"btn btn-danger btn-lg\">İkram</button>\n          <button *ngIf=\"permissions.discount\" type=\"button\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#productPricer\" (click)=\"numpad = selectedProduct?.price.toString(); isFirstTime = true;\" class=\"btn btn-info btn-lg\">Fiyat Düzenle</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"specsModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-xl\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">{{selectedProduct?.name}}\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div *ngIf=\"productSpecs?.length > 0\" class=\"modal-body\">\n        <div class=\"row\">\n          <div *ngFor=\"let spec of productSpecs\" class=\"col pr-2 pl-2 mb-2\">\n            <button class=\"btn btn-warning btn-lg btn-block btn-specs\" (click)=\"changeSpecs(spec)\">\n              {{spec.spec_name}}\n              <b class=\"spec-price\">{{spec.spec_price | price }} </b>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"printersModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Yazıcı Seç\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div *ngIf=\"printers?.length > 0\" class=\"modal-body\">\n        <div class=\"row\">\n          <ng-container *ngFor=\"let printer of printers\">\n            <div *ngIf=\"printer.mission == 'Adisyon'\" class=\"col pr-2 pl-2 mb-2\">\n              <button class=\"btn btn-warning btn-lg btn-block btn-specs\" (click)=\"printCheck(printer)\">{{printer.name}}</button>\n            </div>\n          </ng-container>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"qrPrintersModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Yazıcı Seç\n        </h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div *ngIf=\"printers?.length > 0\" class=\"modal-body\">\n        <div class=\"row\">\n          <ng-container *ngFor=\"let printer of printers\">\n            <div *ngIf=\"printer.mission == 'Adisyon'\" class=\"col pr-2 pl-2 mb-2\">\n              <button class=\"btn btn-warning btn-lg btn-block btn-specs\" (click)=\"qrCode(printer)\">{{printer.name}}</button>\n            </div>\n          </ng-container>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"checkNote\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Hesaba Not Ekle</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form #checkNoteForm=\"ngForm\" (ngSubmit)=\"addCheckNote(checkNoteForm)\">\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <input type=\"text\" placeholder=\"Notunuz...\" name=\"description\" class=\"form-control form-control-lg\" ngModel>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n          <button type=\"submit\" class=\"btn btn-danger btn-lg\">Not Ekle</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"cancelProduct\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">İptal Nedeni</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div *ngFor=\"let reason of cancelReasons\" class=\"col pl-2 pr-2\">\n            <button type=\"button\" class=\"btn btn-lg btn-danger btn-block sellButton text-white\" (click)=\"cancelProduct(reason)\">{{reason}}</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"splitTable\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-big\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Masalar</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col-lg-10 tFlow pl-1 pr-1\">\n            <div class=\"row pr-3 pl-3\">\n              <div *ngFor=\"let item of tablesView\" class=\"col-lg-2 pl-1 pr-1 mb-2\">\n                <div [ngClass]=\"{'bg-success': item.status == 2 ,'bg-danger': item.status == 3, 'bg-warning text-dark' : item.status == 1 && item._id !== selectedTable?._id , 'bg-info': item._id == selectedTable?._id}\" (click)=\"selectTable(item)\" class=\"card tableCard\">\n                  <div class=\"card-body p-3\">\n                    <h4 class=\"card-title\" style=\"white-space: nowrap;overflow: hidden;text-overflow: ellipsis;\">{{item.name}}</h4>\n                    <p class=\"card-text\">\n                      <i class=\"fa fa-user\" aria-hidden=\"true\"></i> {{item.capacity}}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-lg-2 pl-2 pr-2 tFlow\">\n            <div (click)=\"tablesView = tables; selectedFloor = undefined\" [ngClass]=\"{'bg-danger text-white':selectedFloor == undefined}\" class=\"card mb-2 dark-bg\">\n              <div class=\"card-body p-2 pt-3\">\n                <h2 style=\"font-size:1.7vw; font-weight:bold;\">Tüm Masalar</h2>\n              </div>\n            </div>\n            <div *ngFor=\"let floor of floors\" [ngClass]=\"{'bg-danger text-white':selectedFloor == floor._id}\" (click)=\"filterTables(floor._id)\" class=\"card mb-2 dark-bg\">\n              <div class=\"card-body p-2 pt-3\">\n                <h2 style=\"font-size:1.7vw; font-weight:bold;\">{{floor.name}}</h2>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button *ngIf=\"onProductChange\" oneShot type=\"button\" class=\"btn btn-danger btn-lg\" (click)=\"splitProduct()\" [disabled]=\"selectedTable == undefined\">Ürün\n          Taşı\n        </button>\n        <button *ngIf=\"!onProductChange\" oneShot type=\"button\" class=\"btn btn-danger btn-lg\" (click)=\"splitTable()\" [disabled]=\"selectedTable == undefined\">Masa\n          Değiştir\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"productSpecs\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">{{productWithSpecs?.name}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card\">\n          <!-- <div class=\"card-header\">Miktar</div> -->\n          <div class=\"card-body p-0\" class=\"tareClass\">\n            <div class=\"input-group\">\n              <input #specsInput mask=\"separator.2\" thousandSeparator=\".\" type=\"text\" readonly class=\"form-control form-control-lg\" [ngModel]=\"numpad\" />\n              <div class=\"input-group-append normal\">\n                <div #specsUnit class=\"input-group-text\">{{productStock?.stock_id | general:'stocks':'unit' | async}}</div>\n              </div>\n              <div class=\"input-group-append normal\">\n                <button type=\"button\" (click)=\"tareScaler()\" class=\"btn btn-lg btn-danger btn-block\">Dara</button>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer\">\n            <div *ngFor=\"let keys of numboard;\" class=\"row mb-1\">\n              <div *ngFor=\"let key of keys;\" class=\"col-lg-4 pr-1 pl-1 mb-1\">\n                <button type=\"button\" [disabled]=\"key == '◂' && numpad == '' || key == '.' && numpad == '' || key == '0' && numpad == '' || key == '.' && isFirstTime || key == '.' && specsUnit.innerHTML == 'Adet'\" (click)=\"pushKey(key)\" class=\"btn dark-bg btn-outline-primary font-weight-bold btn-lg p-3 btn-block numpad\">{{key}}</button>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <h2 class=\"mb-0\">Tutar:\n                <span class=\"pull-right\">{{(numpad*productWithSpecs?.price) / productStock?.amount | price }}\n                </span>\n              </h2>\n            </b>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button type=\"button\" (click)=\"numpadToCheck()\" [disabled]=\"((numpad*productWithSpecs?.price) / productStock?.amount) == 0\" class=\"btn btn-primary btn-lg\">\n          <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Onayla</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"productPricer\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">{{selectedProduct?.name}}</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body p-0\">\n        <div class=\"card\">\n          <!-- <div class=\"card-header\">Miktar</div> -->\n          <div class=\"card-body p-0\" class=\"tareClass\">\n            <div class=\"input-group\">\n              <!-- mask=\"separator.2\" thousandSeparator=\".\" -->\n              <input #specsInput type=\"text\" readonly class=\"form-control form-control-lg\" [ngModel]=\"numpad\" />\n              <div class=\"input-group-append normal\">\n                <div #specsUnit class=\"input-group-text\">TL</div>\n              </div>\n              <div class=\"input-group-append normal\">\n                <button type=\"button\" (click)=\"numpad = ''\" class=\"btn btn-lg btn-danger btn-block\">Temizle</button>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer\">\n            <div *ngFor=\"let keys of numboard;\" class=\"row mb-1\">\n              <div *ngFor=\"let key of keys;\" class=\"col-lg-4 pr-1 pl-1 mb-1\">\n                <button type=\"button\" [disabled]=\"key == '◂' && numpad == '' || key == '.' && numpad == '' || key == '0' && numpad == '' || key == '.' && isFirstTime || key == '.' && specsUnit.innerHTML == 'Adet'\" (click)=\"pushKeyForPrice(key)\" class=\"btn dark-bg btn-outline-primary font-weight-bold btn-lg p-3 btn-block numpad\">{{key}}</button>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-footer\">\n            <b>\n              <h2 class=\"mb-0\">Tutar:\n                <span class=\"pull-right\">{{numpad | price }}\n                </span>\n              </h2>\n            </b>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n        <button type=\"button\" (click)=\"setProductPrice()\" data-dismiss=\"modal\" [disabled]=\"numpad == 0\" class=\"btn btn-primary btn-lg\">\n          <i class=\"fa fa-check\" aria-hidden=\"true\"></i> Onayla</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"closeCheck\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Hesabı Kapat</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div *ngFor=\"let method of paymentMethods\" class=\"col pr-2 pl-2\">\n            <button oneShot [ngStyle]=\"{'color': method.color, 'border': '1px solid', 'border-color': method.color}\" (click)=\"closeCheck(method.name)\" class=\"btn btn-secondary btn-block btn-lg sellButton\">\n              <i class=\"fa {{method.icon}}\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>{{method.name}}</b>\n              </p>\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">İptal</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal\" id=\"checkOptions\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Hesap İşlemleri</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col pr-2 pl-2\">\n            <button data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#checkNote\" class=\"btn btn-secondary text-warning border-warning btn-block btn-lg sellButton\">\n              <i class=\"fa fa-sticky-note\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>Hesaba Nok Ekle</b>\n              </p>\n            </button>\n          </div>\n          <div class=\"col pr-2 pl-2\">\n            <button [disabled]=\"!permissions.discount\" data-toggle=\"modal\" data-dismiss=\"modal\" data-target=\"#checkDiscount\" class=\"btn btn-secondary text-danger border-danger btn-block btn-lg sellButton\">\n              <i class=\"fa fa-arrow-down\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>İndirim Yap</b>\n              </p>\n            </button>\n          </div>\n          <div class=\"col pr-2 pl-2\">\n            <button data-toggle=\"modal\" [disabled]=\"ownerRole !== 'Yönetici'\" data-dismiss=\"modal\" data-target=\"#userChangeModal\" class=\"btn btn-secondary text-info border-info btn-block btn-lg sellButton\">\n              <i class=\"fa fa-user\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>Kullanıcı Değiştir</b>\n              </p>\n            </button>\n          </div>\n          <div *ngIf=\"table?.status == 3\" class=\"col pr-2 pl-2\">\n            <button (click)=\"continueCheck()\" [disabled]=\"ownerRole !== 'Yönetici'\" data-dismiss=\"modal\" class=\"btn btn-secondary text-primary border-primary btn-block btn-lg sellButton\">\n              <i class=\"fa fa-times\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>Vazgeç</b>\n              </p>\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">İptal</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div class=\"modal\" id=\"paymentOptions\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\" id=\"modelTitleId\">Ödeme İşlemleri</h4>\n        <button type=\"button\" (click)=\"selectedPayment = undefined;\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col pr-2 pl-2\">\n            <h3 class=\"text-center mb-3\"> {{selectedPayment?.amount | price }} Tutarındaki {{selectedPayment?.method}} Ödeme</h3>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col pr-2 pl-2\">\n            <button data-toggle=\"modal\" [disabled]=\"!permissions.undoPayment\" data-dismiss=\"modal\" (click)=\"undoPayment(selectedPayment)\" class=\"btn btn-secondary text-danger border-danger btn-block btn-lg sellButton\">\n              <i class=\"fa fa-undo\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>Ödemeyi Geri Al</b>\n              </p>\n            </button>\n          </div>\n          <!-- <div class=\"col pr-2 pl-2\">\n            <button [disabled]=\"!permissions.cancelCheck\" data-toggle=\"modal\" data-dismiss=\"modal\"  data-target=\"#checkDiscount\" class=\"btn btn-secondary text-info border-info btn-block btn-lg sellButton\">\n              <i class=\"fa fa-pencil-square-o\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>Metod Değiştir</b>\n              </p>\n            </button>\n          </div> -->\n          <!-- <div class=\"col pr-2 pl-2\">\n            <button data-toggle=\"modal\" [disabled]=\"!check._id\" data-dismiss=\"modal\" (click)=\"qrCode()\" class=\"btn btn-secondary text-info border-info btn-block btn-lg sellButton\">\n              <i class=\"fa fa-qrcode\"></i>\n              <p class=\"mt-1 mb-1\">\n                <b>QR qrCode</b>\n              </p>\n            </button>\n          </div> -->\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\" (click)=\"selectedPayment = undefined;\">İptal</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal show\" id=\"occupationModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"false\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Kişi Şayısı</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col-lg-12\">\n            <div class=\"input-group input-group-lg\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text humanIcon\"><i class=\"fa fa-male\" aria-hidden=\"true\"></i></div>\n              </div>\n              <input type=\"number\" readonly value=\"{{check.occupation.male}}\" class=\"form-control form-contol-lg\" style=\"font-weight: bolder; font-size: 20px;\">\n              <div *ngFor=\"let item of [1,2,3,4,5,6,7,8]\" class=\"input-group-append normal\">\n                <button (click)=\"check.occupation.male = item\" class=\"btn btn-outline-success\" [ngClass]=\"{'active': check.occupation.male == item}\">{{item}}</button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mt-4\">\n          <div class=\"col-lg-12\">\n            <div class=\"input-group input-group-lg\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text humanIcon\"><i class=\"fa fa-female\" aria-hidden=\"true\"></i></div>\n              </div>\n              <input type=\"number\" readonly value=\"{{check.occupation.female}}\" class=\"form-control form-contol-lg\" style=\"font-weight: bolder; font-size: 20px;\">\n              <div *ngFor=\"let item of [1,2,3,4,5,6,7,8]\" class=\"input-group-append normal\">\n                <button (click)=\"check.occupation.female = item\" class=\"btn btn-outline-success\" [ngClass]=\"{'active': check.occupation.female == item}\">{{item}}</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class=\"modal fade\" id=\"checkDiscount\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-md\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">İndirim Yap</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col\">\n            <div class=\"input-group\">\n              <input #discountInput type=\"number\" min=\"0\" placeholder=\"İndirim Tutarı Giriniz\" class=\"form-control form-control-lg\">\n              <div class=\"input-group-append normal\">\n                <div class=\"input-group-text\"><i class=\"fa fa-turkish-lira fa-2x\" aria-hidden=\"true\"></i></div>\n              </div>\n              <span class=\"input-group-append\">\n                <button class=\"btn btn-primary btn-lg\" [disabled]=\"discountInput.value >= checkTotal() || discountInput.value <= 0\" (click)=\"setDiscount((discountInput.value*100)/checkTotal())\" type=\"button\">\n                  <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> İndirim Yap\n                </button>\n              </span>\n            </div>\n            <!-- <div class=\"input-group\">\n              <input #discountInput type=\"number\" placeholder=\"0\" class=\"form-control text-center form-control-lg\">\n              <div class=\"input-group-append normal\">\n                <div class=\"input-group-text\"><i class=\"fa fa-percent fa-2x\" aria-hidden=\"true\"></i></div>\n              </div>\n              <span class=\"input-group-append\">\n                <button class=\"btn btn-primary btn-lg\" [disabled]=\"discountInput.value >= checkTotal() || discountInput.value <= 0\" (click)=\"setDiscount((discountInput.value*100)/checkTotal())\" type=\"button\">\n                  <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> İndirim Yap\n                </button>\n              </span>\n            </div> -->\n          </div>\n        </div>\n        <div class=\"row mt-4 pr-2 pl-2\">\n          <div *ngFor=\"let item of discounts;\" class=\"col-lg-4 mb-2 pr-1 pl-1\">\n            <button type=\"button\" (click)=\"setDiscount(item)\" class=\"btn btn-primary btn-block btn-lg btn-discount\">{{item}}\n              %</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button *ngIf=\"check.discountPercent\" type=\"button\" class=\"btn btn-danger btn-lg\" data-dismiss=\"modal\" (click)=\"setDiscount(undefined)\">İndirimi\n          İptal Et</button>\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n\n\n<div class=\"modal fade\" id=\"userChangeModal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\n  <div class=\"modal-dialog modal-lg\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">Kullanıcı Değiştir</h4>\n        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <div class=\"row\">\n          <div class=\"col\">\n          </div>\n        </div>\n        <div class=\"row pr-2 pl-2\">\n          <div *ngFor=\"let user of users;\" class=\"col-lg-4 mb-2 pr-1 pl-1\">\n            <button type=\"button\" (click)=\"changeUser(user)\" class=\"btn btn-primary btn-block btn-lg btn-discount\" style=\"font-size: medium !important;\">{{user.name}}</button>\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-secondary btn-lg\" data-dismiss=\"modal\">Kapat</button>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/store/selling-screen/selling-screen.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".sellButton {\n  font-family: Quickly;\n  margin-bottom: 3.8px;\n  margin-top: 0px;\n  padding-top: 10.5px;\n  padding-bottom: 10.5px;\n  padding-right: 0px;\n  padding-left: 0px;\n  color: #000;\n  -webkit-text-decoration: wavy;\n          text-decoration: wavy; }\n  .sellButton i {\n    font-size: 7.4vh; }\n\n.sellButton[disabled] {\n  opacity: 0.6;\n  color: rgba(0, 0, 0, 0.5); }\n\n.sendButton {\n  font-family: Quickly;\n  margin-bottom: 3.8px;\n  margin-top: 0px;\n  padding-top: 10.5px;\n  padding-bottom: 10.5px;\n  padding-right: 0px;\n  padding-left: 0px;\n  color: #000;\n  -webkit-text-decoration: wavy;\n          text-decoration: wavy; }\n  .sendButton i {\n    font-size: 7.4vh; }\n\n.sendButton[disabled] {\n  opacity: 0.6;\n  color: rgba(0, 0, 0, 0.5); }\n\n.sendButton p {\n  font-size: smaller;\n  margin: 0px !important; }\n\n.btn-specs {\n  padding: 25px;\n  float: left;\n  font-weight: bolder;\n  font-size: 30px;\n  text-transform: capitalize; }\n  .btn-specs .spec-price {\n    font-size: 20px;\n    color: #8a5f25;\n    margin-left: 5px; }\n\n.payment-flow {\n  height: 35vh;\n  overflow: hidden;\n  overflow-y: scroll;\n  overflow-x: hidden; }\n  .payment-flow p {\n    font-weight: bolder; }\n\n.tareClass .input-group {\n  height: 75px; }\n\n.tareClass input {\n  height: 100%;\n  font-size: 30px;\n  font-weight: bolder; }\n\n#productHolder {\n  overflow-y: scroll; }\n\n.normal {\n  width: auto !important; }\n\n.tFlow {\n  height: 60vh;\n  overflow-y: scroll;\n  overflow-x: hidden; }\n\n.modal-big {\n  max-width: 1300px; }\n\n.payedLayer {\n  border-top: 1px solid white; }\n\n.payedLayer:hover {\n  background-color: rgba(0, 0, 0, 0.8); }\n\n.payed-things {\n  min-height: 200px; }\n\n.numpad {\n  font-size: 30px;\n  font-weight: bolder; }\n\n.proCard p.card-text {\n  width: 95%; }\n  .proCard p.card-text .price {\n    float: left;\n    width: 37%; }\n  .proCard p.card-text .category {\n    position: relative;\n    left: 10px;\n    font-size: 8px;\n    text-align: right;\n    font-weight: bold; }\n\n.catButton {\n  padding-top: 3px !important;\n  font-weight: bold;\n  white-space: pre-line;\n  font-size: 1.3vw;\n  height: 47.65px;\n  text-align: start; }\n\n.humanIcon {\n  font-size: 20px !important;\n  padding: 0 2 0 2 !important; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/store/selling-screen/selling-screen.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SellingScreenComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_order__ = __webpack_require__("./src/app/mocks/order.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mocks_product__ = __webpack_require__("./src/app/mocks/product.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mocks_settings__ = __webpack_require__("./src/app/mocks/settings.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mocks_table__ = __webpack_require__("./src/app/mocks/table.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__providers_printer_service__ = __webpack_require__("./src/app/providers/printer.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__services_log_service__ = __webpack_require__("./src/app/services/log.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__providers_scaler_service__ = __webpack_require__("./src/app/providers/scaler.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};














let SellingScreenComponent = class SellingScreenComponent {
    constructor(mainService, printerService, route, router, electron, message, settingsService, scalerService, logService, zone) {
        this.mainService = mainService;
        this.printerService = printerService;
        this.route = route;
        this.router = router;
        this.electron = electron;
        this.message = message;
        this.settingsService = settingsService;
        this.scalerService = scalerService;
        this.logService = logService;
        this.zone = zone;
        this.newOrders = [];
        this.countData = [];
        this.payedShow = false;
        this.payedTitle = 'Alınan Ödemeleri Görüntüle';
        this.onProductChange = false;
        this.readyNotes = [];
        this.isCollapsedView = false;
        this.owner = this.settingsService.getUser('name');
        this.ownerRole = this.settingsService.getUser('type');
        this.ownerId = this.settingsService.getUser('id');
        this.discounts = [5, 10, 15, 20, 25, 40];
        this.selectedQuantity = 1;
        this.paymentMethods = [
            new __WEBPACK_IMPORTED_MODULE_5__mocks_settings__["b" /* PaymentMethod */]('Nakit', 'Nakit Ödeme', '#5cb85c', 'fa-money', 1, 1),
            new __WEBPACK_IMPORTED_MODULE_5__mocks_settings__["b" /* PaymentMethod */]('Kart', 'Kredi veya Banka Kartı', '#f0ad4e', 'fa-credit-card', 2, 1),
            new __WEBPACK_IMPORTED_MODULE_5__mocks_settings__["b" /* PaymentMethod */]('Kupon', 'İndirim Kuponu veya Yemek Çeki', '#5bc0de', 'fa-bookmark', 3, 1),
            new __WEBPACK_IMPORTED_MODULE_5__mocks_settings__["b" /* PaymentMethod */]('İkram', 'İkram Hesap', '#c9302c', 'fa-handshake-o', 4, 1)
        ];
        this.cancelReasons = [
            'Zayi',
            'Stokta Yok',
            'Yanlış Sipariş',
            'Müşteri İstemedi',
        ];
        this.numboard = [[1, 2, 3], [4, 5, 6], [7, 8, 9], [".", 0, "◂"]];
        this.route.params.subscribe(params => {
            this.id = params['id'];
            this.type = params['type'];
            switch (this.type) {
                case 'Normal':
                    this.check = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["a" /* Check */](this.id, 0, 0, this.owner, '', __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL, Object(__WEBPACK_IMPORTED_MODULE_3__mocks_check__["b" /* CheckNo */])());
                    this.check.freeAmount = 0;
                    this.getCheck({ table_id: this.id }).finally(() => {
                        if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                            $('#occupationModal').modal({ backdrop: 'static', keyboard: false });
                        }
                    });
                    break;
                case 'Fast':
                    if (this.id == 'New') {
                        this.check = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["a" /* Check */]('Hızlı Satış', 0, 0, this.owner, '', __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_3__mocks_check__["b" /* CheckNo */])());
                        this.check.freeAmount = 0;
                    }
                    else {
                        this.check = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["a" /* Check */]('Hızlı Satış', 0, 0, this.owner, '', __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST, Object(__WEBPACK_IMPORTED_MODULE_3__mocks_check__["b" /* CheckNo */])());
                        this.check.freeAmount = 0;
                        this.getCheck({ _id: this.id }).finally(() => {
                            if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                                $('#occupationModal').modal({ backdrop: 'static', keyboard: false });
                            }
                        });
                    }
                    break;
                case 'Order':
                    this.check = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["a" /* Check */]('Paket Servis', 0, 0, this.owner, '', __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE, [], Date.now(), __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER, Object(__WEBPACK_IMPORTED_MODULE_3__mocks_check__["b" /* CheckNo */])());
                    this.getCheck({ _id: this.id }).finally(() => {
                        if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                            $('#occupationModal').modal({ backdrop: 'static', keyboard: false });
                        }
                    });
                    break;
                default:
                    break;
            }
        });
        this.settingsService.DateSettings.subscribe(res => {
            this.day = res.value.day;
        });
        this.settingsService.AppSettings.subscribe(res => {
            let takeaway = res.value.takeaway;
            if (takeaway == 'Kapalı') {
                this.takeaway = false;
            }
            else {
                this.takeaway = true;
            }
        });
        this.permissions = JSON.parse(localStorage['userPermissions']);
        this.settingsService.getPrinters().subscribe(res => this.printers = res.value);
        if (localStorage.getItem('selectedFloor')) {
            this.selectedFloor = JSON.parse(localStorage['selectedFloor']);
        }
        this.tareNumber = 0;
    }
    ngOnInit() {
        this.fillData();
        this.changes = this.mainService.LocalDB['checks'].changes({ since: 'now', live: true }).on('change', (change) => {
            if (change.id == this.check_id) {
                if (!change.deleted) {
                    this.mainService.getData('checks', change.id).then(res => {
                        this.check = res;
                        this.id = res.table_id;
                        if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PROCESSING) {
                            this.router.navigate(['/store']);
                        }
                        setTimeout(() => {
                            $('#check-products').scrollTop(999999);
                        }, 200);
                    });
                }
                else {
                    this.router.navigate(['/store']);
                }
            }
        });
        // setTimeout(() => {
        //   if (this.check.status == CheckStatus.PASSIVE) {
        //     $('#occupationModal').modal({backdrop:'static',keyboard:false});
        //   }
        // }, 500)
        this.zone.run(() => {
            let unsub = () => this.scalerListener.unsubscribe();
            $('#productSpecs').on('hide.bs.modal', function (event) {
                unsub();
            });
            let setdefquntity = () => this.selectedQuantity = 1;
            $('#specsModal').on('hide.bs.modal', function (event) {
                setdefquntity();
            });
        });
    }
    ngOnDestroy() {
        this.changes.cancel();
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER && this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
            if (this.check.products.length == 0 && !this.check.hasOwnProperty('payment_flow')) {
                this.mainService.removeData('checks', this.check._id);
            }
        }
    }
    changeUser(user) {
        this.owner = user.name;
        this.ownerId = user._id;
        this.check.owner = this.owner;
        $('#userChangeModal').modal('hide');
    }
    undoPayment(payment) {
        this.selectedPayment = undefined;
        let indexOf = this.check.payment_flow.findIndex(obj => obj.amount == payment.amount && obj.method == payment.method && obj.discount == payment.discount && obj.timestamp == payment.timestamp && obj.payed_products.length == payment.payed_products.length);
        this.check.payment_flow.splice(indexOf, 1);
        this.check.products = this.check.products.concat(payment.payed_products);
        this.check.products.sort((a, b) => a.timestamp - b.timestamp);
        if (this.check.payment_flow.length == 0) {
            this.check.payment_flow = undefined;
        }
        ;
        this.check.total_price = this.checkTotal() + (payment.amount + payment.discount);
        this.check.discount -= payment.amount;
        this.mainService.updateData('checks', this.check_id, this.check).then(isOK => {
            console.log(isOK);
        }).catch(err => {
            console.log(err);
        });
    }
    goPayment() {
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST) {
            if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                this.updateUserReport();
                this.updateProductReport(this.countData);
                this.check.products.map(obj => obj.status = 2);
                this.check.status = __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].OCCUPIED;
                this.mainService.addData('checks', this.check).then(res => {
                    if (res.ok) {
                        this.router.navigate(['/payment', res.id]);
                    }
                });
            }
            else {
                // this.check.status = CheckStatus.PROCESSING;
                // this.mainService.updateData('checks',this.check_id,this.check).then(isOk => {
                //   this.router.navigate(['/payment', this.check_id]);
                // }).catch(err => {
                //   this.message.sendMessage('Adisyonda Şuan İşlem Yapılmaktadır!')
                // })
                this.router.navigate(['/payment', this.check_id]);
            }
        }
        else {
            // this.check.status = CheckStatus.PROCESSING;
            // this.mainService.updateData('checks',this.check_id,this.check).then(isOk => {
            //   this.router.navigate(['/payment', this.check_id]);
            // }).catch(err => {
            //   this.message.sendMessage('Adisyonda Şuan İşlem Yapılmaktadır!')
            // })
            this.router.navigate(['/payment', this.check_id]);
        }
    }
    getCheck(filter) {
        if (this.type !== 'Order') {
            return this.mainService.getAllBy('checks', filter).then((result) => {
                if (result.docs.length > 0) {
                    this.check = result.docs[0];
                    this.check_id = result.docs[0]._id;
                    this.getCheckDetails();
                }
            });
        }
        else {
            return this.mainService.getAllBy('checks', filter).then((result) => {
                if (result.docs.length > 0) {
                    this.check = result.docs[0];
                    this.check_id = result.docs[0]._id;
                    this.getCheckDetails();
                }
            }).catch(err => {
                console.log('Checks', err);
            });
            // setTimeout(() => {
            //   if (this.check.status == CheckStatus.PASSIVE) {
            //     $('#occupationModal').modal({backdrop:'static',keyboard:false});
            //   }
            // }, 500)
            // this.mainService.getAllBy('closed_checks', filter).then((result) => {
            //   if (result.docs.length > 0) {
            //     this.check = result.docs[0];
            //     this.check_id = result.docs[0]._id;
            //     this.check.occupation = { male: 0, female: 0 };
            //   }
            // }).catch(err => {
            //   console.log('Closed Checks', err);
            // });
        }
    }
    tareScaler() {
        this.tareNumber = this.numpad;
    }
    addToCheck(product) {
        // this.selectedIndex = undefined;
        // this.selectedProduct = undefined;
        if (product.type == __WEBPACK_IMPORTED_MODULE_4__mocks_product__["g" /* ProductType */].MANUEL) {
            this.isFirstTime = true;
            this.productWithSpecs = product;
            this.mainService.getAllBy('recipes', { product_id: product._id }).then(res => {
                this.productStock = res.docs[0].recipe[0];
                this.numpad = this.productStock.amount;
                this.scalerListener = this.scalerService.listenScalerEvent().subscribe((weight) => {
                    if (weight && weight !== 0) {
                        this.numpad = weight * this.productStock.amount;
                        if (this.tareNumber !== 0) {
                            this.numpad = this.numpad - this.tareNumber;
                        }
                    }
                });
            });
            $('#productSpecs').modal('show');
        }
        else {
            this.productFilterInput.nativeElement.value = '';
            let newProduct = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["c" /* CheckProduct */](product._id, product.cat_id, product.name, product.price, '', 1, this.ownerId, Date.now(), product.tax_value, product.barcode, []);
            if (![0.5, 1.5].includes(this.selectedQuantity)) {
                for (let index = 0; index < this.selectedQuantity; index++) {
                    this.countProductsData(product._id, product.price);
                    this.check.total_price = this.checkTotal() + product.price;
                    this.check.products.push(newProduct);
                    this.newOrders.push(newProduct);
                }
            }
            else {
                this.countProductsData(product._id, (product.price * this.selectedQuantity), this.selectedQuantity);
                this.check.total_price = this.checkTotal() + (product.price * this.selectedQuantity);
                newProduct.price = (product.price * this.selectedQuantity);
                newProduct.name = newProduct.name + ' ' + this.selectedQuantity + ' Porsiyon';
                this.check.products.push(newProduct);
                this.newOrders.push(newProduct);
            }
            this.selectedIndex = this.check.products.length - 1;
            this.selectedProduct = this.check.products[this.selectedIndex];
            try {
                this.readyNotes = (product.notes.split(',') == [''] ? [] : product.notes.split(','));
            }
            catch (error) {
                this.readyNotes = [];
            }
            try {
                this.productExtras = product.extras;
            }
            catch (error) {
                this.productExtras = [];
            }
            if (product.specifies.length > 0) {
                // this.selectedIndex = this.check.products.length - 1;
                // this.selectedProduct = this.check.products[this.selectedIndex];
                this.getSpecies(newProduct);
                $('#specsModal').modal({ backdrop: 'static', keyboard: false });
            }
            else {
                this.selectedQuantity = 1;
            }
        }
        setTimeout(() => {
            $('#check-products').scrollTop(999999);
        }, 200);
        // this.selectedQuantity = 1;
    }
    isAlreadyAdded(extra) {
        return this.selectedProduct.extras.some(obj => obj.extra_name == extra.extra_name);
    }
    continueCheck() {
        if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                this.mainService.updateData('tables', this.id, { status: 2 });
            }
        }
    }
    checkTotal() {
        return this.check.products.filter(obj => obj.status !== 3).map(obj => obj.price).reduce((a, b) => a + b, 0);
    }
    numpadToCheck() {
        let newAmount = (this.numpad * this.productWithSpecs.price) / this.productStock.amount;
        let newNote = `${this.numpad} ${this.productUnit.nativeElement.innerHTML}`;
        const newProduct = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["c" /* CheckProduct */](this.productWithSpecs._id, this.productWithSpecs.cat_id, this.productWithSpecs.name, newAmount, newNote, 1, this.owner, Date.now(), this.productWithSpecs.tax_value, this.productWithSpecs.barcode);
        this.check.total_price = this.checkTotal() + newProduct.price;
        let countFor = newAmount / this.productWithSpecs.price;
        if (this.productUnit.nativeElement.innerHTML === 'Adet') {
            for (let index = 0; index < countFor; index++) {
                let repeatingProducts = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["c" /* CheckProduct */](this.productWithSpecs._id, this.productWithSpecs.cat_id, this.productWithSpecs.name, this.productWithSpecs.price, '', 1, this.owner, Date.now(), this.productWithSpecs.tax_value, this.productWithSpecs.barcode);
                this.check.products.push(repeatingProducts);
                this.newOrders.push(repeatingProducts);
            }
        }
        else {
            this.check.products.push(newProduct);
            this.newOrders.push(newProduct);
        }
        this.countProductsData(this.productWithSpecs._id, newAmount, countFor);
        this.tareNumber = 0;
        this.numpad = 0;
        $('#productSpecs').modal('hide');
    }
    pushKey(key) {
        if (key === "◂") {
            this.numpad = '';
        }
        else {
            if (this.isFirstTime) {
                this.numpad = '';
                this.isFirstTime = false;
            }
            this.numpad += key;
        }
    }
    pushKeyForPrice(key) {
        if (key === "◂") {
            this.numpad = '';
        }
        else {
            if (this.isFirstTime) {
                this.numpad = '';
                this.isFirstTime = false;
            }
            this.numpad += key;
        }
    }
    setProductPrice() {
        const oldPrice = this.selectedProduct.price;
        const newPrice = parseFloat(this.numpad);
        this.selectedProduct.price = newPrice;
        // this.check.total_price = this.checkTotal() - oldPrice;
        // this.check.total_price = this.checkTotal() + newPrice;
        this.check.total_price = this.checkTotal();
        if (this.selectedProduct.status == 2) {
            this.mainService.updateData('checks', this.check_id, this.check).then(isOK => {
            }).catch(err => {
                console.log(err);
            });
        }
    }
    addServiceCharge(percent) {
        let contains = this.check.products.find(pr => pr.id == 'servicecharge');
        if (contains == undefined) {
            const checkTotal = this.check.total_price;
            // const service = new CheckProduct('servicecharge','service','%' + percent + ' Servis Ücreti',(checkTotal * percent) / 100,'',2,this.ownerId,Date.now(),0,0)
            const product = new __WEBPACK_IMPORTED_MODULE_4__mocks_product__["c" /* Product */]('300131c9-f8c1-4a12-95d0-7de84f96f79d', 1, '', '%' + percent + ' Servis Ücreti', (checkTotal * percent) / 100, 1, 0, 0, '', null, [], [], '77a24b1c-5c5e-42c9-bfd1-2ade2ad2336e');
            this.addToCheck(product);
            // this.check.products.push(service);
            // this.check.total_price = this.checkTotal();
            // this.mainService.updateData('checks',this.check_id,this.check).then(isOK => {
            //   console.log()
            // }).catch(err => {
            //   console.log(err);
            // })
        }
    }
    confirmCheck() {
        this.router.navigate(['/store']);
        let timestamp = Date.now();
        this.check.products.map(element => {
            if (element.status === 1) {
                element.status = 2;
                element.timestamp = timestamp;
            }
        });
        if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                this.mainService.updateData('tables', this.id, { status: 2 });
            }
            this.mainService.updateData('checks', this.check_id, this.check).then(res => {
                if (res.updated) {
                    let newOrder = new __WEBPACK_IMPORTED_MODULE_2__mocks_order__["a" /* Order */](this.check._id, { id: this.ownerId, name: this.owner + ' ( Personel )' }, [], __WEBPACK_IMPORTED_MODULE_2__mocks_order__["b" /* OrderStatus */].APPROVED, __WEBPACK_IMPORTED_MODULE_2__mocks_order__["c" /* OrderType */].EMPLOOYEE, timestamp);
                    this.newOrders.forEach(order => {
                        let orderItem = {
                            name: order.name,
                            price: order.price,
                            note: '',
                            product_id: order.id
                        };
                        newOrder.items.push(orderItem);
                    });
                    this.mainService.addData('orders', newOrder).then(res => {
                        let pricesTotal = this.newOrders.map(obj => obj.price).reduce((a, b) => a + b);
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_UPDATED, this.check._id, `${this.table.name} hesabına ${pricesTotal} TL tutarında sipariş eklendi.`);
                        }
                        else {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_UPDATED, this.check._id, `${this.check.note} hesabına ${pricesTotal} TL tutarında sipariş eklendi.`);
                        }
                    }).catch(err => {
                        console.log(err);
                    });
                }
            });
        }
        else {
            this.check.status = __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].READY;
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                this.mainService.updateData('tables', this.id, { status: 2, timestamp: Date.now() });
            }
            this.mainService.addData('checks', this.check).then(res => {
                if (res.ok) {
                    let newOrder = new __WEBPACK_IMPORTED_MODULE_2__mocks_order__["a" /* Order */](res.id, { id: this.ownerId, name: this.owner + ' ( Personel )' }, [], __WEBPACK_IMPORTED_MODULE_2__mocks_order__["b" /* OrderStatus */].APPROVED, __WEBPACK_IMPORTED_MODULE_2__mocks_order__["c" /* OrderType */].EMPLOOYEE, timestamp);
                    this.newOrders.forEach(order => {
                        let orderItem = {
                            name: order.name,
                            price: order.price,
                            note: '',
                            product_id: order.id
                        };
                        newOrder.items.push(orderItem);
                    });
                    this.mainService.addData('orders', newOrder).then(res => {
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CREATED, res.id, `${this.table.name} Masasına '${this.owner}' tarafından hesap açıldı`);
                        }
                        else {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CREATED, res.id, `${this.check.note} Notlu Hızlı Hesap '${this.owner}' tarafından açıldı`);
                        }
                    }).catch(err => {
                        console.log(err);
                    });
                }
            });
        }
        this.updateUserReport();
        this.updateProductReport(this.countData);
    }
    sendCheck() {
        switch (this.check.type) {
            case __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL:
                if (this.askForPrint) {
                    this.message.sendConfirm('Fiş Yazdırılsın mı ?').then(isOk => {
                        if (isOk) {
                            this.printOrder();
                            this.confirmCheck();
                        }
                        else {
                            this.confirmCheck();
                        }
                    });
                }
                else {
                    this.printOrder();
                    this.confirmCheck();
                }
                break;
            case __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST:
                if (this.check.note == '' || this.check.note == undefined) {
                    this.message.sendConfirm('Hızlı Hesap oluşturmanız için hesaba not eklemek zorundasınız.').then(isOk => {
                        if (isOk) {
                            $('#checkNote').modal('show');
                            return false;
                        }
                        else {
                            return false;
                        }
                    });
                }
                else {
                    if (this.askForPrint) {
                        this.message.sendConfirm('Fiş Yazdırılsın mı ?').then(isOk => {
                            if (isOk) {
                                this.printOrder();
                                this.confirmCheck();
                            }
                            else {
                                this.confirmCheck();
                            }
                        });
                    }
                    else {
                        this.printOrder();
                        this.confirmCheck();
                    }
                }
                break;
            case __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER:
                this.check.products.map(element => {
                    if (element.status === 1) {
                        element.status = 2;
                    }
                });
                if (this.check.status == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                    this.check.status = __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].READY;
                    this.mainService.updateData('checks', this.check._id, this.check).then(res => {
                        if (res.updated) {
                            let pricesTotal = this.newOrders.map(obj => obj.price).reduce((a, b) => a + b);
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_UPDATED, this.check._id, `${this.check.note} hesabına ${pricesTotal} TL tutarında sipariş eklendi.`);
                        }
                    });
                }
                else {
                    this.mainService.updateData('closed_checks', this.check_id, this.check).then(res => {
                        if (res.updated) {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_UPDATED, this.check._id, `${this.check.note} hesabı ${this.owner} tarafından güncellendi.`);
                        }
                    });
                }
                this.router.navigate(['/store']);
                this.updateUserReport();
                this.updateProductReport(this.countData);
                break;
        }
    }
    endCheck() {
        this.message.sendConfirm('Dikkat! Hesap Kapatılacak.').then(isOK => {
            if (isOK) {
                let checkWillClose = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, (this.checkTotal() + this.check.discount) - 0, 0, this.check.owner, this.check.note, __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].OCCUPIED, this.check.products, this.check.timestamp, this.check.type, 'Parçalı', this.check.payment_flow, null, this.check.occupation);
                this.mainService.addData('closed_checks', checkWillClose).then(res => {
                    this.updateSellingReport('Parçalı');
                });
                if (this.check._id !== undefined) {
                    this.mainService.removeData('checks', this.check._id);
                    this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                    this.updateTableReport(this.check);
                }
                this.router.navigate(['/store']);
            }
        });
    }
    closeCheck(method) {
        if (method == 'İkram' && this.permissions.giveFree !== true) {
            this.message.sendMessage('İkram Yetkiniz Yok !');
            return false;
        }
        if (method == 'Nakit') {
            this.printerService.kickCashdraw(this.printers[0]);
        }
        let total_discounts = 0;
        let general_discount = 0;
        if (this.check.payment_flow) {
            let lastAmount = 0;
            let lastProducts = this.check.products.filter(obj => obj.status == 2);
            lastProducts.forEach(product => {
                lastAmount += product.price;
            });
            if (this.check.discountPercent) {
                general_discount = (this.checkTotal() * this.check.discountPercent) / 100;
            }
            let lastPayment = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["g" /* PaymentStatus */](this.owner, method, lastAmount - general_discount, general_discount, Date.now(), lastProducts);
            this.check.payment_flow.push(lastPayment);
            this.check.products = [];
            method = 'Parçalı';
            total_discounts = this.check.payment_flow.map(obj => obj.discount).reduce((a, b) => a + b);
        }
        else {
            if (this.check.discountPercent) {
                general_discount = (this.checkTotal() * this.check.discountPercent) / 100;
                total_discounts += general_discount;
            }
        }
        $('#closeCheck').modal('hide');
        let checkWillClose = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, (this.checkTotal() + this.check.discount) - general_discount, total_discounts, this.check.owner, this.check.note, __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].OCCUPIED, this.check.products, this.check.timestamp, this.check.type, method, this.check.payment_flow, null, this.check.occupation);
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER) {
            checkWillClose.products.map(obj => obj.status = 2);
            checkWillClose.status = 2;
        }
        this.mainService.addData('closed_checks', checkWillClose).then(res => {
            this.updateSellingReport(method);
        });
        if (this.check._id !== undefined) {
            this.mainService.removeData('checks', this.check._id);
        }
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL || this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER) {
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER) {
                this.updateProductReport(this.countData);
            }
            else {
                this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                this.updateTableReport(this.check);
            }
            this.router.navigate(['/store']);
        }
        else {
            this.updateUserReport();
            this.updateProductReport(this.countData);
            if (this.takeaway) {
                this.router.navigate(['']);
            }
            else {
                this.router.navigate(['/store']);
            }
        }
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST) {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CLOSED, this.ownerId, `${this.owner} tarafından ${this.check.table_id} Hesabı ${this.check.total_price} TL ${method} ödeme alınarak kapatıldı.`);
        }
        else if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CLOSED, this.check._id, `${this.owner} tarafından ${this.table.name} Masası ${this.check.total_price} TL '${method}' ödeme alınarak kapatıldı.`);
        }
        else {
            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CLOSED, this.check._id, `${this.owner} tarafından Paket Servis- ${this.check.note} hesabı ${this.check.total_price} TL '${method}' ödeme alınarak kapatıldı.`);
        }
        if (this.askForCheckPrint) {
            this.message.sendConfirm('Fiş Yazdırılsın mı ?').then(isOK => {
                if (isOK) {
                    if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                        this.printerService.printCheck(this.printers[0], this.table.name, checkWillClose);
                    }
                    else {
                        this.printerService.printCheck(this.printers[0], this.check.table_id, checkWillClose);
                    }
                }
            });
        }
        else {
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                this.printerService.printCheck(this.printers[0], this.table.name, checkWillClose);
            }
            else {
                this.printerService.printCheck(this.printers[0], this.check.table_id, checkWillClose);
            }
        }
        this.message.sendMessage(`Hesap ${this.check.total_price} TL tutarında ödeme alınarak kapatıldı`);
    }
    updateSellingReport(method) {
        let general_discount = 0;
        if (this.check.discountPercent) {
            general_discount = (this.checkTotal() * this.check.discountPercent) / 100;
        }
        if (method !== 'Parçalı') {
            this.mainService.getAllBy('reports', { connection_id: method }).then(res => {
                if (res.docs.length > 0) {
                    let doc = res.docs[0];
                    doc.count++;
                    doc.amount += (this.checkTotal() + this.check.discount) - general_discount;
                    doc.weekly[this.day] += (this.checkTotal() + this.check.discount) - general_discount;
                    doc.weekly_count[this.day]++;
                    doc.monthly[new Date().getMonth()] += (this.checkTotal() + this.check.discount) - general_discount;
                    doc.monthly_count[new Date().getMonth()]++;
                    doc.timestamp = Date.now();
                    this.mainService.updateData('reports', doc._id, doc);
                }
            });
        }
        else {
            this.mainService.getAllBy('reports', { type: "Store" }).then(res => {
                let sellingReports = res.docs;
                this.check.payment_flow.forEach((obj, index) => {
                    let reportWillChange = sellingReports.find(report => report.connection_id == obj.method);
                    reportWillChange.count++;
                    reportWillChange.amount += obj.amount;
                    reportWillChange.weekly[this.day] += obj.amount;
                    reportWillChange.weekly_count[this.day]++;
                    reportWillChange.monthly[new Date().getMonth()] += obj.amount;
                    reportWillChange.monthly_count[new Date().getMonth()]++;
                    reportWillChange.timestamp = Date.now();
                    if (this.check.payment_flow.length == index + 1) {
                        sellingReports.forEach((report) => {
                            if (this.check.payment_flow.some(obj => obj.method == report.connection_id)) {
                                this.mainService.updateData('reports', report._id, report);
                            }
                        });
                    }
                });
            });
        }
    }
    updateTableReport(check) {
        this.mainService.getAllBy('reports', { connection_id: check.table_id }).then(res => {
            let report = res.docs[0];
            report.count++;
            report.amount += this.checkTotal() + this.check.discount;
            report.timestamp = Date.now();
            report.weekly[this.day] += this.checkTotal() + this.check.discount;
            report.weekly_count[this.day]++;
            report.monthly[new Date().getMonth()] += this.checkTotal() + this.check.discount;
            report.monthly_count[new Date().getMonth()]++;
            this.mainService.updateData('reports', report._id, report);
        });
    }
    togglePayed() {
        if (this.payedShow) {
            this.payedShow = false;
            this.payedTitle = 'Alınan Ödemeleri Görüntüle';
        }
        else {
            this.payedShow = true;
            this.payedTitle = 'Alınan Ödemeleri Gizle';
        }
    }
    checkItems() {
        if (this.check.products.length > 0) {
            let viewArray = [];
            this.check.products.forEach(item => {
                if (viewArray.some(obj => obj.name == item.name && obj.id == item.id && obj.status == item.status && obj.note == item.note && obj.timeout == item.timeout)) {
                    viewArray[viewArray.findIndex(obj => obj.name == item.name && obj.id == item.id && obj.status == item.status && obj.note == item.note && obj.timeout == item.timeout)].quantity++;
                }
                else {
                    let viewItem = { id: item.id, name: item.name, note: item.note, quantity: 1, price: item.price, status: item.status };
                    if (item.timeout) {
                        viewItem.timeout = item.timeout;
                    }
                    viewArray.push(viewItem);
                }
            });
            return viewArray.sort((a, b) => {
                if (a.status > b.status) {
                    return -1;
                }
                else if (a.status < b.status) {
                    return 1;
                }
                else {
                    return b.quantity - a.quantity;
                }
            });
        }
        else {
            return [];
        }
    }
    toggleProduct() {
        if (this.isCollapsedView) {
            this.isCollapsedView = false;
        }
        else {
            this.isCollapsedView = true;
        }
    }
    selectProduct(index) {
        if (this.selectedIndex == index) {
            this.selectedIndex = undefined;
            this.selectedProduct = undefined;
        }
        else {
            this.selectedProduct = this.check.products[index];
            this.selectedIndex = index;
            this.selectedCat = 'OnSelect';
            this.productsView = this.products.filter(obj => obj._id == this.selectedProduct.id);
            try {
                this.readyNotes = this.products.find(obj => obj._id == this.selectedProduct.id).notes.split(',');
                this.productExtras = this.products.find(obj => obj._id == this.selectedProduct.id).extras;
            }
            catch (error) {
                this.readyNotes = [];
            }
        }
    }
    getSpecies(product) {
        this.productSpecs = this.products.find(obj => obj._id == product.id).specifies;
    }
    recalculateTotal() {
        this.check.total_price = this.check.products.filter(obj => obj.status != 3).map(obj => obj.price).reduce((a, b) => a + b, 0);
    }
    changeSpecs(spec) {
        const oldPrice = this.selectedProduct.price;
        if (![0.5, 1.5].includes(this.selectedQuantity)) {
            this.selectedProduct.name = this.selectedProduct.name + ' ' + spec.spec_name;
            this.selectedProduct.price = spec.spec_price;
        }
        else {
            this.selectedProduct.name = this.selectedProduct.name + ' ' + spec.spec_name;
            this.selectedProduct.price = (spec.spec_price * this.selectedQuantity);
        }
        this.recalculateTotal();
        $('#specsModal').modal('hide');
    }
    addNote(form) {
        if (this.selectedProduct != undefined) {
            let note = form.value.description;
            if (note == '' || note == null || note == ' ') {
                this.message.sendMessage('Not Alanı Boş Bırakılamaz');
            }
            else {
                this.check.products[this.selectedIndex].note += note;
                form.reset();
                $('#noteModal').modal('hide');
            }
        }
    }
    addReadyNotes(note) {
        this.noteInput.nativeElement.value += note + ', ';
        this.noteInput.nativeElement.dispatchEvent(new Event('input'));
    }
    addExtras(extra) {
        // this.check.products[this.selectedIndex].note += note + ', ';
        // this.noteInput.nativeElement.value += extra.extra_name + ', ';
        if (!this.isAlreadyAdded(extra)) {
            this.selectedProduct.price += extra.extra_price;
            this.selectedProduct.extras.push(extra);
            this.check.products[this.selectedIndex].note += extra.extra_name + ', ';
            this.check.total_price = this.calculateTotalPrice();
            // this.noteInput.nativeElement.value += extra.extra_name + ', ';
        }
        else {
            this.selectedProduct.price -= extra.extra_price;
            this.selectedProduct.note = this.selectedProduct.note.replace(extra.extra_name + ',', '');
            if (this.selectedProduct.note == ' ') {
                this.selectedProduct.note = '';
            }
            this.selectedProduct.extras = this.selectedProduct.extras.filter(obj => obj.extra_name !== extra.extra_name);
            this.check.total_price = this.calculateTotalPrice();
        }
        // this.noteInput.nativeElement.dispatchEvent(new Event('input'));
    }
    calculateTotalPrice() {
        return this.check.products.filter(obj => obj.status !== 3).map(obj => obj.price).reduce((a, b) => a + b, 0);
    }
    makeGift() {
        if (this.selectedProduct != undefined) {
            this.check.products[this.selectedIndex].name += ' (İkram)';
            if (!this.check.freeAmount)
                this.check.freeAmount = 0;
            this.check.freeAmount += this.check.products[this.selectedIndex].price;
            this.check.total_price = this.checkTotal() - this.check.products[this.selectedIndex].price;
            this.check.products[this.selectedIndex].price = 0;
            if (this.selectedProduct.status == 2) {
                this.mainService.updateData('checks', this.check_id, this.check).then(isOk => {
                    console.log(isOk);
                }).catch(err => {
                    console.log(err);
                });
            }
            $('#noteModal').modal('hide');
        }
    }
    dontGive() {
        if (this.selectedProduct != undefined) {
            this.check.products[this.selectedIndex].note = 'Verme';
            $('#noteModal').modal('hide');
        }
    }
    addCheckNote(form) {
        let note = form.value.description;
        if (note == '' || note == null || note == ' ') {
            this.message.sendMessage('Not Alanı Boş Bırakılamaz!');
        }
        else {
            this.check.note = note;
            if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                this.mainService.updateData('checks', this.check_id, { note: note }).then(res => {
                    this.check._rev = res.rev;
                });
            }
            form.reset();
            $('#checkNote').modal('hide');
        }
    }
    cancelProduct(reason) {
        if (this.selectedProduct !== undefined) {
            this.check.products[this.selectedIndex].status = 3;
            this.check.products[this.selectedIndex].note = reason;
            this.check.products[this.selectedIndex].owner = this.owner;
            const orderTimestamp = this.check.products[this.selectedIndex].timestamp;
            let orderWillCancel = this.orders.find(order => order.timestamp == orderTimestamp && order.status == __WEBPACK_IMPORTED_MODULE_2__mocks_order__["b" /* OrderStatus */].APPROVED);
            if (orderWillCancel) {
                // let orderItemsLenght = orderWillCancel.items.filter(item => item.product_id ==  this.check.products[this.selectedIndex].id).length;
                if (orderWillCancel.items.length == 1) {
                    orderWillCancel.status = __WEBPACK_IMPORTED_MODULE_2__mocks_order__["b" /* OrderStatus */].CANCELED;
                    orderWillCancel.items[0].note = reason;
                }
                else {
                    let orderProductsWillCancel = orderWillCancel.items.filter(item => item.product_id == this.check.products[this.selectedIndex].id);
                    if (orderProductsWillCancel.length == 1) {
                        let thatProduct = orderWillCancel.items.find(item => item.product_id == this.check.products[this.selectedIndex].id);
                        thatProduct.price = 0;
                        thatProduct.name += ' (İptal)';
                        thatProduct.note = reason;
                    }
                    else {
                        let thatProduct = orderWillCancel.items.find(item => item.product_id == this.check.products[this.selectedIndex].id && item.price !== 0);
                        thatProduct.price = 0;
                        thatProduct.name += ' (İptal)';
                        thatProduct.note = reason;
                    }
                    if (orderWillCancel.items.map(item => item.price).reduce((a, b) => a + b, 0) == 0) {
                        orderWillCancel.status = __WEBPACK_IMPORTED_MODULE_2__mocks_order__["b" /* OrderStatus */].CANCELED;
                        orderWillCancel.items[0].note = reason;
                    }
                    else {
                        orderWillCancel.edited = true;
                    }
                }
                this.mainService.updateData('orders', orderWillCancel._id, orderWillCancel).then(isOK => {
                    console.log(isOK);
                }).catch(err => {
                    console.log(err);
                });
            }
            this.check.products[this.selectedIndex].timestamp = Date.now();
            this.check.total_price = this.calculateTotalPrice();
            const productAfterCancel = this.check.products.filter(obj => obj.status == 1);
            this.check.products = this.check.products.filter(obj => obj.status !== 1);
            let analizeCheck = this.check.products.some(obj => obj.status !== 3);
            if (analizeCheck) {
                this.mainService.updateData(this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER ? 'closed_checks' : 'checks', this.check_id, this.check).then((res) => {
                    if (res.updated) {
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                            let pCat = this.categories.find(obj => obj._id == this.check.products[this.selectedIndex].cat_id);
                            let device = this.printers.find(obj => obj.name == pCat.printer);
                            this.printerService.printCancel(device, this.check.products[this.selectedIndex], reason, this.table.name, this.owner);
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].ORDER_CANCELED, this.check._id, `${this.table.name} Masasından ${this.selectedProduct.name} adlı ürün iptal edildi Açıklama:'${reason}'`);
                        }
                        else {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].ORDER_CANCELED, this.check._id, `${this.check.note} Hesabından ${this.selectedProduct.name} adlı ürün iptal edildi Açıklama:'${reason}'`);
                        }
                        this.check._rev = res.rev;
                        this.message.sendMessage('Ürün İptal Edildi');
                        this.selectedProduct = undefined;
                        this.selectedIndex = undefined;
                        productAfterCancel.forEach(element => {
                            this.check.products.push(element);
                        });
                    }
                });
            }
            else {
                let canceledTotalPrice = this.check.products.map(obj => obj.price).reduce((a, b) => a + b);
                let checkToCancel = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, canceledTotalPrice, 0, this.owner, this.check.note, 3, this.check.products, Date.now(), 3, 'İkram', [], null, this.check.occupation);
                checkToCancel.description = 'Bütün Ürünler İptal Edildi';
                this.mainService.addData('closed_checks', checkToCancel).then(res => {
                    this.message.sendMessage('Hesap İptal Edildi');
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_CANCELED, this.check._id, `${this.table.name}'de kalan bütün ürünler iptal edildi. Hesap Kapatıldı.`);
                });
                if (this.check.payment_flow) {
                    let payedDiscounts = 0;
                    this.mainService.getAllBy('reports', { type: "Store" }).then(res => {
                        let sellingReports = res.docs;
                        this.check.payment_flow.forEach((obj, index) => {
                            payedDiscounts += obj.discount;
                            let reportWillChange = sellingReports.find(report => report.connection_id == obj.method);
                            reportWillChange.count++;
                            reportWillChange.amount += obj.amount;
                            reportWillChange.weekly[this.day] += obj.amount;
                            reportWillChange.weekly_count[this.day]++;
                            reportWillChange.monthly[new Date().getMonth()] += obj.amount;
                            reportWillChange.monthly_count[new Date().getMonth()]++;
                            reportWillChange.timestamp = Date.now();
                            if (this.check.payment_flow.length == index + 1) {
                                sellingReports.forEach((report, dd) => {
                                    if (this.check.payment_flow.some(obj => obj.method == report.connection_id)) {
                                        this.mainService.updateData('reports', report._id, report);
                                    }
                                });
                            }
                        });
                    });
                    let checksForPayed = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, this.check.discount, payedDiscounts, this.owner, this.check.note, this.check.status, [], Date.now(), this.check.type, 'Parçalı', this.check.payment_flow, null, this.check.occupation);
                    this.mainService.addData('closed_checks', checksForPayed);
                }
                this.mainService.removeData('checks', this.check._id);
                if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                    this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                }
                this.router.navigate(['/store']);
            }
        }
        $('#cancelProduct').modal('hide');
    }
    //// 28900848 Protocol DAD
    //// CODENAME:BELALIM
    undoChanges() {
        if (this.selectedProduct) {
            if (this.selectedProduct.status == __WEBPACK_IMPORTED_MODULE_4__mocks_product__["f" /* ProductStatus */].ACTIVE) {
                let newIndex = this.newOrders.indexOf(this.check.products[this.selectedIndex]);
                this.decountProductsData(this.check.products[this.selectedIndex]);
                this.check.total_price = this.checkTotal() - this.check.products[this.selectedIndex].price;
                this.check.products.splice(this.selectedIndex, 1);
                this.newOrders.splice(newIndex, 1);
                this.selectedIndex = undefined;
                this.selectedProduct = undefined;
            }
            else {
                return false;
            }
        }
        else {
            this.newOrders.pop();
            let count = this.check.products.length;
            if (count > 0) {
                if (this.check.products[count - 1].status !== 2) {
                    this.selectedIndex = undefined;
                    this.selectedProduct = undefined;
                    let lastItem = this.check.products.pop();
                    this.decountProductsData(lastItem);
                    this.check.total_price = this.checkTotal() - lastItem.price;
                }
                else {
                    return false;
                }
            }
        }
    }
    decountProductsData(deProduct) {
        let contains = this.countData.some(obj => obj.product === deProduct.id);
        if (contains) {
            let index = this.countData.findIndex(p_id => p_id.product == deProduct.id);
            this.countData[index].count--;
            this.countData[index].total -= deProduct.price;
            if (this.countData[index].count == 0) {
                this.countData = this.countData.filter(obj => obj.product !== deProduct.id);
            }
        }
    }
    countProductsData(id, price, manuelCount) {
        let countObj;
        if (manuelCount) {
            countObj = { product: id, count: manuelCount, total: price };
        }
        else {
            countObj = { product: id, count: 1, total: price };
        }
        let contains = this.countData.some(obj => obj.product === id);
        if (contains) {
            let index = this.countData.findIndex(p_id => p_id.product == id);
            if (manuelCount) {
                this.countData[index].count += manuelCount;
            }
            else {
                this.countData[index].count++;
            }
            this.countData[index].total += price;
        }
        else {
            this.countData.push(countObj);
        }
    }
    updateUserReport() {
        if (this.newOrders.length > 0) {
            let pricesTotal = this.newOrders.map(obj => obj.price).reduce((a, b) => a + b);
            if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].ORDER_CREATED, this.check._id, `'${this.owner}' ${this.table.name} masasına ${pricesTotal} TL tutarında sipariş girdi.`);
            }
            else {
                this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].ORDER_CREATED, this.check._id, `'${this.owner}' Hızlı Satış - ${this.check.note} hesabına ${pricesTotal} TL tutarında sipariş girdi.`);
            }
            this.mainService.getAllBy('reports', { connection_id: this.ownerId }).then(res => {
                let doc = res.docs[0];
                doc.amount += pricesTotal;
                doc.count++;
                doc.weekly[this.day] += pricesTotal;
                doc.weekly_count[this.day]++;
                doc.monthly[new Date().getMonth()] += pricesTotal;
                doc.monthly_count[new Date().getMonth()]++;
                if (doc.weekly_count[this.day] == 100) {
                    this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].USER_CHECKPOINT, this.ownerId, `'${this.owner}' günün 100. siparişini girdi.`);
                }
                doc.timestamp = Date.now();
                this.mainService.updateData('reports', doc._id, doc).then();
            });
        }
    }
    updateProductReport(data) {
        data.forEach((obj, index) => {
            this.mainService.getAllBy('reports', { connection_id: obj.product }).then(res => {
                let report = res.docs[0];
                this.mainService.changeData('reports', report._id, (doc) => {
                    doc.count += obj.count;
                    doc.amount += obj.total;
                    doc.timestamp = Date.now();
                    doc.weekly[this.day] += obj.total;
                    doc.weekly_count[this.day] += obj.count;
                    doc.monthly[new Date().getMonth()] += obj.total;
                    doc.monthly_count[new Date().getMonth()]++;
                    return doc;
                });
            });
            this.mainService.getAllBy('recipes', { product_id: obj.product }).then(result => {
                if (result.docs.length > 0) {
                    const pRecipe = result.docs[0].recipe;
                    pRecipe.forEach(stock => {
                        let downStock = stock.amount * obj.count;
                        this.mainService.changeData('stocks', stock.stock_id, (doc) => {
                            doc.left_total -= downStock;
                            doc.quantity = doc.left_total / doc.total;
                            if (doc.left_total < doc.warning_limit) {
                                if (doc.db_name) {
                                    if (doc.left_total <= 0) {
                                        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok tükendi!`);
                                    }
                                    else {
                                        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok bitmek üzere! - Kalan: '${doc.left_total + ' ' + doc.unit}'`);
                                    }
                                }
                            }
                            return doc;
                        });
                    });
                }
            });
        });
    }
    qrCode(printer) {
        $('#qrPrintersModal').modal('hide');
        if (!printer) {
            printer = this.printers[0];
        }
        const slug = localStorage.getItem('Slug');
        console.log(this.check);
        if (this.check._id !== undefined) {
            let qrdata = `https://quickly.cafe/${slug}/${this.check._id}`;
            this.printerService.printQRCode(printer, qrdata, this.table.name, this.owner);
        }
        else {
            this.check.status = __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].OCCUPIED;
            // this.check.type = CheckType.SELF;
            if (this.check.products.some(obj => obj.status == 1)) {
                this.check.products = this.check.products.filter(obj => obj.status !== 1);
                this.check.total_price = this.calculateTotalPrice();
                this.mainService.addData('checks', this.check).then(res => {
                    this.mainService.updateData('tables', this.table._id, { status: 2, timestamp: Date.now() }).then(() => {
                        console.log(this.check._id);
                        setTimeout(() => {
                            let qrdata = `https://quickly.cafe/${slug}/${this.check._id}`;
                            this.printerService.printQRCode(printer, qrdata, this.table.name, this.owner);
                        }, 100);
                    });
                });
            }
            else {
                this.mainService.addData('checks', this.check).then(res => {
                    this.mainService.updateData('tables', this.table._id, { status: 2, timestamp: Date.now() }).then(() => {
                        console.log(this.check._id);
                        setTimeout(() => {
                            let qrdata = `https://quickly.cafe//${slug}/${this.check._id}`;
                            this.printerService.printQRCode(printer, qrdata, this.table.name, this.owner);
                        }, 100);
                    });
                });
            }
        }
        this.router.navigate(['/store']);
    }
    printOrderOld() {
        if (this.printers.length > 0) {
            let orders = this.check.products.filter(obj => obj.status == 1);
            if (orders.length > 0) {
                let splitPrintArray = [];
                orders.forEach((obj, index) => {
                    let catPrinter = this.categories.filter(cat => cat._id == obj.cat_id)[0].printer || this.printers[0].name;
                    let contains = splitPrintArray.some(element => element.printer.name == catPrinter);
                    if (contains) {
                        let index = splitPrintArray.findIndex(p_name => p_name.printer.name == catPrinter);
                        splitPrintArray[index].products.push(obj);
                    }
                    else {
                        let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                        let splitPrintOrder = { printer: thePrinter, products: [obj] };
                        splitPrintArray.push(splitPrintOrder);
                    }
                    if (index == orders.length - 1) {
                        let table_name;
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST) {
                            table_name = this.check.note;
                        }
                        else {
                            table_name = this.table.name;
                        }
                        splitPrintArray.forEach(order => {
                            this.printerService.printOrder(order.printer, table_name, order.products, this.owner);
                        });
                    }
                });
            }
        }
    }
    printOrder() {
        if (this.printers.length > 0) {
            let orders = this.check.products.filter(obj => obj.status == 1);
            if (orders.length > 0) {
                let splitPrintArray = [];
                for (const obj of orders) {
                    let catPrinter = this.categories.filter(cat => cat._id == obj.cat_id)[0].printer || this.printers[0].name;
                    let contains = splitPrintArray.some(element => element.printer.name == catPrinter);
                    if (contains) {
                        let index = splitPrintArray.findIndex(p_name => p_name.printer.name == catPrinter);
                        splitPrintArray[index].products.push(obj);
                    }
                    else {
                        let thePrinter = this.printers.filter(obj => obj.name == catPrinter)[0];
                        let splitPrintOrder = { printer: thePrinter, products: [obj] };
                        splitPrintArray.push(splitPrintOrder);
                    }
                }
                let table_name;
                if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST) {
                    table_name = this.check.note;
                }
                else {
                    table_name = this.table.name;
                }
                splitPrintArray.forEach(order => {
                    this.printerService.printOrder(order.printer, table_name, order.products, this.owner);
                });
            }
        }
    }
    printCheck(selectedPrinter) {
        $('#printersModal').modal('hide');
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
            this.check.products = this.check.products.filter(obj => obj.status == 2);
            this.check.total_price = this.check.products.map(obj => obj.price).reduce((a, b) => a + b);
            if (this.table.status !== __WEBPACK_IMPORTED_MODULE_6__mocks_table__["d" /* TableStatus */].WILL_READY) {
                this.printerService.printCheck(selectedPrinter, this.table.name, this.check);
                if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                    if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                        this.mainService.updateData('tables', this.id, { status: 3 }).then(res => {
                            this.router.navigate(['store']);
                        });
                        this.message.sendMessage('Hesap Yazdırıldı..');
                    }
                }
            }
            else {
                this.message.sendConfirm('Adisyon Tekrar Yazdırılsın mı?').then(isOk => {
                    if (isOk) {
                        this.printerService.printCheck(selectedPrinter, this.table.name, this.check);
                    }
                });
            }
        }
        else if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST) {
            this.check.total_price = this.check.products.map(obj => obj.price).reduce((a, b) => a + b);
            this.printerService.printCheck(selectedPrinter, this.check.note, this.check);
        }
    }
    getProductsBy(id) {
        this.selectedCat = id;
        this.subCatsView = this.sub_categories.filter(obj => obj.cat_id == id);
        this.productsView = this.products.filter(obj => obj.cat_id == id);
        // .sort((a, b) => a.name.localeCompare(b.name));
    }
    getProductsBySubCat(id) {
        this.productsView = this.products.filter(obj => obj.subcat_id == id);
        // .sort((a, b) => a.name.localeCompare(b.name));
    }
    selectTable(id) {
        this.selectedTable = id;
    }
    splitProduct() {
        if (this.selectedTable.status == __WEBPACK_IMPORTED_MODULE_6__mocks_table__["d" /* TableStatus */].ACTIVE) {
            this.message.sendConfirm(`${this.selectedProduct.name}, ${this.selectedTable.name} Masasına Aktarılacak ve Yeni Hesap Açılacak.`).then(isOk => {
                if (isOk) {
                    let newCheck = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["a" /* Check */](this.selectedTable._id, this.selectedProduct.price, 0, this.owner, '', 1, [this.selectedProduct], Date.now(), __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL, Object(__WEBPACK_IMPORTED_MODULE_3__mocks_check__["b" /* CheckNo */])());
                    this.mainService.addData('checks', newCheck).then(res => {
                        if (res.ok) {
                            this.check.products.splice(this.selectedIndex, 1);
                            this.check.total_price = this.checkTotal() - this.selectedProduct.price;
                            this.mainService.updateData('tables', this.selectedTable._id, { status: 2, timestamp: Date.now() }).then(res => {
                                if (res.updated) {
                                    if (this.check.products.length == 0) {
                                        if (this.check.payment_flow) {
                                            let payedDiscounts = 0;
                                            this.check.payment_flow.forEach((obj, index) => {
                                                payedDiscounts += obj.discount;
                                                this.mainService.getAllBy('reports', { connection_id: obj.method }).then(res => {
                                                    this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
                                                        doc.count++;
                                                        doc.weekly_count[this.day]++;
                                                        doc.amount += obj.amount;
                                                        doc.weekly[this.day] += obj.amount;
                                                        doc.monthly[new Date().getMonth()] += obj.amount;
                                                        doc.monthly_count[new Date().getMonth()]++;
                                                        doc.timestamp = Date.now();
                                                        return doc;
                                                    });
                                                });
                                            });
                                            let checksForPayed = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, this.check.discount, payedDiscounts, this.owner, this.check.note, this.check.status, [], Date.now(), this.check.type, 'Parçalı', this.check.payment_flow, null, this.check.occupation);
                                            this.mainService.addData('closed_checks', checksForPayed);
                                        }
                                        this.mainService.removeData('checks', this.check._id).then(res => {
                                            if (res.ok) {
                                                $('#splitTable').modal('hide');
                                                this.mainService.updateData('tables', this.check.table_id, { status: 1 }).then(res => {
                                                    this.message.sendMessage(`Ürün ${this.selectedTable.name} Masasına Aktarıldı`);
                                                });
                                                this.router.navigate(['/store']);
                                            }
                                        });
                                    }
                                    else {
                                        this.mainService.updateData('checks', this.check._id, this.check).then(res => {
                                            if (res.updated) {
                                                this.message.sendMessage(`Ürün ${this.selectedTable.name} Masasına Aktarıldı`);
                                                this.check._rev = res.rev;
                                                this.setDefault();
                                                $('#splitTable').modal('hide');
                                            }
                                        });
                                    }
                                }
                            });
                        }
                    });
                }
            });
        }
        else {
            this.mainService.getAllBy('checks', { table_id: this.selectedTable._id }).then(res => {
                let otherCheck = res.docs[0];
                otherCheck.products.push(this.selectedProduct);
                otherCheck.total_price = this.checkTotal() + this.selectedProduct.price;
                this.check.total_price = this.checkTotal() - this.selectedProduct.price;
                this.check.products.splice(this.selectedIndex, 1);
                this.mainService.updateData('checks', otherCheck._id, otherCheck).then(res => {
                    if (res.updated) {
                        if (this.check.products.length == 0) {
                            if (this.check.payment_flow) {
                                let payedDiscounts = 0;
                                this.check.payment_flow.forEach((obj, index) => {
                                    payedDiscounts += obj.discount;
                                    this.mainService.getAllBy('reports', { connection_id: obj.method }).then(res => {
                                        this.mainService.changeData('reports', res.docs[0]._id, (doc) => {
                                            doc.count++;
                                            doc.weekly_count[this.day]++;
                                            doc.amount += obj.amount;
                                            doc.weekly[this.day] += obj.amount;
                                            doc.monthly[new Date().getMonth()] += obj.amount;
                                            doc.monthly_count[new Date().getMonth()]++;
                                            doc.timestamp = Date.now();
                                            return doc;
                                        });
                                    });
                                });
                                let checksForPayed = new __WEBPACK_IMPORTED_MODULE_3__mocks_check__["f" /* ClosedCheck */](this.check.table_id, this.check.discount, payedDiscounts, this.owner, this.check.note, this.check.status, [], Date.now(), this.check.type, 'Parçalı', this.check.payment_flow, null, this.check.occupation);
                                this.mainService.addData('closed_checks', checksForPayed);
                            }
                            this.mainService.removeData('checks', this.check._id).then(res => {
                                if (res.ok) {
                                    $('#splitTable').modal('hide');
                                    this.mainService.updateData('tables', this.check.table_id, { status: 1 }).then(res => {
                                        this.message.sendMessage(`Ürün ${this.selectedTable.name} Masasına Aktarıldı`);
                                    });
                                    this.router.navigate(['/store']);
                                }
                            });
                        }
                        else {
                            this.mainService.updateData('checks', this.check._id, this.check).then(res => {
                                if (res.updated) {
                                    this.message.sendMessage(`Ürün ${this.selectedTable.name} Masasına Aktarıldı`);
                                    this.check._rev = res.rev;
                                    this.setDefault();
                                    $('#splitTable').modal('hide');
                                }
                            });
                        }
                    }
                });
            });
        }
        this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].ORDER_MOVED, this.selectedProduct.id, `${this.selectedProduct.name} siparişi ${this.table.name} masasından ${this.selectedTable.name} masasına aktarıldı`);
    }
    splitTable() {
        if (this.selectedTable.status == __WEBPACK_IMPORTED_MODULE_6__mocks_table__["d" /* TableStatus */].ACTIVE) {
            if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                    this.mainService.updateData('tables', this.check.table_id, { status: 1, timestamp: Date.now() });
                }
                this.mainService.updateData('tables', this.selectedTable._id, { status: 2, timestamp: Date.now() });
                this.mainService.updateData('checks', this.check_id, { table_id: this.selectedTable._id, type: 1 }).then(res => {
                    if (res.updated) {
                        this.message.sendMessage(`Hesap ${this.selectedTable.name} Masasına Aktarıldı.`);
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_MOVED, this.check._id, `${this.table.name} Hesabı ${this.selectedTable.name} masasına taşındı.`);
                        }
                        else {
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_MOVED, this.check._id, `${this.check.note} Hesabı ${this.selectedTable.name} masasına taşındı.`);
                        }
                        $('#splitTable').modal('hide');
                        this.router.navigate(['/store']);
                    }
                }).catch(err => {
                    console.log('Table Split Error');
                });
            }
        }
        else {
            this.message.sendConfirm(`Bütün Ürünler, ${this.selectedTable.name} Masasına Aktarılacak.`).then(isOk => {
                if (isOk) {
                    this.mainService.getAllBy('checks', { table_id: this.selectedTable._id }).then(res => {
                        let otherCheck = res.docs[0];
                        otherCheck.products = otherCheck.products.concat(this.check.products);
                        otherCheck.total_price += this.checkTotal();
                        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                            otherCheck.note = `${this.table.name} Masası İle Birleştirildi`;
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_MOVED, this.check._id, `${this.table.name} Masası ${this.selectedTable.name} ile Birleştirildi.`);
                        }
                        else {
                            otherCheck.note = `${this.check.note} Hesabı İle Birleştirildi`;
                            this.logService.createLog(__WEBPACK_IMPORTED_MODULE_10__services_log_service__["b" /* logType */].CHECK_MOVED, this.check._id, `${this.check.note} Hesabı ${this.selectedTable.name} Masasına Aktarıldı.`);
                        }
                        if (this.check.payment_flow) {
                            if (otherCheck.payment_flow) {
                                otherCheck.payment_flow = otherCheck.payment_flow.concat(this.check.payment_flow);
                            }
                            else {
                                otherCheck.payment_flow = this.check.payment_flow;
                            }
                            otherCheck.discount += this.check.discount;
                            otherCheck.timestamp = Date.now();
                        }
                        this.mainService.updateData('checks', otherCheck._id, otherCheck).then(res => {
                            if (res.updated) {
                                if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
                                    this.mainService.updateData('tables', this.check.table_id, { status: 1 });
                                }
                                this.mainService.removeData('checks', this.check._id).then(res => {
                                    if (res.ok) {
                                        this.message.sendMessage(`Hesap ${this.selectedTable.name} Masası ile Birleştirildi.`);
                                        $('#splitTable').modal('hide');
                                        this.router.navigate(['/store']);
                                    }
                                });
                            }
                        });
                    });
                }
            });
        }
    }
    setDiscount(value) {
        this.check.discountPercent = value;
        $('#checkDiscount').modal('hide');
        if (this.check.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].NORMAL) {
            if (this.check.status !== __WEBPACK_IMPORTED_MODULE_3__mocks_check__["d" /* CheckStatus */].PASSIVE) {
                this.mainService.changeData('checks', this.check._id, (doc) => {
                    doc.discountPercent = value;
                    return doc;
                });
            }
        }
    }
    catName(cat_id) {
        try {
            return this.categories.find(obj => obj._id == cat_id).name;
        }
        catch (error) {
            return '';
        }
    }
    filterProducts(value) {
        if (value !== '') {
            let regexp = new RegExp(value, 'i');
            this.productsView = this.products.filter(({ name }) => name.match(regexp));
            this.selectedCat = 'OnSearch';
        }
        else {
            this.selectedCat = undefined;
        }
    }
    filterTables(id) {
        this.selectedFloor = id;
        this.selectedTable = undefined;
        this.tablesView = this.tables.filter(obj => obj.floor_id == id);
    }
    setDefault() {
        this.selectedIndex = undefined;
        this.selectedTable = undefined;
        this.selectedProduct = undefined;
        this.selectedFloor = undefined;
        this.onProductChange = false;
        this.fillData();
    }
    getCheckDetails() {
        this.mainService.getAllBy('orders', { check: this.check_id }).then(result => {
            this.orders = result.docs;
            console.log(this.orders);
        });
        this.mainService.getAllBy('receipts', { check: this.check_id }).then(result => {
            this.receipts = result.docs;
            console.log(this.receipts);
        });
    }
    fillData() {
        this.selectedCat = undefined;
        this.mainService.getAllBy('users', {}).then(result => {
            this.users = result.docs;
        });
        this.mainService.getAllBy('categories', {}).then(result => {
            this.categories = result.docs;
            this.categories = this.categories.sort((a, b) => a.order - b.order);
        });
        this.mainService.getAllBy('sub_categories', {}).then(result => {
            this.sub_categories = result.docs;
        });
        this.mainService.getAllBy('products', {}).then(result => {
            this.products = result.docs;
            this.products = this.products.sort((a, b) => a.price - b.price);
            // this.products = this.products.sort((a, b) => a.name.localeCompare(b.name));
            this.productsView = this.products;
        });
        this.mainService.getAllBy('tables', {}).then(res => {
            this.tables = res.docs;
            this.table = this.tables.filter(obj => obj._id == this.id)[0];
            this.tables = this.tables.filter(obj => obj._id !== this.id).filter(obj => obj.status !== 3).sort((a, b) => a.name.localeCompare(b.name));
            if (this.selectedFloor) {
                this.tablesView = this.tables.filter(obj => obj.floor_id == this.selectedFloor);
            }
            else {
                this.tablesView = this.tables;
            }
        });
        this.mainService.getAllBy('floors', {}).then(res => {
            this.floors = res.docs;
        });
        this.settingsService.getAppSettings().subscribe((res) => {
            if (res.value.ask_print_order == 'Sor') {
                this.askForPrint = true;
            }
            else {
                this.askForPrint = false;
            }
            if (res.value.ask_print_check == 'Sor') {
                this.askForCheckPrint = true;
            }
            else {
                this.askForCheckPrint = false;
            }
        });
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('productName'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], SellingScreenComponent.prototype, "productFilterInput", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('specsUnit'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], SellingScreenComponent.prototype, "productUnit", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('noteInput'),
    __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
], SellingScreenComponent.prototype, "noteInput", void 0);
SellingScreenComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-selling-screen',
        template: __webpack_require__("./src/app/components/store/selling-screen/selling-screen.component.html"),
        styles: [__webpack_require__("./src/app/components/store/selling-screen/selling-screen.component.scss")],
        providers: [__WEBPACK_IMPORTED_MODULE_12__services_settings_service__["a" /* SettingsService */]]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_11__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_9__providers_printer_service__["a" /* PrinterService */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["a" /* ActivatedRoute */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_7__providers_electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_8__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_12__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_13__providers_scaler_service__["a" /* ScalerService */], __WEBPACK_IMPORTED_MODULE_10__services_log_service__["a" /* LogService */], __WEBPACK_IMPORTED_MODULE_0__angular_core__["NgZone"]])
], SellingScreenComponent);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/components/store/store.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"row\">\n  <div class=\"col-lg-10 pr-0\">\n    <div class=\"card full-height\">\n      <div class=\"card-header pb-0\">\n        <div class=\"row\">\n          <div class=\"col-lg-9 pl-1 pr-1\">\n            <!-- Masalar  nav-justified -->\n            <ul class=\"nav nav-tabs\">\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Masalar'}\" (click)=\"changeSection('Masalar')\">\n                  <i class=\"fa fa-square\" aria-hidden=\"true\"></i>\n                  Masalar\n                </a>\n              </li>\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Kroki'}\" (click)=\"changeSection('Kroki')\">\n                  <i class=\"fa fa-map\" aria-hidden=\"true\"></i> Kroki</a>\n              </li>\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Hesaplar'}\" (click)=\"changeSection('Hesaplar')\">\n                  <i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i>\n                  Hesaplar\n                  <span *ngIf=\"checks.length > 0\" class=\"badge bg-danger\">{{checks?.length}}</span>\n                </a>\n              </li>\n              <!-- <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Paket Servis'}\" (click)=\"changeSection('Kroki')\">\n                  <i class=\"fa fa-motorcycle\" aria-hidden=\"true\"></i> Paket Servis</a>\n              </li> -->\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Siparişler'}\" (click)=\"changeSection('Siparişler')\">\n                  <i class=\"fa fa-paper-plane\" aria-hidden=\"true\"></i>\n                  Siparişler\n                  <span *ngIf=\"waitingOrders > 0\" class=\"badge bg-danger animated flash infinite slow\">{{waitingOrders}}</span>\n                </a>\n              </li>\n              <li class=\"nav-item\">\n                <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Ödemeler'}\" (click)=\"changeSection('Ödemeler')\">\n                  <i class=\"fa fa-credit-card-alt\" aria-hidden=\"true\"></i>\n                  Ödemeler\n                  <span *ngIf=\"waitingReceipts > 0\" class=\"badge bg-danger animated flash infinite slow\">{{waitingReceipts}}</span>\n                </a>\n              </li>\n                <!-- <li class=\"nav-item\">\n                  <a class=\"nav-link\" [ngClass]=\"{'active': section == 'Calls'}\" (click)=\"changeSection('Calls')\">\n                    <i class=\"fa fa-phone\" aria-hidden=\"true\"></i>\n                    Çağrılar\n                  </a>\n                </li> -->\n            </ul>\n          </div>\n          <div class=\"col-lg-3 pr-2\">\n            <div class=\"input-group input-group\">\n              <div class=\"input-group-prepend normal\">\n                <div class=\"input-group-text\"><i class=\"fa fa-search\" aria-hidden=\"true\"></i></div>\n              </div>\n              <input #tableName type=\"text\" placeholder=\"Masa Adı Girin.\" (click)=\"tableViews = tables\" (keyup)=\"filterTables(tableName.value)\" class=\"form-control form-contol\">\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div *ngIf=\"section == 'Masalar'\" class=\"card-body pt-0 flow\">\n        <section id=\"tables\">\n          <div class=\"row\">\n            <div *ngFor=\"let table of tableViews\" [routerLink]=\"['/selling-screen','Normal', table._id]\" class=\"col-xl-2 col-lg-2 mt-2 col-card\">\n              <div [ngClass]=\"{'bg-success': table.status == 2, 'bg-warning text-dark':table.status == 1, 'bg-danger text-white animated flash slow infinite': table.status == 3, 'bg-indigo text-white animated tada slow infinite': table.status == 4 }\" class=\"card tableCard\">\n                <div class=\"card-body p-2\">\n                  <h1 [ngClass]=\"{'long-name mb-3': table.name.length >= 7}\" class=\"card-title mb-2\">{{table.name}}</h1>\n                  <span *ngIf=\"getTableTotal(table._id)\" style=\"font-weight:bolder; position: relative; top:-5px;\">{{getTableTotal(table._id) | price}}</span>\n                  <p class=\"tableInfo\">\n                      <i class=\"fa fa-user\"></i> {{table.capacity}}\n                    <span *ngIf=\"table.status == 2\" class=\"pull-right\">\n                      <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> {{table.timestamp | timeAgo }}\n                    </span>\n                    <span *ngIf=\"table.status == 3\" class=\"pull-right\">\n                      <i class=\"fa fa-print\" aria-hidden=\"true\"></i>\n                    </span>\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div *ngFor=\"let check of fastChecks\" [routerLink]=\"['/selling-screen','Fast', check._id]\" class=\"col-xl-2 col-lg-2 mt-2 col-card\">\n              <div class=\"card bg-info tableCard\">\n                <div class=\"card-body p-2\">\n                  <h1 class=\"card-title long-name mb-3\">{{check.note}}</h1>\n                  <p class=\"card-text\">\n                    <i class=\"fa fa-user\" aria-hidden=\"true\"></i> {{check.owner}}\n                    <br>\n                    <i class=\"fa fa-clock-o\"></i> {{check.timestamp | date:'HH:mm'}}\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div *ngIf=\"section == 'Hesaplar'\" class=\"card-body pt-0 flow\">\n        <section id=\"checks\">\n          <div class=\"row\">\n            <div *ngFor=\"let check of checksView\" [routerLink]=\"['/selling-screen','Normal', check.table_id]\" class=\"col-xl-3 col-lg-4 mt-2 col-card check-card\">\n              <!-- [ngClass]=\"check.type == 1 ? 'bg-white text-dark' : 'bg-info text-white'\" -->\n              <div class=\"card\" [ngClass]=\"{'bg-white text-dark': check.type == 1, 'bg-info text-white' : check.type == 2 , 'bg-teal text-white' : check.type == 5}\">\n                <div class=\"card-header pr-2 pl-2\">\n                  <b>\n                    <span class=\"float-left\">{{check.table_id | general:'tables' | async}} <small style=\"font-weight: bold;\">{{check.note}}</small></span>\n                    <span class=\"float-right\">{{check.total_price | price }}</span>\n                  </b>\n                </div>\n                <div class=\"card-body pr-2 pl-2 pt-1 check-flow\">\n                  <!-- <div *ngFor=\"let product of check.products\" class=\"check-product\">\n                    <div class=\"product-name\">\n                      {{product.name}}\n                    </div>\n                    <div class=\"product-price\">\n                      {{product.price | price }}\n                    </div>\n                  </div> -->\n\n\n\n                  <!-- <ng-container> -->\n                    <div *ngFor=\"let item of checkItems(check); let i = index\">\n                      <p style=\"font-weight:bold; width:100%; display: flex; flex-direction: row; padding-bottom: 5px;\" class=\"check-product\">\n                        <span  style=\"min-width: 10%; float: left; text-align: center; font-weight: bolder;\">{{ item.quantity }} x</span>\n                        <span  style=\"min-width: 60%; max-width: 60%; padding-left: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; text-transform: capitalize;\"> {{ item.name }}</span>\n                        <span  style=\"min-width: 30%; float: right; text-align: right;\">{{ item.price * item.quantity  | price}}</span>\n                      </p>\n                    </div>\n                  <!-- </ng-container> -->\n                </div>\n                <div class=\"card-footer p-2\">\n                  <span class=\"float-left\">\n                    <i class=\"fa fa-user\" aria-hidden=\"true\"></i> {{check.owner}}\n                  </span>\n                  <span class=\"float-right\">\n                    <i class=\"fa fa-clock-o\"></i> {{check.timestamp | date:'HH:mm'}}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </section>\n      </div>\n\n      <div *ngIf=\"section == 'Siparişler'\" class=\"card-body pt-0 flow\">\n        <section id=\"orders\">\n          <div class=\"row\">\n            <ng-container *ngFor=\"let order of ordersView\">\n              <div class=\"col-xl-3 col-lg-4 mt-2 col-card check-card mb-3\">\n                <div class=\"card text-dark animated slow\" [ngClass]=\"{'bg-warning': order.status == 0, 'bg-info' : order.status == 1 , 'bg-teal fadeOut' : order.status == 2, 'bg-success fadeOut' : order.status == 4, 'bg-danger fadeOut' : order.status == 3}\">\n                  <div class=\"card-header pr-2 pl-2\">\n                    <b>\n                      <span class=\"float-left\">{{ findTable(order.check) }} <small style=\"font-weight: bold;\"> ({{order.user.name}})</small></span>\n                      <span class=\"float-right\">{{ order.timestamp | date: 'HH:mm' }}</span>\n                      <!-- <p>{{statusNote(order.status)}}</p> -->\n                    </b>\n                  </div>\n                  <div class=\"card-body pr-2 pl-2 pt-1 check-flow\">\n                    <div *ngFor=\"let product of order.items\" class=\"check-product\">\n                      <div class=\"product-name\">\n                        {{product.name}} {{product.type | titlecase}}\n                        <p *ngIf=\"product.note\"><small>{{product.note}}</small></p>\n                      </div>\n                      <div class=\"product-price\">\n                        {{product.price | price }}\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"card-footer p-2\">\n                    <ng-container *ngIf=\"!isOwner(order.check)\">\n                      <b>Hesap Sahibi:  {{checkOwner(order.check) | general:'users' | async}}</b>\n                    </ng-container>\n                    <ng-container *ngIf=\"isOwner(order.check)\">\n                      <div *ngIf=\"order.status == 0\" class=\"btn-group btn-group-justify btn-block\">\n                        <button oneShot type=\"button\" [disabled]=\"!isOwner(order.check)\" (click)=\"cancelOrder(order)\" oneShot class=\"btn btn-danger \">İptal</button>\n                        <button oneShot type=\"button\" [disabled]=\"!isOwner(order.check)\" (click)=\"approoveOrder(order)\" oneShot class=\"btn btn-success btn-block\">Onayla</button>\n                      </div>\n                    </ng-container>\n                    <!-- <button *ngIf=\"order.status == 1\" [disabled]=\"!isOwner(order.check)\" type=\"button\" (click)=\"approoveOrder(order)\" oneShot class=\"btn btn-success btn-block\">Tamamla</button> -->\n                    <h4 *ngIf=\"order.status == 2\" class=\"text-center mb-1 mt-1\">Teslim Edildi</h4>\n                    <h4 *ngIf=\"order.status == 3\" class=\"text-center mb-1 mt-1\">İptal Edildi</h4>\n                  </div>\n                </div>\n              </div>\n            </ng-container>\n          </div>\n        </section>\n      </div>\n\n      <div *ngIf=\"section == 'Kroki'\" class=\"card-body p-0\">\n        <section *ngIf=\"selected == ''\" id=\"err\">\n          <h1>Lütfen Sağ Taraftan Bölüm Seçiniz</h1>\n        </section>\n        <section *ngIf=\"selected !== ''\" id=\"plan\">\n          <ng-container *ngFor=\"let table of tableViews\">\n            <div *ngIf=\"table.position\" draggable='true' (dragstart)=\"dragStart($event,table)\" (dragend)=\"changePosition($event,table)\" [routerLink]=\"['/selling-screen','Normal', table._id]\" class=\"relativeTable p-2\"\n              [ngClass]=\"{'bg-success': table.status == 2, 'bg-warning text-dark':table.status == 1, 'bg-danger text-white animated heartBeat slow infinite': table.status == 3, 'bg-indigo text-white animated tada slow infinite': table.status == 4 }\" [style.height.px]=\"table.position.height\" [style.width.px]=\"table.position.width\" [style.left.px]=\"table.position.x\"\n              [style.top.px]=\"table.position.y\">\n              <h5>\n                <strong>{{table.name}}</strong>\n              </h5>\n              <p class=\"absTableInfo\">\n                <i class=\"fa fa-user\"></i> {{table.capacity}}\n                <span *ngIf=\"table.status == 2\" class=\"pull-right\">\n                  <i class=\"fa fa-clock-o\" aria-hidden=\"true\"></i> {{table.timestamp | timeAgo }}\n                </span>\n                <span *ngIf=\"table.status == 3\" class=\"pull-right\">\n                  <i class=\"fa fa-print\" aria-hidden=\"true\"></i>\n                </span>\n              </p>\n            </div>\n          </ng-container>\n        </section>\n      </div>\n\n\n      <div *ngIf=\"section == 'Ödemeler'\" class=\"card-body pt-0 flow\">\n        <section id=\"orders\">\n          <div class=\"row\">\n            <ng-container *ngFor=\"let receipt of receiptsView\">\n              <div class=\"col-xl-3 col-lg-4 mt-2 col-card check-card mb-3\">\n                <div class=\"card text-dark animated slow\" [ngClass]=\"{'bg-warning': receipt.status == 1, 'bg-info' : receipt.status == 2 ,'bg-success fadeOut' : receipt.status == 3, 'bg-danger fadeOut' : receipt.status == 4}\">\n                  <div class=\"card-header pr-2 pl-2\">\n                    <b>\n                      <span class=\"float-left\">{{ findTable(receipt.check) }} <small style=\"font-weight: bold;\">( {{receipt.user.name}} )</small></span>\n                      <span class=\"float-right\">{{ receipt.timestamp | date: 'HH:mm' }}</span>\n                      <!-- <p>{{statusNote(order.status)}}</p> -->\n                    </b>\n                  </div>\n                  <div class=\"card-header pr-2 pl-2\">\n                    <b>\n                      <span class=\"float-left\">{{ paymentNote(receipt.method) }}</span>\n                      <span class=\"float-right\">{{ receipt.total | price }}</span>\n                    </b>\n                  </div>\n                  <div class=\"card-body pr-2 pl-2 pt-1 check-flow\" style=\"height: 150px;\">\n                    <div class=\"text-center p-3\">\n                      <i *ngIf=\"receipt.status == 1\" class=\"fa fa-hand-paper-o fa-4x\" aria-hidden=\"true\"></i>\n                      <i *ngIf=\"receipt.status == 2\" class=\"fa fa-circle-o-notch fa-spin fa-4x\" aria-hidden=\"true\"></i>\n                      <i *ngIf=\"receipt.status == 3\" class=\"fa fa-check fa-4x\" aria-hidden=\"true\"></i>\n                      <i *ngIf=\"receipt.status == 4\" class=\"fa fa-times fa-4x\" aria-hidden=\"true\"></i>\n                      <p class=\"mt-3\"><b>{{paymentStatus(receipt.status)}}</b></p>\n                    </div>\n\n\n                    <!-- <div *ngFor=\"let product of order.items\" class=\"check-product\">\n                      <div class=\"product-name\">\n                        {{product.name}} {{product.type | titlecase}}\n                        <p *ngIf=\"product.note\"><small>{{product.note}}</small></p>\n                      </div>\n                      <div class=\"product-price\">\n                        {{product.price | price }}\n                      </div>\n                    </div> -->\n                  </div>\n                  <div class=\"card-footer p-2\">\n                    <div *ngIf=\"receipt.status == 1\" class=\"btn-group btn-group-justify btn-block\">\n                      <button type=\"button\" [disabled]=\"!isOwner(receipt.check)\" (click)=\"cancelReceipt(receipt)\" oneShot class=\"btn btn-danger \">İptal</button>\n                      <button type=\"button\" [disabled]=\"!isOwner(receipt.check)\" (click)=\"acceptReceipt(receipt)\" oneShot class=\"btn btn-success btn-block\">Onayla</button>\n                    </div>\n                    <button *ngIf=\"receipt.status == 2 && receipt.method !== 4\" [disabled]=\"!isOwner(receipt.check)\" type=\"button\" (click)=\"approoveReceipt(receipt)\" oneShot class=\"btn btn-success btn-block\">Tamamla</button>\n                    <!-- <button *ngIf=\"receipt.status == 2 \" type=\"button\" (click)=\"approoveReceipt(receipt)\" oneShot class=\"btn btn-success btn-block\">Tamamla</button> -->\n                    <h5 *ngIf=\"receipt.status == 2 && receipt.method == 4\" class=\"text-center mb-2 mt-2\">Mobil Ödeme Bekleniyor</h5>\n                    <h4 *ngIf=\"receipt.status == 3\" class=\"text-center mb-1 mt-1\">Ödeme Tamamlandı</h4>\n                    <h4 *ngIf=\"receipt.status == 4\" class=\"text-center mb-1 mt-1\">İptal Edildi</h4>\n                  </div>\n                </div>\n              </div>\n            </ng-container>\n          </div>\n        </section>\n      </div>\n\n      <div *ngIf=\"section == 'Calls'\" class=\"card-body p-0 flow\">\n        <table class=\"table  table-bordered table-striped table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"5%\">#</th>\n              <th width=\"10%\">Hat</th>\n              <th width=\"55%\">Numara</th>\n              <th width=\"15%\">Saat</th>\n              <th width=\"15%\">Tarih</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let call of calls let i = index;\">\n              <td>{{i+1}}</td>\n              <td>{{call.line}}</td>\n              <td>{{call.number |  mask: '0 (000) 000 00 00' }}</td>\n              <td>{{call.timestamp | date:\"HH:mm\" }}</td>\n              <td>{{call.timestamp | date:\"dd/MM/y\" }}</td>\n            </tr>\n          </tbody>\n        </table>\n        <h3 *ngIf=\"calls == undefined || calls.length == 0\" class=\"text-center mt-5\">Çağrı Yok</h3>\n      </div>\n\n      <!-- <div *ngIf=\"section == 'Paket Servis'\" class=\"card-body p-0 flow\">\n        <table class=\"table  table-bordered table-striped table-hover\">\n          <thead class=\"thead-dark\">\n            <tr>\n              <th width=\"7%\">#</th>\n              <th width=\"33%\">Müşteri</th>\n              <th width=\"20%\">Tutar</th>\n              <th width=\"13%\">Saat</th>\n              <th width=\"17%\">Kullanıcı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let check of closedDelivery let i = index;\"  [routerLink]=\"['/selling-screen','Order', check._id]\" [ngClass]=\"{'table-warning text-dark': check.status == 1}\">\n              <td>{{i+1}}</td>\n              <td>{{check.note}}</td>\n              <td>{{check.total_price + check.discount | price}}\n                <small *ngIf=\"check.discount > 0\" class=\"pull-right text-danger\">\n                  <i class=\"fa fa-arrow-down\" aria-hidden=\"true\"></i> {{check.discount | price}}\n                </small>\n              </td>\n              <td>{{check.timestamp | date:\"HH:mm\" }}</td>\n              <td>{{check.owner}}</td>\n            </tr>\n          </tbody>\n        </table>\n        <h3 *ngIf=\"closedDelivery == undefined || closedDelivery.length == 0\" class=\"text-center mt-5\">Çağrı Yok</h3>\n      </div> -->\n\n    </div>\n  </div>\n  <div id=\"floorHolder\" class=\"col-lg-2\">\n    <div [routerLink]=\"['/selling-screen','Fast', 'New']\" class=\"card mb-2 bg-info text-white\">\n      <div class=\"card-body\">\n        <h2 class=\"mt-2\"><i class=\"fa fa-sticky-note\" aria-hidden=\"true\"></i> Hızlı Hesap</h2>\n      </div>\n    </div>\n    <div class=\"card mb-2\" (click)=\"getTablesBy('All')\" [ngClass]=\"{'bg-danger text-white':selected == ''}\">\n      <div class=\"card-body\">\n        <h2 class=\"mt-2\">Tüm Masalar</h2>\n      </div>\n    </div>\n    <div *ngFor=\"let floor of floors\" (click)=\"getTablesBy(floor._id)\" class=\"card mb-2\" [ngClass]=\"{'bg-danger text-white':selected == floor._id}\">\n      <div class=\"card-body\">\n        <h2 class=\"mt-2\">{{floor.name}}</h2>\n      </div>\n    </div>\n  </div>\n</div>\n";

/***/ }),

/***/ "./src/app/components/store/store.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("./node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "#floorHolder .card {\n  height: 68.1px; }\n\n#floorHolder .card-body {\n  padding: 0.75rem; }\n\n#floorHolder h2 {\n  font-size: 1.7vw;\n  font-weight: bolder;\n  text-transform: capitalize; }\n\n.normal {\n  width: auto !important; }\n\n.nav-link {\n  font-size: 1.4vw; }\n\n.nav-link.active {\n  background-color: #4e5d6c;\n  border-color: #43505e;\n  border-bottom-color: #4e5d6c; }\n\n.check-card {\n  height: 288px;\n  margin-bottom: 5px; }\n  .check-card .card-header span.float-left {\n    width: 62%;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap; }\n  .check-card .card-body {\n    height: 200px;\n    overflow: hidden; }\n\n.check-product {\n  border-bottom: 1px dashed #5b6977;\n  font-size: 13px;\n  color: #1b2731; }\n\n.relativeTable {\n  position: absolute !important;\n  -webkit-box-shadow: 1px 1px 4px #2b3e50;\n          box-shadow: 1px 1px 4px #2b3e50;\n  overflow: hidden; }\n\n.tableInfo {\n  position: absolute;\n  bottom: 5px;\n  width: 85%; }\n\n.absTableInfo {\n  margin-top: 16px;\n  bottom: 5px;\n  width: 100%; }\n\n@media screen and (min-width: 900px) {\n  #plan {\n    position: relative;\n    -webkit-transform: scaleX(0.75) scaleY(0.8);\n            transform: scaleX(0.75) scaleY(0.8);\n    left: -110px;\n    -webkit-box-flex: 1;\n        -ms-flex: 1 1 auto;\n            flex: 1 1 auto; } }\n\n@media screen and (min-width: 1200px) {\n  #plan {\n    position: relative;\n    -webkit-transform: scaleX(1) scaleY(1);\n            transform: scaleX(1) scaleY(1);\n    left: 0px !important;\n    -webkit-box-flex: 1;\n        -ms-flex: 1 1 auto;\n            flex: 1 1 auto; } }\n\n#err {\n  position: fixed;\n  text-align: center;\n  top: 50%;\n  width: 79%; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "./src/app/components/store/store.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return StoreComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mocks_check__ = __webpack_require__("./src/app/mocks/check.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mocks_order__ = __webpack_require__("./src/app/mocks/order.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__ = __webpack_require__("./src/app/mocks/receipt.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







;
let StoreComponent = class StoreComponent {
    constructor(mainService, router, settingsService) {
        this.mainService = mainService;
        this.router = router;
        this.settingsService = settingsService;
        this.floors = [];
        this.tables = [];
        this.tableViews = [];
        this.checks = [];
        this.checksView = [];
        this.fastChecks = [];
        this.deliveryChecks = [];
        this.products = [];
        this.orders = [];
        this.ordersView = [];
        this.receipts = [];
        this.receiptsView = [];
        this.waitingOrders = 0;
        this.waitingReceipts = 0;
        this.countProductsData = (counDataArray, id, price, manuelCount) => {
            let countObj;
            if (manuelCount) {
                countObj = { product: id, count: manuelCount, total: price };
            }
            else {
                countObj = { product: id, count: 1, total: price };
            }
            let contains = counDataArray.some(obj => obj.product === id);
            if (contains) {
                let index = counDataArray.findIndex(p_id => p_id.product == id);
                if (manuelCount) {
                    counDataArray[index].count += manuelCount;
                }
                else {
                    counDataArray[index].count++;
                }
                counDataArray[index].total += price;
            }
            else {
                counDataArray.push(countObj);
            }
            return counDataArray;
        };
        this.updateProductReport = async (count_data) => {
            try {
                const StoreDayInfo = await (await this.mainService.LocalDB['allData'].find({ selector: { key: 'DateSettings' } })).docs[0].value;
                const Month = new Date(StoreDayInfo.time).getMonth();
                count_data.forEach(async (obj) => {
                    const ProductReport = await (await this.mainService.LocalDB['allData'].find({ selector: { db_name: 'reports', connection_id: obj.product } })).docs[0];
                    const ProductRecipe = await (await this.mainService.LocalDB['allData'].find({ selector: { db_name: 'recipes', product_id: obj.product } })).docs[0];
                    if (ProductReport) {
                        this.mainService.LocalDB['allData'].upsert(ProductReport._id, (doc) => {
                            doc.count += obj.count;
                            doc.amount += obj.total;
                            doc.timestamp = Date.now();
                            doc.weekly[StoreDayInfo.day] += obj.total;
                            doc.weekly_count[StoreDayInfo.day] += obj.count;
                            doc.monthly[Month] += obj.total;
                            doc.weekly_count[Month] += obj.count;
                            return doc;
                        });
                    }
                    if (ProductRecipe) {
                        ProductRecipe.forEach(ingredient => {
                            let downStock = ingredient.amount * obj.count;
                            this.mainService.LocalDB['allData'].upsert(ingredient.stock_id, (doc) => {
                                doc.left_total -= downStock;
                                doc.quantity = doc.left_total / doc.total;
                                if (doc.left_total < doc.warning_limit) {
                                    if (doc.left_total <= 0) {
                                        doc.left_total = 0;
                                        // this.logService.createLog(logType.STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok tükendi!`);
                                    }
                                    else {
                                        // this.logService.createLog(logType.STOCK_CHECKPOINT, doc._id, `${doc.name} adlı stok bitmek üzere! - Kalan: '${doc.left_total + ' ' + doc.unit}'`);
                                    }
                                }
                                return doc;
                            });
                        });
                    }
                });
                return true;
            }
            catch (error) {
                console.log(error);
            }
        };
        this.owner = this.settingsService.getUser('name');
        this.ownerId = this.settingsService.getUser('id');
        this.fillData();
        if (localStorage.getItem('selectedSection')) {
            let selectedSection = localStorage['selectedSection'];
            this.section = selectedSection;
        }
        else {
            this.section = 'Masalar';
        }
    }
    ngOnInit() {
        this.checkChanges = this.mainService.LocalDB['checks'].changes({ since: 'now', live: true }).on('change', (change) => {
            this.mainService.getAllBy('checks', {}).then((result) => {
                this.checks = result.docs;
                if (localStorage.getItem('selectedFloor')) {
                    let selectedID = JSON.parse(localStorage['selectedFloor']);
                    this.getTablesBy(selectedID);
                }
            });
        });
        this.orderChanges = this.mainService.LocalDB['orders'].changes({ since: 'now', live: true }).on('change', (change) => {
            this.mainService.getAllBy('orders', { type: { $ne: __WEBPACK_IMPORTED_MODULE_4__mocks_order__["c" /* OrderType */].EMPLOOYEE } }).then((result) => {
                this.orders = result.docs;
                this.ordersView = this.orders.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING);
                this.waitingOrders = this.ordersView.length;
            });
        });
        this.receiptChanges = this.mainService.LocalDB['receipts'].changes({ since: 'now', live: true }).on('change', (change) => {
            this.mainService.getAllBy('receipts', {}).then((result) => {
                this.receipts = result.docs;
                this.receiptsView = this.receipts.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY);
                this.waitingReceipts = this.receiptsView.length;
            });
        });
        this.tableChanges = this.mainService.LocalDB['tables'].changes({ since: 'now', live: true }).on('change', (change) => {
            this.mainService.getAllBy('tables', {}).then((result) => {
                this.tables = result.docs;
                this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name, 'tr', { numeric: true, sensitivity: 'base' }));
                this.tableViews = this.tables;
                if (localStorage.getItem('selectedFloor')) {
                    let selectedID = JSON.parse(localStorage['selectedFloor']);
                    this.getTablesBy(selectedID);
                }
            });
        });
    }
    ngOnDestroy() {
        this.tableChanges.cancel();
        this.checkChanges.cancel();
        this.orderChanges.cancel();
        this.receiptChanges.cancel();
    }
    changeSection(section) {
        this.section = section;
        localStorage.setItem('selectedSection', section);
    }
    getTablesBy(id) {
        if (id !== 'All') {
            this.selected = id;
            localStorage.setItem('selectedFloor', JSON.stringify(id));
            this.tableViews = this.tables.filter(obj => obj.floor_id == id);
            this.checksView = this.checks.filter(({ table_id }) => this.tableViews.some(table => table._id == table_id));
            this.ordersView = this.orders.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING).filter(({ check }) => this.checksView.some(obj => obj._id == check));
            this.receiptsView = this.receipts.sort((a, b) => b.timestamp - a.timestamp).filter(receipt => receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING || receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY).filter(({ check }) => this.checksView.some(obj => obj._id == check));
        }
        else {
            this.selected = '';
            this.tableViews = this.tables;
            this.checksView = this.checks;
            this.ordersView = this.orders.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING);
            this.receiptsView = this.receipts.sort((a, b) => b.timestamp - a.timestamp).filter(receipt => receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING || receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY);
            localStorage.removeItem('selectedFloor');
        }
    }
    getTableTotal(table_id) {
        let thatCheck = this.checks.find(check => check.table_id == table_id);
        if (thatCheck) {
            return thatCheck.total_price;
        }
        else {
            return null;
        }
    }
    changePosition(value, table) {
        console.log('x', value);
        console.log('y', value.layerY, value.offsetY);
        table.position.x += value.layerX;
        table.position.y += value.layerY;
        this.mainService.updateData('tables', table._id, { position: { x: Math.round(table.position.x), y: Math.round(table.position.y), height: table.position.height, width: table.position.width } });
        // let tabletoGo = this.loweredTables.find(({ name }) => name == value);
        // this.router.navigate(['/selling-screen', 'Normal', tabletoGo._id])
    }
    dragStart(value, table) {
        console.log('x', value);
        console.log('y', value.layerY, value.offsetY);
    }
    filterTables(value) {
        let regexp = new RegExp(value, 'i');
        this.tableViews = this.tables.filter(({ name }) => name.match(regexp));
        this.checksView = this.checks.filter(({ table_id }) => this.tableViews.some(table => table._id == table_id));
        this.ordersView = this.orders.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING).filter(({ check }) => this.checksView.some(obj => obj._id == check));
        this.receiptsView = this.receipts.sort((a, b) => b.timestamp - a.timestamp).filter(receipt => receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING || receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY).filter(({ check }) => this.checksView.some(obj => obj._id == check));
    }
    statusNote(status) {
        switch (status) {
            case __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING:
                return "Onay Bekliyor";
            case __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING:
                return "Hazırlanıyor";
            case __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].APPROVED:
                return "Onaylandı";
            case __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].CANCELED:
                return "İptal Edildi";
            case __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PAYED:
                return "Ödeme Yapıldı";
            default:
                break;
        }
    }
    acceptOrder(order) {
        order.status = __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING;
        this.mainService.updateData('orders', order._id, { status: __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING }).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    }
    approoveOrder(order) {
        order.status = __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].APPROVED;
        let approveTime = Date.now();
        this.mainService.updateData('orders', order._id, { status: __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].APPROVED, timestamp: approveTime }).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
        // this.mainService.changeData('checks', order.check, (check: Check) => {
        //   order.items.forEach(orderItem => {
        //     let mappedProduct = this.products.find(product => product._id == orderItem.product_id || product.name == orderItem.name);
        //     let newProduct = new CheckProduct(mappedProduct._id, mappedProduct.cat_id, mappedProduct.name + (orderItem.type ? ' ' + orderItem.type : ''), orderItem.price, orderItem.note, 2, this.ownerId, approveTime, mappedProduct.tax_value, mappedProduct.barcode,[]);
        //     this.countProductsData(CountData, newProduct.id, newProduct.price)
        //     check.total_price = check.total_price + newProduct.price;
        //     check.products.push(newProduct);
        //   })
        //   return check;
        // }).then(isOk => {
        //   this.mainService.updateData('orders', order._id, { status: OrderStatus.APPROVED, timestamp: approveTime }).then(res => {
        //     this.updateProductReport(CountData);
        //   }).catch(err => {
        //     console.log(err);
        //   })
        // }).catch(err => {
        //   console.log(err);
        // })
    }
    cancelOrder(order) {
        order.status = __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].CANCELED;
        this.mainService.updateData('orders', order._id, { status: __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].CANCELED }).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    }
    acceptReceipt(receipt) {
        receipt.status = __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY;
        receipt.timestamp = Date.now();
        this.mainService.updateData('receipts', receipt._id, { status: __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY }).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    }
    approoveReceipt(receipt) {
        // const orderRequestType: any = this.checks.find(check => check._id == receipt.check);
        // switch (receipt.type == ReceiptType.) {
        // case 'checks':
        let Check = this.checks.find(check => check._id == receipt.check);
        let User = receipt.user;
        let userItems = receipt.orders.filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].APPROVED);
        userItems.map(obj => {
            obj.status = __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PAYED;
            return obj;
        });
        let productsWillPay = Check.products.filter(product => userItems.map(obj => obj.timestamp).includes(product.timestamp));
        let receiptMethod = (receipt.method == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].CARD ? 'Kart' : receipt.method == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].CASH ? 'Nakit' : receipt.method == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].COUPON ? 'Kupon' : 'İkram');
        const newPayment = { owner: User.name, method: receiptMethod, amount: receipt.total, discount: receipt.discount, timestamp: Date.now(), payed_products: productsWillPay };
        if (Check.payment_flow == undefined) {
            Check.payment_flow = [];
        }
        Check.payment_flow.push(newPayment);
        Check.discount += newPayment.amount;
        Check.products = Check.products.filter(product => !productsWillPay.includes(product));
        Check.total_price = Check.products.map(product => product.price).reduce((a, b) => a + b, 0);
        receipt.status = __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].APPROVED;
        receipt.timestamp = Date.now();
        this.mainService.LocalDB['allData'].bulkDocs(userItems).then(order_res => {
            this.mainService.updateData('receipts', receipt._id, { status: __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].APPROVED, timestamp: Date.now() }).then(isOK => {
                this.mainService.updateData('checks', Check._id, Check).then(isCheckUpdated => {
                    if (isCheckUpdated.updated) {
                    }
                }).catch(err => {
                    console.log('Check Update Error on Payment Process', err);
                });
            }).catch(err => {
                console.log('Receipt Update Error on Payment Process', err);
            });
        }).catch(err => {
            console.log('Orders Update Error on Payment Process', err);
        });
        //   break;
        // case 'customers':
        //   let Customer = orderRequestType;
        //   receipt.status = ReceiptStatus.APPROVED;
        //   delete receipt.orders[0]._rev;
        //   this.mainService.LocalDB['allData'].put(receipt.orders[0]).then(order_res => {
        //     receipt.orders[0].status = OrderStatus.PREPARING;
        //     delete receipt._rev;
        //     this.mainService.LocalDB['allData'].put(receipt).then(isOk => {
        //     }).catch(err => {
        //       console.log(err);
        //     })
        //   }).catch(err => {
        //     console.log(err);
        //   })
        //   break;
        // default:
        //   break;
        // }
    }
    cancelReceipt(receipt) {
        receipt.status = __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].CANCELED;
        receipt.timestamp = Date.now();
        this.mainService.updateData('receipts', receipt._id, { status: __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].CANCELED }).then(res => {
            console.log(res);
        }).catch(err => {
            console.log(err);
        });
    }
    paymentNote(method) {
        switch (method) {
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].CASH:
                return "Nakit";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].CARD:
                return "Kredi Kartı";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].COUPON:
                return "Yemek Kartı - Kupon";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].MOBILE:
                return "Mobil Ödeme";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["a" /* ReceiptMethod */].CRYPTO:
                return "Bitcoin";
            default:
                break;
        }
    }
    paymentStatus(status) {
        switch (status) {
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING:
                return "Onay Bekliyor";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY:
                return "İşlemde";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].APPROVED:
                return "Onaylandı";
            case __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].CANCELED:
                return "İptal Edildi";
            default:
                break;
        }
    }
    isOwner(check_id) {
        const checkThatProcess = this.checks.find(obj => obj._id == check_id);
        return (checkThatProcess.owner == this.owner ? true : false);
    }
    checkOwner(check_id) {
        const checkThatProcess = this.checks.find(obj => obj._id == check_id);
        return checkThatProcess.owner;
    }
    fillData() {
        this.selected = '';
        this.mainService.getAllBy('calls', {}).then((result) => {
            this.calls = result.docs.sort((a, b) => b.timestamp - a.timestamp);
        });
        this.mainService.getAllBy('products', {}).then((result) => {
            this.products = result.docs;
        });
        this.mainService.getAllBy('floors', {}).then((result) => {
            this.floors = result.docs;
            this.floors = this.floors.sort((a, b) => a.timestamp - b.timestamp);
        });
        this.mainService.getAllBy('checks', {}).then(res => {
            this.checks = res.docs;
            this.checksView = this.checks;
            this.fastChecks = this.checks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].FAST);
            this.deliveryChecks = this.checks.filter(obj => obj.type == __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER);
        });
        this.mainService.getAllBy('closed_checks', { type: __WEBPACK_IMPORTED_MODULE_3__mocks_check__["e" /* CheckType */].ORDER }).then(res => {
            this.closedDelivery = res.docs.sort((a, b) => b.timestamp - a.timestamp);
            try {
                this.deliveryChecks.forEach(check => {
                    this.closedDelivery.unshift(check);
                });
            }
            catch (error) {
                console.log(error);
            }
        });
        this.mainService.getAllBy('orders', { type: { $ne: __WEBPACK_IMPORTED_MODULE_4__mocks_order__["c" /* OrderType */].EMPLOOYEE } }).then(res => {
            this.orders = res.docs;
            this.ordersView = this.orders.sort((a, b) => b.timestamp - a.timestamp).filter(order => order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].WAITING || order.status == __WEBPACK_IMPORTED_MODULE_4__mocks_order__["b" /* OrderStatus */].PREPARING);
            this.waitingOrders = this.ordersView.length;
        });
        this.mainService.getAllBy('receipts', {}).then(res => {
            this.receipts = res.docs;
            this.receiptsView = this.receipts.sort((a, b) => b.timestamp - a.timestamp).filter(receipt => receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].WAITING || receipt.status == __WEBPACK_IMPORTED_MODULE_6__mocks_receipt__["b" /* ReceiptStatus */].READY);
            this.waitingReceipts = this.receiptsView.length;
        });
        this.mainService.getAllBy('tables', {}).then((result) => {
            this.tables = result.docs;
            this.tables = this.tables.sort((a, b) => a.name.localeCompare(b.name, 'tr', { numeric: true, sensitivity: 'base' }));
            this.loweredTables = JSON.parse(JSON.stringify(result.docs));
            this.loweredTables.map(obj => {
                obj.name = obj.name.replace(/-/g, '').toLowerCase();
                return obj;
            });
            this.tableViews = this.tables;
            if (localStorage.getItem('selectedFloor')) {
                let selectedID = JSON.parse(localStorage['selectedFloor']);
                this.getTablesBy(selectedID);
            }
        });
    }
    findTable(check_id) {
        const check = this.checks.find(obj => obj._id == check_id);
        const table = this.tables.find(obj => obj._id == check.table_id);
        return table.name;
    }
    checkItems(check) {
        if (check.products.length > 0) {
            let viewArray = [];
            check.products.forEach(item => {
                if (viewArray.some(obj => obj.name == item.name && obj.id == item.id && obj.status == item.status && obj.note == item.note && obj.timeout == item.timeout)) {
                    viewArray[viewArray.findIndex(obj => obj.name == item.name && obj.id == item.id && obj.status == item.status && obj.note == item.note && obj.timeout == item.timeout)].quantity++;
                }
                else {
                    let viewItem = { id: item.id, name: item.name, note: item.note, quantity: 1, price: item.price, status: item.status };
                    if (item.timeout) {
                        viewItem.timeout = item.timeout;
                    }
                    viewArray.push(viewItem);
                }
            });
            return viewArray.sort((a, b) => {
                if (a.status > b.status) {
                    return -1;
                }
                else if (a.status < b.status) {
                    return 1;
                }
                else {
                    return b.quantity - a.quantity;
                }
            });
        }
        else {
            return [];
        }
    }
};
StoreComponent = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-store',
        template: __webpack_require__("./src/app/components/store/store.component.html"),
        styles: [__webpack_require__("./src/app/components/store/store.component.scss")]
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_5__services_settings_service__["a" /* SettingsService */]])
], StoreComponent);



/***/ }),

/***/ "./src/app/directives/button.directive.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ButtonDirective; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let ButtonDirective = class ButtonDirective {
    constructor(element) {
        this.element = element;
        if (this.isActive) {
            this.isActive = true;
        }
    }
    onClick() {
        if (this.isActive) {
            this.element.nativeElement.disabled = true;
        }
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])('oneShot'),
    __metadata("design:type", Object)
], ButtonDirective.prototype, "isActive", void 0);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('click'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], ButtonDirective.prototype, "onClick", null);
ButtonDirective = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[oneShot]'
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]])
], ButtonDirective);



/***/ }),

/***/ "./src/app/directives/keyboard.directive.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return KeyboardDirective; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__providers_keyboard_service__ = __webpack_require__("./src/app/providers/keyboard.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let KeyboardDirective = class KeyboardDirective {
    constructor(element, keyboardService, renderer) {
        this.element = element;
        this.keyboardService = keyboardService;
        this.renderer = renderer;
        this.onAir = false;
    }
    onClick(event) {
        this.keyboardService.triggerKeyboard('Open', this.element);
        let inputElement = this.element.nativeElement;
        // console.log(inputElement.getBoundingClientRect()); 
    }
    onInput() {
        this.element.nativeElement.focus();
        // console.log(this.element.nativeElement.selectionStart);
    }
    onBlur() {
        // this.keyboardService.triggerKeyboard('Close', this.element);
    }
};
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('click'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], KeyboardDirective.prototype, "onClick", null);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('input'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], KeyboardDirective.prototype, "onInput", null);
__decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('blur'),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], KeyboardDirective.prototype, "onBlur", null);
KeyboardDirective = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: 'input:not([type="checkbox"]):not([id="keyboardElement"]):not([readonly]),textarea:not([readonly])'
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"], __WEBPACK_IMPORTED_MODULE_1__providers_keyboard_service__["a" /* KeyboardService */], __WEBPACK_IMPORTED_MODULE_0__angular_core__["Renderer2"]])
], KeyboardDirective);



/***/ }),

/***/ "./src/app/guards/auth.guard.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return CanActivateViaAuthGuard; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AnonymousCanActivate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return SetupFinished; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return DayStarted; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_auth_service__ = __webpack_require__("./src/app/services/auth.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let CanActivateViaAuthGuard = class CanActivateViaAuthGuard {
    constructor(authService) {
        this.authService = authService;
    }
    canActivate(route, state) {
        return this.authService.isAuthed(state.url);
    }
};
CanActivateViaAuthGuard = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__services_auth_service__["a" /* AuthService */]])
], CanActivateViaAuthGuard);

let AnonymousCanActivate = class AnonymousCanActivate {
    constructor(authService) {
        this.authService = authService;
    }
    canActivate() {
        return !this.authService.isAnonymous();
    }
};
AnonymousCanActivate = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__services_auth_service__["a" /* AuthService */]])
], AnonymousCanActivate);

let SetupFinished = class SetupFinished {
    constructor(settings) {
        this.settings = settings;
    }
    canActivate() {
        return true;
    }
};
SetupFinished = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_4__services_settings_service__["a" /* SettingsService */]])
], SetupFinished);

let DayStarted = class DayStarted {
    constructor(settings, messageService, router) {
        this.settings = settings;
        this.messageService = messageService;
        this.router = router;
    }
    canActivate() {
        let Status = JSON.parse(localStorage.getItem('DayStatus'));
        let isStarted = Status.started;
        if (isStarted == false) {
            this.messageService.sendAlert('Dikkat', 'Lütfen Gün Başlangıcı Yapınız', 'warning');
            this.router.navigate(['/endoftheday']);
        }
        return isStarted;
    }
};
DayStarted = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_4__services_settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_2__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */]])
], DayStarted);



/***/ }),

/***/ "./src/app/mocks/cashbox.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export CashboxType */
class Cashbox {
    constructor(type, description, timestamp, cash, card, coupon, user, category, _id, _rev) {
        this.type = type;
        this.description = description;
        this.timestamp = timestamp;
        this.cash = cash;
        this.card = card;
        this.coupon = coupon;
        this.user = user;
        this.category = category;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Cashbox;

class CashboxCategory {
    constructor(name, description, timestamp, _id, _rev) {
        this.name = name;
        this.description = description;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = CashboxCategory;

var CashboxType;
(function (CashboxType) {
    CashboxType[CashboxType["PASSIVE"] = 0] = "PASSIVE";
    CashboxType[CashboxType["INCOME"] = 1] = "INCOME";
    CashboxType[CashboxType["OUTCOME"] = 2] = "OUTCOME";
})(CashboxType || (CashboxType = {}));


/***/ }),

/***/ "./src/app/mocks/check.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return CheckType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return CheckStatus; });
/* unused harmony export CheckProductStatus */
/* harmony export (immutable) */ __webpack_exports__["b"] = CheckNo;
class Check {
    constructor(table_id, total_price, discount, owner, note, status, products, timestamp, type, check_no, payment_flow, discountPercent, freeAmount, _id, _rev) {
        this.table_id = table_id;
        this.total_price = total_price;
        this.discount = discount;
        this.owner = owner;
        this.note = note;
        this.status = status;
        this.products = products;
        this.timestamp = timestamp;
        this.type = type;
        this.check_no = check_no;
        this.payment_flow = payment_flow;
        this.discountPercent = discountPercent;
        this.freeAmount = freeAmount;
        this._id = _id;
        this._rev = _rev;
        this.occupation = { male: 0, female: 0 };
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Check;

class ClosedCheck {
    constructor(table_id, total_price, discount, owner, note, status, products, timestamp, type, payment_method, payment_flow, description, occupation, _id, _rev) {
        this.table_id = table_id;
        this.total_price = total_price;
        this.discount = discount;
        this.owner = owner;
        this.note = note;
        this.status = status;
        this.products = products;
        this.timestamp = timestamp;
        this.type = type;
        this.payment_method = payment_method;
        this.payment_flow = payment_flow;
        this.description = description;
        this.occupation = occupation;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["f"] = ClosedCheck;

class PaymentStatus {
    constructor(owner, method, amount, discount, timestamp, payed_products) {
        this.owner = owner;
        this.method = method;
        this.amount = amount;
        this.discount = discount;
        this.timestamp = timestamp;
        this.payed_products = payed_products;
    }
}
/* harmony export (immutable) */ __webpack_exports__["g"] = PaymentStatus;

class CheckProduct {
    constructor(id, cat_id, name, price, note, status, owner, timestamp, tax_value, barcode, extras, timeout) {
        this.id = id;
        this.cat_id = cat_id;
        this.name = name;
        this.price = price;
        this.note = note;
        this.status = status;
        this.owner = owner;
        this.timestamp = timestamp;
        this.tax_value = tax_value;
        this.barcode = barcode;
        this.extras = extras;
        this.timeout = timeout;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = CheckProduct;

var CheckType;
(function (CheckType) {
    CheckType[CheckType["PASSIVE"] = 0] = "PASSIVE";
    CheckType[CheckType["NORMAL"] = 1] = "NORMAL";
    CheckType[CheckType["FAST"] = 2] = "FAST";
    CheckType[CheckType["CANCELED"] = 3] = "CANCELED";
    CheckType[CheckType["PROCESSING"] = 4] = "PROCESSING";
    CheckType[CheckType["ORDER"] = 5] = "ORDER";
    CheckType[CheckType["PREORDER"] = 6] = "PREORDER";
    CheckType[CheckType["SELF"] = 7] = "SELF";
})(CheckType || (CheckType = {}));
var CheckStatus;
(function (CheckStatus) {
    CheckStatus[CheckStatus["PASSIVE"] = 0] = "PASSIVE";
    CheckStatus[CheckStatus["READY"] = 1] = "READY";
    CheckStatus[CheckStatus["OCCUPIED"] = 2] = "OCCUPIED";
    CheckStatus[CheckStatus["PROCESSING"] = 3] = "PROCESSING";
})(CheckStatus || (CheckStatus = {}));
var CheckProductStatus;
(function (CheckProductStatus) {
    CheckProductStatus[CheckProductStatus["PASSIVE"] = 0] = "PASSIVE";
    CheckProductStatus[CheckProductStatus["READY"] = 1] = "READY";
    CheckProductStatus[CheckProductStatus["LOCKED"] = 2] = "LOCKED";
    CheckProductStatus[CheckProductStatus["CANCELED"] = 3] = "CANCELED";
    CheckProductStatus[CheckProductStatus["ONMARCH"] = 4] = "ONMARCH";
})(CheckProductStatus || (CheckProductStatus = {}));
function CheckNo() {
    // let currentID = parseInt(localStorage.getItem('CheckNo'));
    // let CheckNo = currentID+1;
    // localStorage.setItem('CheckNo', CheckNo.toString());
    let CheckNo = Math.floor(Math.random() * Math.floor(500));
    return CheckNo;
}


/***/ }),

/***/ "./src/app/mocks/customer.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return CustomerType; });
class Customer {
    constructor(name, surname, phone_number, address, picture, type, timestamp, _id, _rev) {
        this.name = name;
        this.surname = surname;
        this.phone_number = phone_number;
        this.address = address;
        this.picture = picture;
        this.type = type;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Customer;

class CustomerAccount {
    constructor(customer_id, points, limit, _id, _rev) {
        this.customer_id = customer_id;
        this.points = points;
        this.limit = limit;
        this._id = _id;
        this._rev = _rev;
    }
}
/* unused harmony export CustomerAccount */

var CustomerType;
(function (CustomerType) {
    CustomerType[CustomerType["NEAR"] = 0] = "NEAR";
    CustomerType[CustomerType["FAR"] = 1] = "FAR";
})(CustomerType || (CustomerType = {}));


/***/ }),

/***/ "./src/app/mocks/endoftheday.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
class EndDay {
    constructor(timestamp, owner, total_income, cash_total, card_total, coupon_total, free_total, canceled_total, discount_total, check_count, incomes, outcomes, customers, data_file, is_synchronized, _id, _rev) {
        this.timestamp = timestamp;
        this.owner = owner;
        this.total_income = total_income;
        this.cash_total = cash_total;
        this.card_total = card_total;
        this.coupon_total = coupon_total;
        this.free_total = free_total;
        this.canceled_total = canceled_total;
        this.discount_total = discount_total;
        this.check_count = check_count;
        this.incomes = incomes;
        this.outcomes = outcomes;
        this.customers = customers;
        this.data_file = data_file;
        this.is_synchronized = is_synchronized;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = EndDay;

class BackupData {
    constructor(database, docs) {
        this.database = database;
        this.docs = docs;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = BackupData;



/***/ }),

/***/ "./src/app/mocks/log.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return logType; });
class Log {
    constructor(type, user, connection_id, description, status, timestamp, _id, _rev) {
        this.type = type;
        this.user = user;
        this.connection_id = connection_id;
        this.description = description;
        this.status = status;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Log;

var logType;
(function (logType) {
    logType[logType["CHECK_CREATED"] = 0] = "CHECK_CREATED";
    logType[logType["CHECK_CLOSED"] = 1] = "CHECK_CLOSED";
    logType[logType["CHECK_PAYED"] = 2] = "CHECK_PAYED";
    logType[logType["CHECK_MOVED"] = 3] = "CHECK_MOVED";
    logType[logType["CHECK_CANCELED"] = 4] = "CHECK_CANCELED";
    logType[logType["CHECK_UPDATED"] = 5] = "CHECK_UPDATED";
    logType[logType["ORDER_CREATED"] = 6] = "ORDER_CREATED";
    logType[logType["ORDER_CANCELED"] = 7] = "ORDER_CANCELED";
    logType[logType["ORDER_MOVED"] = 8] = "ORDER_MOVED";
    logType[logType["STOCK_CREATED"] = 9] = "STOCK_CREATED";
    logType[logType["STOCK_DELETED"] = 10] = "STOCK_DELETED";
    logType[logType["STOCK_UPDATED"] = 11] = "STOCK_UPDATED";
    logType[logType["STOCK_CHECKPOINT"] = 12] = "STOCK_CHECKPOINT";
    logType[logType["USER_CREATED"] = 13] = "USER_CREATED";
    logType[logType["USER_DELETED"] = 14] = "USER_DELETED";
    logType[logType["USER_UPDATED"] = 15] = "USER_UPDATED";
    logType[logType["USER_CHECKPOINT"] = 16] = "USER_CHECKPOINT";
    logType[logType["PRODUCT_CREATED"] = 17] = "PRODUCT_CREATED";
    logType[logType["PRODUCT_DELETED"] = 18] = "PRODUCT_DELETED";
    logType[logType["PRODUCT_UPDATED"] = 19] = "PRODUCT_UPDATED";
    logType[logType["PRODUCT_CHECKPOINT"] = 20] = "PRODUCT_CHECKPOINT";
    logType[logType["TABLE_CREATED"] = 21] = "TABLE_CREATED";
    logType[logType["TABLE_DELETED"] = 22] = "TABLE_DELETED";
    logType[logType["TABLE_UPDATED"] = 23] = "TABLE_UPDATED";
    logType[logType["TABLE_CHECKPOINT"] = 24] = "TABLE_CHECKPOINT";
    logType[logType["CASHBOX_CREATED"] = 25] = "CASHBOX_CREATED";
    logType[logType["CASHBOX_DELETED"] = 26] = "CASHBOX_DELETED";
    logType[logType["CASHBOX_UPDATED"] = 27] = "CASHBOX_UPDATED";
    logType[logType["DISCOUNT"] = 28] = "DISCOUNT";
    logType[logType["CUSTOMER_CREATED"] = 29] = "CUSTOMER_CREATED";
    logType[logType["CUSTOMER_DELETED"] = 30] = "CUSTOMER_DELETED";
    logType[logType["CUSTOMER_UPDATED"] = 31] = "CUSTOMER_UPDATED";
    logType[logType["CUSTOMER_CHECKPOINT"] = 32] = "CUSTOMER_CHECKPOINT";
})(logType || (logType = {}));


/***/ }),

/***/ "./src/app/mocks/order.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return OrderType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return OrderStatus; });
class Order {
    constructor(check, user, items, status, type, timestamp, timeout, edited, _id, _rev) {
        this.check = check;
        this.user = user;
        this.items = items;
        this.status = status;
        this.type = type;
        this.timestamp = timestamp;
        this.timeout = timeout;
        this.edited = edited;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Order;

var OrderType;
(function (OrderType) {
    OrderType[OrderType["INSIDE"] = 0] = "INSIDE";
    OrderType[OrderType["OUTSIDE"] = 1] = "OUTSIDE";
    OrderType[OrderType["TAKEAWAY"] = 2] = "TAKEAWAY";
    OrderType[OrderType["EMPLOOYEE"] = 3] = "EMPLOOYEE";
    OrderType[OrderType["DEVICE"] = 4] = "DEVICE";
})(OrderType || (OrderType = {}));
var OrderStatus;
(function (OrderStatus) {
    OrderStatus[OrderStatus["WAITING"] = 0] = "WAITING";
    OrderStatus[OrderStatus["PREPARING"] = 1] = "PREPARING";
    OrderStatus[OrderStatus["APPROVED"] = 2] = "APPROVED";
    OrderStatus[OrderStatus["CANCELED"] = 3] = "CANCELED";
    OrderStatus[OrderStatus["PAYED"] = 4] = "PAYED";
})(OrderStatus || (OrderStatus = {}));


/***/ }),

/***/ "./src/app/mocks/print.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return PrintOutStatus; });
class PrintOut {
    constructor(type, status, connection, printer, cancelObj, _id, _rev) {
        this.type = type;
        this.status = status;
        this.connection = connection;
        this.printer = printer;
        this.cancelObj = cancelObj;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = PrintOut;

var PrintOutStatus;
(function (PrintOutStatus) {
    PrintOutStatus[PrintOutStatus["WAITING"] = 0] = "WAITING";
    PrintOutStatus[PrintOutStatus["PRINTED"] = 1] = "PRINTED";
    PrintOutStatus[PrintOutStatus["ERROR"] = 2] = "ERROR";
})(PrintOutStatus || (PrintOutStatus = {}));


/***/ }),

/***/ "./src/app/mocks/product.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return ProductType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return ProductStatus; });
class Category {
    constructor(name, description, status, printer, order, tags, _id, _rev) {
        this.name = name;
        this.description = description;
        this.status = status;
        this.printer = printer;
        this.order = order;
        this.tags = tags;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Category;

class SubCategory {
    constructor(cat_id, name, description, status, _id, _rev) {
        this.cat_id = cat_id;
        this.name = name;
        this.description = description;
        this.status = status;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["i"] = SubCategory;

class Occations {
    constructor(name, price_list) {
        this.name = name;
        this.price_list = price_list;
    }
}
/* unused harmony export Occations */

class OccationUnit {
    constructor(product_id, price) {
        this.product_id = product_id;
        this.price = price;
    }
}
/* unused harmony export OccationUnit */

class Product {
    constructor(cat_id, type, description, name, price, status, tax_value, barcode, notes, subcat_id, specifies, extras, _id, _rev) {
        this.cat_id = cat_id;
        this.type = type;
        this.description = description;
        this.name = name;
        this.price = price;
        this.status = status;
        this.tax_value = tax_value;
        this.barcode = barcode;
        this.notes = notes;
        this.subcat_id = subcat_id;
        this.specifies = specifies;
        this.extras = extras;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = Product;

class ProductGroup {
    constructor(cat_id, name, description, price, products, status, subcat_id, specifies, _id, _rev) {
        this.cat_id = cat_id;
        this.name = name;
        this.description = description;
        this.price = price;
        this.products = products;
        this.status = status;
        this.subcat_id = subcat_id;
        this.specifies = specifies;
        this._id = _id;
        this._rev = _rev;
    }
}
/* unused harmony export ProductGroup */

class ProductSpecs {
    constructor(spec_name, spec_price) {
        this.spec_name = spec_name;
        this.spec_price = spec_price;
    }
}
/* harmony export (immutable) */ __webpack_exports__["e"] = ProductSpecs;

class ProductExtras {
    constructor(extra_name, extra_price) {
        this.extra_name = extra_name;
        this.extra_price = extra_price;
    }
}
/* harmony export (immutable) */ __webpack_exports__["d"] = ProductExtras;

class Recipe {
    constructor(product_id, recipe, _id, _rev) {
        this.product_id = product_id;
        this.recipe = recipe;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["h"] = Recipe;

class Ingredient {
    constructor(stock_id, amount) {
        this.stock_id = stock_id;
        this.amount = amount;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = Ingredient;

var ProductType;
(function (ProductType) {
    ProductType[ProductType["PASSIVE"] = 0] = "PASSIVE";
    ProductType[ProductType["AUTOMATIC"] = 1] = "AUTOMATIC";
    ProductType[ProductType["MANUEL"] = 2] = "MANUEL";
})(ProductType || (ProductType = {}));
var ProductStatus;
(function (ProductStatus) {
    ProductStatus[ProductStatus["PASSIVE"] = 0] = "PASSIVE";
    ProductStatus[ProductStatus["ACTIVE"] = 1] = "ACTIVE";
    ProductStatus[ProductStatus["LOCKED"] = 2] = "LOCKED";
    ProductStatus[ProductStatus["CANCELED"] = 3] = "CANCELED";
})(ProductStatus || (ProductStatus = {}));


/***/ }),

/***/ "./src/app/mocks/receipt.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ReceiptMethod; });
/* unused harmony export ReceiptType */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ReceiptStatus; });
class Receipt {
    constructor(db_name, user, check, orders, total, discount, type, method, status, timestamp, note, _id, _rev) {
        this.db_name = db_name;
        this.user = user;
        this.check = check;
        this.orders = orders;
        this.total = total;
        this.discount = discount;
        this.type = type;
        this.method = method;
        this.status = status;
        this.timestamp = timestamp;
        this.note = note;
        this._id = _id;
        this._rev = _rev;
    }
}
/* unused harmony export Receipt */

var ReceiptMethod;
(function (ReceiptMethod) {
    ReceiptMethod[ReceiptMethod["UNDEFINED"] = 0] = "UNDEFINED";
    ReceiptMethod[ReceiptMethod["CASH"] = 1] = "CASH";
    ReceiptMethod[ReceiptMethod["CARD"] = 2] = "CARD";
    ReceiptMethod[ReceiptMethod["COUPON"] = 3] = "COUPON";
    ReceiptMethod[ReceiptMethod["MOBILE"] = 4] = "MOBILE";
    ReceiptMethod[ReceiptMethod["CRYPTO"] = 5] = "CRYPTO";
})(ReceiptMethod || (ReceiptMethod = {}));
var ReceiptType;
(function (ReceiptType) {
    ReceiptType[ReceiptType["ALL"] = 0] = "ALL";
    ReceiptType[ReceiptType["USER"] = 1] = "USER";
    ReceiptType[ReceiptType["PARTIAL"] = 2] = "PARTIAL";
})(ReceiptType || (ReceiptType = {}));
var ReceiptStatus;
(function (ReceiptStatus) {
    ReceiptStatus[ReceiptStatus["REQUESTED"] = 0] = "REQUESTED";
    ReceiptStatus[ReceiptStatus["WAITING"] = 1] = "WAITING";
    ReceiptStatus[ReceiptStatus["READY"] = 2] = "READY";
    ReceiptStatus[ReceiptStatus["APPROVED"] = 3] = "APPROVED";
    ReceiptStatus[ReceiptStatus["CANCELED"] = 4] = "CANCELED";
})(ReceiptStatus || (ReceiptStatus = {}));


/***/ }),

/***/ "./src/app/mocks/report.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
class Report {
    constructor(type, connection_id, count, amount, profit, weekly, weekly_count, monthly, monthly_count, month, year, description, timestamp, db_name, db_seq, _id, _rev) {
        this.type = type;
        this.connection_id = connection_id;
        this.count = count;
        this.amount = amount;
        this.profit = profit;
        this.weekly = weekly;
        this.weekly_count = weekly_count;
        this.monthly = monthly;
        this.monthly_count = monthly_count;
        this.month = month;
        this.year = year;
        this.description = description;
        this.timestamp = timestamp;
        this.db_name = db_name;
        this.db_seq = db_seq;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = Report;

class Activity {
    constructor(type, name, activity, activity_time, activity_count) {
        this.type = type;
        this.name = name;
        this.activity = activity;
        this.activity_time = activity_time;
        this.activity_count = activity_count;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Activity;



/***/ }),

/***/ "./src/app/mocks/settings.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
class Settings {
    constructor(key, value, description, timestamp) {
        this.key = key;
        this.value = value;
        this.description = description;
        this.timestamp = timestamp;
    }
}
/* harmony export (immutable) */ __webpack_exports__["d"] = Settings;

class AuthInfo {
    constructor(app_remote, app_port, app_db, app_id, app_token) {
        this.app_remote = app_remote;
        this.app_port = app_port;
        this.app_db = app_db;
        this.app_id = app_id;
        this.app_token = app_token;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = AuthInfo;

class ServerInfo {
    constructor(type, status, ip_address, ip_port, key) {
        this.type = type;
        this.status = status;
        this.ip_address = ip_address;
        this.ip_port = ip_port;
        this.key = key;
    }
}
/* unused harmony export ServerInfo */

class Printer {
    constructor(name, type, note, device_port, mission) {
        this.name = name;
        this.type = type;
        this.note = note;
        this.device_port = device_port;
        this.mission = mission;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = Printer;

class PaymentMethod {
    constructor(name, description, color, icon, type, status) {
        this.name = name;
        this.description = description;
        this.color = color;
        this.icon = icon;
        this.type = type;
        this.status = status;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = PaymentMethod;

class DayInfo {
    constructor(day, started, time) {
        this.day = day;
        this.started = started;
        this.time = time;
    }
}
/* unused harmony export DayInfo */



/***/ }),

/***/ "./src/app/mocks/stocks.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export WarehouseType */
/* unused harmony export ProductType */
/* unused harmony export ProductStatus */
/* unused harmony export MarketingChannel */
class StockCategory {
    constructor(name, description, _id, _rev) {
        this.name = name;
        this.description = description;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = StockCategory;

class Stock {
    constructor(name, description, unit, portion, quantity, first_quantity, total, left_total, first_total, warning_value, warning_limit, category, sub_category, producer, product, warehouse, supplier, timestamp, _id, _rev) {
        this.name = name;
        this.description = description;
        this.unit = unit;
        this.portion = portion;
        this.quantity = quantity;
        this.first_quantity = first_quantity;
        this.total = total;
        this.left_total = left_total;
        this.first_total = first_total;
        this.warning_value = warning_value;
        this.warning_limit = warning_limit;
        this.category = category;
        this.sub_category = sub_category;
        this.producer = producer;
        this.product = product;
        this.warehouse = warehouse;
        this.supplier = supplier;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Stock;

var WarehouseType;
(function (WarehouseType) {
    WarehouseType[WarehouseType["INSIDE"] = 0] = "INSIDE";
    WarehouseType[WarehouseType["OUTSIDE"] = 1] = "OUTSIDE";
})(WarehouseType || (WarehouseType = {}));
class Warehouse {
    constructor(name, description, type, timestamp, _id, _rev) {
        this.name = name;
        this.description = description;
        this.type = type;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = Warehouse;

var ProductType;
(function (ProductType) {
    ProductType[ProductType["RAW"] = 0] = "RAW";
    ProductType[ProductType["PRODUCT"] = 1] = "PRODUCT";
    ProductType[ProductType["BOTH"] = 2] = "BOTH";
})(ProductType || (ProductType = {}));
var ProductStatus;
(function (ProductStatus) {
    ProductStatus[ProductStatus["ACTIVE"] = 0] = "ACTIVE";
    ProductStatus[ProductStatus["PASSIVE"] = 1] = "PASSIVE";
    ProductStatus[ProductStatus["SUSPENDEND"] = 2] = "SUSPENDEND";
})(ProductStatus || (ProductStatus = {}));
var MarketingChannel;
(function (MarketingChannel) {
    MarketingChannel[MarketingChannel["ON_TRADE"] = 0] = "ON_TRADE";
    MarketingChannel[MarketingChannel["OFF_TRADE"] = 1] = "OFF_TRADE";
    MarketingChannel[MarketingChannel["BOTH_TRADE"] = 2] = "BOTH_TRADE";
})(MarketingChannel || (MarketingChannel = {}));


/***/ }),

/***/ "./src/app/mocks/table.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return TableStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return TableType; });
class Table {
    constructor(name, floor_id, capacity, description, status, timestamp, customers, position, _id, _rev) {
        this.name = name;
        this.floor_id = floor_id;
        this.capacity = capacity;
        this.description = description;
        this.status = status;
        this.timestamp = timestamp;
        this.customers = customers;
        this.position = position;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = Table;

class Floor {
    constructor(name, description, status, timestamp, special, conditions, _id, _rev) {
        this.name = name;
        this.description = description;
        this.status = status;
        this.timestamp = timestamp;
        this.special = special;
        this.conditions = conditions;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = Floor;

class FloorSpecs {
    constructor(air, cigarate, reservation, music, events) {
        this.air = air;
        this.cigarate = cigarate;
        this.reservation = reservation;
        this.music = music;
        this.events = events;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = FloorSpecs;

var TableStatus;
(function (TableStatus) {
    TableStatus[TableStatus["PASSIVE"] = 0] = "PASSIVE";
    TableStatus[TableStatus["ACTIVE"] = 1] = "ACTIVE";
    TableStatus[TableStatus["OCCUPIED"] = 2] = "OCCUPIED";
    TableStatus[TableStatus["WILL_READY"] = 3] = "WILL_READY";
})(TableStatus || (TableStatus = {}));
var TableType;
(function (TableType) {
    TableType[TableType["ROUND"] = 0] = "ROUND";
    TableType[TableType["SQUARE"] = 1] = "SQUARE";
    TableType[TableType["SQUARE_ROUND"] = 2] = "SQUARE_ROUND";
})(TableType || (TableType = {}));


/***/ }),

/***/ "./src/app/mocks/user.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
class User {
    constructor(name, role, role_id, pincode, status, timestamp, _id, _rev) {
        this.name = name;
        this.role = role;
        this.role_id = role_id;
        this.pincode = pincode;
        this.status = status;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["b"] = User;

class UserGroup {
    constructor(name, description, auth, status, timestamp, _id, _rev) {
        this.name = name;
        this.description = description;
        this.auth = auth;
        this.status = status;
        this.timestamp = timestamp;
        this._id = _id;
        this._rev = _rev;
    }
}
/* harmony export (immutable) */ __webpack_exports__["d"] = UserGroup;

class UserAuth {
    constructor(components, cancelCheck, cancelProduct, discount, payment, end, moveTable, moveProduct, giveFree, undoPayment, acceptOrder) {
        this.components = components;
        this.cancelCheck = cancelCheck;
        this.cancelProduct = cancelProduct;
        this.discount = discount;
        this.payment = payment;
        this.end = end;
        this.moveTable = moveTable;
        this.moveProduct = moveProduct;
        this.giveFree = giveFree;
        this.undoPayment = undoPayment;
        this.acceptOrder = acceptOrder;
    }
}
/* harmony export (immutable) */ __webpack_exports__["c"] = UserAuth;

class ComponentsAuth {
    constructor(store, cashbox, endoftheday, reports, settings) {
        this.store = store;
        this.cashbox = cashbox;
        this.endoftheday = endoftheday;
        this.reports = reports;
        this.settings = settings;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = ComponentsAuth;



/***/ }),

/***/ "./src/app/pipes/general.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return GeneralPipe; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let GeneralPipe = class GeneralPipe {
    constructor(mainService) {
        this.mainService = mainService;
    }
    transform(value, args, property) {
        return this.mainService.getData(args, value).then((result) => {
            if (property) {
                return result[property];
            }
            else {
                return result.name;
            }
        }).catch((err) => {
            return value;
        });
    }
};
GeneralPipe = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'general'
    }),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__services_main_service__["a" /* MainService */]])
], GeneralPipe);



/***/ }),

/***/ "./src/app/pipes/price.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PricePipe; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let PricePipe = class PricePipe {
    constructor() { }
    transform(value) {
        if (!value)
            value = 0;
        return '₺ ' + Number(value).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
    }
};
PricePipe = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'price'
    }),
    __metadata("design:paramtypes", [])
], PricePipe);



/***/ }),

/***/ "./src/app/pipes/timeago.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TimeAgoPipe; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let TimeAgoPipe = class TimeAgoPipe {
    constructor() { }
    transform(value) {
        let current = Date.now();
        let msPerMinute = 60 * 1000;
        let msPerHour = msPerMinute * 60;
        let msPerDay = msPerHour * 24;
        let msPerMonth = msPerDay * 30;
        let msPerYear = msPerDay * 365;
        let elapsed = current - value;
        if (elapsed < msPerMinute) {
            return Math.round(elapsed / 1000) + ' sn';
        }
        else if (elapsed < msPerHour) {
            return Math.round(elapsed / msPerMinute) + ' dk';
        }
        else if (elapsed < msPerDay) {
            return Math.round(elapsed / msPerHour) + ' sa';
        }
        else if (elapsed < msPerMonth) {
            return Math.round(elapsed / msPerDay) + ' gün';
        }
        else if (elapsed < msPerYear) {
            return Math.round(elapsed / msPerMonth) + ' ay';
        }
        else {
            return Math.round(elapsed / msPerYear) + ' yıl';
        }
    }
};
TimeAgoPipe = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'timeAgo'
    }),
    __metadata("design:paramtypes", [])
], TimeAgoPipe);



/***/ }),

/***/ "./src/app/providers/caller-id.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CallerIDService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs__ = __webpack_require__("./node_modules/rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let CallerIDService = class CallerIDService {
    constructor(electron, mainService, messageService, settings) {
        this.electron = electron;
        this.mainService = mainService;
        this.messageService = messageService;
        this.settings = settings;
        this.CallEvent = new __WEBPACK_IMPORTED_MODULE_4_rxjs__["Subject"]();
        this.electron.ipcRenderer.on('callerError', (event, message) => {
            this.messageService.sendMessage(message);
        });
        this.electron.ipcRenderer.on('phoneRequest', (event, data) => {
            if (data.toString().split('.')[1] == undefined || data.toString().split('.')[0] == "    ----    CIDSHOW - 2020  - Sistemler") {
                console.log('Device Signal...');
            }
            else {
                const newCall = { line: data.toString().split('.')[0], number: data.toString().split('.')[1], serial: data.toString().split('.')[3], timestamp: Date.now() };
                this.CallEvent.next(newCall);
                this.mainService.addData('calls', newCall).then(isOk => {
                }).catch(err => {
                });
            }
        });
        this.electron.ipcRenderer.on('callerPath', (event, message) => {
            console.log('CIDSHOW PATH:', message);
        });
    }
    startCallerID() {
        console.log('CallerID Service Started...');
        this.electron.ipcRenderer.send('startCaller');
    }
    listenCallEvent() {
        return this.CallEvent.asObservable();
    }
    testCall() {
        const testCall = { line: 0, number: '05448743568', serial: 5556666, timestamp: Date.now() };
        this.CallEvent.next(testCall);
    }
};
CallerIDService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_5__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */]])
], CallerIDService);



/***/ }),

/***/ "./src/app/providers/electron.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ElectronService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_electron__ = __webpack_require__("electron");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_electron___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_electron__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_fs__ = __webpack_require__("fs");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_fs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_fs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_child_process__ = __webpack_require__("child_process");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_child_process___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_child_process__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_os__ = __webpack_require__("os");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_os___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_os__);
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





// import * as crypto from 'crypto';
let ElectronService = class ElectronService {
    constructor() {
        this.app = __WEBPACK_IMPORTED_MODULE_1_electron__["remote"].app;
        this.appWindow = __WEBPACK_IMPORTED_MODULE_1_electron__["remote"].getCurrentWindow();
        this.appWebContents = this.appWindow.webContents;
        this.appPath = this.app.getAppPath();
        this.appRealPath = window.process.cwd();
        this.ipcRenderer = __WEBPACK_IMPORTED_MODULE_1_electron__["ipcRenderer"];
        this.webFrame = __WEBPACK_IMPORTED_MODULE_1_electron__["webFrame"];
        this.fileSystem = __WEBPACK_IMPORTED_MODULE_2_fs__;
    }
    isElectron() {
        __WEBPACK_IMPORTED_MODULE_1_electron__["webFrame"].setVisualZoomLevelLimits(1, 1);
        __WEBPACK_IMPORTED_MODULE_1_electron__["webFrame"].setLayoutZoomLevelLimits(0, 0);
        return window && window.process && window.process.type;
    }
    // encryptData(secret: string, data: Buffer) {
    //   return crypto.privateEncrypt(secret, data);
    // }
    // decryptData(secret: string, data: Buffer) {
    //   return crypto.privateDecrypt(secret, data);
    // }
    getLocalIP() {
        const interfaces = __WEBPACK_IMPORTED_MODULE_4_os__["networkInterfaces"]();
        this.ipAddress = [];
        for (var k in interfaces) {
            for (var k2 in interfaces[k]) {
                var address = interfaces[k][k2];
                if (address.family === 'IPv4' && !address.internal) {
                    this.ipAddress.push(address.address);
                }
            }
        }
        return this.ipAddress[0];
    }
    saveLogo(data) {
        var base64Data = data.replace(/^data:image\/png;base64,/, "");
        // base64Data += base64Data.replace('+', ' ');
        let binaryData = new Buffer(base64Data, 'base64'); //.toString('binary')
        // fs.writeFile(this.appRealPath + '/data/customer.png', binaryData, function (err) {
        //   console.log(err);
        // });
        __WEBPACK_IMPORTED_MODULE_2_fs__["exists"](this.appRealPath + '/data/', (exists) => {
            if (!exists) {
                __WEBPACK_IMPORTED_MODULE_2_fs__["mkdir"](this.appRealPath + '/data/', (err) => {
                    if (!err) {
                        __WEBPACK_IMPORTED_MODULE_2_fs__["writeFile"](this.appRealPath + '/data/customer.png', binaryData, function (err) {
                            console.log(err);
                        });
                        // let file = fs.createWriteStream(this.appRealPath + '/data/customer.png');
                        // let request = https.get(url, (response) => {
                        //   response.pipe(file);
                        // });
                    }
                });
            }
            else {
                __WEBPACK_IMPORTED_MODULE_2_fs__["writeFile"](this.appRealPath + '/data/customer.png', binaryData, function (err) {
                    console.log(err);
                });
                // let file = fs.createWriteStream(this.appRealPath + '/data/customer.png');
                // let request = https.get(url, (response) => {
                //   response.pipe(file);
                // });
            }
        });
    }
    initApplicationData() {
    }
    backupData(data, date) {
        let json = JSON.stringify(data);
        __WEBPACK_IMPORTED_MODULE_2_fs__["exists"](this.appRealPath + '/data/backup/', (exists) => {
            if (!exists) {
                __WEBPACK_IMPORTED_MODULE_2_fs__["mkdir"](this.appRealPath + '/data/backup/', (err) => {
                    if (!err) {
                        __WEBPACK_IMPORTED_MODULE_2_fs__["writeFile"](this.appRealPath + '/data/backup/' + date, json, (err) => {
                            if (err) {
                                console.log(err);
                            }
                        });
                    }
                });
            }
            else {
                __WEBPACK_IMPORTED_MODULE_2_fs__["writeFile"](this.appRealPath + '/data/backup/' + date, json, (err) => {
                    if (err) {
                        console.log(err);
                    }
                });
            }
        });
    }
    readBackupData(filename) {
        return new Promise((resolve, reject) => {
            __WEBPACK_IMPORTED_MODULE_2_fs__["exists"](this.appRealPath + '/data/backup/' + filename, (exists) => {
                if (exists) {
                    __WEBPACK_IMPORTED_MODULE_2_fs__["readFile"](this.appRealPath + '/data/backup/' + filename, (err, data) => {
                        if (!err) {
                            let buffer = data.toString('utf8');
                            let backup = JSON.parse(buffer);
                            resolve(backup);
                        }
                        else {
                            reject('Dosya Okunurken Hata Oluştu.');
                        }
                    });
                }
                else {
                    reject('Dosya Bulunamadı');
                }
            });
        });
    }
    fullScreen(status) {
        this.appWindow.setResizable(true);
        this.appWindow.setFullScreen(status);
    }
    shellCommand(command) {
        __WEBPACK_IMPORTED_MODULE_3_child_process__["exec"](command, (error, stdout, stderr) => {
            if (error) {
                console.error(`exec error: ${error}`);
                return;
            }
            console.log(`stdout: ${stdout}`);
            console.error(`stderr: ${stderr}`);
        });
    }
    shellSpawn(command, args, opts) {
        const shell = __WEBPACK_IMPORTED_MODULE_3_child_process__["spawn"](command, args, opts);
        shell.stdout.on('data', (data) => {
            console.log(`stdout: ${data}`);
        });
        shell.stderr.on('data', (data) => {
            console.error(`stderr: ${data}`);
        });
        shell.on('close', (code) => {
            console.log(`child process exited with code ${code}`);
        });
    }
    reloadProgram() {
        this.appWindow.reload();
    }
    relaunchProgram() {
        this.app.relaunch();
        this.app.quit();
    }
    exitProgram() {
        this.app.quit();
    }
    openDevTools() {
        this.appWebContents.openDevTools();
    }
};
ElectronService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], ElectronService);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/buffer/index.js").Buffer))

/***/ }),

/***/ "./src/app/providers/keyboard.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return KeyboardService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__);
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let KeyboardService = class KeyboardService {
    constructor() {
        this.signal = new __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__["Subject"]();
        this.input = new __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__["Subject"]();
    }
    triggerKeyboard(command, element) {
        this.signal.next(command);
        this.input.next(element);
    }
    listenKeyboard() {
        return this.signal.asObservable();
    }
    listenInput() {
        return this.input.asObservable();
    }
    syncInputs(element) {
        this.input.next(element);
    }
};
KeyboardService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], KeyboardService);



/***/ }),

/***/ "./src/app/providers/message.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MessageService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_sweetalert__ = __webpack_require__("./node_modules/sweetalert/dist/sweetalert.min.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_sweetalert___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_sweetalert__);
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



let MessageService = class MessageService {
    constructor() {
        this.subject = new __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__["Subject"]();
    }
    sendMessage(message) {
        this.subject.next({ text: message });
        setTimeout(() => {
            this.subject.next();
        }, 2000);
    }
    getMessage() {
        return this.subject.asObservable();
    }
    sendAlert(header, message, type) {
        __WEBPACK_IMPORTED_MODULE_2_sweetalert___default()(header, message, type, {
            buttons: {
                confirm: {
                    text: "Tamam",
                    value: true,
                    visible: true,
                    className: "btn btn-lg btn-success",
                    closeModal: true
                }
            }
        });
    }
    sendConfirm(message) {
        return __WEBPACK_IMPORTED_MODULE_2_sweetalert___default()(message, {
            buttons: {
                cancel: {
                    text: "İptal",
                    value: false,
                    visible: true,
                    className: "btn btn-lg btn-danger",
                    closeModal: true,
                },
                confirm: {
                    text: "Tamam",
                    value: true,
                    visible: true,
                    className: "btn btn-lg btn-success",
                    closeModal: true
                }
            },
        });
    }
};
MessageService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])()
], MessageService);



/***/ }),

/***/ "./src/app/providers/printer.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PrinterService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_escpos__ = __webpack_require__("./node_modules/escpos/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_escpos___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_escpos__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mocks_print__ = __webpack_require__("./src/app/mocks/print.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







function groupBy(array, key) {
    return array.reduce((acc, obj) => {
        const property = obj[key];
        acc[property] = acc[property] || [];
        acc[property].push(obj);
        return acc;
    }, {});
}
;
let PrinterService = class PrinterService {
    constructor(electron, mainService, messageService, settings) {
        this.electron = electron;
        this.mainService = mainService;
        this.messageService = messageService;
        this.settings = settings;
        this.storeLogo = this.electron.appRealPath + '/data/customer.png';
        this.quicklyLogo = this.electron.appPath + '/assets/quickly.png';
        this.electron.ipcRenderer.on('error', (event, message, check, device) => {
            this.messageService.sendMessage(message);
            let newPrint = new __WEBPACK_IMPORTED_MODULE_5__mocks_print__["a" /* PrintOut */]('Check', __WEBPACK_IMPORTED_MODULE_5__mocks_print__["b" /* PrintOutStatus */].WAITING, check._id, device);
            this.mainService.addData('prints', newPrint).then(isSended => {
                console.log('Print Sended!');
            }).catch(err => {
                console.log('Hata Yazıcıya Ulaşılamadı');
            });
        });
        this.mainService.getAllBy('settings', { key: 'CurrencySettings' }).then(currencySettings => {
            this.currency = currencySettings.docs[0].value;
        }).catch(err => {
            console.log(err);
        });
    }
    printTest(device) {
        this.electron.ipcRenderer.send('printTest', device);
    }
    printOrder(device, table, orders, owner) {
        const printer = device;
        let ordersArray = [];
        orders.forEach(element => {
            let contains = ordersArray.some(obj => obj.name == element.name && obj.note == element.note);
            if (contains) {
                let index = ordersArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                ordersArray[index].price += element.price;
                ordersArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: element.note, price: element.price, count: 1, category: element.cat_id };
                ordersArray.push(schema);
            }
        });
        // this.electron.ipcRenderer.send('printOrder', device, table, ordersArray, owner);
        if (printer.device_port.toString().split(',').length > 0) {
            printer.device_port.toString().split(',').forEach(port => {
                let xdevice = { device_port: port, mission: printer.mission, name: printer.name, note: printer.note, type: printer.type };
                // this.electron.ipcRenderer.send('printOrder', xdevice, table, ordersArray, owner);
                this.electron.ipcRenderer.send('printOrderGroupped', xdevice, table, ordersArray, owner);
            });
        }
        else {
            // this.electron.ipcRenderer.send('printOrder', printer, table, ordersArray, owner);
            this.electron.ipcRenderer.send('printOrderGroupped', printer, table, ordersArray, owner);
        }
    }
    printOrderEleni(device, table, orders, owner) {
        let ordersArray = [];
        orders.forEach(element => {
            let contains = ordersArray.some(obj => obj.name == element.name && obj.note == element.note);
            if (contains) {
                let index = ordersArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                ordersArray[index].price += element.price;
                ordersArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: element.note, price: element.price, count: 1 };
                ordersArray.push(schema);
            }
        });
        // this.electron.ipcRenderer.send('printOrder', device, table, ordersArray, owner);
        this.electron.ipcRenderer.send('printOrderEleni', device, table, ordersArray, owner);
    }
    printTableOrder(device, table, order) {
        let ordersArray = [];
        order.items.forEach(element => {
            let contains = ordersArray.some(obj => obj.name == element.name && obj.note == element.note);
            if (contains) {
                let index = ordersArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                ordersArray[index].price += element.price;
                ordersArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: element.note, price: element.price, count: 1 };
                ordersArray.push(schema);
            }
        });
        this.electron.ipcRenderer.send('printOrder', device, table, ordersArray, order.user.name);
    }
    printCheck(device, table, check) {
        const printer = device;
        let productsArray = [];
        let payedArray = [];
        check.products.forEach(element => {
            let contains = productsArray.some(obj => obj.name == element.name && obj.note == element.note && obj.price == element.price);
            if (contains) {
                let index = productsArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                productsArray[index].total_price += element.price;
                productsArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: element.note, price: element.price, total_price: element.price, count: 1, status: element.status };
                productsArray.push(schema);
            }
        });
        if (check.payment_flow) {
            let payed = [];
            if (check.payment_flow.length > 1) {
                let things = check.payment_flow.map(obj => obj.payed_products);
                things.forEach(element => {
                    payed = payed.concat(element);
                });
            }
            else {
                payed = check.payment_flow[0].payed_products;
            }
            payed.forEach(element => {
                let contains = payedArray.some(obj => obj.name == element.name && obj.note == element.note && obj.price == element.price);
                if (contains) {
                    let index = payedArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                    payedArray[index].total_price += element.price;
                    payedArray[index].count++;
                }
                else {
                    let schema = { name: element.name, note: element.note, price: element.price, total_price: element.price, count: 1, status: element.status };
                    payedArray.push(schema);
                }
            });
        }
        let newCheck = Object.assign({}, check);
        newCheck.products = productsArray;
        newCheck.payed_products = payedArray;
        if (printer.device_port.toString().split(',').length > 0) {
            printer.device_port.toString().split(',').forEach(port => {
                let xdevice = { device_port: port, mission: printer.mission, name: printer.name, note: printer.note, type: printer.type };
                this.electron.ipcRenderer.send('printCheck', xdevice, newCheck, table, this.storeLogo, '', this.currency);
            });
        }
        else {
            this.electron.ipcRenderer.send('printCheck', device, newCheck, table, this.storeLogo, '', this.currency);
        }
    }
    printPayment(device, table, payment) {
        let productsArray = [];
        payment.payed_products.forEach(element => {
            let contains = productsArray.some(obj => obj.name == element.name && obj.note == element.note);
            if (contains) {
                let index = productsArray.findIndex(obj => obj.name == element.name && obj.note == element.note);
                productsArray[index].total_price += element.price;
                productsArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: element.note, price: element.price, total_price: element.price, count: 1, status: element.status };
                productsArray.push(schema);
            }
        });
        payment.payed_products = productsArray;
        this.electron.ipcRenderer.send('printPayment', device, payment, table, this.storeLogo);
    }
    printEndDay(device, EndDayData) {
        this.electron.ipcRenderer.send('printEndDay', device, EndDayData, this.quicklyLogo);
    }
    printReport(device, category, reports) {
        this.electron.ipcRenderer.send('printReport', device, category, reports);
    }
    printCancel(printer, product, reason, table, owner) {
        if (printer.device_port.toString().split(',').length > 0) {
            printer.device_port.toString().split(',').forEach(port => {
                let xdevice = { device_port: port, mission: printer.mission, name: printer.name, note: printer.note, type: printer.type };
                this.electron.ipcRenderer.send('printCancel', xdevice, product, reason, table, owner);
            });
        }
        else {
            this.electron.ipcRenderer.send('printCancel', printer, product, reason, table, owner);
        }
    }
    printQRCode(device, data, table, owner) {
        this.electron.ipcRenderer.send('printQRcode', device, data, table, owner);
    }
    kickCashdraw(device) {
        this.electron.ipcRenderer.send('kickCashdraw', device);
    }
    getUSBPrinters() {
        return __WEBPACK_IMPORTED_MODULE_4_escpos__["USB"].findPrinter();
    }
    getSerialPrinters(path) {
        return __WEBPACK_IMPORTED_MODULE_4_escpos__["Serial"](path, {
            baudRate: 14400,
            stopBit: 2
        });
    }
};
PrinterService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_6__services_main_service__["a" /* MainService */], __WEBPACK_IMPORTED_MODULE_2__message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */]])
], PrinterService);



/***/ }),

/***/ "./src/app/providers/scaler.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ScalerService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs__ = __webpack_require__("./node_modules/rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_operators_map__ = __webpack_require__("./node_modules/rxjs/operators/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_operators_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_rxjs_operators_map__);
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let ScalerService = class ScalerService {
    constructor(electron, messageService, settings) {
        this.electron = electron;
        this.messageService = messageService;
        this.settings = settings;
        this.scalerEvent = new __WEBPACK_IMPORTED_MODULE_4_rxjs__["Subject"]();
        this.decoder = new TextDecoder("utf-8");
        this.electron.ipcRenderer.on('scalerError', (event, message) => {
            console.log('Scaler ERR:', message.toString());
            this.messageService.sendMessage(message);
        });
        this.electron.ipcRenderer.on('scalerData', (event, data) => {
            this.scalerEvent.next(this.decoder.decode(data));
        });
    }
    // testFlow() {
    //     let data = [
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.000kg',
    //         'S  0.254kg',
    //         'S  0.350kg',
    //         'U  0.350kg',
    //         'U  0.350kg',
    //         'S  0.350kg',
    //         'U  0.350kg',
    //         'U  0.350kg',
    //         'S  0.350kg',
    //         'U  0.350kg',
    //         'U  0.350kg',
    //         'S  0.460kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //         'S  0.560kg',
    //     ];
    //     let i = 0;
    //     setInterval(() => {
    //         // let randomIndex = Math.round(Math.random() * 13);
    //         console.log(data[i]);
    //         this.scalerEvent.next(data[i]);
    //         if (i <= data.length) {
    //             i++
    //         } else {
    //             i = 0;
    //         }
    //     }, 1100)
    // }
    startScaler() {
        console.log('Scaler Service Started...');
        this.electron.ipcRenderer.send('startScaler');
        // this.testFlow();
    }
    closeScaler() {
        this.electron.ipcRenderer.send('closeScaler');
    }
    listenScalerEvent() {
        return this.scalerEvent.asObservable().pipe(Object(__WEBPACK_IMPORTED_MODULE_5_rxjs_operators_map__["map"])((obj) => {
            if (obj) {
                let formatted = obj.replace('S', '').replace('U', '').replace('kg', '').replace('- ', '-').trim();
                return parseFloat(formatted);
            }
        }));
    }
};
ScalerService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__electron_service__["a" /* ElectronService */], __WEBPACK_IMPORTED_MODULE_2__message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */]])
], ScalerService);



/***/ }),

/***/ "./src/app/providers/terminal.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TerminalService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let TerminalService = class TerminalService {
    constructor(electron) {
        this.electron = electron;
    }
    printOrders(printers, categories, check, tables) {
        if (printers.length > 0) {
            let orders = check.products.filter(obj => obj.status == 1);
            if (orders.length > 0) {
                let splitPrintArray = [];
                orders.forEach((obj, index) => {
                    let catPrinter = categories.filter(cat => cat._id == obj.cat_id)[0].printer || printers[0].name;
                    let contains = splitPrintArray.some(element => element.printer.name == catPrinter);
                    if (contains) {
                        let index = splitPrintArray.findIndex(p_name => p_name.printer.name == catPrinter);
                        splitPrintArray[index].products.push(obj);
                    }
                    else {
                        let thePrinter = printers.filter(obj => obj.name == catPrinter)[0];
                        let splitPrintOrder = { printer: thePrinter, products: [obj] };
                        splitPrintArray.push(splitPrintOrder);
                    }
                    if (index == orders.length - 1) {
                        let table_name = tables.filter(obj => obj._id == check.table_id)[0].name;
                        // if (check.type == 2) {
                        //   table_name = 'Hızlı Satış';
                        // } else {
                        //   table_name = table.name;
                        // }
                        splitPrintArray.forEach(order => {
                            this.printOrder(order.printer, table_name, order.products);
                        });
                    }
                });
            }
        }
    }
    printOrder(device, table, orders) {
        let ordersArray = [];
        orders.forEach(element => {
            let contains = ordersArray.some(obj => obj.name == element.name);
            if (contains) {
                let index = ordersArray.findIndex(obj => obj.name == element.name);
                ordersArray[index].price += element.price;
                ordersArray[index].count++;
            }
            else {
                let schema = { name: element.name, note: "", price: element.price, count: 1 };
                ordersArray.push(schema);
            }
        });
        this.electron.ipcRenderer.send('printOrder', device, table, ordersArray, orders[0].owner);
    }
};
TerminalService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__electron_service__["a" /* ElectronService */]])
], TerminalService);



/***/ }),

/***/ "./src/app/services/application.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function($) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ApplicationService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("./node_modules/@angular/router/esm5/router.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__settings_service__ = __webpack_require__("./src/app/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let ApplicationService = class ApplicationService {
    constructor(settings, messageService, router, http) {
        this.settings = settings;
        this.messageService = messageService;
        this.router = router;
        this.http = http;
        this.settings.AppSettings.subscribe((data) => {
            if (data) {
                this.appLockTime = data.value.timeout;
                this.screenLock('start');
            }
        });
    }
    isActive() {
        this.settings.ActivationStatus.subscribe(res => {
            if (res.value) {
                console.log('İşletme Hesabı Aktif.');
            }
            else {
                console.warn('İşletme Hesabı Aktif Değil.');
                this.router.navigate(['/setup']);
            }
        });
    }
    connectionStatus() {
        let appType = localStorage.getItem('AppType');
        if (navigator.onLine) {
            switch (appType) {
                case 'Primary':
                    return true;
                case 'Secondary':
                    // let serverInfo = this.settings.Settings.find(obj => obj.key == 'ServerSettings' && obj.value.type == 1).value;
                    // console.log(serverInfo);
                    // return this.http.get('http://' + serverInfo.ip_address + ':' + serverInfo.ip_port + '/' + serverInfo.key + '/appServer').toPromise().then(isOK => {
                    //   return true;
                    // }).catch(err => {
                    //   console.log(err)
                    // })
                    return true;
                default:
                    break;
            }
        }
        else {
            return false;
        }
    }
    screenLock(command) {
        switch (command) {
            case 'start':
                this.timer = this.appLockTime;
                this.countDown = setInterval(() => {
                    if (this.timer == 0) {
                        if (this.router.url === '/' || this.router.url.match('payment') || this.router.url === '/endoftheday' || this.router.url === '/endoftheday_no_guard' || this.router.url === '/activation' || this.router.url === '/settings' || this.router.url === '/reports' || this.router.url === '/setup' || this.router.url === '/admin') {
                            this.timer = this.appLockTime;
                        }
                        else {
                            this.timer = this.appLockTime;
                            if ($('body').hasClass('modal-open')) {
                                $('*').modal('hide');
                            }
                            this.router.navigate(['']);
                            this.messageService.sendMessage('Zaman aşımına uğrandı.');
                        }
                    }
                    this.timer--;
                }, 1000);
                break;
            case 'reset':
                this.timer = this.appLockTime;
                break;
            case 'stop':
                clearInterval(this.countDown);
                break;
            default:
                break;
        }
    }
};
ApplicationService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__settings_service__["a" /* SettingsService */], __WEBPACK_IMPORTED_MODULE_2__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_1__angular_router__["b" /* Router */], __WEBPACK_IMPORTED_MODULE_4__angular_http__["b" /* Http */]])
], ApplicationService);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/jquery/dist/jquery.js")))

/***/ }),

/***/ "./src/app/services/auth.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AuthService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__providers_message_service__ = __webpack_require__("./src/app/providers/message.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let AuthService = class AuthService {
    constructor(messageService, mainService) {
        this.messageService = messageService;
        this.mainService = mainService;
        this.subject = new __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__["Subject"]();
    }
    parseJWT(token) {
        let base64Url = token.split('.')[1];
        let base64 = base64Url.replace('-', '+').replace('_', '/');
        return JSON.parse(atob(base64));
    }
    saveToken(userType) {
        localStorage['userType'] = userType;
    }
    login(user) {
        localStorage['userName'] = user.name;
        localStorage['userType'] = user.role;
        localStorage['userAuth'] = user.role_id;
        localStorage['userID'] = user._id;
        this.subject.next({ name: user.name, type: user.role });
    }
    logout() {
        localStorage.removeItem('userType');
        localStorage.removeItem('userName');
        localStorage.removeItem('userAuth');
        localStorage.removeItem('userID');
        localStorage.removeItem('userPermissions');
    }
    getToken() {
        return localStorage.getItem('userType');
    }
    isAnonymous() {
        let token = this.getToken();
        if (token) {
            return false;
        }
        else {
            this.messageService.sendMessage("Şifre girilmedi.");
            return true;
        }
    }
    getCurrentUser() {
        return this.subject.asObservable();
    }
    setPermissions() {
        let auth = localStorage.getItem('userAuth');
        this.mainService.getData('users_group', auth).then(result => {
            delete result.auth.components;
            localStorage.setItem('userPermissions', JSON.stringify(result.auth));
        });
    }
    isAuthed(url) {
        let auth = localStorage.getItem('userAuth');
        if (auth) {
            url = url.replace('/', '').split('/');
            return this.mainService.getData('users_group', auth).then(result => {
                let guard = result.auth.components;
                switch (url[0]) {
                    case 'settings':
                        if (guard.settings) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'selling-screen':
                        if (guard.store) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'fast-selling':
                        if (guard.store) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'store':
                        if (guard.store) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'reports':
                        if (guard.reports) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'endoftheday':
                        if (guard.endoftheday) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    case 'cashbox':
                        if (guard.cashbox) {
                            return true;
                        }
                        this.messageService.sendMessage("Giriş Yetkiniz Yok!");
                        break;
                    default:
                        break;
                }
            });
        }
        else {
            this.messageService.sendMessage("Şifre girilmedi.");
        }
    }
};
AuthService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__providers_message_service__["a" /* MessageService */], __WEBPACK_IMPORTED_MODULE_3__main_service__["a" /* MainService */]])
], AuthService);



/***/ }),

/***/ "./src/app/services/conflict.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ConflictService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let ConflictService = class ConflictService {
    constructor(mainService) {
        this.mainService = mainService;
    }
    conflictListener() {
        return setInterval(() => {
            this.getConflicts().then(conflicts => {
                if (conflicts.length > 0) {
                    conflicts.forEach(conflicted_document => {
                        this.getPreRevision(conflicted_document).then(older_document => {
                            this.conflictResolver(conflicted_document, older_document);
                        }).catch(err => {
                            this.conflictResolver(conflicted_document);
                        });
                    });
                }
            });
        }, 60000);
    }
    conflictResolver(conflicted_document, older_document) {
        this.mainService.ServerDB.resolveConflicts(conflicted_document, (a, b) => {
            return this.diffResolver(a, b, older_document);
        }).catch(err => { });
    }
    getConflicts() {
        return this.mainService.ServerDB.allDocs({ include_docs: true, conflicts: true, revs: true }).then(res => {
            return res.rows.map(obj => { return obj.doc; }).filter(obj => obj.hasOwnProperty('_conflicts'));
        });
    }
    getPreRevision(conflicted_document) {
        return this.mainService.ServerDB.get(conflicted_document._id, { revs: true }).then(res => {
            let revToGet = `${res._revisions.start - 1}-${res._revisions.ids[1]}`;
            return this.mainService.ServerDB.get(res._id, { rev: revToGet });
        });
    }
    diffResolver(a, b, older_document) {
        if (older_document !== undefined) {
            if (older_document.db_name == 'reports') {
                const aDiff = this.diffReduce(a, older_document);
                const bDiff = this.diffReduce(b, older_document);
                const resolvedDoc = JSON.parse(JSON.stringify(older_document));
                const olderACopy = JSON.parse(JSON.stringify(older_document));
                const olderBCopy = JSON.parse(JSON.stringify(older_document));
                aDiff.forEach(diff => {
                    if (diff.hasOwnProperty('secondProp')) {
                        resolvedDoc[diff.firsProp][diff.secondProp] += Math.abs(olderACopy[diff.firsProp][diff.secondProp] - diff.data);
                    }
                    else {
                        resolvedDoc[diff.firsProp] += Math.abs(olderACopy[diff.firsProp] - diff.data);
                    }
                });
                bDiff.forEach(diff => {
                    if (diff.hasOwnProperty('secondProp')) {
                        resolvedDoc[diff.firsProp][diff.secondProp] += Math.abs(olderBCopy[diff.firsProp][diff.secondProp] - diff.data);
                    }
                    else {
                        resolvedDoc[diff.firsProp] += Math.abs(olderBCopy[diff.firsProp] - diff.data);
                    }
                });
                console.log('OLDER', older_document);
                console.log('A_REV', a);
                console.log('B_REV', b);
                console.log('RESOLVED', resolvedDoc);
                this.mainService.ServerDB.remove(a).then((res) => {
                    if (res.ok) {
                        this.mainService.ServerDB.remove(b).then((res) => {
                            if (res.ok) {
                                delete resolvedDoc._rev;
                                this.mainService.ServerDB.put(resolvedDoc).then(res => {
                                    console.log(res);
                                });
                            }
                        });
                    }
                });
            }
            else {
                console.log('Have OlderDoc Out Of Reports!', a, b);
                if (a.timestamp > b.timestamp)
                    this.diffRecreate(a, b);
                if (b.timestamp > a.timestamp)
                    this.diffRecreate(b, a);
                if (b.timestamp == a.timestamp)
                    this.diffRevision(a, b);
            }
        }
        else {
            console.log('No OlderDoc', a);
            this.diffRecreate(a, b);
        }
    }
    diffRevision(a, b) {
        let aRev = a._rev.split('-')[0];
        let bRev = b._rev.split('-')[0];
        if (aRev > bRev)
            this.diffRecreate(a, b);
        if (bRev > aRev)
            this.diffRecreate(b, a);
    }
    diffRecreate(first, second) {
        console.log('Creating Diff', first);
        this.mainService.ServerDB.remove(first).then((res) => {
            if (res.ok) {
                this.mainService.ServerDB.remove(second).then((res) => {
                    if (res.ok) {
                        delete first._rev;
                        this.mainService.ServerDB.put(first).then(res => {
                            console.log(res);
                        }).catch(err => {
                            console.log(err);
                            console.log('First Put Error', first);
                        });
                    }
                }).catch(err => {
                    console.log(err);
                    console.log('Second Remove Error', first);
                });
            }
        }).catch(err => {
            console.log(err);
            console.log('First Remove Error', first);
        });
    }
    diffReduce(reduce_element, older_element) {
        let objDiff = this.deepDiffMapper().map(reduce_element, older_element);
        let parsedDiff = this.diffParser('updated', objDiff);
        return parsedDiff;
    }
    diffParser(diffType, objDiff) {
        delete objDiff._id;
        delete objDiff._rev;
        delete objDiff._conflicts;
        let diffObjArr = [];
        for (let prop in objDiff) {
            if (Object.keys(objDiff[prop]).length > 2) {
                for (let innerProp in objDiff[prop]) {
                    if (objDiff[prop][innerProp].type == diffType) {
                        let diffObj = {
                            firsProp: prop,
                            secondProp: innerProp,
                            data: objDiff[prop][innerProp].data
                        };
                        diffObjArr.push(diffObj);
                    }
                }
            }
            else {
                if (objDiff[prop].type == diffType) {
                    let diffObj = {
                        firsProp: prop,
                        data: objDiff[prop].data
                    };
                    diffObjArr.push(diffObj);
                }
            }
        }
        return diffObjArr;
    }
    deepDiffMapper() {
        return {
            VALUE_CREATED: 'created',
            VALUE_UPDATED: 'updated',
            VALUE_DELETED: 'deleted',
            VALUE_UNCHANGED: 'unchanged',
            map: function (obj1, obj2) {
                if (this.isFunction(obj1) || this.isFunction(obj2)) {
                    throw 'Invalid argument. Function given, object expected.';
                }
                if (this.isValue(obj1) || this.isValue(obj2)) {
                    return {
                        type: this.compareValues(obj1, obj2),
                        data: (obj1 === undefined) ? obj2 : obj1
                    };
                }
                var diff = {};
                for (var key in obj1) {
                    if (this.isFunction(obj1[key])) {
                        continue;
                    }
                    var value2 = undefined;
                    if ('undefined' != typeof (obj2[key])) {
                        value2 = obj2[key];
                    }
                    diff[key] = this.map(obj1[key], value2);
                }
                for (var key in obj2) {
                    if (this.isFunction(obj2[key]) || ('undefined' != typeof (diff[key]))) {
                        continue;
                    }
                    diff[key] = this.map(undefined, obj2[key]);
                }
                return diff;
            },
            compareValues: function (value1, value2) {
                if (value1 === value2) {
                    return this.VALUE_UNCHANGED;
                }
                if (this.isDate(value1) && this.isDate(value2) && value1.getTime() === value2.getTime()) {
                    return this.VALUE_UNCHANGED;
                }
                if ('undefined' == typeof (value1)) {
                    return this.VALUE_CREATED;
                }
                if ('undefined' == typeof (value2)) {
                    return this.VALUE_DELETED;
                }
                return this.VALUE_UPDATED;
            },
            isFunction: function (obj) {
                return {}.toString.apply(obj) === '[object Function]';
            },
            isArray: function (obj) {
                return {}.toString.apply(obj) === '[object Array]';
            },
            isDate: function (obj) {
                return {}.toString.apply(obj) === '[object Date]';
            },
            isObject: function (obj) {
                return {}.toString.apply(obj) === '[object Object]';
            },
            isValue: function (obj) {
                return !this.isObject(obj) && !this.isArray(obj);
            }
        };
    }
};
ConflictService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__main_service__["a" /* MainService */]])
], ConflictService);



/***/ }),

/***/ "./src/app/services/http.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return HttpService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_catch__ = __webpack_require__("./node_modules/rxjs/add/operator/catch.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_catch___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_catch__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_map__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let HttpService = class HttpService {
    constructor(http, mainService) {
        this.http = http;
        this.mainService = mainService;
        this.headers = new __WEBPACK_IMPORTED_MODULE_1__angular_http__["a" /* Headers */]({ 'Content-Type': 'application/json', 'charset': 'UTF-8' });
        this.options = new __WEBPACK_IMPORTED_MODULE_1__angular_http__["d" /* RequestOptions */]({ headers: this.headers });
        // this.baseUrl = 'http://localhost:3000'; // 'https://hq.quickly.com.tr';
        this.baseUrl = 'https://hq.quickly.com.tr';
        // this.baseUrl = 'http://192.168.0.29:3000'
        this.mainService.getAllBy('settings', { key: 'RestaurantInfo' }).then(res => {
            this.store_id = res.docs[0].value._id;
        });
    }
    _createAuthorizationHeader(headers, token) {
        headers.set('Authorization', token);
        headers.set('Store', this.store_id);
    }
    get(url, token) {
        this._createAuthorizationHeader(this.headers, token);
        return this.http.get(this.baseUrl + url, {
            headers: this.headers
        });
    }
    post(url, data, token) {
        this._createAuthorizationHeader(this.headers, token);
        return this.http.post(this.baseUrl + url, data, {
            headers: this.headers
        });
    }
    put(url, data, token) {
        this._createAuthorizationHeader(this.headers, token);
        return this.http.post(this.baseUrl + url, data, {
            headers: this.headers
        });
    }
    delete(url, token) {
        this._createAuthorizationHeader(this.headers, token);
        return this.http.get(this.baseUrl + url, {
            headers: this.headers
        });
    }
};
HttpService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_4__main_service__["a" /* MainService */]])
], HttpService);



/***/ }),

/***/ "./src/app/services/log.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LogService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mocks_log__ = __webpack_require__("./src/app/mocks/log.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__main_service__ = __webpack_require__("./src/app/services/main.service.ts");
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return __WEBPACK_IMPORTED_MODULE_1__mocks_log__["b"]; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let LogService = class LogService {
    constructor(mainService) {
        this.mainService = mainService;
    }
    createLog(type, connection_id, message) {
        this.user = localStorage.getItem('userName');
        let log = new __WEBPACK_IMPORTED_MODULE_1__mocks_log__["a" /* Log */](type, this.user, connection_id, message, 0, Date.now());
        this.mainService.addData('logs', log);
    }
    deleteLog(id) {
        this.mainService.removeData('logs', id);
    }
};
LogService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__main_service__["a" /* MainService */]])
], LogService);



/***/ }),

/***/ "./src/app/services/main.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(Buffer) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MainService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__ = __webpack_require__("pouchdb-browser");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_pouchdb_find__ = __webpack_require__("pouchdb-find");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_pouchdb_find___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_pouchdb_find__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_pouchdb_upsert__ = __webpack_require__("pouchdb-upsert");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_pouchdb_upsert___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_pouchdb_upsert__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_pouch_resolve_conflicts__ = __webpack_require__("./node_modules/pouch-resolve-conflicts/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_pouch_resolve_conflicts___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_pouch_resolve_conflicts__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_pouchdb_adapter_memory__ = __webpack_require__("pouchdb-adapter-memory");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_pouchdb_adapter_memory___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_pouchdb_adapter_memory__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_pouchdb_replication_stream__ = __webpack_require__("./node_modules/pouchdb-replication-stream/lib/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_pouchdb_replication_stream___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_pouchdb_replication_stream__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__providers_electron_service__ = __webpack_require__("./src/app/providers/electron.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








const db_opts_mem = { revs_limit: 1, auto_compaction: true, adapter: 'memory' };
const db_opts_hdd = { revs_limit: 3, auto_compaction: true };
let MainService = class MainService {
    constructor(electronService) {
        this.electronService = electronService;
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_2_pouchdb_find__);
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_3_pouchdb_upsert__);
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_4_pouch_resolve_conflicts__);
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_5_pouchdb_adapter_memory__);
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_6_pouchdb_replication_stream__["plugin"]);
        __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["plugin"](__WEBPACK_IMPORTED_MODULE_6_pouchdb_replication_stream__["plugin"]);
        this.LocalDB = {
            users: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_users', db_opts_mem),
            users_group: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_users_group', db_opts_mem),
            checks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_checks', db_opts_mem),
            closed_checks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_closed_checks', db_opts_mem),
            credits: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_credits', db_opts_hdd),
            customers: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_customers', db_opts_mem),
            orders: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_orders', db_opts_mem),
            receipts: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_receipts', db_opts_mem),
            calls: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_calls', db_opts_mem),
            cashbox: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_cashbox', db_opts_mem),
            cashbox_categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_cashbox_categories', db_opts_hdd),
            categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_categories', db_opts_mem),
            sub_categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_sub_cats', db_opts_mem),
            occations: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_occations', db_opts_mem),
            products: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_products', db_opts_mem),
            recipes: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_recipes', db_opts_mem),
            floors: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_floors', db_opts_mem),
            tables: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_tables', db_opts_mem),
            stocks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_stocks', db_opts_mem),
            stocks_cat: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_stocks_cat', db_opts_mem),
            warehouses: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_warehouses', db_opts_mem),
            endday: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_endday', db_opts_mem),
            reports: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_reports', db_opts_mem),
            logs: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_logs', db_opts_mem),
            commands: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_commands', db_opts_mem),
            comments: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_comments', db_opts_mem),
            prints: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_prints', db_opts_mem),
            settings: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_settings', db_opts_hdd),
            allData: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_alldata', db_opts_hdd)
        };
        this.getAllBy('settings', { key: 'AuthInfo' }).then(res => {
            if (res.docs.length > 0) {
                this.authInfo = res.docs[0].value;
                this.hostname = 'http://' + this.authInfo.app_remote + ':' + this.authInfo.app_port;
                this.ajax_opts = { ajax: { headers: { Authorization: 'Basic ' + Buffer.from(this.authInfo.app_id + ':' + this.authInfo.app_token).toString('base64') } } };
                this.db_prefix = this.authInfo.app_db;
                this.RemoteDB = new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__(this.hostname + this.db_prefix, this.ajax_opts);
            }
        });
        this.getAllBy('settings', { key: 'ServerSettings' }).then(res => {
            if (res.docs.length > 0) {
                let appType = localStorage.getItem('AppType');
                switch (appType) {
                    case 'Primary':
                        this.serverInfo = res.docs.find(obj => obj.key == 'ServerSettings' && obj.value.type == 0).value;
                        break;
                    case 'Secondary':
                        this.serverInfo = res.docs.find(obj => obj.key == 'ServerSettings' && obj.value.type == 1).value;
                    default:
                        break;
                }
                if (this.serverInfo.type == 0) {
                    if (this.serverInfo.status == 1) {
                        this.ServerDB = new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__(`http://${this.serverInfo.ip_address}:${this.serverInfo.ip_port}/${this.serverInfo.key}/appServer`);
                    }
                }
                else if (this.serverInfo.type == 1) {
                    this.RemoteDB = new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__(`http://${this.serverInfo.ip_address}:${this.serverInfo.ip_port}/${this.serverInfo.key}/appServer`);
                }
            }
        });
    }
    getAllData(db) {
        return this.LocalDB[db].allDocs({ include_docs: true });
    }
    getAllBy(db, $schema) {
        return this.LocalDB[db].find({
            selector: $schema,
            limit: 10000
        });
    }
    getData(db, id) {
        return this.LocalDB[db].get(id);
    }
    getBulk(db, docs) {
        return this.LocalDB[db].bulkGet(docs);
    }
    addData(db, schema) {
        return this.LocalDB[db].post(schema).then(res => {
            let doc = Object.assign(schema, { db_name: db, db_seq: 0 });
            delete doc._rev;
            delete doc._rev_tree;
            return this.LocalDB['allData'].put(doc).catch(err => {
                console.log('addData-All', err);
            });
        }).catch(err => {
            console.log('addData-Local', err);
        });
        ;
    }
    changeData(db, id, schema) {
        return this.LocalDB['allData'].upsert(id, schema).then(res => {
            return this.LocalDB[db].upsert(id, schema).catch(err => {
                console.log('changeData-All', err);
            });
        }).catch(err => {
            console.log('changeData-Local', err);
        });
    }
    updateData(db, id, schema) {
        this.LocalDB['allData'].upsert(id, (alldoc) => {
            return Object.assign(alldoc, schema);
        }).catch(err => {
            console.log('updateData-Local', err);
        });
        return this.LocalDB[db].upsert(id, (localdoc) => {
            return Object.assign(localdoc, schema);
        }).catch(err => {
            console.log('updateData-All', err);
        });
    }
    removeData(db, id) {
        this.LocalDB['allData'].get(id).then((doc) => {
            this.LocalDB['allData'].remove(doc).catch(err => {
                console.log('removeData-All', err);
            });
        });
        return this.LocalDB[db].get(id).then((doc) => {
            return this.LocalDB[db].remove(doc).catch(err => {
                console.log('removeData-Local', err);
            });
        });
    }
    putDoc(db, doc) {
        return this.LocalDB[db].put(doc);
    }
    removeDoc(db, doc) {
        return this.LocalDB[db].remove(doc);
    }
    putAll(db, docs) {
        return this.LocalDB[db].bulkDocs(docs);
    }
    removeAll(db, $schema) {
        return this.getAllBy(db, $schema).then(res => {
            return res.docs.map(obj => {
                return { _id: obj._id, _rev: obj._rev, _deleted: true };
            });
        }).then(deleteDocs => {
            return this.LocalDB[db].bulkDocs(deleteDocs);
        });
    }
    createIndex(db, fields) {
        return this.LocalDB[db].createIndex({
            index: {
                fields: fields
            }
        });
    }
    destroyDB(db) {
        if (Array.isArray(db)) {
            return new Promise((resolve, reject) => {
                db.forEach((db_name, index) => {
                    this.LocalDB[db_name].destroy().then(res => {
                        if (res.ok) {
                            console.log(db_name, 'DB destroyed.');
                            if (db.length == index + 1) {
                                resolve({ ok: true });
                            }
                        }
                        else {
                            console.error(db_name, 'DB not destroyed!');
                            reject({ ok: false });
                        }
                    });
                });
            });
        }
        else {
            return this.LocalDB[db].destroy();
        }
    }
    compactDB(db) {
        return this.LocalDB[db].compact();
    }
    initDatabases() {
        const db_opts_mem = { revs_limit: 1, auto_compaction: true, adapter: 'memory' };
        this.LocalDB = {
            users: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_users', db_opts_mem),
            users_group: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_users_group', db_opts_mem),
            checks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_checks', db_opts_mem),
            closed_checks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_closed_checks', db_opts_mem),
            credits: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_credits', db_opts_hdd),
            customers: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_customers', db_opts_mem),
            orders: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_orders', db_opts_mem),
            receipts: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_receipts', db_opts_mem),
            calls: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_calls', db_opts_mem),
            cashbox: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_cashbox', db_opts_mem),
            cashbox_categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_cashbox_categories', db_opts_hdd),
            categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_categories', db_opts_mem),
            sub_categories: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_sub_cats', db_opts_mem),
            occations: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_occations', db_opts_mem),
            products: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_products', db_opts_mem),
            recipes: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_recipes', db_opts_mem),
            floors: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_floors', db_opts_mem),
            tables: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_tables', db_opts_mem),
            stocks: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_stocks', db_opts_mem),
            stocks_cat: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_stocks_cat', db_opts_mem),
            warehouses: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_warehouses', db_opts_mem),
            endday: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_endday', db_opts_mem),
            reports: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_reports', db_opts_mem),
            logs: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_logs', db_opts_mem),
            commands: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_commands', db_opts_mem),
            comments: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_comments', db_opts_mem),
            prints: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_prints', db_opts_mem),
            settings: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_settings', db_opts_hdd),
            allData: new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__('local_alldata', db_opts_hdd)
        };
    }
    localSyncBeforeRemote(local_db) {
        return this.LocalDB[local_db].changes({ since: 'now', include_docs: true }).on('change', (change) => {
            if (change.deleted) {
                this.LocalDB['allData'].get(change.id).then((doc) => {
                    this.LocalDB['allData'].remove(doc);
                });
            }
            else {
                let cData = Object.assign({ db_name: local_db, db_seq: change.seq }, change.doc);
                this.LocalDB['allData'].putIfNotExists(cData).then((res) => {
                    if (!res.updated) {
                        this.LocalDB['allData'].upsert(res.id, function () {
                            return cData;
                        });
                    }
                });
            }
        });
    }
    handleChanges(sync) {
        const changes = sync.change.docs;
        if (sync.direction === 'pull') {
            changes.forEach((element) => {
                if (!element._deleted) {
                    let db = element.db_name;
                    if (element.key !== 'ServerSettings' || element.key !== 'ActivationStatus') {
                        delete element._rev;
                        delete element._revisions;
                        delete element.db_seq;
                        delete element.db_name;
                        this.LocalDB[db].upsert(element._id, (doc) => {
                            return Object.assign(doc, element);
                        }).catch(err => {
                            console.log(err);
                        });
                    }
                }
                else {
                    for (let db in this.LocalDB) {
                        if (db !== 'allData') {
                            this.LocalDB[db].get(element._id).then((doc) => {
                                if (doc)
                                    return this.LocalDB[db].remove(doc);
                            }).catch(err => { });
                        }
                    }
                }
            });
        }
    }
    loadAppData() {
        return new Promise((resolve, reject) => {
            this.getAllBy('allData', {}).then(res => {
                let docs = res.docs;
                let docsWillPut = docs.filter(obj => obj.db_name !== 'settings' && obj.db_name !== 'credits');
                docsWillPut.map(obj => {
                    delete obj.db_seq;
                    delete obj._rev;
                    return obj;
                });
                let promisesAll = [];
                docsWillPut.forEach(element => {
                    const db = element.db_name;
                    delete element.db_name;
                    if (db !== undefined) {
                        let promise = this.LocalDB[db].put(element);
                        promisesAll.push(promise);
                    }
                });
                Promise.all(promisesAll).then(res => {
                    if (res.length == 0) {
                        this.loadFromBackup();
                    }
                    else {
                        console.log('Memory INIT SUCCESS', res);
                        resolve(true);
                    }
                }).catch(err => {
                    console.log(err);
                    console.log('Memory INIT ERR', err.id);
                    //// Should Be False Reject
                    resolve(true);
                    // this.LocalDB['allData'].get(err.id).then(res => {
                    //   console.log(res);
                    // }).catch(err => {
                    //   console.log(err);
                    // })
                });
            }).catch(err => {
                console.log(err);
                reject(false);
            });
        });
    }
    dumpDatabase() {
    }
    syncToLocal(database) {
        let selector;
        if (database) {
            selector = { db_name: database };
        }
        else {
            selector = {};
        }
        return new Promise((resolve, reject) => {
            this.getAllBy('allData', selector).then(res => {
                const docs = res.docs;
                if (docs.length > 0) {
                    docs.forEach((element, index) => {
                        let db = element.db_name;
                        if (db !== undefined) {
                            if (element.key !== 'ServerSettings') {
                                delete element.db_name;
                                delete element.db_seq;
                                delete element._rev;
                                this.LocalDB[db].put(element).then(res => {
                                    if (docs.length == index + 1) {
                                        resolve(true);
                                    }
                                }).catch(err => {
                                    console.log(db, element);
                                });
                            }
                        }
                    });
                }
                else {
                    reject(false);
                }
            });
        });
    }
    loadFromBackup() {
        this.electronService.fileSystem.readFile('./data/db.dat', (err, data) => {
            const rdata = JSON.parse(data.toString('utf-8'));
            this.destroyDB('allData').then(res => {
                if (res.ok) {
                    this.initDatabases();
                    setTimeout(() => {
                        this.putAll('allData', rdata).then(res => {
                            console.log(res);
                            this.electronService.reloadProgram();
                        }).catch(err => {
                            this.electronService.reloadProgram();
                        });
                    }, 2500);
                }
            }).catch(err => {
                console.error(err);
            });
        });
    }
    replicateDB(db_configrations) {
        let db = new __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__(`http://${db_configrations.ip_address}:${db_configrations.ip_port}/${db_configrations.key}/appServer`);
        return db.replicate.to(this.LocalDB['allData'], { batch_size: 500, batches_limit: 50, timeout: 60000 });
    }
    replicateFrom() {
        return this.RemoteDB.replicate.to(this.LocalDB['allData'], { batch_size: 500, batches_limit: 50, timeout: 60000 });
    }
    syncToServer() {
        return __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["sync"](this.LocalDB['allData'], this.ServerDB, {
            batch_size: 500,
            batches_limit: 50,
            timeout: false,
            live: true, retry: true, heartbeat: 2500, back_off_function: (delay) => {
                delay = 1000;
                return delay;
            }
        })
            .on('change', (sync) => { this.handleChanges(sync); })
            .on('complete', (info) => {
            console.log(info);
        })
            // .on('active', () => { console.log('Server Active') })
            // .on('paused', (err) => { console.log('Server Paused', err) })
            .on('error', (err) => { console.error('Server Error', err); });
    }
    syncToRemote() {
        let rOpts = { live: true, retry: true };
        if (this.serverInfo.type == 1) {
            rOpts = {
                // batch_size:250,
                // batches_limit:25,
                timeout: false,
                live: true, retry: true, heartbeat: 2500, back_off_function: (delay) => {
                    delay = 1000;
                    return delay;
                }
            };
        }
        return __WEBPACK_IMPORTED_MODULE_1_pouchdb_browser__["sync"](this.LocalDB['allData'], this.RemoteDB, rOpts)
            .on('change', (sync) => { this.handleChanges(sync); });
        // .on('complete',(info) => {console.log(info)})
        // .on('active', () => { console.log('Remote Active') })
        // .on('paused', (err) => { console.log('Remote Paused', err) })
        // .on('error', (err) => { console.error('Remote Error', err) });
    }
};
MainService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_7__providers_electron_service__["a" /* ElectronService */]])
], MainService);


/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__("./node_modules/buffer/index.js").Buffer))

/***/ }),

/***/ "./src/app/services/market.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MarketService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__http_service__ = __webpack_require__("./src/app/services/http.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let MarketService = class MarketService {
    constructor(httpService) {
        this.httpService = httpService;
    }
};
MarketService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__http_service__["a" /* HttpService */]])
], MarketService);



/***/ }),

/***/ "./src/app/services/settings.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SettingsService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("./node_modules/rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mocks_settings__ = __webpack_require__("./src/app/mocks/settings.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__main_service__ = __webpack_require__("./src/app/services/main.service.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let SettingsService = class SettingsService {
    constructor(mainService) {
        this.mainService = mainService;
        this.AppInformation = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.AppSettings = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.AuthInfo = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.ActivationStatus = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.RestaurantInfo = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.Printers = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.ServerSettings = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.DateSettings = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.CurrencySettings = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.mainService.getAllBy('settings', {}).then((res) => {
            this.Settings = res.docs;
            this.AppSettings.next(this.Settings.find((setting) => setting.key == 'AppSettings'));
            this.AuthInfo.next(this.Settings.find((setting) => setting.key == 'AuthInfo'));
            this.ActivationStatus.next(this.Settings.find((setting) => setting.key == 'ActivationStatus'));
            this.AppInformation.next(this.Settings.find((setting) => setting.key == 'AppInformation'));
            this.RestaurantInfo.next(this.Settings.find((setting) => setting.key == 'RestaurantInfo'));
            this.Printers.next(this.Settings.find((setting) => setting.key == 'Printers'));
            this.DateSettings.next(this.Settings.find((setting) => setting.key == 'DateSettings'));
            this.CurrencySettings.next(this.Settings.find((setting) => setting.key == 'CurrencySettings'));
            let appType = localStorage.getItem('AppType');
            switch (appType) {
                case 'Primary':
                    this.ServerSettings.next(this.Settings.find((setting) => setting.key == 'ServerSettings' && setting.value.type == 0));
                    break;
                case 'Secondary':
                    this.ServerSettings.next(this.Settings.find((setting) => setting.key == 'ServerSettings' && setting.value.type == 1));
                default:
                    break;
            }
        });
    }
    getUser(value) {
        let result;
        switch (value) {
            case 'id':
                result = localStorage.getItem('userID');
                break;
            case 'auth':
                result = localStorage.getItem('userAuth');
                break;
            case 'type':
                result = localStorage.getItem('userType');
                break;
            case 'name':
                result = localStorage.getItem('userName');
                break;
            default:
                break;
        }
        return result;
    }
    setLocalStorage() {
        this.DateSettings.subscribe(res => {
            if (res) {
                localStorage.setItem('DayStatus', JSON.stringify(res.value));
            }
        });
    }
    setAppSettings(Key, SettingsData) {
        let AppSettings = new __WEBPACK_IMPORTED_MODULE_2__mocks_settings__["d" /* Settings */](Key, SettingsData, Key, Date.now());
        return this.mainService.getAllBy('settings', { key: Key }).then(res => {
            return this.mainService.updateData('settings', res.docs[0]._id, AppSettings);
        });
    }
    getPrinters() {
        return this.Printers.asObservable();
    }
    addPrinter(printerData) {
        this.mainService.getAllBy('settings', { key: 'Printers' }).then(res => {
            if (res.docs.length > 0) {
                res.docs[0].value.push(printerData);
                this.mainService.updateData('settings', res.docs[0]._id, res.docs[0]);
                this.Printers.next(res.docs[0]);
            }
            else {
                let printerSettings = new __WEBPACK_IMPORTED_MODULE_2__mocks_settings__["d" /* Settings */]('Printers', [printerData], 'Yazıcılar', Date.now());
                this.mainService.addData('settings', printerSettings);
                this.Printers.next(printerSettings);
            }
        });
    }
    updatePrinter(newPrinter, oldPrinter) {
        this.mainService.getAllBy('settings', { key: 'Printers' }).then(res => {
            res.docs[0].value = res.docs[0].value.filter(obj => obj.name !== oldPrinter.name);
            res.docs[0].value.push(newPrinter);
            this.mainService.updateData('settings', res.docs[0]._id, res.docs[0]);
            this.Printers.next(res.docs[0]);
        });
    }
    removePrinter(printer) {
        this.mainService.getAllBy('settings', { key: 'Printers' }).then(res => {
            res.docs[0].value = res.docs[0].value.filter(obj => obj.name !== printer.name);
            this.mainService.updateData('settings', res.docs[0]._id, res.docs[0]);
            this.Printers.next(res.docs[0]);
        });
    }
    getDate() {
        this.DateSettings.asObservable();
    }
    getActivationStatus() {
        return this.ActivationStatus.asObservable();
    }
    getAppSettings() {
        return this.AppSettings.asObservable();
    }
};
SettingsService = __decorate([
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_3__main_service__["a" /* MainService */]])
], SettingsService);



/***/ }),

/***/ "./src/assets/logo.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "src/assets/logo.svg";

/***/ }),

/***/ "./src/environments/index.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// This file contains production variables. (When you work in PROD MODE)
// This file is use by webpack. Please don't rename it and don't move it to another directory.
const environment = {
    production: true
};
/* harmony export (immutable) */ __webpack_exports__["a"] = environment;



/***/ }),

/***/ "./src/main.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__ = __webpack_require__("./node_modules/@angular/platform-browser-dynamic/esm5/platform-browser-dynamic.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_app_module__ = __webpack_require__("./src/app/app.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_environments__ = __webpack_require__("./src/environments/index.ts");




if (__WEBPACK_IMPORTED_MODULE_3_environments__["a" /* environment */].production) {
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["enableProdMode"])();
}
Object(__WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__["a" /* platformBrowserDynamic */])().bootstrapModule(__WEBPACK_IMPORTED_MODULE_2__app_app_module__["a" /* AppModule */]);


/***/ }),

/***/ 0:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__("./src/main.ts");


/***/ }),

/***/ "buffer":
/***/ (function(module, exports) {

module.exports = require('buffer');

/***/ }),

/***/ "child_process":
/***/ (function(module, exports) {

module.exports = require('child_process');

/***/ }),

/***/ "electron":
/***/ (function(module, exports) {

module.exports = require('electron');

/***/ }),

/***/ "events":
/***/ (function(module, exports) {

module.exports = require('events');

/***/ }),

/***/ "fs":
/***/ (function(module, exports) {

module.exports = require('fs');

/***/ }),

/***/ "net":
/***/ (function(module, exports) {

module.exports = require('net');

/***/ }),

/***/ "os":
/***/ (function(module, exports) {

module.exports = require('os');

/***/ }),

/***/ "path":
/***/ (function(module, exports) {

module.exports = require('path');

/***/ }),

/***/ "pouchdb-adapter-memory":
/***/ (function(module, exports) {

module.exports = require('pouchdb-adapter-memory');

/***/ }),

/***/ "pouchdb-browser":
/***/ (function(module, exports) {

module.exports = require('pouchdb-browser');

/***/ }),

/***/ "pouchdb-find":
/***/ (function(module, exports) {

module.exports = require('pouchdb-find');

/***/ }),

/***/ "pouchdb-upsert":
/***/ (function(module, exports) {

module.exports = require('pouchdb-upsert');

/***/ }),

/***/ "serialport":
/***/ (function(module, exports) {

module.exports = require('serialport');

/***/ }),

/***/ "stream":
/***/ (function(module, exports) {

module.exports = require('stream');

/***/ }),

/***/ "string_decoder":
/***/ (function(module, exports) {

module.exports = require('string_decoder');

/***/ }),

/***/ "usb":
/***/ (function(module, exports) {

module.exports = require('usb');

/***/ }),

/***/ "util":
/***/ (function(module, exports) {

module.exports = require('util');

/***/ }),

/***/ "zlib":
/***/ (function(module, exports) {

module.exports = require('zlib');

/***/ })

},[0]);
//# sourceMappingURL=main.bundle.js.map
//# sourceMappingURL=main.bundle.js.map